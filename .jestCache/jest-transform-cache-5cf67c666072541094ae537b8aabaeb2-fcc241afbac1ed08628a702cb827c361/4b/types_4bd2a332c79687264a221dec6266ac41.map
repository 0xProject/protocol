{"file":"/Users/davidwalsh/code-local/0x-rfq-api/src/entities/types.ts","mappings":"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","names":[],"sources":["/Users/davidwalsh/code-local/0x-rfq-api/src/entities/types.ts"],"sourcesContent":["import { OtcOrderFields } from '@0x/protocol-utils';\r\nimport { BigNumber } from '@0x/utils';\r\n\r\nexport enum RfqTables {\r\n    RfqmV2Quotes = 'rfqm_v2_quotes',\r\n    RfqmV2Jobs = 'rfqm_v2_jobs',\r\n    RfqmV2TransactionSubmissions = 'rfqm_v2_transaction_submissions',\r\n}\r\n\r\nexport enum RfqmJobStatus {\r\n    // Transaction has been enqueued and will be processed once a worker is available\r\n    PendingEnqueued = 'pending_enqueued',\r\n    // Transaction has passed initial validation. Last look will be executed and transaction will be submitted if last look is accepted.\r\n    PendingProcessing = 'pending_processing',\r\n    // For v1 orders, the last look has been approved. For v2 orders, the market maker has signed the order.\r\n    PendingLastLookAccepted = 'pending_last_look_accepted',\r\n    // Transaction has passed initial verification and has been submitted to the mem pool\r\n    PendingSubmitted = 'pending_submitted',\r\n\r\n    // Eth Call made before transaction submission was unsuccessful\r\n    FailedEthCallFailed = 'failed_eth_call_failed',\r\n    // Transaction has expired prior to eth call or worker is not available to make an eth call\r\n    FailedExpired = 'failed_expired',\r\n    // Market Maker declined the last look\r\n    FailedLastLookDeclined = 'failed_last_look_declined',\r\n    // [RFQM v2] Balance checks executed before obtaining market maker signature failed\r\n    FailedPresignValidationFailed = 'failed_presign_validation_failed',\r\n    // Transaction was reverted more than 3 blocks ago\r\n    FailedRevertedConfirmed = 'failed_reverted_confirmed',\r\n    // Transaction was reverted less than 3 blocks ago\r\n    FailedRevertedUnconfirmed = 'failed_reverted_unconfirmed',\r\n    // Obtaining the market maker's signature for a v2 order failed.\r\n    // This is NOT a status for the case where the market maker intentionally declined to sign.\r\n    FailedSignFailed = 'failed_sign_failed',\r\n    // Submitting the transaction to the network was unsuccessful\r\n    FailedSubmitFailed = 'failed_submit_failed',\r\n    // Transaction does not contain call data\r\n    FailedValidationNoCallData = 'failed_validation_no_call_data',\r\n    // Transaction does not include a maker URI\r\n    FailedValidationNoMakerUri = 'failed_validation_no_maker_uri',\r\n    // Job has been submitted with no taker signuature\r\n    FailedValidationNoTakerSignature = 'failed_validation_no_taker_signature',\r\n    // Transaction does not contain an order\r\n    FailedValidationNoOrder = 'failed_validation_no_order',\r\n    // Transaction does not contain a fee\r\n    FailedValidationNoFee = 'failed_validation_no_fee',\r\n\r\n    // Transaction has succeeded with 3 subsequent blocks\r\n    SucceededConfirmed = 'succeeded_confirmed',\r\n    // Transaction was successfully mined and filled\r\n    SucceededUnconfirmed = 'succeeded_unconfirmed',\r\n}\r\n\r\n// From https://0xproject.quip.com/ixNbA6mmn1KT/Error-reason-on-RFQm-zerog-status\r\nexport enum JobFailureReason {\r\n    TransactionSimulationFailed = 'transaction_simulation_failed',\r\n    OrderExpired = 'order_expired',\r\n    LastLookDeclined = 'last_look_declined',\r\n    TransactionReverted = 'transaction_reverted',\r\n    MarketMakerSignatureError = 'market_maker_sigature_error',\r\n    InvalidBalance = 'invalid_balance',\r\n    InternalError = 'internal_error', // fallback error reason\r\n}\r\n\r\n/**\r\n * Determines whether or not a given `RfqmJobStatus` indicates\r\n * the associated job has been processed to completion or not.\r\n *\r\n * Returns `true` if the status indicates the associated job is\r\n * resolved and should not be retried; returns `false` if the\r\n * associated job is in an incomplete state and should be retried.\r\n */\r\nfunction isJobResolved(status: RfqmJobStatus): boolean {\r\n    switch (status) {\r\n        case RfqmJobStatus.FailedEthCallFailed:\r\n        case RfqmJobStatus.FailedExpired:\r\n        case RfqmJobStatus.FailedLastLookDeclined:\r\n        case RfqmJobStatus.FailedPresignValidationFailed:\r\n        case RfqmJobStatus.FailedRevertedConfirmed:\r\n        case RfqmJobStatus.FailedSignFailed:\r\n        case RfqmJobStatus.FailedSubmitFailed:\r\n        case RfqmJobStatus.FailedValidationNoCallData:\r\n        case RfqmJobStatus.FailedValidationNoFee:\r\n        case RfqmJobStatus.FailedValidationNoMakerUri:\r\n        case RfqmJobStatus.FailedValidationNoOrder:\r\n        case RfqmJobStatus.FailedValidationNoTakerSignature:\r\n        case RfqmJobStatus.SucceededConfirmed:\r\n            return true;\r\n        case RfqmJobStatus.FailedRevertedUnconfirmed:\r\n        case RfqmJobStatus.PendingEnqueued:\r\n        case RfqmJobStatus.PendingLastLookAccepted:\r\n        case RfqmJobStatus.PendingProcessing:\r\n        case RfqmJobStatus.PendingSubmitted:\r\n        case RfqmJobStatus.SucceededUnconfirmed:\r\n            return false;\r\n        default:\r\n            ((_x: never) => {\r\n                throw new Error('unreachable');\r\n            })(status);\r\n    }\r\n}\r\n\r\n/**\r\n * `RfqmJobStatus` values which should be considered incomplete\r\n * and should be retried.\r\n */\r\nexport const UnresolvedRfqmJobStatuses = Object.values(RfqmJobStatus).filter((v) => !isJobResolved(v));\r\n\r\nexport enum RfqmTransactionSubmissionType {\r\n    Trade = 'trade',\r\n    Approval = 'approval',\r\n}\r\n\r\nexport enum RfqmTransactionSubmissionStatus {\r\n    DroppedAndReplaced = 'dropped_and_replaced',\r\n    Presubmit = 'presubmit', // Transaction created but not yet broadcast\r\n    RevertedConfirmed = 'reverted_confirmed',\r\n    RevertedUnconfirmed = 'reverted_unconfirmed',\r\n    Submitted = 'submitted',\r\n    SucceededConfirmed = 'succeeded_confirmed',\r\n    SucceededUnconfirmed = 'succeeded_unconfirmed',\r\n}\r\n\r\n/**\r\n * `SubmissionContext` contains multiple submissions with different gas prices. `SubmissionContextStatus`\r\n * is the collective status of all submissions contained within the submission context. It marks the final result of a\r\n * submission action which may contain several submission attempts.\r\n */\r\nexport enum SubmissionContextStatus {\r\n    FailedExpired = 'failed_expired',\r\n    FailedRevertedConfirmed = 'failed_reverted_confirmed',\r\n    FailedRevertedUnconfirmed = 'failed_reverted_unconfirmed',\r\n    PendingSubmitted = 'pending_submitted',\r\n    SucceededConfirmed = 'succeeded_confirmed',\r\n    SucceededUnconfirmed = 'succeeded_unconfirmed',\r\n}\r\n\r\nexport interface TransactionEntityOpts {\r\n    refHash: string;\r\n    apiKey?: string;\r\n    txHash?: string;\r\n    takerAddress?: string;\r\n    status: string;\r\n    expectedMinedInSec: number;\r\n    to: string;\r\n    data?: string;\r\n    value?: BigNumber;\r\n    from?: string;\r\n    nonce?: number;\r\n    gasPrice?: BigNumber;\r\n    gas?: number | null;\r\n    gasUsed?: number | null;\r\n    blockNumber?: number;\r\n    // Ethereum tx status, 1 == success, 0 == failure\r\n    txStatus?: number | null;\r\n}\r\n\r\nexport enum RfqmOrderTypes {\r\n    V4Rfq = 'v4Rfq',\r\n    Otc = 'otc',\r\n}\r\n\r\n/******* OTC ********/\r\nexport interface StoredOtcOrder {\r\n    type: RfqmOrderTypes.Otc;\r\n    order: StringOtcOrderFields;\r\n}\r\n\r\nexport type StringOtcOrderFields = Record<keyof OtcOrderFields, string>;\r\n"],"version":3}