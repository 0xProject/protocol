{"file":"/Users/davidwalsh/code-local/0x-rfq-api/test/rfq_blockchain_utils_test.ts","mappings":"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","names":[],"sources":["/Users/davidwalsh/code-local/0x-rfq-api/test/rfq_blockchain_utils_test.ts"],"sourcesContent":["// tslint:disable custom-no-magic-numbers\n// tslint:disable await-promise\n// tslint:disable max-file-line-count\nimport { artifacts as assetSwapperArtifacts, BalanceCheckerContract } from '@0x/asset-swapper';\nimport { ChainId } from '@0x/contract-addresses';\nimport { artifacts as erc20Artifacts, DummyERC20TokenContract } from '@0x/contracts-erc20';\nimport { artifacts as zeroExArtifacts, fullMigrateAsync, IZeroExContract } from '@0x/contracts-zero-ex';\nimport { Web3ProviderEngine } from '@0x/dev-utils';\nimport { ethSignHashWithProviderAsync, OtcOrder, RfqOrder, Signature } from '@0x/protocol-utils';\nimport { BigNumber } from '@0x/utils';\nimport { TxData, Web3Wrapper } from '@0x/web3-wrapper';\nimport { expect } from 'chai';\nimport { Contract, providers, Wallet } from 'ethers';\n\nimport { ONE_MINUTE_MS, ZERO } from '../src/core/constants';\nimport { BalanceChecker } from '../src/utils/balance_checker';\nimport { RfqBlockchainUtils } from '../src/utils/rfq_blockchain_utils';\n\nimport {\n    getProvider,\n    MATCHA_AFFILIATE_ADDRESS,\n    MOCK_EXECUTE_META_TRANSACTION_APPROVAL,\n    MOCK_EXECUTE_META_TRANSACTION_CALLDATA,\n    MOCK_PERMIT_APPROVAL,\n    MOCK_PERMIT_CALLDATA,\n    TEST_RFQ_ORDER_FILLED_EVENT_LOG,\n    TEST_RFQ_ORDER_FILLED_EVENT_TAKER_AMOUNT,\n    WORKER_TEST_PRIVATE_KEY,\n} from './constants';\nimport { setupDependenciesAsync, TeardownDependenciesFunctionHandle } from './test_utils/deployment';\n\nconst GAS_PRICE = 1e9;\nconst VALID_EXPIRY = new BigNumber(9000000000);\nconst CHAIN_ID = ChainId.Ganache;\n\njest.setTimeout(ONE_MINUTE_MS * 2);\nlet teardownDependencies: TeardownDependenciesFunctionHandle;\n\ndescribe('RFQ Blockchain Utils', () => {\n    let provider: Web3ProviderEngine;\n    let makerToken: DummyERC20TokenContract;\n    let takerToken: DummyERC20TokenContract;\n    let makerAmount: BigNumber;\n    let takerAmount: BigNumber;\n    let invalidTakerAmount: BigNumber;\n    let makerBalance: BigNumber;\n    let takerBalance: BigNumber;\n    let web3Wrapper: Web3Wrapper;\n    let owner: string;\n    let maker: string;\n    let taker: string;\n    let signer: string;\n    let txOrigin: string;\n    let zeroEx: IZeroExContract;\n    let rfqOrder: RfqOrder;\n    let otcOrder: OtcOrder;\n    let unfillableRfqOrder: RfqOrder;\n    let rfqBlockchainUtils: RfqBlockchainUtils;\n    let orderSig: Signature;\n    let sigForUnfillableOrder: Signature;\n    let makerOtcOrderSig: Signature;\n    let takerOtcOrderSig: Signature;\n\n    beforeAll(async () => {\n        teardownDependencies = await setupDependenciesAsync(['ganache']);\n        provider = getProvider();\n        web3Wrapper = new Web3Wrapper(provider);\n\n        [owner, maker, taker, txOrigin, signer] = await web3Wrapper.getAvailableAddressesAsync();\n\n        // Deploy dummy tokens\n        makerToken = await DummyERC20TokenContract.deployFrom0xArtifactAsync(\n            erc20Artifacts.DummyERC20Token,\n            provider,\n            { from: maker, gas: 10000000 },\n            {},\n            'The token that originally belongs to the maker',\n            'makerToken',\n            new BigNumber(18),\n            new BigNumber(0),\n        );\n\n        takerToken = await DummyERC20TokenContract.deployFrom0xArtifactAsync(\n            erc20Artifacts.DummyERC20Token,\n            provider,\n            { from: taker, gas: 10000000 },\n            {},\n            'The token that originally belongs to the maker',\n            'takerToken',\n            new BigNumber(18),\n            new BigNumber(0),\n        );\n\n        // Deploy Balance Checker (only necessary for Ganache because ganache doesn't have overrides)\n        const balanceCheckerContract = await BalanceCheckerContract.deployFrom0xArtifactAsync(\n            assetSwapperArtifacts.BalanceChecker,\n            provider,\n            { from: owner, gas: 10000000 },\n            {},\n        );\n        const balanceChecker = new BalanceChecker(provider, balanceCheckerContract);\n\n        makerAmount = new BigNumber(100);\n        takerAmount = new BigNumber(50);\n        invalidTakerAmount = new BigNumber(10000000);\n\n        // Deploy ZeroEx to Ganache\n        zeroEx = await fullMigrateAsync(\n            owner,\n            provider,\n            { from: owner, gasPrice: GAS_PRICE },\n            {},\n            { protocolFeeMultiplier: Number(0) },\n            {\n                nativeOrders: zeroExArtifacts.NativeOrdersFeature,\n                metaTransactions: zeroExArtifacts.MetaTransactionsFeature,\n            },\n        );\n\n        // Prepare an RfqOrder\n        rfqOrder = new RfqOrder({\n            makerToken: makerToken.address,\n            takerToken: takerToken.address,\n            makerAmount,\n            takerAmount,\n            maker,\n            taker,\n            txOrigin,\n            expiry: VALID_EXPIRY,\n            salt: new BigNumber(1),\n            verifyingContract: zeroEx.address,\n            chainId: CHAIN_ID,\n        });\n        orderSig = await rfqOrder.getSignatureWithProviderAsync(provider);\n\n        // Prepare an Unfillable RfqOrder\n        unfillableRfqOrder = new RfqOrder({\n            makerToken: makerToken.address,\n            takerToken: takerToken.address,\n            makerAmount,\n            takerAmount: invalidTakerAmount,\n            maker,\n            taker,\n            txOrigin,\n            expiry: VALID_EXPIRY,\n            salt: new BigNumber(1),\n            verifyingContract: zeroEx.address,\n            chainId: CHAIN_ID,\n        });\n        sigForUnfillableOrder = await unfillableRfqOrder.getSignatureWithProviderAsync(provider);\n\n        // Prepare an OtcOrder and valid signatures\n        otcOrder = new OtcOrder({\n            maker,\n            taker,\n            makerAmount,\n            takerAmount,\n            makerToken: makerToken.address,\n            takerToken: takerToken.address,\n            txOrigin,\n            expiryAndNonce: OtcOrder.encodeExpiryAndNonce(\n                new BigNumber(VALID_EXPIRY),\n                ZERO,\n                new BigNumber(VALID_EXPIRY),\n            ),\n            chainId: CHAIN_ID,\n            verifyingContract: zeroEx.address,\n        });\n        const orderHash = otcOrder.getHash();\n        makerOtcOrderSig = await ethSignHashWithProviderAsync(orderHash, maker, provider);\n        takerOtcOrderSig = await ethSignHashWithProviderAsync(orderHash, taker, provider);\n\n        // Mint enough tokens for a few trades\n        const numTrades = 2;\n        makerBalance = makerAmount.times(numTrades);\n        takerBalance = takerAmount.times(numTrades);\n\n        await makerToken.mint(makerBalance).awaitTransactionSuccessAsync({ from: maker });\n        await makerToken.approve(zeroEx.address, makerBalance.times(2)).awaitTransactionSuccessAsync({ from: maker });\n        await takerToken.mint(takerBalance).awaitTransactionSuccessAsync({ from: taker });\n        await takerToken.approve(zeroEx.address, takerBalance.times(2)).awaitTransactionSuccessAsync({ from: taker });\n\n        const ethersProvider = new providers.JsonRpcProvider();\n        const ethersWallet = new Wallet(WORKER_TEST_PRIVATE_KEY, ethersProvider);\n\n        rfqBlockchainUtils = new RfqBlockchainUtils(\n            provider,\n            zeroEx.address,\n            balanceChecker,\n            ethersProvider,\n            ethersWallet,\n        );\n    });\n\n    afterAll(async () => {\n        if (!teardownDependencies()) {\n            throw new Error('Failed to tear down dependencies');\n        }\n    });\n\n    describe('getMinOfBalancesAndAllowancesAsync', () => {\n        it('should fetch min of token balances and allowances', async () => {\n            const addresses = [\n                { owner: maker, token: makerToken.address },\n                { owner: maker, token: takerToken.address },\n                { owner: taker, token: makerToken.address },\n                { owner: taker, token: takerToken.address },\n            ];\n            const res = await rfqBlockchainUtils.getMinOfBalancesAndAllowancesAsync(addresses);\n            expect(res).to.deep.eq([makerBalance, ZERO, ZERO, takerBalance]);\n        });\n    });\n\n    describe('getTokenBalancesAsync', () => {\n        it('should fetch token balances', async () => {\n            const addresses = [\n                { owner: maker, token: makerToken.address },\n                { owner: maker, token: takerToken.address },\n                { owner: taker, token: makerToken.address },\n                { owner: taker, token: takerToken.address },\n            ];\n            const res = await rfqBlockchainUtils.getTokenBalancesAsync(addresses);\n            expect(res).to.deep.eq([makerBalance, ZERO, ZERO, takerBalance]);\n        });\n    });\n\n    describe('OtcOrder', () => {\n        describe('estimateGasForFillTakerSignedOtcOrderAsync', () => {\n            it('does not throw an error on valid order', async () => {\n                try {\n                    const gasEstimate = await rfqBlockchainUtils.estimateGasForFillTakerSignedOtcOrderAsync(\n                        otcOrder,\n                        makerOtcOrderSig,\n                        takerOtcOrderSig,\n                        txOrigin,\n                        false,\n                    );\n                    expect(gasEstimate).to.be.greaterThan(0);\n                } catch (err) {\n                    expect.fail('should not throw');\n                }\n            });\n\n            it('throws an error if order is invalid', async () => {\n                const invalidOtcOrder = new OtcOrder({\n                    maker,\n                    taker,\n                    makerAmount,\n                    takerAmount,\n                    makerToken: makerToken.address,\n                    takerToken: takerToken.address,\n                    txOrigin,\n                    expiryAndNonce: OtcOrder.encodeExpiryAndNonce(\n                        ZERO, // expired\n                        ZERO,\n                        VALID_EXPIRY,\n                    ),\n                    chainId: CHAIN_ID,\n                    verifyingContract: zeroEx.address,\n                });\n                const orderHash = invalidOtcOrder.getHash();\n\n                const makerSig = await ethSignHashWithProviderAsync(orderHash, maker, provider);\n                const takerSig = await ethSignHashWithProviderAsync(orderHash, taker, provider);\n\n                expect(\n                    rfqBlockchainUtils.estimateGasForFillTakerSignedOtcOrderAsync(\n                        invalidOtcOrder, // invalid order, should be expired\n                        makerSig,\n                        takerSig,\n                        txOrigin,\n                        false,\n                    ),\n                ).to.eventually.be.rejectedWith(/revert/);\n            });\n\n            it('throws an error if signatures invalid', async () => {\n                expect(\n                    rfqBlockchainUtils.estimateGasForFillTakerSignedOtcOrderAsync(\n                        otcOrder,\n                        makerOtcOrderSig,\n                        makerOtcOrderSig, // wrong signature\n                        txOrigin,\n                        false,\n                    ),\n                ).to.eventually.be.rejectedWith('revert');\n            });\n        });\n    });\n\n    describe('validateMetaTransaction', () => {\n        it('returns successful filled amounts for a valid metatransaction', async () => {\n            const metaTx = rfqBlockchainUtils.generateMetaTransaction(rfqOrder, orderSig, taker, takerAmount, CHAIN_ID);\n            const metaTxSig = await metaTx.getSignatureWithProviderAsync(provider);\n            const res = await rfqBlockchainUtils.validateMetaTransactionOrThrowAsync(metaTx, metaTxSig, txOrigin);\n\n            expect(res[0]).to.deep.equal(takerAmount);\n            expect(res[1]).to.deep.equal(makerAmount);\n        });\n\n        it('throws for a metatransaction with an invalid signature', async () => {\n            const metaTx = rfqBlockchainUtils.generateMetaTransaction(rfqOrder, orderSig, taker, takerAmount, CHAIN_ID);\n            const invalidMetaTxSig = orderSig;\n\n            expect(\n                rfqBlockchainUtils.validateMetaTransactionOrThrowAsync(metaTx, invalidMetaTxSig, txOrigin),\n            ).to.eventually.be.rejectedWith('SignatureValidationError');\n        });\n\n        it('throws for a metatransaction with an unfillable order', async () => {\n            const metaTx = rfqBlockchainUtils.generateMetaTransaction(\n                unfillableRfqOrder,\n                sigForUnfillableOrder,\n                taker,\n                invalidTakerAmount,\n                CHAIN_ID,\n            );\n            const metaTxSig = await metaTx.getSignatureWithProviderAsync(provider);\n\n            expect(\n                rfqBlockchainUtils.validateMetaTransactionOrThrowAsync(metaTx, metaTxSig, txOrigin),\n            ).to.eventually.be.rejectedWith('MetaTransactionCallFailedError');\n        });\n\n        it('returns successful filled amounts for a valid metatransaction when validating calldata', async () => {\n            const metaTx = rfqBlockchainUtils.generateMetaTransaction(rfqOrder, orderSig, taker, takerAmount, CHAIN_ID);\n            const metaTxSig = await metaTx.getSignatureWithProviderAsync(provider);\n\n            const callData = rfqBlockchainUtils.generateMetaTransactionCallData(\n                metaTx,\n                metaTxSig,\n                MATCHA_AFFILIATE_ADDRESS,\n            );\n            const res = await rfqBlockchainUtils.decodeMetaTransactionCallDataAndValidateAsync(callData, txOrigin);\n\n            expect(res[0]).to.deep.equal(takerAmount);\n            expect(res[1]).to.deep.equal(makerAmount);\n        });\n        it('throws for a metatransaction with an invalid signature when validating calldata', async () => {\n            const metaTx = rfqBlockchainUtils.generateMetaTransaction(rfqOrder, orderSig, taker, takerAmount, CHAIN_ID);\n            const invalidMetaTxSig = orderSig;\n\n            const callData = rfqBlockchainUtils.generateMetaTransactionCallData(\n                metaTx,\n                invalidMetaTxSig,\n                MATCHA_AFFILIATE_ADDRESS,\n            );\n\n            expect(\n                rfqBlockchainUtils.decodeMetaTransactionCallDataAndValidateAsync(callData, txOrigin),\n            ).to.eventually.be.rejectedWith('SignatureValidationError');\n        });\n\n        it('throws for a metatransaction with an unfillable order when validating calldata', async () => {\n            const metaTx = rfqBlockchainUtils.generateMetaTransaction(\n                unfillableRfqOrder,\n                sigForUnfillableOrder,\n                taker,\n                invalidTakerAmount,\n                CHAIN_ID,\n            );\n            const metaTxSig = await metaTx.getSignatureWithProviderAsync(provider);\n\n            const callData = rfqBlockchainUtils.generateMetaTransactionCallData(\n                metaTx,\n                metaTxSig,\n                MATCHA_AFFILIATE_ADDRESS,\n            );\n\n            expect(\n                rfqBlockchainUtils.decodeMetaTransactionCallDataAndValidateAsync(callData, txOrigin),\n            ).to.eventually.be.rejectedWith('MetaTransactionCallFailedError');\n        });\n\n        it('should throw for a partially filled order', async () => {\n            const metaTx1 = rfqBlockchainUtils.generateMetaTransaction(\n                rfqOrder,\n                orderSig,\n                taker,\n                takerAmount.div(2),\n                CHAIN_ID,\n            );\n            const metaTxSig1 = await metaTx1.getSignatureWithProviderAsync(provider);\n\n            await zeroEx.executeMetaTransaction(metaTx1, metaTxSig1).awaitTransactionSuccessAsync({ from: txOrigin });\n\n            const metaTx2 = rfqBlockchainUtils.generateMetaTransaction(\n                rfqOrder,\n                orderSig,\n                taker,\n                takerAmount,\n                CHAIN_ID,\n            );\n            const metaTxSig2 = await metaTx2.getSignatureWithProviderAsync(provider);\n\n            expect(\n                rfqBlockchainUtils.validateMetaTransactionOrThrowAsync(metaTx2, metaTxSig2, txOrigin),\n            ).to.eventually.be.rejectedWith('filled amount is less than requested fill amount');\n        });\n    });\n\n    describe('transformTxDataToTransactionRequest', () => {\n        it('creates a TransactionRequest', () => {\n            const txOptions: TxData = {\n                from: '0xfromaddress',\n                gas: new BigNumber(210000000),\n                maxFeePerGas: new BigNumber(200000),\n                maxPriorityFeePerGas: new BigNumber(100000),\n                nonce: 21,\n                to: '0xtoaddress',\n                value: 0,\n            };\n\n            const result = rfqBlockchainUtils.transformTxDataToTransactionRequest(\n                txOptions,\n                /* chainId = */ 1337,\n                /* callData */ '0x01234',\n            );\n\n            expect(result.from).to.equal('0xfromaddress');\n            expect(result.gasLimit).to.equal(BigInt(210000000));\n            expect(result.maxFeePerGas).to.equal(BigInt(200000));\n            expect(result.maxPriorityFeePerGas).to.equal(BigInt(100000));\n            expect(result.nonce).to.equal(21);\n            expect(result.to).to.equal('0xtoaddress');\n            expect(result.value).to.equal(0);\n        });\n\n        it(\"uses the proxy address if no 'to' address is provided\", () => {\n            const txOptions: TxData = { from: '0xfromaddress' };\n\n            const result = rfqBlockchainUtils.transformTxDataToTransactionRequest(txOptions);\n\n            expect(result.to).to.equal(zeroEx.address);\n        });\n    });\n\n    describe('getDecodedRfqOrderFillEventLogFromLogs', () => {\n        it('correctly parses an RfqOrderFillEvent from logs', async () => {\n            const rfqOrderFilledEvent = rfqBlockchainUtils.getDecodedRfqOrderFillEventLogFromLogs([\n                TEST_RFQ_ORDER_FILLED_EVENT_LOG,\n            ]);\n\n            expect(rfqOrderFilledEvent.args.takerTokenFilledAmount).to.deep.eq(\n                TEST_RFQ_ORDER_FILLED_EVENT_TAKER_AMOUNT,\n            );\n            expect(rfqOrderFilledEvent.blockNumber).to.deep.eq(TEST_RFQ_ORDER_FILLED_EVENT_LOG.blockNumber);\n        });\n    });\n\n    describe('getTokenDecimalsAsync', () => {\n        it('gets the token decimals', async () => {\n            const decimals = await rfqBlockchainUtils.getTokenDecimalsAsync(makerToken.address);\n\n            expect(decimals).to.equal(18);\n        });\n\n        it('throws if the contract does not exist', () => {\n            // tslint:disable-next-line: no-unused-expression no-unbound-method\n            expect(rfqBlockchainUtils.getTokenDecimalsAsync('0x29D7d1dd5B6f9C864d9db560D72a247c178aE86B')).to.be\n                .rejected;\n        });\n    });\n\n    describe('isValidOrderSigner', () => {\n        it('returns false if signer is not valid', async () => {\n            const isValidOrderSigner = await rfqBlockchainUtils.isValidOrderSignerAsync(maker, signer);\n            expect(isValidOrderSigner).to.equal(false);\n        });\n\n        it('returns true when valid signer address is passed', async () => {\n            await rfqBlockchainUtils.registerAllowedOrderSignerAsync(maker, signer, true);\n\n            const isValidOrderSigner = await rfqBlockchainUtils.isValidOrderSignerAsync(maker, signer);\n            expect(isValidOrderSigner).to.equal(true);\n        });\n    });\n\n    describe('generateApprovalCalldataAsync', () => {\n        it('generates executeMetaTransaction calldata', async () => {\n            const token = makerToken.address;\n            const approval = MOCK_EXECUTE_META_TRANSACTION_APPROVAL;\n            const signature: Signature = {\n                r: '0x0000000000000000000000000000000000000000000000000000000000000000',\n                s: '0x0000000000000000000000000000000000000000000000000000000000000000',\n                v: 28,\n                signatureType: 2,\n            };\n            const calldata = await rfqBlockchainUtils.generateApprovalCalldataAsync(token, approval, signature);\n            expect(calldata).to.eq(MOCK_EXECUTE_META_TRANSACTION_CALLDATA);\n        });\n\n        it('generates permit calldata', async () => {\n            const token = makerToken.address;\n            const approval = MOCK_PERMIT_APPROVAL;\n            const signature: Signature = {\n                r: '0x0000000000000000000000000000000000000000000000000000000000000000',\n                s: '0x0000000000000000000000000000000000000000000000000000000000000000',\n                v: 28,\n                signatureType: 2,\n            };\n            const calldata = await rfqBlockchainUtils.generateApprovalCalldataAsync(token, approval, signature);\n            expect(calldata).to.eq(MOCK_PERMIT_CALLDATA);\n        });\n    });\n\n    describe('estimateGasForAsync', () => {\n        it('throws exception on invalid calldata', async () => {\n            const erc20AbiDecimals = `[{\n                \"constant\": true,\n                \"inputs\": [],\n                \"name\": \"decimals\",\n                \"outputs\": [\n                    {\n                        \"name\": \"\",\n                        \"type\": \"uint8\"\n                    }\n                ],\n                \"payable\": false,\n                \"stateMutability\": \"view\",\n                \"type\": \"function\"\n            }]`;\n            const erc20 = new Contract(takerToken.address, erc20AbiDecimals);\n            const { data: calldata } = await erc20.populateTransaction.decimals();\n            if (!calldata) {\n                throw new Error('calldata for decimals should not be undefined or empty');\n            }\n            const invalidCalldata = `${calldata.substring(0, calldata.length - 1)}0`;\n\n            try {\n                await rfqBlockchainUtils.estimateGasForAsync({ to: takerToken.address, data: invalidCalldata });\n                expect.fail();\n            } catch (e) {\n                expect(e.message).to.contain('estimateGasForAsync');\n            }\n        });\n\n        it('successfully estimates gas', async () => {\n            const erc20AbiDecimals = `[{\n                \"constant\": true,\n                \"inputs\": [],\n                \"name\": \"decimals\",\n                \"outputs\": [\n                    {\n                        \"name\": \"\",\n                        \"type\": \"uint8\"\n                    }\n                ],\n                \"payable\": false,\n                \"stateMutability\": \"view\",\n                \"type\": \"function\"\n            }]`;\n            const erc20 = new Contract(takerToken.address, erc20AbiDecimals);\n            const { data: calldata } = await erc20.populateTransaction.decimals();\n            if (!calldata) {\n                throw new Error('calldata for decimals should not be undefined or empty');\n            }\n\n            await rfqBlockchainUtils.estimateGasForAsync({ to: takerToken.address, data: calldata });\n        });\n    });\n});\n"],"version":3}