{"file":"/Users/davidwalsh/code-local/0x-rfq-api/src/utils/address_utils.ts","mappings":";;;AAAA,6CAAsE;AAEtE,uDAA6D;AAC7D,qCAAyC;AAIzC;;;GAGG;AACI,MAAM,0BAA0B,GAAG,CAAI,GAAM,EAAE,EAAE;IACpD,6DAA6D;IAC7D,8DAA8D;IAC9D,MAAM,UAAU,GAA2B,EAAE,CAAC;IAC9C,KAAK,MAAM,CAAC,GAAG,EAAE,KAAK,CAAC,IAAI,MAAM,CAAC,OAAO,CAAC,GAAG,CAAC,EAAE;QAC5C,IAAI,KAAK,IAAI,oBAAY,CAAC,SAAS,CAAC,KAAe,CAAC,EAAE;YAClD,UAAU,CAAC,GAAG,CAAC,GAAI,KAAgB,CAAC,WAAW,EAAE,CAAC;SACrD;KACJ;IAED,OAAO;QACH,GAAG,GAAG;QACN,GAAG,UAAU;KAChB,CAAC;AACN,CAAC,CAAC;AAdW,QAAA,0BAA0B,8BAcrC;AAEF;;;;;GAKG;AACH,SAAgB,+BAA+B,CAAC,OAAe,EAAE,KAAa,EAAE,OAAgB;IAC5F,IAAI;QACA,OAAO,IAAA,wCAAuB,EAAC,OAAO,EAAE,OAAO,CAAC,CAAC;KACpD;IAAC,OAAO,CAAC,EAAE;QACR,MAAM,IAAI,2BAAe,CAAC;YACtB;gBACI,KAAK;gBACL,IAAI,EAAE,gCAAoB,CAAC,eAAe;gBAC1C,MAAM,EAAE,CAAC,CAAC,OAAO;aACpB;SACJ,CAAC,CAAC;KACN;AACL,CAAC;AAZD,0EAYC;AAED;;;GAGG;AACH,SAAgB,cAAc,CAAC,WAAsC;IACjE,MAAM,UAAU,GAA2C,EAAE,MAAM,EAAE,EAAE,EAAE,MAAM,EAAE,EAAE,EAAE,CAAC;IACtF,IAAI,KAAK,CAAC,OAAO,CAAC,WAAW,CAAC,EAAE;QAC5B,OAAO,WAAW,CAAC,MAAM,CAAC,CAAC,EAAE,MAAM,EAAE,MAAM,EAAE,EAAE,UAAU,EAAE,EAAE;YACzD,OAAO;gBACH,MAAM,EAAE,MAAM,CAAC,MAAM,CAAC,UAAU,CAAC,KAAK,CAAC;gBACvC,MAAM,EAAE,MAAM,CAAC,MAAM,CAAC,UAAU,CAAC,KAAK,CAAC;aAC1C,CAAC;QACN,CAAC,EAAE,UAAU,CAAC,CAAC;KAClB;SAAM;QACH,OAAO;YACH,MAAM,EAAE,CAAC,WAAW,CAAC,KAAK,CAAC;YAC3B,MAAM,EAAE,CAAC,WAAW,CAAC,KAAK,CAAC;SAC9B,CAAC;KACL;AACL,CAAC;AAfD,wCAeC","names":[],"sources":["/Users/davidwalsh/code-local/0x-rfq-api/src/utils/address_utils.ts"],"sourcesContent":["import { ValidationError, ValidationErrorCodes } from '@0x/api-utils';\r\nimport { ChainId } from '@0x/contract-addresses';\r\nimport { findTokenAddressOrThrow } from '@0x/token-metadata';\r\nimport { addressUtils } from '@0x/utils';\r\n\r\nimport { ERC20Owner } from '../core/types';\r\n\r\n/**\r\n * Checks top level attributes of an object for values matching an ETH address\r\n * and normalizes the address by turning it to lowercase\r\n */\r\nexport const objectETHAddressNormalizer = <T>(obj: T) => {\r\n    // $eslint-fix-me https://github.com/rhinodavid/eslint-fix-me\r\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n    const normalized: { [key: string]: any } = {};\r\n    for (const [key, value] of Object.entries(obj)) {\r\n        if (value && addressUtils.isAddress(value as string)) {\r\n            normalized[key] = (value as string).toLowerCase();\r\n        }\r\n    }\r\n\r\n    return {\r\n        ...obj,\r\n        ...normalized,\r\n    };\r\n};\r\n\r\n/**\r\n * Attempts to find the address of the token and throws if not found\r\n *\r\n * @param address the uppercase symbol of the token (ex. `REP`) or the address of the contract\r\n * @param chainId the Network where the address should be hosted on.\r\n */\r\nexport function findTokenAddressOrThrowApiError(address: string, field: string, chainId: ChainId): string {\r\n    try {\r\n        return findTokenAddressOrThrow(address, chainId);\r\n    } catch (e) {\r\n        throw new ValidationError([\r\n            {\r\n                field,\r\n                code: ValidationErrorCodes.ValueOutOfRange,\r\n                reason: e.message,\r\n            },\r\n        ]);\r\n    }\r\n}\r\n\r\n/**\r\n * Splits an array of ERC20Owner objects into string arrays of owner and token addresses.\r\n * This serves as an intermediate step before passing the objects to the Balance Checker contract.\r\n */\r\nexport function splitAddresses(erc20Owners: ERC20Owner | ERC20Owner[]): { owners: string[]; tokens: string[] } {\r\n    const splitAddrs: { owners: string[]; tokens: string[] } = { owners: [], tokens: [] };\r\n    if (Array.isArray(erc20Owners)) {\r\n        return erc20Owners.reduce(({ owners, tokens }, erc20Owner) => {\r\n            return {\r\n                owners: owners.concat(erc20Owner.owner),\r\n                tokens: tokens.concat(erc20Owner.token),\r\n            };\r\n        }, splitAddrs);\r\n    } else {\r\n        return {\r\n            owners: [erc20Owners.owner],\r\n            tokens: [erc20Owners.token],\r\n        };\r\n    }\r\n}\r\n"],"version":3}