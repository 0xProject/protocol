aee216ea28d9b9926a2b0702713be5ef
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
// tslint:disable:max-file-line-count
// tslint:disable:custom-no-magic-numbers
const utils_1 = require("@0x/utils");
const ts_mockito_1 = require("ts-mockito");
const config_1 = require("../../src/config");
const constants_1 = require("../../src/core/constants");
const fee_service_1 = require("../../src/services/fee_service");
const config_manager_1 = require("../../src/utils/config_manager");
const GasStationAttendantEthereum_1 = require("../../src/utils/GasStationAttendantEthereum");
const TokenPriceOracle_1 = require("../../src/utils/TokenPriceOracle");
const ZeroExApiClient_1 = require("../../src/utils/ZeroExApiClient");
const feeTokenSymbol = 'fee';
const feeTokenAddress = 'feeTokenAddress';
const feeTokenDecimals = 18;
const buildFeeService = (overrides) => {
    const chainId = (overrides === null || overrides === void 0 ? void 0 : overrides.chainId) || 1337;
    const feeTokenMetadata = (overrides === null || overrides === void 0 ? void 0 : overrides.feeTokenMetadata) || {
        symbol: feeTokenSymbol,
        decimals: feeTokenDecimals,
        tokenAddress: feeTokenAddress,
    };
    const feeModelConfiguration = (overrides === null || overrides === void 0 ? void 0 : overrides.feeModelConfiguration) || config_1.DEFAULT_FEE_MODEL_CONFIGURATION;
    const gasPrice = (overrides === null || overrides === void 0 ? void 0 : overrides.gasPrice) || new utils_1.BigNumber(1e9);
    const tradeTokenPrice = (overrides === null || overrides === void 0 ? void 0 : overrides.tradeTokenPrice) || null;
    const feeTokenPrice = (overrides === null || overrides === void 0 ? void 0 : overrides.feeTokenPrice) || null;
    const ammQuote = (overrides === null || overrides === void 0 ? void 0 : overrides.ammQuote) || null;
    const configManagerMock = (0, ts_mockito_1.mock)(config_manager_1.ConfigManager);
    (0, ts_mockito_1.when)(configManagerMock.getFeeModelConfiguration(chainId, (0, ts_mockito_1.anything)(), (0, ts_mockito_1.anything)())).thenReturn(feeModelConfiguration);
    const gasStationAttendantMock = (0, ts_mockito_1.mock)(GasStationAttendantEthereum_1.GasStationAttendantEthereum);
    (0, ts_mockito_1.when)(gasStationAttendantMock.getExpectedTransactionGasRateAsync()).thenResolve(gasPrice);
    const tokenPriceOracleMock = (0, ts_mockito_1.mock)(TokenPriceOracle_1.TokenPriceOracle);
    (0, ts_mockito_1.when)(tokenPriceOracleMock.batchFetchTokenPriceAsync((0, ts_mockito_1.anything)())).thenResolve([tradeTokenPrice, feeTokenPrice]);
    const zeroExApiClientMock = (0, ts_mockito_1.mock)(ZeroExApiClient_1.ZeroExApiClient);
    (0, ts_mockito_1.when)(zeroExApiClientMock.fetchAmmQuoteAsync((0, ts_mockito_1.anything)())).thenResolve(ammQuote);
    return new fee_service_1.FeeService(chainId, feeTokenMetadata, (0, ts_mockito_1.instance)((overrides === null || overrides === void 0 ? void 0 : overrides.configManagerMock) || configManagerMock), (0, ts_mockito_1.instance)((overrides === null || overrides === void 0 ? void 0 : overrides.gasStationAttendantMock) || gasStationAttendantMock), (0, ts_mockito_1.instance)((overrides === null || overrides === void 0 ? void 0 : overrides.tokenPriceOracleMock) || tokenPriceOracleMock), (0, ts_mockito_1.instance)((overrides === null || overrides === void 0 ? void 0 : overrides.zeroExApiClientMock) || zeroExApiClientMock), constants_1.DEFAULT_MIN_EXPIRY_DURATION_MS);
};
describe('FeeService', () => {
    const workflow = 'rfqm';
    const txOrigin = 'registryAddress';
    const makerToken = 'UsdcAddress';
    const makerTokenDecimals = 6;
    const makerTokenPrice = new utils_1.BigNumber(1e-6);
    const takerToken = 'WbtcAddress';
    const takerTokenDecimals = 18;
    const takerTokenPrice = new utils_1.BigNumber(6e-14);
    const gasPrice = new utils_1.BigNumber(1e9);
    const gasEstimate = constants_1.RFQM_TX_OTC_ORDER_GAS_ESTIMATE;
    const feeTokenPrice = new utils_1.BigNumber(3e-15);
    const integrator = {
        apiKeys: [],
        integratorId: 'integratorId',
        allowedChainIds: [1, 3, 137, 1337],
        label: 'dummy integrator',
        plp: true,
        rfqm: true,
        rfqt: true,
    };
    const takerAddress = 'takerAddress';
    afterAll(() => {
        jest.useRealTimers();
    });
    describe('calculateFeeAsync v0', () => {
        const feeModelVersion = 0;
        it('should calculate v0 fee for RFQm correctly', async () => {
            // Given
            const isSelling = true;
            const isUnwrap = false;
            const assetFillAmount = new utils_1.BigNumber(0.345e18);
            const tradeSizeBps = 5;
            const feeService = buildFeeService({
                feeModelConfiguration: {
                    marginRakeRatio: 0,
                    tradeSizeBps,
                },
                gasPrice,
                tradeTokenPrice: takerTokenPrice,
                feeTokenPrice,
            });
            // When
            const { feeWithDetails: fee } = await feeService.calculateFeeAsync({
                workflow,
                chainId: 1337,
                feeModelVersion,
                txOrigin,
                makerToken,
                takerToken,
                originalMakerToken: makerToken,
                makerTokenDecimals,
                takerTokenDecimals,
                isUnwrap,
                isSelling,
                assetFillAmount,
                takerAmount: assetFillAmount,
                isFirm: true,
                takerAddress,
                trader: takerAddress,
                integrator,
            });
            // Then
            const expectedGasFeeAmount = gasPrice.times(gasEstimate);
            const expectedFee = {
                type: 'fixed',
                token: feeTokenAddress,
                amount: expectedGasFeeAmount,
                details: {
                    kind: 'gasOnly',
                    feeModelVersion,
                    gasFeeAmount: expectedGasFeeAmount,
                    gasPrice,
                },
                breakdown: {
                    gas: {
                        amount: expectedGasFeeAmount,
                        details: {
                            gasPrice,
                            estimatedGas: new utils_1.BigNumber(gasEstimate),
                        },
                    },
                },
                conversionRates: {
                    nativeTokenBaseUnitPriceUsd: null,
                    feeTokenBaseUnitPriceUsd: null,
                    takerTokenBaseUnitPriceUsd: null,
                    makerTokenBaseUnitPriceUsd: null,
                },
            };
            expect(fee).toMatchObject(expectedFee);
        });
        it('should calculate v0 fee for RFQt correctly', async () => {
            // Given
            const isSelling = true;
            const isUnwrap = false;
            const assetFillAmount = new utils_1.BigNumber(0.345e18);
            const tradeSizeBps = 5;
            const feeService = buildFeeService({
                feeModelConfiguration: {
                    marginRakeRatio: 0,
                    tradeSizeBps,
                },
                gasPrice,
                tradeTokenPrice: takerTokenPrice,
                feeTokenPrice,
            });
            // When
            const { feeWithDetails: fee } = await feeService.calculateFeeAsync({
                workflow: 'rfqt',
                chainId: 1337,
                feeModelVersion,
                txOrigin,
                makerToken,
                takerToken,
                originalMakerToken: makerToken,
                makerTokenDecimals,
                takerTokenDecimals,
                isUnwrap,
                isSelling,
                assetFillAmount,
                takerAmount: assetFillAmount,
                isFirm: true,
                takerAddress,
                trader: takerAddress,
                integrator,
            });
            // Then
            const expectedFee = {
                type: 'fixed',
                token: feeTokenAddress,
                amount: new utils_1.BigNumber(0),
                details: {
                    kind: 'gasOnly',
                    feeModelVersion,
                    gasFeeAmount: new utils_1.BigNumber(0),
                    gasPrice: new utils_1.BigNumber(0),
                },
                breakdown: {},
                conversionRates: {
                    nativeTokenBaseUnitPriceUsd: null,
                    feeTokenBaseUnitPriceUsd: null,
                    takerTokenBaseUnitPriceUsd: null,
                    makerTokenBaseUnitPriceUsd: null,
                },
            };
            expect(fee).toMatchObject(expectedFee);
        });
    });
    describe('calculateFeeAsync v1', () => {
        const feeModelVersion = 1;
        it('should calculate v1 fee for RFQm selling correctly', async () => {
            // Given
            const isSelling = true;
            const isUnwrap = false;
            const assetFillAmount = new utils_1.BigNumber(0.345e18);
            const tradeSizeBps = 5;
            const feeService = buildFeeService({
                feeModelConfiguration: {
                    marginRakeRatio: 0,
                    tradeSizeBps,
                },
                gasPrice,
                tradeTokenPrice: takerTokenPrice,
                feeTokenPrice,
            });
            // When
            const { feeWithDetails: fee } = await feeService.calculateFeeAsync({
                workflow,
                chainId: 1337,
                feeModelVersion,
                txOrigin,
                makerToken,
                takerToken,
                originalMakerToken: makerToken,
                makerTokenDecimals,
                takerTokenDecimals,
                isUnwrap,
                isSelling,
                assetFillAmount,
                takerAmount: assetFillAmount,
                isFirm: true,
                takerAddress,
                trader: takerAddress,
                integrator,
            });
            // Then
            const expectedGasFeeAmount = gasPrice.times(gasEstimate);
            const expectedZeroExFeeAmount = assetFillAmount
                .times(tradeSizeBps * constants_1.BPS_TO_RATIO)
                .times(takerTokenPrice)
                .div(feeTokenPrice)
                .integerValue();
            const expectedTotalFeeAmount = expectedZeroExFeeAmount.plus(expectedGasFeeAmount);
            const expectedFee = {
                type: 'fixed',
                token: feeTokenAddress,
                amount: expectedTotalFeeAmount,
                details: {
                    kind: 'default',
                    feeModelVersion,
                    gasFeeAmount: expectedGasFeeAmount,
                    gasPrice,
                    zeroExFeeAmount: expectedZeroExFeeAmount,
                    tradeSizeBps,
                    feeTokenBaseUnitPriceUsd: feeTokenPrice,
                    takerTokenBaseUnitPriceUsd: takerTokenPrice,
                    makerTokenBaseUnitPriceUsd: null,
                },
                breakdown: {
                    gas: {
                        amount: expectedGasFeeAmount,
                        details: {
                            gasPrice,
                            estimatedGas: new utils_1.BigNumber(gasEstimate),
                        },
                    },
                    zeroEx: {
                        amount: expectedZeroExFeeAmount,
                        details: {
                            kind: 'volume',
                            tradeSizeBps,
                        },
                    },
                },
                conversionRates: {
                    nativeTokenBaseUnitPriceUsd: feeTokenPrice,
                    feeTokenBaseUnitPriceUsd: feeTokenPrice,
                    takerTokenBaseUnitPriceUsd: takerTokenPrice,
                    makerTokenBaseUnitPriceUsd: null,
                },
            };
            expect(fee).toMatchObject(expectedFee);
        });
        it('should calculate v1 fee for RFQm buying correctly', async () => {
            // Given
            const isSelling = false;
            const isUnwrap = false;
            const assetFillAmount = new utils_1.BigNumber(5000e6);
            const tradeSizeBps = 4;
            const feeService = buildFeeService({
                feeModelConfiguration: {
                    marginRakeRatio: 0,
                    tradeSizeBps,
                },
                gasPrice,
                tradeTokenPrice: makerTokenPrice,
                feeTokenPrice,
            });
            // When
            const { feeWithDetails: fee } = await feeService.calculateFeeAsync({
                workflow,
                chainId: 1337,
                feeModelVersion,
                makerToken,
                takerToken,
                originalMakerToken: makerToken,
                makerTokenDecimals,
                takerTokenDecimals,
                isUnwrap,
                isSelling,
                assetFillAmount,
                makerAmount: assetFillAmount,
                isFirm: false,
                takerAddress,
                integrator,
            });
            // Then
            const expectedGasFeeAmount = gasPrice.times(gasEstimate);
            const expectedZeroExFeeAmount = assetFillAmount
                .times(tradeSizeBps * constants_1.BPS_TO_RATIO)
                .times(makerTokenPrice)
                .div(feeTokenPrice)
                .integerValue();
            const expectedTotalFeeAmount = expectedZeroExFeeAmount.plus(expectedGasFeeAmount);
            const expectedFee = {
                type: 'fixed',
                token: feeTokenAddress,
                amount: expectedTotalFeeAmount,
                details: {
                    kind: 'default',
                    feeModelVersion,
                    gasFeeAmount: expectedGasFeeAmount,
                    gasPrice,
                    zeroExFeeAmount: expectedZeroExFeeAmount,
                    tradeSizeBps,
                    feeTokenBaseUnitPriceUsd: feeTokenPrice,
                    takerTokenBaseUnitPriceUsd: null,
                    makerTokenBaseUnitPriceUsd: makerTokenPrice,
                },
                breakdown: {
                    gas: {
                        amount: expectedGasFeeAmount,
                        details: {
                            gasPrice,
                            estimatedGas: new utils_1.BigNumber(gasEstimate),
                        },
                    },
                    zeroEx: {
                        amount: expectedZeroExFeeAmount,
                        details: {
                            kind: 'volume',
                            tradeSizeBps,
                        },
                    },
                },
                conversionRates: {
                    nativeTokenBaseUnitPriceUsd: feeTokenPrice,
                    feeTokenBaseUnitPriceUsd: feeTokenPrice,
                    takerTokenBaseUnitPriceUsd: null,
                    makerTokenBaseUnitPriceUsd: makerTokenPrice,
                },
            };
            expect(fee).toMatchObject(expectedFee);
        });
        it('should calculate v1 fee for RFQt selling correctly', async () => {
            // Given
            const isSelling = true;
            const isUnwrap = false;
            const assetFillAmount = new utils_1.BigNumber(0.345e18);
            const tradeSizeBps = 5;
            const feeService = buildFeeService({
                feeModelConfiguration: {
                    marginRakeRatio: 0,
                    tradeSizeBps,
                },
                gasPrice,
                tradeTokenPrice: takerTokenPrice,
                feeTokenPrice,
            });
            // When
            const { feeWithDetails: fee } = await feeService.calculateFeeAsync({
                workflow: 'rfqt',
                chainId: 1337,
                feeModelVersion,
                txOrigin,
                makerToken,
                takerToken,
                originalMakerToken: makerToken,
                makerTokenDecimals,
                takerTokenDecimals,
                isUnwrap,
                isSelling,
                assetFillAmount,
                takerAmount: assetFillAmount,
                isFirm: true,
                takerAddress,
                trader: takerAddress,
                integrator,
            });
            // Then
            const expectedZeroExFeeAmount = assetFillAmount
                .times(tradeSizeBps * constants_1.BPS_TO_RATIO)
                .times(takerTokenPrice)
                .div(feeTokenPrice)
                .integerValue();
            const expectedFee = {
                type: 'fixed',
                token: feeTokenAddress,
                amount: expectedZeroExFeeAmount,
                details: {
                    kind: 'default',
                    feeModelVersion,
                    gasFeeAmount: new utils_1.BigNumber(0),
                    gasPrice: new utils_1.BigNumber(0),
                    zeroExFeeAmount: expectedZeroExFeeAmount,
                    tradeSizeBps,
                    feeTokenBaseUnitPriceUsd: feeTokenPrice,
                    takerTokenBaseUnitPriceUsd: takerTokenPrice,
                    makerTokenBaseUnitPriceUsd: null,
                },
                breakdown: {
                    zeroEx: {
                        amount: expectedZeroExFeeAmount,
                        details: {
                            kind: 'volume',
                            tradeSizeBps,
                        },
                    },
                },
                conversionRates: {
                    nativeTokenBaseUnitPriceUsd: feeTokenPrice,
                    feeTokenBaseUnitPriceUsd: feeTokenPrice,
                    takerTokenBaseUnitPriceUsd: takerTokenPrice,
                    makerTokenBaseUnitPriceUsd: null,
                },
            };
            expect(fee).toMatchObject(expectedFee);
        });
        it('should not include zeroEx fee for non-configured pairs', async () => {
            // Given
            const isSelling = true;
            const isUnwrap = false;
            const assetFillAmount = new utils_1.BigNumber(0.345e18);
            const feeService = buildFeeService({
                gasPrice,
                tradeTokenPrice: takerTokenPrice,
                feeTokenPrice,
            });
            // When
            const { feeWithDetails: fee } = await feeService.calculateFeeAsync({
                workflow,
                chainId: 1337,
                feeModelVersion,
                makerToken,
                takerToken,
                originalMakerToken: makerToken,
                makerTokenDecimals,
                takerTokenDecimals,
                isUnwrap,
                isSelling,
                assetFillAmount,
                takerAmount: assetFillAmount,
                isFirm: false,
                takerAddress,
                integrator,
            });
            // Then
            const expectedGasFeeAmount = gasPrice.times(gasEstimate);
            const expectedFee = {
                type: 'fixed',
                token: feeTokenAddress,
                amount: expectedGasFeeAmount,
                details: {
                    kind: 'default',
                    feeModelVersion,
                    gasFeeAmount: expectedGasFeeAmount,
                    gasPrice,
                    zeroExFeeAmount: new utils_1.BigNumber(0),
                    tradeSizeBps: 0,
                    feeTokenBaseUnitPriceUsd: null,
                    takerTokenBaseUnitPriceUsd: null,
                    makerTokenBaseUnitPriceUsd: null,
                },
                breakdown: {
                    gas: {
                        amount: expectedGasFeeAmount,
                        details: {
                            gasPrice,
                            estimatedGas: new utils_1.BigNumber(gasEstimate),
                        },
                    },
                    zeroEx: {
                        amount: new utils_1.BigNumber(0),
                        details: {
                            kind: 'volume',
                            tradeSizeBps: 0,
                        },
                    },
                },
                conversionRates: {
                    nativeTokenBaseUnitPriceUsd: null,
                    feeTokenBaseUnitPriceUsd: null,
                    takerTokenBaseUnitPriceUsd: null,
                    makerTokenBaseUnitPriceUsd: null,
                },
            };
            expect(fee).toMatchObject(expectedFee);
        });
        it('should not include zeroEx fee if price oracle is down', async () => {
            // Given
            const isSelling = false;
            const isUnwrap = false;
            const assetFillAmount = new utils_1.BigNumber(5000e6);
            const tradeSizeBps = 4;
            const feeService = buildFeeService({
                feeModelConfiguration: {
                    marginRakeRatio: 0,
                    tradeSizeBps,
                },
                gasPrice,
                tradeTokenPrice: makerTokenPrice,
                feeTokenPrice: null,
            });
            // When
            const { feeWithDetails: fee } = await feeService.calculateFeeAsync({
                workflow,
                chainId: 1337,
                feeModelVersion,
                txOrigin,
                makerToken,
                takerToken,
                originalMakerToken: makerToken,
                makerTokenDecimals,
                takerTokenDecimals,
                isUnwrap,
                isSelling,
                assetFillAmount,
                makerAmount: assetFillAmount,
                isFirm: true,
                takerAddress,
                trader: takerAddress,
                integrator,
            });
            // Then
            const expectedGasFeeAmount = gasPrice.times(gasEstimate);
            const expectedFee = {
                type: 'fixed',
                token: feeTokenAddress,
                amount: expectedGasFeeAmount,
                details: {
                    kind: 'gasOnly',
                    feeModelVersion,
                    gasFeeAmount: expectedGasFeeAmount,
                    gasPrice,
                },
                breakdown: {
                    gas: {
                        amount: expectedGasFeeAmount,
                        details: {
                            gasPrice,
                            estimatedGas: new utils_1.BigNumber(gasEstimate),
                        },
                    },
                },
                conversionRates: {
                    nativeTokenBaseUnitPriceUsd: null,
                    feeTokenBaseUnitPriceUsd: null,
                    takerTokenBaseUnitPriceUsd: null,
                    makerTokenBaseUnitPriceUsd: null,
                },
            };
            expect(fee).toMatchObject(expectedFee);
        });
    });
    describe('calculateFeeAsync v2', () => {
        const feeModelVersion = 2;
        it('should calculate v2 `price improvement` based fee for sell correctly if price improvement detection succeeded', async () => {
            // Given
            const isSelling = true;
            const isUnwrap = false;
            const assetFillAmount = new utils_1.BigNumber(1e18);
            const marginRakeRatio = 0.5;
            const ammMakerAmount = new utils_1.BigNumber(3450e6);
            const expectedSlippage = new utils_1.BigNumber(-0.01);
            const estimatedAmmGasFeeWei = new utils_1.BigNumber(100e9);
            const decodedUniqueId = '1234-5678';
            const ammQuote = {
                makerAmount: ammMakerAmount,
                takerAmount: assetFillAmount,
                expectedSlippage,
                estimatedGasFeeWei: estimatedAmmGasFeeWei,
                decodedUniqueId,
            };
            const mm1MakerAmount = new utils_1.BigNumber(3550e6);
            const mm2MakerAmount = new utils_1.BigNumber(3600e6);
            const mmQuotes = [
                {
                    maker: 'maker1Address',
                    makerUri: 'http://maker1.com',
                    makerToken,
                    takerToken,
                    makerAmount: mm1MakerAmount,
                    takerAmount: assetFillAmount,
                    expiry: new utils_1.BigNumber(1652722767),
                },
                {
                    maker: 'maker2Address',
                    makerUri: 'http://maker2.com',
                    makerToken,
                    takerToken,
                    makerAmount: mm2MakerAmount,
                    takerAmount: assetFillAmount,
                    expiry: new utils_1.BigNumber(1652722767),
                },
            ];
            const feeService = buildFeeService({
                feeModelConfiguration: {
                    marginRakeRatio,
                    tradeSizeBps: 0,
                },
                gasPrice,
                tradeTokenPrice: makerTokenPrice,
                feeTokenPrice,
                ammQuote,
            });
            const quoteContext = {
                workflow,
                chainId: 1337,
                isFirm: true,
                feeModelVersion,
                txOrigin,
                makerToken,
                takerToken,
                originalMakerToken: makerToken,
                makerTokenDecimals,
                takerTokenDecimals,
                isUnwrap,
                isSelling,
                assetFillAmount,
                takerAmount: assetFillAmount,
                takerAddress,
                trader: takerAddress,
                integrator,
            };
            // When
            jest.useFakeTimers().setSystemTime(1650000000000);
            const { feeWithDetails, quotesWithGasFee, ammQuoteUniqueId } = await feeService.calculateFeeAsync(quoteContext, async () => {
                return Promise.resolve(mmQuotes);
            });
            // Then
            const expectedGasFeeAmount = gasPrice.times(gasEstimate);
            const expectedMargin = mm2MakerAmount
                .minus(ammMakerAmount.times(new utils_1.BigNumber(1).plus(expectedSlippage)))
                .times(makerTokenPrice)
                .div(feeTokenPrice)
                .plus(estimatedAmmGasFeeWei)
                .integerValue();
            const expectedZeroExFeeAmount = expectedMargin.times(marginRakeRatio).integerValue();
            const expectedTotalFeeAmount = expectedZeroExFeeAmount.plus(expectedGasFeeAmount);
            const expectedFee = {
                type: 'fixed',
                token: feeTokenAddress,
                amount: expectedTotalFeeAmount,
                details: {
                    kind: 'margin',
                    feeModelVersion,
                    gasFeeAmount: expectedGasFeeAmount,
                    gasPrice,
                    zeroExFeeAmount: expectedZeroExFeeAmount,
                    margin: expectedMargin,
                    marginRakeRatio,
                    feeTokenBaseUnitPriceUsd: feeTokenPrice,
                    takerTokenBaseUnitPriceUsd: null,
                    makerTokenBaseUnitPriceUsd: makerTokenPrice,
                },
                breakdown: {
                    gas: {
                        amount: expectedGasFeeAmount,
                        details: {
                            gasPrice,
                            estimatedGas: new utils_1.BigNumber(gasEstimate),
                        },
                    },
                    zeroEx: {
                        amount: expectedZeroExFeeAmount,
                        details: {
                            kind: 'price_improvement',
                            priceImprovement: expectedMargin,
                            rakeRatio: marginRakeRatio,
                        },
                    },
                },
                conversionRates: {
                    nativeTokenBaseUnitPriceUsd: feeTokenPrice,
                    feeTokenBaseUnitPriceUsd: feeTokenPrice,
                    takerTokenBaseUnitPriceUsd: null,
                    makerTokenBaseUnitPriceUsd: makerTokenPrice,
                },
            };
            expect(feeWithDetails).toMatchObject(expectedFee);
            expect(quotesWithGasFee).toMatchObject(mmQuotes);
            expect(ammQuoteUniqueId).toBe(decodedUniqueId);
            // When
            const revisedQuotes = await feeService.reviseQuotesAsync(
            // $eslint-fix-me https://github.com/rhinodavid/eslint-fix-me
            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion
            quotesWithGasFee, expectedZeroExFeeAmount, quoteContext);
            // Then
            const expectedRevisedQuotes = mmQuotes.map((quote) => (0, fee_service_1.reviseQuoteWithFees)(quote, expectedZeroExFeeAmount, isSelling, makerTokenPrice, feeTokenPrice));
            expect(revisedQuotes).toMatchObject(expectedRevisedQuotes);
        });
        it('should calculate v2 `price improvement` based fee for buy correctly if price improvement detection succeeded', async () => {
            // Given
            const isSelling = false;
            const isUnwrap = false;
            const assetFillAmount = new utils_1.BigNumber(1e18);
            const marginRakeRatio = 0.4;
            const ammTakerAmount = new utils_1.BigNumber(3450e6);
            const expectedSlippage = new utils_1.BigNumber(-0.1);
            const estimatedAmmGasFeeWei = new utils_1.BigNumber(100e9);
            const decodedUniqueId = '1234-5678';
            const ammQuote = {
                makerAmount: assetFillAmount,
                takerAmount: ammTakerAmount,
                expectedSlippage,
                estimatedGasFeeWei: estimatedAmmGasFeeWei,
                decodedUniqueId,
            };
            const mm1TakerAmount = new utils_1.BigNumber(3400e6);
            const mm2TakerAmount = new utils_1.BigNumber(3350e6);
            const mmQuotes = [
                {
                    maker: 'maker1Address',
                    makerUri: 'http://maker1.com',
                    makerToken,
                    takerToken,
                    makerAmount: assetFillAmount,
                    takerAmount: mm1TakerAmount,
                    expiry: new utils_1.BigNumber(1652722767),
                },
                {
                    maker: 'maker2Address',
                    makerUri: 'http://maker2.com',
                    makerToken,
                    takerToken,
                    makerAmount: assetFillAmount,
                    takerAmount: mm2TakerAmount,
                    expiry: new utils_1.BigNumber(1652722767),
                },
            ];
            const feeService = buildFeeService({
                feeModelConfiguration: {
                    marginRakeRatio,
                    tradeSizeBps: 0,
                },
                gasPrice,
                tradeTokenPrice: takerTokenPrice,
                feeTokenPrice,
                ammQuote,
            });
            const quoteContext = {
                workflow,
                chainId: 1337,
                feeModelVersion,
                makerToken,
                takerToken,
                originalMakerToken: makerToken,
                makerTokenDecimals,
                takerTokenDecimals,
                isUnwrap,
                isSelling,
                assetFillAmount,
                makerAmount: assetFillAmount,
                isFirm: false,
                takerAddress,
                integrator,
            };
            // When
            jest.useFakeTimers().setSystemTime(1650000000000);
            const { feeWithDetails, quotesWithGasFee, ammQuoteUniqueId } = await feeService.calculateFeeAsync(quoteContext, async () => {
                return Promise.resolve(mmQuotes);
            });
            // Then
            const expectedGasFeeAmount = gasPrice.times(gasEstimate);
            const expectedMargin = ammTakerAmount
                .times(new utils_1.BigNumber(1).minus(expectedSlippage))
                .minus(mm2TakerAmount)
                .times(takerTokenPrice)
                .div(feeTokenPrice)
                .plus(estimatedAmmGasFeeWei)
                .integerValue();
            const expectedZeroExFeeAmount = expectedMargin.times(marginRakeRatio).integerValue();
            const expectedTotalFeeAmount = expectedZeroExFeeAmount.plus(expectedGasFeeAmount);
            const expectedFee = {
                type: 'fixed',
                token: feeTokenAddress,
                amount: expectedTotalFeeAmount,
                details: {
                    kind: 'margin',
                    feeModelVersion,
                    gasFeeAmount: expectedGasFeeAmount,
                    gasPrice,
                    zeroExFeeAmount: expectedZeroExFeeAmount,
                    margin: expectedMargin,
                    marginRakeRatio,
                    feeTokenBaseUnitPriceUsd: feeTokenPrice,
                    takerTokenBaseUnitPriceUsd: takerTokenPrice,
                    makerTokenBaseUnitPriceUsd: null,
                },
                breakdown: {
                    gas: {
                        amount: expectedGasFeeAmount,
                        details: {
                            gasPrice,
                            estimatedGas: new utils_1.BigNumber(gasEstimate),
                        },
                    },
                    zeroEx: {
                        amount: expectedZeroExFeeAmount,
                        details: {
                            kind: 'price_improvement',
                            priceImprovement: expectedMargin,
                            rakeRatio: marginRakeRatio,
                        },
                    },
                },
                conversionRates: {
                    nativeTokenBaseUnitPriceUsd: feeTokenPrice,
                    feeTokenBaseUnitPriceUsd: feeTokenPrice,
                    takerTokenBaseUnitPriceUsd: takerTokenPrice,
                    makerTokenBaseUnitPriceUsd: null,
                },
            };
            expect(feeWithDetails).toMatchObject(expectedFee);
            expect(quotesWithGasFee).toMatchObject(mmQuotes);
            expect(ammQuoteUniqueId).toBe(decodedUniqueId);
            // When
            const revisedQuotes = await feeService.reviseQuotesAsync(
            // $eslint-fix-me https://github.com/rhinodavid/eslint-fix-me
            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion
            quotesWithGasFee, expectedZeroExFeeAmount, quoteContext);
            // Then
            const expectedRevisedQuotes = mmQuotes.map((quote) => (0, fee_service_1.reviseQuoteWithFees)(quote, expectedZeroExFeeAmount, isSelling, takerTokenPrice, feeTokenPrice));
            expect(revisedQuotes).toMatchObject(expectedRevisedQuotes);
        });
        it('should calculate v2 `default` fee correctly if token price query succeeded but 0x-api query failed', async () => {
            // Given
            const isSelling = true;
            const isUnwrap = false;
            const assetFillAmount = new utils_1.BigNumber(1e18);
            const marginRakeRatio = 0.5;
            const tradeSizeBps = 5;
            const ammQuote = null;
            const mm1MakerAmount = new utils_1.BigNumber(3550e6);
            const mm2MakerAmount = new utils_1.BigNumber(3600e6);
            const mmQuotes = [
                {
                    maker: 'maker1Address',
                    makerUri: 'http://maker1.com',
                    makerToken,
                    takerToken,
                    makerAmount: mm1MakerAmount,
                    takerAmount: assetFillAmount,
                    expiry: new utils_1.BigNumber(1652722767),
                },
                {
                    maker: 'maker2Address',
                    makerUri: 'http://maker2.com',
                    makerToken,
                    takerToken,
                    makerAmount: mm2MakerAmount,
                    takerAmount: assetFillAmount,
                    expiry: new utils_1.BigNumber(1652722767),
                },
            ];
            const feeService = buildFeeService({
                feeModelConfiguration: {
                    marginRakeRatio,
                    tradeSizeBps,
                },
                gasPrice,
                tradeTokenPrice: makerTokenPrice,
                feeTokenPrice,
                ammQuote,
            });
            const quoteContext = {
                workflow,
                chainId: 1337,
                feeModelVersion,
                txOrigin,
                makerToken,
                takerToken,
                originalMakerToken: makerToken,
                makerTokenDecimals,
                takerTokenDecimals,
                isUnwrap,
                isSelling,
                assetFillAmount,
                takerAmount: assetFillAmount,
                isFirm: true,
                takerAddress,
                trader: takerAddress,
                integrator,
            };
            // When
            jest.useFakeTimers().setSystemTime(1650000000000);
            const { feeWithDetails, quotesWithGasFee, ammQuoteUniqueId } = await feeService.calculateFeeAsync(quoteContext, async () => {
                return Promise.resolve(mmQuotes);
            });
            // Then
            const expectedGasFeeAmount = gasPrice.times(gasEstimate);
            const expectedZeroExFeeAmount = (0, fee_service_1.calculateDefaultFeeAmount)(mm2MakerAmount, tradeSizeBps, makerTokenPrice, feeTokenPrice);
            const expectedTotalFeeAmount = expectedZeroExFeeAmount.plus(expectedGasFeeAmount);
            const expectedFee = {
                type: 'fixed',
                token: feeTokenAddress,
                amount: expectedTotalFeeAmount,
                details: {
                    kind: 'default',
                    feeModelVersion,
                    gasFeeAmount: expectedGasFeeAmount,
                    gasPrice,
                    zeroExFeeAmount: expectedZeroExFeeAmount,
                    tradeSizeBps,
                    feeTokenBaseUnitPriceUsd: feeTokenPrice,
                    takerTokenBaseUnitPriceUsd: null,
                    makerTokenBaseUnitPriceUsd: makerTokenPrice,
                },
                breakdown: {
                    gas: {
                        amount: expectedGasFeeAmount,
                        details: {
                            gasPrice,
                            estimatedGas: new utils_1.BigNumber(gasEstimate),
                        },
                    },
                    zeroEx: {
                        amount: expectedZeroExFeeAmount,
                        details: {
                            kind: 'volume',
                            tradeSizeBps,
                        },
                    },
                },
                conversionRates: {
                    nativeTokenBaseUnitPriceUsd: feeTokenPrice,
                    feeTokenBaseUnitPriceUsd: feeTokenPrice,
                    takerTokenBaseUnitPriceUsd: null,
                    makerTokenBaseUnitPriceUsd: makerTokenPrice,
                },
            };
            expect(feeWithDetails).toMatchObject(expectedFee);
            expect(quotesWithGasFee).toMatchObject(mmQuotes);
            expect(ammQuoteUniqueId).toBe(undefined);
            // When
            const revisedQuotes = await feeService.reviseQuotesAsync(
            // $eslint-fix-me https://github.com/rhinodavid/eslint-fix-me
            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion
            quotesWithGasFee, expectedZeroExFeeAmount, quoteContext);
            // Then
            const expectedRevisedQuotes = mmQuotes.map((quote) => (0, fee_service_1.reviseQuoteWithFees)(quote, expectedZeroExFeeAmount, isSelling, makerTokenPrice, feeTokenPrice));
            expect(revisedQuotes).toMatchObject(expectedRevisedQuotes);
        });
        it('should calculate v2 `gasOnly` fee correctly if token price query failed', async () => {
            // Given
            const isSelling = true;
            const isUnwrap = false;
            const assetFillAmount = new utils_1.BigNumber(1e18);
            const marginRakeRatio = 0.5;
            const tradeSizeBps = 5;
            const ammMakerAmount = new utils_1.BigNumber(3450e6);
            const expectedSlippage = new utils_1.BigNumber(-0.01);
            const estimatedAmmGasFeeWei = new utils_1.BigNumber(100e9);
            const decodedUniqueId = '1234-5678';
            const ammQuote = {
                makerAmount: ammMakerAmount,
                takerAmount: assetFillAmount,
                expectedSlippage,
                estimatedGasFeeWei: estimatedAmmGasFeeWei,
                decodedUniqueId,
            };
            const mm1MakerAmount = new utils_1.BigNumber(3550e6);
            const mm2MakerAmount = new utils_1.BigNumber(3600e6);
            const mmQuotes = [
                {
                    maker: 'maker1Address',
                    makerUri: 'http://maker1.com',
                    makerToken,
                    takerToken,
                    makerAmount: mm1MakerAmount,
                    takerAmount: assetFillAmount,
                    expiry: new utils_1.BigNumber(1652722767),
                },
                {
                    maker: 'maker2Address',
                    makerUri: 'http://maker2.com',
                    makerToken,
                    takerToken,
                    makerAmount: mm2MakerAmount,
                    takerAmount: assetFillAmount,
                    expiry: new utils_1.BigNumber(1652722767),
                },
            ];
            const feeService = buildFeeService({
                feeModelConfiguration: {
                    marginRakeRatio,
                    tradeSizeBps,
                },
                gasPrice,
                tradeTokenPrice: makerTokenPrice,
                feeTokenPrice: null,
                ammQuote,
            });
            // When
            jest.useFakeTimers().setSystemTime(1650000000000);
            const { feeWithDetails, quotesWithGasFee, ammQuoteUniqueId } = await feeService.calculateFeeAsync({
                workflow,
                chainId: 1337,
                feeModelVersion,
                txOrigin,
                makerToken,
                takerToken,
                originalMakerToken: makerToken,
                makerTokenDecimals,
                takerTokenDecimals,
                isUnwrap,
                isSelling,
                assetFillAmount,
                takerAmount: assetFillAmount,
                isFirm: true,
                takerAddress,
                trader: takerAddress,
                integrator,
            }, async () => {
                return Promise.resolve(mmQuotes);
            });
            // Then
            const expectedGasFeeAmount = gasPrice.times(gasEstimate);
            const expectedFee = {
                type: 'fixed',
                token: feeTokenAddress,
                amount: expectedGasFeeAmount,
                details: {
                    kind: 'gasOnly',
                    feeModelVersion,
                    gasFeeAmount: expectedGasFeeAmount,
                    gasPrice,
                },
                breakdown: {
                    gas: {
                        amount: expectedGasFeeAmount,
                        details: {
                            gasPrice,
                            estimatedGas: new utils_1.BigNumber(gasEstimate),
                        },
                    },
                },
                conversionRates: {
                    nativeTokenBaseUnitPriceUsd: null,
                    feeTokenBaseUnitPriceUsd: null,
                    takerTokenBaseUnitPriceUsd: null,
                    makerTokenBaseUnitPriceUsd: null,
                },
            };
            expect(feeWithDetails).toMatchObject(expectedFee);
            expect(quotesWithGasFee).toMatchObject(mmQuotes);
            expect(ammQuoteUniqueId).toBe(decodedUniqueId);
        });
        it('should calculate v2 `price improvement` based fee with zero zeroExFee if price improvement is zero', async () => {
            // Given
            const isSelling = true;
            const isUnwrap = false;
            const assetFillAmount = new utils_1.BigNumber(1e18);
            const marginRakeRatio = 0.5;
            const ammMakerAmount = new utils_1.BigNumber(4000e6);
            const expectedSlippage = new utils_1.BigNumber(-0.01);
            const estimatedAmmGasFeeWei = new utils_1.BigNumber(100e9);
            const decodedUniqueId = '1234-5678';
            const ammQuote = {
                makerAmount: ammMakerAmount,
                takerAmount: assetFillAmount,
                expectedSlippage,
                estimatedGasFeeWei: estimatedAmmGasFeeWei,
                decodedUniqueId,
            };
            const mm1MakerAmount = new utils_1.BigNumber(3550e6);
            const mm2MakerAmount = new utils_1.BigNumber(3600e6);
            const mmQuotes = [
                {
                    maker: 'maker1Address',
                    makerUri: 'http://maker1.com',
                    makerToken,
                    takerToken,
                    makerAmount: mm1MakerAmount,
                    takerAmount: assetFillAmount,
                    expiry: new utils_1.BigNumber(1652722767),
                },
                {
                    maker: 'maker2Address',
                    makerUri: 'http://maker2.com',
                    makerToken,
                    takerToken,
                    makerAmount: mm2MakerAmount,
                    takerAmount: assetFillAmount,
                    expiry: new utils_1.BigNumber(1652722767),
                },
            ];
            const feeService = buildFeeService({
                feeModelConfiguration: {
                    marginRakeRatio,
                    tradeSizeBps: 0,
                },
                gasPrice,
                tradeTokenPrice: makerTokenPrice,
                feeTokenPrice,
                ammQuote,
            });
            // When
            jest.useFakeTimers().setSystemTime(1650000000000);
            const { feeWithDetails, quotesWithGasFee, ammQuoteUniqueId } = await feeService.calculateFeeAsync({
                workflow,
                chainId: 1337,
                feeModelVersion,
                txOrigin,
                makerToken,
                takerToken,
                originalMakerToken: makerToken,
                makerTokenDecimals,
                takerTokenDecimals,
                isUnwrap,
                isSelling,
                assetFillAmount,
                takerAmount: assetFillAmount,
                isFirm: true,
                takerAddress,
                trader: takerAddress,
                integrator,
            }, async () => {
                return Promise.resolve(mmQuotes);
            });
            // Then
            const expectedGasFeeAmount = gasPrice.times(gasEstimate);
            const expectedFee = {
                type: 'fixed',
                token: feeTokenAddress,
                amount: expectedGasFeeAmount,
                details: {
                    kind: 'margin',
                    feeModelVersion,
                    gasFeeAmount: expectedGasFeeAmount,
                    gasPrice,
                    zeroExFeeAmount: constants_1.ZERO,
                    margin: constants_1.ZERO,
                    marginRakeRatio,
                    feeTokenBaseUnitPriceUsd: feeTokenPrice,
                    takerTokenBaseUnitPriceUsd: null,
                    makerTokenBaseUnitPriceUsd: makerTokenPrice,
                },
                breakdown: {
                    gas: {
                        amount: expectedGasFeeAmount,
                        details: {
                            gasPrice,
                            estimatedGas: new utils_1.BigNumber(gasEstimate),
                        },
                    },
                    zeroEx: {
                        amount: constants_1.ZERO,
                        details: {
                            kind: 'price_improvement',
                            priceImprovement: constants_1.ZERO,
                            rakeRatio: marginRakeRatio,
                        },
                    },
                },
                conversionRates: {
                    nativeTokenBaseUnitPriceUsd: feeTokenPrice,
                    feeTokenBaseUnitPriceUsd: feeTokenPrice,
                    takerTokenBaseUnitPriceUsd: null,
                    makerTokenBaseUnitPriceUsd: makerTokenPrice,
                },
            };
            expect(feeWithDetails).toMatchObject(expectedFee);
            expect(quotesWithGasFee).toMatchObject(mmQuotes);
            expect(ammQuoteUniqueId).toBe(decodedUniqueId);
        });
        it('should throw if called from RFQt workflow', async () => {
            // Given
            const isSelling = true;
            const isUnwrap = false;
            const assetFillAmount = new utils_1.BigNumber(1e18);
            const marginRakeRatio = 0.5;
            const ammMakerAmount = new utils_1.BigNumber(3450e6);
            const expectedSlippage = new utils_1.BigNumber(-0.01);
            const estimatedAmmGasFeeWei = new utils_1.BigNumber(100e9);
            const decodedUniqueId = '1234-5678';
            const ammQuote = {
                makerAmount: ammMakerAmount,
                takerAmount: assetFillAmount,
                expectedSlippage,
                estimatedGasFeeWei: estimatedAmmGasFeeWei,
                decodedUniqueId,
            };
            const feeService = buildFeeService({
                feeModelConfiguration: {
                    marginRakeRatio,
                    tradeSizeBps: 0,
                },
                gasPrice,
                tradeTokenPrice: makerTokenPrice,
                feeTokenPrice,
                ammQuote,
            });
            const quoteContext = {
                workflow: 'rfqt',
                chainId: 1337,
                isFirm: true,
                feeModelVersion,
                txOrigin,
                makerToken,
                takerToken,
                originalMakerToken: makerToken,
                makerTokenDecimals,
                takerTokenDecimals,
                isUnwrap,
                isSelling,
                assetFillAmount,
                takerAmount: assetFillAmount,
                takerAddress,
                trader: takerAddress,
                integrator,
            };
            // When
            await expect(() => feeService.calculateFeeAsync(quoteContext)).rejects.toThrow('Not implemented');
        });
    });
    describe('pure function calculateDefaultFeeAmount()', () => {
        it('should calculate default fee amount correctly', async () => {
            // Given
            const tradeTokenAmount = new utils_1.BigNumber(1e18);
            const feeRateBps = 5;
            const tradeTokenBaseUnitPriceUsd = new utils_1.BigNumber(6e-14);
            const feeTokenBaseUnitPriceUsd = new utils_1.BigNumber(3e-15);
            // When
            const defaultFeeAmount = (0, fee_service_1.calculateDefaultFeeAmount)(tradeTokenAmount, feeRateBps, tradeTokenBaseUnitPriceUsd, feeTokenBaseUnitPriceUsd);
            // Then
            const expectedDefaultFeeAmount = new utils_1.BigNumber(1e16);
            expect(defaultFeeAmount).toMatchObject(expectedDefaultFeeAmount);
        });
        it('should return zero if bps is zero', async () => {
            // Given
            const tradeTokenAmount = new utils_1.BigNumber(1e18);
            const feeRateBps = 0;
            const tradeTokenBaseUnitPriceUsd = new utils_1.BigNumber(6e-14);
            const feeTokenBaseUnitPriceUsd = new utils_1.BigNumber(3e-15);
            // When
            const defaultFeeAmount = (0, fee_service_1.calculateDefaultFeeAmount)(tradeTokenAmount, feeRateBps, tradeTokenBaseUnitPriceUsd, feeTokenBaseUnitPriceUsd);
            // Then
            expect(defaultFeeAmount).toMatchObject(constants_1.ZERO);
        });
        it('should return zero if either trade token price or fee token price is null', async () => {
            // Given
            const tradeTokenAmount = new utils_1.BigNumber(1e18);
            const feeRateBps = 5;
            const tradeTokenBaseUnitPriceUsd = new utils_1.BigNumber(6e-14);
            const feeTokenBaseUnitPriceUsd = new utils_1.BigNumber(3e-15);
            // When
            const defaultFeeAmount1 = (0, fee_service_1.calculateDefaultFeeAmount)(tradeTokenAmount, feeRateBps, null, feeTokenBaseUnitPriceUsd);
            const defaultFeeAmount2 = (0, fee_service_1.calculateDefaultFeeAmount)(tradeTokenAmount, feeRateBps, tradeTokenBaseUnitPriceUsd, null);
            // Then
            expect(defaultFeeAmount1).toMatchObject(constants_1.ZERO);
            expect(defaultFeeAmount2).toMatchObject(constants_1.ZERO);
        });
    });
    describe('pure function calculatePriceImprovementAmount()', () => {
        it('should calculate price improvement amount for selling correctly', async () => {
            // Given
            const isSelling = true;
            const assetFillAmount = new utils_1.BigNumber(3e17);
            const makerQuoteWithGasFee = {
                maker: 'maker1Address',
                makerUri: 'http://maker1.com',
                makerToken,
                takerToken,
                makerAmount: new utils_1.BigNumber(1100e6),
                takerAmount: assetFillAmount,
                expiry: new utils_1.BigNumber(1652722767),
            };
            const ammQuote = {
                makerAmount: new utils_1.BigNumber(1000e6),
                takerAmount: assetFillAmount,
                expectedSlippage: new utils_1.BigNumber(-0.02),
                estimatedGasFeeWei: new utils_1.BigNumber(10e15),
            };
            const quoteTokenBaseUnitPriceUsd = new utils_1.BigNumber(1e-6);
            const feeTokenBaseUnitPriceUsd = new utils_1.BigNumber(3e-15);
            // When
            const priceImprovementAmount = (0, fee_service_1.calculatePriceImprovementAmount)(makerQuoteWithGasFee, ammQuote, isSelling, quoteTokenBaseUnitPriceUsd, feeTokenBaseUnitPriceUsd);
            // Then
            const expectedPriceImprovementAmount = new utils_1.BigNumber(50e15);
            expect(priceImprovementAmount).toMatchObject(expectedPriceImprovementAmount);
        });
        it('should calculate price improvement amount for buying correctly', async () => {
            // Given
            const isSelling = false;
            const assetFillAmount = new utils_1.BigNumber(3e17);
            const makerQuoteWithGasFee = {
                maker: 'maker1Address',
                makerUri: 'http://maker1.com',
                makerToken,
                takerToken,
                makerAmount: assetFillAmount,
                takerAmount: new utils_1.BigNumber(900e6),
                expiry: new utils_1.BigNumber(1652722767),
            };
            const ammQuote = {
                makerAmount: assetFillAmount,
                takerAmount: new utils_1.BigNumber(1000e6),
                expectedSlippage: new utils_1.BigNumber(-0.02),
                estimatedGasFeeWei: new utils_1.BigNumber(10e15),
            };
            const quoteTokenBaseUnitPriceUsd = new utils_1.BigNumber(1e-6);
            const feeTokenBaseUnitPriceUsd = new utils_1.BigNumber(3e-15);
            // When
            const priceImprovementAmount = (0, fee_service_1.calculatePriceImprovementAmount)(makerQuoteWithGasFee, ammQuote, isSelling, quoteTokenBaseUnitPriceUsd, feeTokenBaseUnitPriceUsd);
            // Then
            const expectedPriceImprovementAmount = new utils_1.BigNumber(50e15);
            expect(priceImprovementAmount).toMatchObject(expectedPriceImprovementAmount);
        });
        it('should return zero if there is no price improvement', async () => {
            // Given
            const isSelling = false;
            const assetFillAmount = new utils_1.BigNumber(3e17);
            const makerQuoteWithGasFee = {
                maker: 'maker1Address',
                makerUri: 'http://maker1.com',
                makerToken,
                takerToken,
                makerAmount: assetFillAmount,
                takerAmount: new utils_1.BigNumber(1051e6),
                expiry: new utils_1.BigNumber(1652722767),
            };
            const ammQuote = {
                makerAmount: assetFillAmount,
                takerAmount: new utils_1.BigNumber(1000e6),
                expectedSlippage: new utils_1.BigNumber(-0.02),
                estimatedGasFeeWei: new utils_1.BigNumber(10e15),
            };
            const quoteTokenBaseUnitPriceUsd = new utils_1.BigNumber(1e-6);
            const feeTokenBaseUnitPriceUsd = new utils_1.BigNumber(3e-15);
            // When
            const priceImprovementAmount = (0, fee_service_1.calculatePriceImprovementAmount)(makerQuoteWithGasFee, ammQuote, isSelling, quoteTokenBaseUnitPriceUsd, feeTokenBaseUnitPriceUsd);
            // Then
            expect(priceImprovementAmount).toMatchObject(constants_1.ZERO);
        });
    });
    describe('pure function reviseQuoteWithZeroExFee()', () => {
        it('should revise quote correctly for selling', async () => {
            // Given
            const isSelling = true;
            const assetFillAmount = new utils_1.BigNumber(3e17);
            const makerQuoteWithGasFee = {
                maker: 'maker1Address',
                makerUri: 'http://maker1.com',
                makerToken,
                takerToken,
                makerAmount: new utils_1.BigNumber(1000e6),
                takerAmount: assetFillAmount,
                expiry: new utils_1.BigNumber(1652722767),
            };
            const zeroExFeeAmount = new utils_1.BigNumber(10e15);
            const quoteTokenBaseUnitPriceUsd = new utils_1.BigNumber(1e-6);
            const feeTokenBaseUnitPriceUsd = new utils_1.BigNumber(3e-15);
            // When
            const revisedQuote = (0, fee_service_1.reviseQuoteWithFees)(makerQuoteWithGasFee, zeroExFeeAmount, isSelling, quoteTokenBaseUnitPriceUsd, feeTokenBaseUnitPriceUsd);
            // Then
            const expectedRevisedMakerAmount = new utils_1.BigNumber(970e6);
            expect(revisedQuote.makerAmount).toMatchObject(expectedRevisedMakerAmount);
        });
        it('should revise quote correctly for buying', async () => {
            // Given
            const isSelling = false;
            const assetFillAmount = new utils_1.BigNumber(3e17);
            const makerQuoteWithGasFee = {
                maker: 'maker1Address',
                makerUri: 'http://maker1.com',
                makerToken,
                takerToken,
                makerAmount: assetFillAmount,
                takerAmount: new utils_1.BigNumber(1000e6),
                expiry: new utils_1.BigNumber(1652722767),
            };
            const zeroExFeeAmount = new utils_1.BigNumber(10e15);
            const quoteTokenBaseUnitPriceUsd = new utils_1.BigNumber(1e-6);
            const feeTokenBaseUnitPriceUsd = new utils_1.BigNumber(3e-15);
            // When
            const revisedQuote = (0, fee_service_1.reviseQuoteWithFees)(makerQuoteWithGasFee, zeroExFeeAmount, isSelling, quoteTokenBaseUnitPriceUsd, feeTokenBaseUnitPriceUsd);
            // Then
            const expectedRevisedTakerAmount = new utils_1.BigNumber(1030e6);
            expect(revisedQuote.takerAmount).toMatchObject(expectedRevisedTakerAmount);
        });
        it('should not revise quote correctly for zero zeroExFee', async () => {
            // Given
            const isSelling = true;
            const assetFillAmount = new utils_1.BigNumber(3e17);
            const makerQuoteWithGasFee = {
                maker: 'maker1Address',
                makerUri: 'http://maker1.com',
                makerToken,
                takerToken,
                makerAmount: new utils_1.BigNumber(1000e6),
                takerAmount: assetFillAmount,
                expiry: new utils_1.BigNumber(1652722767),
            };
            const zeroExFeeAmount = constants_1.ZERO;
            const quoteTokenBaseUnitPriceUsd = new utils_1.BigNumber(1e-6);
            const feeTokenBaseUnitPriceUsd = new utils_1.BigNumber(3e-15);
            // When
            const revisedQuote = (0, fee_service_1.reviseQuoteWithFees)(makerQuoteWithGasFee, zeroExFeeAmount, isSelling, quoteTokenBaseUnitPriceUsd, feeTokenBaseUnitPriceUsd);
            // Then
            const expectedRevisedMakerAmount = new utils_1.BigNumber(1000e6);
            expect(revisedQuote.makerAmount).toMatchObject(expectedRevisedMakerAmount);
            expect(revisedQuote.takerAmount).toMatchObject(assetFillAmount);
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL2Rhdmlkd2Fsc2gvY29kZS1sb2NhbC8weC1yZnEtYXBpL3Rlc3Qvc2VydmljZXMvZmVlX3NlcnZpY2VfdGVzdC50cyIsIm1hcHBpbmdzIjoiOztBQUFBLHFDQUFxQztBQUNyQyx5Q0FBeUM7QUFFekMscUNBQXNDO0FBQ3RDLDJDQUE0RDtBQUU1RCw2Q0FBMEY7QUFDMUYsd0RBS2tDO0FBQ2xDLGdFQUt3QztBQUd4QyxtRUFBK0Q7QUFDL0QsNkZBQTBGO0FBQzFGLHVFQUFvRTtBQUNwRSxxRUFBNEU7QUFFNUUsTUFBTSxjQUFjLEdBQUcsS0FBSyxDQUFDO0FBQzdCLE1BQU0sZUFBZSxHQUFHLGlCQUFpQixDQUFDO0FBQzFDLE1BQU0sZ0JBQWdCLEdBQUcsRUFBRSxDQUFDO0FBRTVCLE1BQU0sZUFBZSxHQUFHLENBQUMsU0FZeEIsRUFBYyxFQUFFO0lBQ2IsTUFBTSxPQUFPLEdBQUcsQ0FBQSxTQUFTLGFBQVQsU0FBUyx1QkFBVCxTQUFTLENBQUUsT0FBTyxLQUFJLElBQUksQ0FBQztJQUMzQyxNQUFNLGdCQUFnQixHQUFHLENBQUEsU0FBUyxhQUFULFNBQVMsdUJBQVQsU0FBUyxDQUFFLGdCQUFnQixLQUFJO1FBQ3BELE1BQU0sRUFBRSxjQUFjO1FBQ3RCLFFBQVEsRUFBRSxnQkFBZ0I7UUFDMUIsWUFBWSxFQUFFLGVBQWU7S0FDaEMsQ0FBQztJQUNGLE1BQU0scUJBQXFCLEdBQUcsQ0FBQSxTQUFTLGFBQVQsU0FBUyx1QkFBVCxTQUFTLENBQUUscUJBQXFCLEtBQUksd0NBQStCLENBQUM7SUFDbEcsTUFBTSxRQUFRLEdBQUcsQ0FBQSxTQUFTLGFBQVQsU0FBUyx1QkFBVCxTQUFTLENBQUUsUUFBUSxLQUFJLElBQUksaUJBQVMsQ0FBQyxHQUFHLENBQUMsQ0FBQztJQUMzRCxNQUFNLGVBQWUsR0FBRyxDQUFBLFNBQVMsYUFBVCxTQUFTLHVCQUFULFNBQVMsQ0FBRSxlQUFlLEtBQUksSUFBSSxDQUFDO0lBQzNELE1BQU0sYUFBYSxHQUFHLENBQUEsU0FBUyxhQUFULFNBQVMs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QUcsSUFBSSxpQkFBUyxDQUFDLEtBQUssQ0FBQyxDQUFDO1lBRXRELE9BQU87WUFDUCxNQUFNLFlBQVksR0FBRyxJQUFBLGlDQUFtQixFQUNwQyxvQkFBb0IsRUFDcEIsZUFBZSxFQUNmLFNBQVMsRUFDVCwwQkFBMEIsRUFDMUIsd0JBQXdCLENBQzNCLENBQUM7WUFFRixPQUFPO1lBQ1AsTUFBTSwwQkFBMEIsR0FBRyxJQUFJLGlCQUFTLENBQUMsTUFBTSxDQUFDLENBQUM7WUFDekQsTUFBTSxDQUFDLFlBQVksQ0FBQyxXQUFXLENBQUMsQ0FBQyxhQUFhLENBQUMsMEJBQTBCLENBQUMsQ0FBQztZQUMzRSxNQUFNLENBQUMsWUFBWSxDQUFDLFdBQVcsQ0FBQyxDQUFDLGFBQWEsQ0FBQyxlQUFlLENBQUMsQ0FBQztRQUNwRSxDQUFDLENBQUMsQ0FBQztJQUNQLENBQUMsQ0FBQyxDQUFDO0FBQ1AsQ0FBQyxDQUFDLENBQUMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiL1VzZXJzL2Rhdmlkd2Fsc2gvY29kZS1sb2NhbC8weC1yZnEtYXBpL3Rlc3Qvc2VydmljZXMvZmVlX3NlcnZpY2VfdGVzdC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyB0c2xpbnQ6ZGlzYWJsZTptYXgtZmlsZS1saW5lLWNvdW50XG4vLyB0c2xpbnQ6ZGlzYWJsZTpjdXN0b20tbm8tbWFnaWMtbnVtYmVyc1xuXG5pbXBvcnQgeyBCaWdOdW1iZXIgfSBmcm9tICdAMHgvdXRpbHMnO1xuaW1wb3J0IHsgYW55dGhpbmcsIGluc3RhbmNlLCBtb2NrLCB3aGVuIH0gZnJvbSAndHMtbW9ja2l0byc7XG5cbmltcG9ydCB7IERFRkFVTFRfRkVFX01PREVMX0NPTkZJR1VSQVRJT04sIEZlZU1vZGVsQ29uZmlndXJhdGlvbiB9IGZyb20gJy4uLy4uL3NyYy9jb25maWcnO1xuaW1wb3J0IHtcbiAgICBCUFNfVE9fUkFUSU8sXG4gICAgREVGQVVMVF9NSU5fRVhQSVJZX0RVUkFUSU9OX01TLFxuICAgIFJGUU1fVFhfT1RDX09SREVSX0dBU19FU1RJTUFURSxcbiAgICBaRVJPLFxufSBmcm9tICcuLi8uLi9zcmMvY29yZS9jb25zdGFudHMnO1xuaW1wb3J0IHtcbiAgICBjYWxjdWxhdGVEZWZhdWx0RmVlQW1vdW50LFxuICAgIGNhbGN1bGF0ZVByaWNlSW1wcm92ZW1lbnRBbW91bnQsXG4gICAgcmV2aXNlUXVvdGVXaXRoRmVlcyxcbiAgICBGZWVTZXJ2aWNlLFxufSBmcm9tICcuLi8uLi9zcmMvc2VydmljZXMvZmVlX3NlcnZpY2UnO1xuaW1wb3J0IHsgUXVvdGVDb250ZXh0IH0gZnJvbSAnLi4vLi4vc3JjL3NlcnZpY2VzL3R5cGVzJztcbmltcG9ydCB7IEZlZVdpdGhEZXRhaWxzLCBJbmRpY2F0aXZlUXVvdGUsIFRva2VuTWV0YWRhdGEgfSBmcm9tICcuLi8uLi9zcmMvY29yZS90eXBlcyc7XG5pbXBvcnQgeyBDb25maWdNYW5hZ2VyIH0gZnJvbSAnLi4vLi4vc3JjL3V0aWxzL2NvbmZpZ19tYW5hZ2VyJztcbmltcG9ydCB7IEdhc1N0YXRpb25BdHRlbmRhbnRFdGhlcmV1bSB9IGZyb20gJy4uLy4uL3NyYy91dGlscy9HYXNTdGF0aW9uQXR0ZW5kYW50RXRoZXJldW0nO1xuaW1wb3J0IHsgVG9rZW5QcmljZU9yYWNsZSB9IGZyb20gJy4uLy4uL3NyYy91dGlscy9Ub2tlblByaWNlT3JhY2xlJztcbmltcG9ydCB7IEFtbVF1b3RlLCBaZXJvRXhBcGlDbGllbnQgfSBmcm9tICcuLi8uLi9zcmMvdXRpbHMvWmVyb0V4QXBpQ2xpZW50JztcblxuY29uc3QgZmVlVG9rZW5TeW1ib2wgPSAnZmVlJztcbmNvbnN0IGZlZVRva2VuQWRkcmVzcyA9ICdmZWVUb2tlbkFkZHJlc3MnO1xuY29uc3QgZmVlVG9rZW5EZWNpbWFscyA9IDE4O1xuXG5jb25zdCBidWlsZEZlZVNlcnZpY2UgPSAob3ZlcnJpZGVzOiB7XG4gICAgZmVlTW9kZWxDb25maWd1cmF0aW9uPzogRmVlTW9kZWxDb25maWd1cmF0aW9uO1xuICAgIGdhc1ByaWNlPzogQmlnTnVtYmVyO1xuICAgIHRyYWRlVG9rZW5QcmljZT86IEJpZ051bWJlciB8IG51bGw7XG4gICAgZmVlVG9rZW5QcmljZT86IEJpZ051bWJlciB8IG51bGw7XG4gICAgYW1tUXVvdGU/OiBBbW1RdW90ZSB8IG51bGw7XG4gICAgY2hhaW5JZD86IG51bWJlcjtcbiAgICBmZWVUb2tlbk1ldGFkYXRhPzogVG9rZW5NZXRhZGF0YTtcbiAgICBjb25maWdNYW5hZ2VyTW9jaz86IENvbmZpZ01hbmFnZXI7XG4gICAgZ2FzU3RhdGlvbkF0dGVuZGFudE1vY2s/OiBHYXNTdGF0aW9uQXR0ZW5kYW50RXRoZXJldW07XG4gICAgdG9rZW5QcmljZU9yYWNsZU1vY2s/OiBUb2tlblByaWNlT3JhY2xlO1xuICAgIHplcm9FeEFwaUNsaWVudE1vY2s/OiBaZXJvRXhBcGlDbGllbnQ7XG59KTogRmVlU2VydmljZSA9PiB7XG4gICAgY29uc3QgY2hhaW5JZCA9IG92ZXJyaWRlcz8uY2hhaW5JZCB8fCAxMzM3O1xuICAgIGNvbnN0IGZlZVRva2VuTWV0YWRhdGEgPSBvdmVycmlkZXM/LmZlZVRva2VuTWV0YWRhdGEgfHwge1xuICAgICAgICBzeW1ib2w6IGZlZVRva2VuU3ltYm9sLFxuICAgICAgICBkZWNpbWFsczogZmVlVG9rZW5EZWNpbWFscyxcbiAgICAgICAgdG9rZW5BZGRyZXNzOiBmZWVUb2tlbkFkZHJlc3MsXG4gICAgfTtcbiAgICBjb25zdCBmZWVNb2RlbENvbmZpZ3VyYXRpb24gPSBvdmVycmlkZXM/LmZlZU1vZGVsQ29uZmlndXJhdGlvbiB8fCBERUZBVUxUX0ZFRV9NT0RFTF9DT05GSUdVUkFUSU9OO1xuICAgIGNvbnN0IGdhc1ByaWNlID0gb3ZlcnJpZGVzPy5nYXNQcmljZSB8fCBuZXcgQmlnTnVtYmVyKDFlOSk7XG4gICAgY29uc3QgdHJhZGVUb2tlblByaWNlID0gb3ZlcnJpZGVzPy50cmFkZVRva2VuUHJpY2UgfHwgbnVsbDtcbiAgICBjb25zdCBmZWVUb2tlblByaWNlID0gb3ZlcnJpZGVzPy5mZWVUb2tlblByaWNlIHx8IG51bGw7XG4gICAgY29uc3QgYW1tUXVvdGUgPSBvdmVycmlkZXM/LmFtbVF1b3RlIHx8IG51bGw7XG5cbiAgICBjb25zdCBjb25maWdNYW5hZ2VyTW9jayA9IG1vY2soQ29uZmlnTWFuYWdlcik7XG4gICAgd2hlbihjb25maWdNYW5hZ2VyTW9jay5nZXRGZWVNb2RlbENvbmZpZ3VyYXRpb24oY2hhaW5JZCwgYW55dGhpbmcoKSwgYW55dGhpbmcoKSkpLnRoZW5SZXR1cm4oZmVlTW9kZWxDb25maWd1cmF0aW9uKTtcblxuICAgIGNvbnN0IGdhc1N0YXRpb25BdHRlbmRhbnRNb2NrID0gbW9jayhHYXNTdGF0aW9uQXR0ZW5kYW50RXRoZXJldW0pO1xuICAgIHdoZW4oZ2FzU3RhdGlvbkF0dGVuZGFudE1vY2suZ2V0RXhwZWN0ZWRUcmFuc2FjdGlvbkdhc1JhdGVBc3luYygpKS50aGVuUmVzb2x2ZShnYXNQcmljZSk7XG5cbiAgICBjb25zdCB0b2tlblByaWNlT3JhY2xlTW9jayA9IG1vY2soVG9rZW5QcmljZU9yYWNsZSk7XG4gICAgd2hlbih0b2tlblByaWNlT3JhY2xlTW9jay5iYXRjaEZldGNoVG9rZW5QcmljZUFzeW5jKGFueXRoaW5nKCkpKS50aGVuUmVzb2x2ZShbdHJhZGVUb2tlblByaWNlLCBmZWVUb2tlblByaWNlXSk7XG5cbiAgICBjb25zdCB6ZXJvRXhBcGlDbGllbnRNb2NrID0gbW9jayhaZXJvRXhBcGlDbGllbnQpO1xuICAgIHdoZW4oemVyb0V4QXBpQ2xpZW50TW9jay5mZXRjaEFtbVF1b3RlQXN5bmMoYW55dGhpbmcoKSkpLnRoZW5SZXNvbHZlKGFtbVF1b3RlKTtcblxuICAgIHJldHVybiBuZXcgRmVlU2VydmljZShcbiAgICAgICAgY2hhaW5JZCxcbiAgICAgICAgZmVlVG9rZW5NZXRhZGF0YSxcbiAgICAgICAgaW5zdGFuY2Uob3ZlcnJpZGVzPy5jb25maWdNYW5hZ2VyTW9jayB8fCBjb25maWdNYW5hZ2VyTW9jayksXG4gICAgICAgIGluc3RhbmNlKG92ZXJyaWRlcz8uZ2FzU3RhdGlvbkF0dGVuZGFudE1vY2sgfHwgZ2FzU3RhdGlvbkF0dGVuZGFudE1vY2spLFxuICAgICAgICBpbnN0YW5jZShvdmVycmlkZXM/LnRva2VuUHJpY2VPcmFjbGVNb2NrIHx8IHRva2VuUHJpY2VPcmFjbGVNb2NrKSxcbiAgICAgICAgaW5zdGFuY2Uob3ZlcnJpZGVzPy56ZXJvRXhBcGlDbGllbnRNb2NrIHx8IHplcm9FeEFwaUNsaWVudE1vY2spLFxuICAgICAgICBERUZBVUxUX01JTl9FWFBJUllfRFVSQVRJT05fTVMsXG4gICAgKTtcbn07XG5cbmRlc2NyaWJlKCdGZWVTZXJ2aWNlJywgKCkgPT4ge1xuICAgIGNvbnN0IHdvcmtmbG93ID0gJ3JmcW0nO1xuICAgIGNvbnN0IHR4T3JpZ2luID0gJ3JlZ2lzdHJ5QWRkcmVzcyc7XG4gICAgY29uc3QgbWFrZXJUb2tlbiA9ICdVc2RjQWRkcmVzcyc7XG4gICAgY29uc3QgbWFrZXJUb2tlbkRlY2ltYWxzID0gNjtcbiAgICBjb25zdCBtYWtlclRva2VuUHJpY2UgPSBuZXcgQmlnTnVtYmVyKDFlLTYpO1xuXG4gICAgY29uc3QgdGFrZXJUb2tlbiA9ICdXYnRjQWRkcmVzcyc7XG4gICAgY29uc3QgdGFrZXJUb2tlbkRlY2ltYWxzID0gMTg7XG4gICAgY29uc3QgdGFrZXJUb2tlblByaWNlID0gbmV3IEJpZ051bWJlcig2ZS0xNCk7XG5cbiAgICBjb25zdCBnYXNQcmljZSA9IG5ldyBCaWdOdW1iZXIoMWU5KTtcbiAgICBjb25zdCBnYXNFc3RpbWF0ZSA9IFJGUU1fVFhfT1RDX09SREVSX0dBU19FU1RJTUFURTtcblxuICAgIGNvbnN0IGZlZVRva2VuUHJpY2UgPSBuZXcgQmlnTnVtYmVyKDNlLTE1KTtcblxuICAgIGNvbnN0IGludGVncmF0b3IgPSB7XG4gICAgICAgIGFwaUtleXM6IFtdLFxuICAgICAgICBpbnRlZ3JhdG9ySWQ6ICdpbnRlZ3JhdG9ySWQnLFxuICAgICAgICBhbGxvd2VkQ2hhaW5JZHM6IFsxLCAzLCAxMzcsIDEzMzddLFxuICAgICAgICBsYWJlbDogJ2R1bW15IGludGVncmF0b3InLFxuICAgICAgICBwbHA6IHRydWUsXG4gICAgICAgIHJmcW06IHRydWUsXG4gICAgICAgIHJmcXQ6IHRydWUsXG4gICAgfTtcblxuICAgIGNvbnN0IHRha2VyQWRkcmVzcyA9ICd0YWtlckFkZHJlc3MnO1xuXG4gICAgYWZ0ZXJBbGwoKCkgPT4ge1xuICAgICAgICBqZXN0LnVzZVJlYWxUaW1lcnMoKTtcbiAgICB9KTtcblxuICAgIGRlc2NyaWJlKCdjYWxjdWxhdGVGZWVBc3luYyB2MCcsICgpID0+IHtcbiAgICAgICAgY29uc3QgZmVlTW9kZWxWZXJzaW9uID0gMDtcbiAgICAgICAgaXQoJ3Nob3VsZCBjYWxjdWxhdGUgdjAgZmVlIGZvciBSRlFtIGNvcnJlY3RseScsIGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIC8vIEdpdmVuXG4gICAgICAgICAgICBjb25zdCBpc1NlbGxpbmcgPSB0cnVlO1xuICAgICAgICAgICAgY29uc3QgaXNVbndyYXAgPSBmYWxzZTtcbiAgICAgICAgICAgIGNvbnN0IGFzc2V0RmlsbEFtb3VudCA9IG5ldyBCaWdOdW1iZXIoMC4zNDVlMTgpO1xuICAgICAgICAgICAgY29uc3QgdHJhZGVTaXplQnBzID0gNTtcblxuICAgICAgICAgICAgY29uc3QgZmVlU2VydmljZTogRmVlU2VydmljZSA9IGJ1aWxkRmVlU2VydmljZSh7XG4gICAgICAgICAgICAgICAgZmVlTW9kZWxDb25maWd1cmF0aW9uOiB7XG4gICAgICAgICAgICAgICAgICAgIG1hcmdpblJha2VSYXRpbzogMCxcbiAgICAgICAgICAgICAgICAgICAgdHJhZGVTaXplQnBzLFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgZ2FzUHJpY2UsXG4gICAgICAgICAgICAgICAgdHJhZGVUb2tlblByaWNlOiB0YWtlclRva2VuUHJpY2UsXG4gICAgICAgICAgICAgICAgZmVlVG9rZW5QcmljZSxcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAvLyBXaGVuXG4gICAgICAgICAgICBjb25zdCB7IGZlZVdpdGhEZXRhaWxzOiBmZWUgfSA9IGF3YWl0IGZlZVNlcnZpY2UuY2FsY3VsYXRlRmVlQXN5bmMoe1xuICAgICAgICAgICAgICAgIHdvcmtmbG93LFxuICAgICAgICAgICAgICAgIGNoYWluSWQ6IDEzMzcsXG4gICAgICAgICAgICAgICAgZmVlTW9kZWxWZXJzaW9uLFxuICAgICAgICAgICAgICAgIHR4T3JpZ2luLFxuICAgICAgICAgICAgICAgIG1ha2VyVG9rZW4sXG4gICAgICAgICAgICAgICAgdGFrZXJUb2tlbixcbiAgICAgICAgICAgICAgICBvcmlnaW5hbE1ha2VyVG9rZW46IG1ha2VyVG9rZW4sXG4gICAgICAgICAgICAgICAgbWFrZXJUb2tlbkRlY2ltYWxzLFxuICAgICAgICAgICAgICAgIHRha2VyVG9rZW5EZWNpbWFscyxcbiAgICAgICAgICAgICAgICBpc1Vud3JhcCxcbiAgICAgICAgICAgICAgICBpc1NlbGxpbmcsXG4gICAgICAgICAgICAgICAgYXNzZXRGaWxsQW1vdW50LFxuICAgICAgICAgICAgICAgIHRha2VyQW1vdW50OiBhc3NldEZpbGxBbW91bnQsXG4gICAgICAgICAgICAgICAgaXNGaXJtOiB0cnVlLFxuICAgICAgICAgICAgICAgIHRha2VyQWRkcmVzcyxcbiAgICAgICAgICAgICAgICB0cmFkZXI6IHRha2VyQWRkcmVzcyxcbiAgICAgICAgICAgICAgICBpbnRlZ3JhdG9yLFxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIC8vIFRoZW5cbiAgICAgICAgICAgIGNvbnN0IGV4cGVjdGVkR2FzRmVlQW1vdW50ID0gZ2FzUHJpY2UudGltZXMoZ2FzRXN0aW1hdGUpO1xuXG4gICAgICAgICAgICBjb25zdCBleHBlY3RlZEZlZTogRmVlV2l0aERldGFpbHMgPSB7XG4gICAgICAgICAgICAgICAgdHlwZTogJ2ZpeGVkJyxcbiAgICAgICAgICAgICAgICB0b2tlbjogZmVlVG9rZW5BZGRyZXNzLFxuICAgICAgICAgICAgICAgIGFtb3VudDogZXhwZWN0ZWRHYXNGZWVBbW91bnQsXG4gICAgICAgICAgICAgICAgZGV0YWlsczoge1xuICAgICAgICAgICAgICAgICAgICBraW5kOiAnZ2FzT25seScsXG4gICAgICAgICAgICAgICAgICAgIGZlZU1vZGVsVmVyc2lvbixcbiAgICAgICAgICAgICAgICAgICAgZ2FzRmVlQW1vdW50OiBleHBlY3RlZEdhc0ZlZUFtb3VudCxcbiAgICAgICAgICAgICAgICAgICAgZ2FzUHJpY2UsXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBicmVha2Rvd246IHtcbiAgICAgICAgICAgICAgICAgICAgZ2FzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhbW91bnQ6IGV4cGVjdGVkR2FzRmVlQW1vdW50LFxuICAgICAgICAgICAgICAgICAgICAgICAgZGV0YWlsczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdhc1ByaWNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVzdGltYXRlZEdhczogbmV3IEJpZ051bWJlcihnYXNFc3RpbWF0ZSksXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgY29udmVyc2lvblJhdGVzOiB7XG4gICAgICAgICAgICAgICAgICAgIG5hdGl2ZVRva2VuQmFzZVVuaXRQcmljZVVzZDogbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgZmVlVG9rZW5CYXNlVW5pdFByaWNlVXNkOiBudWxsLFxuICAgICAgICAgICAgICAgICAgICB0YWtlclRva2VuQmFzZVVuaXRQcmljZVVzZDogbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgbWFrZXJUb2tlbkJhc2VVbml0UHJpY2VVc2Q6IG51bGwsXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBleHBlY3QoZmVlKS50b01hdGNoT2JqZWN0KGV4cGVjdGVkRmVlKTtcbiAgICAgICAgfSk7XG4gICAgICAgIGl0KCdzaG91bGQgY2FsY3VsYXRlIHYwIGZlZSBmb3IgUkZRdCBjb3JyZWN0bHknLCBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAvLyBHaXZlblxuICAgICAgICAgICAgY29uc3QgaXNTZWxsaW5nID0gdHJ1ZTtcbiAgICAgICAgICAgIGNvbnN0IGlzVW53cmFwID0gZmFsc2U7XG4gICAgICAgICAgICBjb25zdCBhc3NldEZpbGxBbW91bnQgPSBuZXcgQmlnTnVtYmVyKDAuMzQ1ZTE4KTtcbiAgICAgICAgICAgIGNvbnN0IHRyYWRlU2l6ZUJwcyA9IDU7XG5cbiAgICAgICAgICAgIGNvbnN0IGZlZVNlcnZpY2U6IEZlZVNlcnZpY2UgPSBidWlsZEZlZVNlcnZpY2Uoe1xuICAgICAgICAgICAgICAgIGZlZU1vZGVsQ29uZmlndXJhdGlvbjoge1xuICAgICAgICAgICAgICAgICAgICBtYXJnaW5SYWtlUmF0aW86IDAsXG4gICAgICAgICAgICAgICAgICAgIHRyYWRlU2l6ZUJwcyxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGdhc1ByaWNlLFxuICAgICAgICAgICAgICAgIHRyYWRlVG9rZW5QcmljZTogdGFrZXJUb2tlblByaWNlLFxuICAgICAgICAgICAgICAgIGZlZVRva2VuUHJpY2UsXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgLy8gV2hlblxuICAgICAgICAgICAgY29uc3QgeyBmZWVXaXRoRGV0YWlsczogZmVlIH0gPSBhd2FpdCBmZWVTZXJ2aWNlLmNhbGN1bGF0ZUZlZUFzeW5jKHtcbiAgICAgICAgICAgICAgICB3b3JrZmxvdzogJ3JmcXQnLFxuICAgICAgICAgICAgICAgIGNoYWluSWQ6IDEzMzcsXG4gICAgICAgICAgICAgICAgZmVlTW9kZWxWZXJzaW9uLFxuICAgICAgICAgICAgICAgIHR4T3JpZ2luLFxuICAgICAgICAgICAgICAgIG1ha2VyVG9rZW4sXG4gICAgICAgICAgICAgICAgdGFrZXJUb2tlbixcbiAgICAgICAgICAgICAgICBvcmlnaW5hbE1ha2VyVG9rZW46IG1ha2VyVG9rZW4sXG4gICAgICAgICAgICAgICAgbWFrZXJUb2tlbkRlY2ltYWxzLFxuICAgICAgICAgICAgICAgIHRha2VyVG9rZW5EZWNpbWFscyxcbiAgICAgICAgICAgICAgICBpc1Vud3JhcCxcbiAgICAgICAgICAgICAgICBpc1NlbGxpbmcsXG4gICAgICAgICAgICAgICAgYXNzZXRGaWxsQW1vdW50LFxuICAgICAgICAgICAgICAgIHRha2VyQW1vdW50OiBhc3NldEZpbGxBbW91bnQsXG4gICAgICAgICAgICAgICAgaXNGaXJtOiB0cnVlLFxuICAgICAgICAgICAgICAgIHRha2VyQWRkcmVzcyxcbiAgICAgICAgICAgICAgICB0cmFkZXI6IHRha2VyQWRkcmVzcyxcbiAgICAgICAgICAgICAgICBpbnRlZ3JhdG9yLFxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIC8vIFRoZW5cbiAgICAgICAgICAgIGNvbnN0IGV4cGVjdGVkRmVlOiBGZWVXaXRoRGV0YWlscyA9IHtcbiAgICAgICAgICAgICAgICB0eXBlOiAnZml4ZWQnLFxuICAgICAgICAgICAgICAgIHRva2VuOiBmZWVUb2tlbkFkZHJlc3MsXG4gICAgICAgICAgICAgICAgYW1vdW50OiBuZXcgQmlnTnVtYmVyKDApLFxuICAgICAgICAgICAgICAgIGRldGFpbHM6IHtcbiAgICAgICAgICAgICAgICAgICAga2luZDogJ2dhc09ubHknLFxuICAgICAgICAgICAgICAgICAgICBmZWVNb2RlbFZlcnNpb24sXG4gICAgICAgICAgICAgICAgICAgIGdhc0ZlZUFtb3VudDogbmV3IEJpZ051bWJlcigwKSxcbiAgICAgICAgICAgICAgICAgICAgZ2FzUHJpY2U6IG5ldyBCaWdOdW1iZXIoMCksXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBicmVha2Rvd246IHt9LFxuICAgICAgICAgICAgICAgIGNvbnZlcnNpb25SYXRlczoge1xuICAgICAgICAgICAgICAgICAgICBuYXRpdmVUb2tlbkJhc2VVbml0UHJpY2VVc2Q6IG51bGwsXG4gICAgICAgICAgICAgICAgICAgIGZlZVRva2VuQmFzZVVuaXRQcmljZVVzZDogbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgdGFrZXJUb2tlbkJhc2VVbml0UHJpY2VVc2Q6IG51bGwsXG4gICAgICAgICAgICAgICAgICAgIG1ha2VyVG9rZW5CYXNlVW5pdFByaWNlVXNkOiBudWxsLFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgZXhwZWN0KGZlZSkudG9NYXRjaE9iamVjdChleHBlY3RlZEZlZSk7XG4gICAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgZGVzY3JpYmUoJ2NhbGN1bGF0ZUZlZUFzeW5jIHYxJywgKCkgPT4ge1xuICAgICAgICBjb25zdCBmZWVNb2RlbFZlcnNpb24gPSAxO1xuICAgICAgICBpdCgnc2hvdWxkIGNhbGN1bGF0ZSB2MSBmZWUgZm9yIFJGUW0gc2VsbGluZyBjb3JyZWN0bHknLCBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAvLyBHaXZlblxuICAgICAgICAgICAgY29uc3QgaXNTZWxsaW5nID0gdHJ1ZTtcbiAgICAgICAgICAgIGNvbnN0IGlzVW53cmFwID0gZmFsc2U7XG4gICAgICAgICAgICBjb25zdCBhc3NldEZpbGxBbW91bnQgPSBuZXcgQmlnTnVtYmVyKDAuMzQ1ZTE4KTtcbiAgICAgICAgICAgIGNvbnN0IHRyYWRlU2l6ZUJwcyA9IDU7XG5cbiAgICAgICAgICAgIGNvbnN0IGZlZVNlcnZpY2U6IEZlZVNlcnZpY2UgPSBidWlsZEZlZVNlcnZpY2Uoe1xuICAgICAgICAgICAgICAgIGZlZU1vZGVsQ29uZmlndXJhdGlvbjoge1xuICAgICAgICAgICAgICAgICAgICBtYXJnaW5SYWtlUmF0aW86IDAsXG4gICAgICAgICAgICAgICAgICAgIHRyYWRlU2l6ZUJwcyxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGdhc1ByaWNlLFxuICAgICAgICAgICAgICAgIHRyYWRlVG9rZW5QcmljZTogdGFrZXJUb2tlblByaWNlLFxuICAgICAgICAgICAgICAgIGZlZVRva2VuUHJpY2UsXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgLy8gV2hlblxuICAgICAgICAgICAgY29uc3QgeyBmZWVXaXRoRGV0YWlsczogZmVlIH0gPSBhd2FpdCBmZWVTZXJ2aWNlLmNhbGN1bGF0ZUZlZUFzeW5jKHtcbiAgICAgICAgICAgICAgICB3b3JrZmxvdyxcbiAgICAgICAgICAgICAgICBjaGFpbklkOiAxMzM3LFxuICAgICAgICAgICAgICAgIGZlZU1vZGVsVmVyc2lvbixcbiAgICAgICAgICAgICAgICB0eE9yaWdpbixcbiAgICAgICAgICAgICAgICBtYWtlclRva2VuLFxuICAgICAgICAgICAgICAgIHRha2VyVG9rZW4sXG4gICAgICAgICAgICAgICAgb3JpZ2luYWxNYWtlclRva2VuOiBtYWtlclRva2VuLFxuICAgICAgICAgICAgICAgIG1ha2VyVG9rZW5EZWNpbWFscyxcbiAgICAgICAgICAgICAgICB0YWtlclRva2VuRGVjaW1hbHMsXG4gICAgICAgICAgICAgICAgaXNVbndyYXAsXG4gICAgICAgICAgICAgICAgaXNTZWxsaW5nLFxuICAgICAgICAgICAgICAgIGFzc2V0RmlsbEFtb3VudCxcbiAgICAgICAgICAgICAgICB0YWtlckFtb3VudDogYXNzZXRGaWxsQW1vdW50LFxuICAgICAgICAgICAgICAgIGlzRmlybTogdHJ1ZSxcbiAgICAgICAgICAgICAgICB0YWtlckFkZHJlc3MsXG4gICAgICAgICAgICAgICAgdHJhZGVyOiB0YWtlckFkZHJlc3MsXG4gICAgICAgICAgICAgICAgaW50ZWdyYXRvcixcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAvLyBUaGVuXG4gICAgICAgICAgICBjb25zdCBleHBlY3RlZEdhc0ZlZUFtb3VudCA9IGdhc1ByaWNlLnRpbWVzKGdhc0VzdGltYXRlKTtcbiAgICAgICAgICAgIGNvbnN0IGV4cGVjdGVkWmVyb0V4RmVlQW1vdW50ID0gYXNzZXRGaWxsQW1vdW50XG4gICAgICAgICAgICAgICAgLnRpbWVzKHRyYWRlU2l6ZUJwcyAqIEJQU19UT19SQVRJTylcbiAgICAgICAgICAgICAgICAudGltZXModGFrZXJUb2tlblByaWNlKVxuICAgICAgICAgICAgICAgIC5kaXYoZmVlVG9rZW5QcmljZSlcbiAgICAgICAgICAgICAgICAuaW50ZWdlclZhbHVlKCk7XG4gICAgICAgICAgICBjb25zdCBleHBlY3RlZFRvdGFsRmVlQW1vdW50ID0gZXhwZWN0ZWRaZXJvRXhGZWVBbW91bnQucGx1cyhleHBlY3RlZEdhc0ZlZUFtb3VudCk7XG5cbiAgICAgICAgICAgIGNvbnN0IGV4cGVjdGVkRmVlOiBGZWVXaXRoRGV0YWlscyA9IHtcbiAgICAgICAgICAgICAgICB0eXBlOiAnZml4ZWQnLFxuICAgICAgICAgICAgICAgIHRva2VuOiBmZWVUb2tlbkFkZHJlc3MsXG4gICAgICAgICAgICAgICAgYW1vdW50OiBleHBlY3RlZFRvdGFsRmVlQW1vdW50LFxuICAgICAgICAgICAgICAgIGRldGFpbHM6IHtcbiAgICAgICAgICAgICAgICAgICAga2luZDogJ2RlZmF1bHQnLFxuICAgICAgICAgICAgICAgICAgICBmZWVNb2RlbFZlcnNpb24sXG4gICAgICAgICAgICAgICAgICAgIGdhc0ZlZUFtb3VudDogZXhwZWN0ZWRHYXNGZWVBbW91bnQsXG4gICAgICAgICAgICAgICAgICAgIGdhc1ByaWNlLFxuICAgICAgICAgICAgICAgICAgICB6ZXJvRXhGZWVBbW91bnQ6IGV4cGVjdGVkWmVyb0V4RmVlQW1vdW50LFxuICAgICAgICAgICAgICAgICAgICB0cmFkZVNpemVCcHMsXG4gICAgICAgICAgICAgICAgICAgIGZlZVRva2VuQmFzZVVuaXRQcmljZVVzZDogZmVlVG9rZW5QcmljZSxcbiAgICAgICAgICAgICAgICAgICAgdGFrZXJUb2tlbkJhc2VVbml0UHJpY2VVc2Q6IHRha2VyVG9rZW5QcmljZSxcbiAgICAgICAgICAgICAgICAgICAgbWFrZXJUb2tlbkJhc2VVbml0UHJpY2VVc2Q6IG51bGwsXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBicmVha2Rvd246IHtcbiAgICAgICAgICAgICAgICAgICAgZ2FzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhbW91bnQ6IGV4cGVjdGVkR2FzRmVlQW1vdW50LFxuICAgICAgICAgICAgICAgICAgICAgICAgZGV0YWlsczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdhc1ByaWNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVzdGltYXRlZEdhczogbmV3IEJpZ051bWJlcihnYXNFc3RpbWF0ZSksXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB6ZXJvRXg6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFtb3VudDogZXhwZWN0ZWRaZXJvRXhGZWVBbW91bnQsXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXRhaWxzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAga2luZDogJ3ZvbHVtZScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJhZGVTaXplQnBzLFxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGNvbnZlcnNpb25SYXRlczoge1xuICAgICAgICAgICAgICAgICAgICBuYXRpdmVUb2tlbkJhc2VVbml0UHJpY2VVc2Q6IGZlZVRva2VuUHJpY2UsXG4gICAgICAgICAgICAgICAgICAgIGZlZVRva2VuQmFzZVVuaXRQcmljZVVzZDogZmVlVG9rZW5QcmljZSxcbiAgICAgICAgICAgICAgICAgICAgdGFrZXJUb2tlbkJhc2VVbml0UHJpY2VVc2Q6IHRha2VyVG9rZW5QcmljZSxcbiAgICAgICAgICAgICAgICAgICAgbWFrZXJUb2tlbkJhc2VVbml0UHJpY2VVc2Q6IG51bGwsXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBleHBlY3QoZmVlKS50b01hdGNoT2JqZWN0KGV4cGVjdGVkRmVlKTtcbiAgICAgICAgfSk7XG4gICAgICAgIGl0KCdzaG91bGQgY2FsY3VsYXRlIHYxIGZlZSBmb3IgUkZRbSBidXlpbmcgY29ycmVjdGx5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgLy8gR2l2ZW5cbiAgICAgICAgICAgIGNvbnN0IGlzU2VsbGluZyA9IGZhbHNlO1xuICAgICAgICAgICAgY29uc3QgaXNVbndyYXAgPSBmYWxzZTtcbiAgICAgICAgICAgIGNvbnN0IGFzc2V0RmlsbEFtb3VudCA9IG5ldyBCaWdOdW1iZXIoNTAwMGU2KTtcbiAgICAgICAgICAgIGNvbnN0IHRyYWRlU2l6ZUJwcyA9IDQ7XG5cbiAgICAgICAgICAgIGNvbnN0IGZlZVNlcnZpY2U6IEZlZVNlcnZpY2UgPSBidWlsZEZlZVNlcnZpY2Uoe1xuICAgICAgICAgICAgICAgIGZlZU1vZGVsQ29uZmlndXJhdGlvbjoge1xuICAgICAgICAgICAgICAgICAgICBtYXJnaW5SYWtlUmF0aW86IDAsXG4gICAgICAgICAgICAgICAgICAgIHRyYWRlU2l6ZUJwcyxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGdhc1ByaWNlLFxuICAgICAgICAgICAgICAgIHRyYWRlVG9rZW5QcmljZTogbWFrZXJUb2tlblByaWNlLFxuICAgICAgICAgICAgICAgIGZlZVRva2VuUHJpY2UsXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgLy8gV2hlblxuICAgICAgICAgICAgY29uc3QgeyBmZWVXaXRoRGV0YWlsczogZmVlIH0gPSBhd2FpdCBmZWVTZXJ2aWNlLmNhbGN1bGF0ZUZlZUFzeW5jKHtcbiAgICAgICAgICAgICAgICB3b3JrZmxvdyxcbiAgICAgICAgICAgICAgICBjaGFpbklkOiAxMzM3LFxuICAgICAgICAgICAgICAgIGZlZU1vZGVsVmVyc2lvbixcbiAgICAgICAgICAgICAgICBtYWtlclRva2VuLFxuICAgICAgICAgICAgICAgIHRha2VyVG9rZW4sXG4gICAgICAgICAgICAgICAgb3JpZ2luYWxNYWtlclRva2VuOiBtYWtlclRva2VuLFxuICAgICAgICAgICAgICAgIG1ha2VyVG9rZW5EZWNpbWFscyxcbiAgICAgICAgICAgICAgICB0YWtlclRva2VuRGVjaW1hbHMsXG4gICAgICAgICAgICAgICAgaXNVbndyYXAsXG4gICAgICAgICAgICAgICAgaXNTZWxsaW5nLFxuICAgICAgICAgICAgICAgIGFzc2V0RmlsbEFtb3VudCxcbiAgICAgICAgICAgICAgICBtYWtlckFtb3VudDogYXNzZXRGaWxsQW1vdW50LFxuICAgICAgICAgICAgICAgIGlzRmlybTogZmFsc2UsXG4gICAgICAgICAgICAgICAgdGFrZXJBZGRyZXNzLFxuICAgICAgICAgICAgICAgIGludGVncmF0b3IsXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgLy8gVGhlblxuICAgICAgICAgICAgY29uc3QgZXhwZWN0ZWRHYXNGZWVBbW91bnQgPSBnYXNQcmljZS50aW1lcyhnYXNFc3RpbWF0ZSk7XG4gICAgICAgICAgICBjb25zdCBleHBlY3RlZFplcm9FeEZlZUFtb3VudCA9IGFzc2V0RmlsbEFtb3VudFxuICAgICAgICAgICAgICAgIC50aW1lcyh0cmFkZVNpemVCcHMgKiBCUFNfVE9fUkFUSU8pXG4gICAgICAgICAgICAgICAgLnRpbWVzKG1ha2VyVG9rZW5QcmljZSlcbiAgICAgICAgICAgICAgICAuZGl2KGZlZVRva2VuUHJpY2UpXG4gICAgICAgICAgICAgICAgLmludGVnZXJWYWx1ZSgpO1xuICAgICAgICAgICAgY29uc3QgZXhwZWN0ZWRUb3RhbEZlZUFtb3VudCA9IGV4cGVjdGVkWmVyb0V4RmVlQW1vdW50LnBsdXMoZXhwZWN0ZWRHYXNGZWVBbW91bnQpO1xuXG4gICAgICAgICAgICBjb25zdCBleHBlY3RlZEZlZTogRmVlV2l0aERldGFpbHMgPSB7XG4gICAgICAgICAgICAgICAgdHlwZTogJ2ZpeGVkJyxcbiAgICAgICAgICAgICAgICB0b2tlbjogZmVlVG9rZW5BZGRyZXNzLFxuICAgICAgICAgICAgICAgIGFtb3VudDogZXhwZWN0ZWRUb3RhbEZlZUFtb3VudCxcbiAgICAgICAgICAgICAgICBkZXRhaWxzOiB7XG4gICAgICAgICAgICAgICAgICAgIGtpbmQ6ICdkZWZhdWx0JyxcbiAgICAgICAgICAgICAgICAgICAgZmVlTW9kZWxWZXJzaW9uLFxuICAgICAgICAgICAgICAgICAgICBnYXNGZWVBbW91bnQ6IGV4cGVjdGVkR2FzRmVlQW1vdW50LFxuICAgICAgICAgICAgICAgICAgICBnYXNQcmljZSxcbiAgICAgICAgICAgICAgICAgICAgemVyb0V4RmVlQW1vdW50OiBleHBlY3RlZFplcm9FeEZlZUFtb3VudCxcbiAgICAgICAgICAgICAgICAgICAgdHJhZGVTaXplQnBzLFxuICAgICAgICAgICAgICAgICAgICBmZWVUb2tlbkJhc2VVbml0UHJpY2VVc2Q6IGZlZVRva2VuUHJpY2UsXG4gICAgICAgICAgICAgICAgICAgIHRha2VyVG9rZW5CYXNlVW5pdFByaWNlVXNkOiBudWxsLFxuICAgICAgICAgICAgICAgICAgICBtYWtlclRva2VuQmFzZVVuaXRQcmljZVVzZDogbWFrZXJUb2tlblByaWNlLFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgYnJlYWtkb3duOiB7XG4gICAgICAgICAgICAgICAgICAgIGdhczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgYW1vdW50OiBleHBlY3RlZEdhc0ZlZUFtb3VudCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGRldGFpbHM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnYXNQcmljZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlc3RpbWF0ZWRHYXM6IG5ldyBCaWdOdW1iZXIoZ2FzRXN0aW1hdGUpLFxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgemVyb0V4OiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhbW91bnQ6IGV4cGVjdGVkWmVyb0V4RmVlQW1vdW50LFxuICAgICAgICAgICAgICAgICAgICAgICAgZGV0YWlsczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGtpbmQ6ICd2b2x1bWUnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyYWRlU2l6ZUJwcyxcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBjb252ZXJzaW9uUmF0ZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgbmF0aXZlVG9rZW5CYXNlVW5pdFByaWNlVXNkOiBmZWVUb2tlblByaWNlLFxuICAgICAgICAgICAgICAgICAgICBmZWVUb2tlbkJhc2VVbml0UHJpY2VVc2Q6IGZlZVRva2VuUHJpY2UsXG4gICAgICAgICAgICAgICAgICAgIHRha2VyVG9rZW5CYXNlVW5pdFByaWNlVXNkOiBudWxsLFxuICAgICAgICAgICAgICAgICAgICBtYWtlclRva2VuQmFzZVVuaXRQcmljZVVzZDogbWFrZXJUb2tlblByaWNlLFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgZXhwZWN0KGZlZSkudG9NYXRjaE9iamVjdChleHBlY3RlZEZlZSk7XG4gICAgICAgIH0pO1xuICAgICAgICBpdCgnc2hvdWxkIGNhbGN1bGF0ZSB2MSBmZWUgZm9yIFJGUXQgc2VsbGluZyBjb3JyZWN0bHknLCBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAvLyBHaXZlblxuICAgICAgICAgICAgY29uc3QgaXNTZWxsaW5nID0gdHJ1ZTtcbiAgICAgICAgICAgIGNvbnN0IGlzVW53cmFwID0gZmFsc2U7XG4gICAgICAgICAgICBjb25zdCBhc3NldEZpbGxBbW91bnQgPSBuZXcgQmlnTnVtYmVyKDAuMzQ1ZTE4KTtcbiAgICAgICAgICAgIGNvbnN0IHRyYWRlU2l6ZUJwcyA9IDU7XG5cbiAgICAgICAgICAgIGNvbnN0IGZlZVNlcnZpY2U6IEZlZVNlcnZpY2UgPSBidWlsZEZlZVNlcnZpY2Uoe1xuICAgICAgICAgICAgICAgIGZlZU1vZGVsQ29uZmlndXJhdGlvbjoge1xuICAgICAgICAgICAgICAgICAgICBtYXJnaW5SYWtlUmF0aW86IDAsXG4gICAgICAgICAgICAgICAgICAgIHRyYWRlU2l6ZUJwcyxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGdhc1ByaWNlLFxuICAgICAgICAgICAgICAgIHRyYWRlVG9rZW5QcmljZTogdGFrZXJUb2tlblByaWNlLFxuICAgICAgICAgICAgICAgIGZlZVRva2VuUHJpY2UsXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgLy8gV2hlblxuICAgICAgICAgICAgY29uc3QgeyBmZWVXaXRoRGV0YWlsczogZmVlIH0gPSBhd2FpdCBmZWVTZXJ2aWNlLmNhbGN1bGF0ZUZlZUFzeW5jKHtcbiAgICAgICAgICAgICAgICB3b3JrZmxvdzogJ3JmcXQnLFxuICAgICAgICAgICAgICAgIGNoYWluSWQ6IDEzMzcsXG4gICAgICAgICAgICAgICAgZmVlTW9kZWxWZXJzaW9uLFxuICAgICAgICAgICAgICAgIHR4T3JpZ2luLFxuICAgICAgICAgICAgICAgIG1ha2VyVG9rZW4sXG4gICAgICAgICAgICAgICAgdGFrZXJUb2tlbixcbiAgICAgICAgICAgICAgICBvcmlnaW5hbE1ha2VyVG9rZW46IG1ha2VyVG9rZW4sXG4gICAgICAgICAgICAgICAgbWFrZXJUb2tlbkRlY2ltYWxzLFxuICAgICAgICAgICAgICAgIHRha2VyVG9rZW5EZWNpbWFscyxcbiAgICAgICAgICAgICAgICBpc1Vud3JhcCxcbiAgICAgICAgICAgICAgICBpc1NlbGxpbmcsXG4gICAgICAgICAgICAgICAgYXNzZXRGaWxsQW1vdW50LFxuICAgICAgICAgICAgICAgIHRha2VyQW1vdW50OiBhc3NldEZpbGxBbW91bnQsXG4gICAgICAgICAgICAgICAgaXNGaXJtOiB0cnVlLFxuICAgICAgICAgICAgICAgIHRha2VyQWRkcmVzcyxcbiAgICAgICAgICAgICAgICB0cmFkZXI6IHRha2VyQWRkcmVzcyxcbiAgICAgICAgICAgICAgICBpbnRlZ3JhdG9yLFxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIC8vIFRoZW5cbiAgICAgICAgICAgIGNvbnN0IGV4cGVjdGVkWmVyb0V4RmVlQW1vdW50ID0gYXNzZXRGaWxsQW1vdW50XG4gICAgICAgICAgICAgICAgLnRpbWVzKHRyYWRlU2l6ZUJwcyAqIEJQU19UT19SQVRJTylcbiAgICAgICAgICAgICAgICAudGltZXModGFrZXJUb2tlblByaWNlKVxuICAgICAgICAgICAgICAgIC5kaXYoZmVlVG9rZW5QcmljZSlcbiAgICAgICAgICAgICAgICAuaW50ZWdlclZhbHVlKCk7XG5cbiAgICAgICAgICAgIGNvbnN0IGV4cGVjdGVkRmVlOiBGZWVXaXRoRGV0YWlscyA9IHtcbiAgICAgICAgICAgICAgICB0eXBlOiAnZml4ZWQnLFxuICAgICAgICAgICAgICAgIHRva2VuOiBmZWVUb2tlbkFkZHJlc3MsXG4gICAgICAgICAgICAgICAgYW1vdW50OiBleHBlY3RlZFplcm9FeEZlZUFtb3VudCxcbiAgICAgICAgICAgICAgICBkZXRhaWxzOiB7XG4gICAgICAgICAgICAgICAgICAgIGtpbmQ6ICdkZWZhdWx0JyxcbiAgICAgICAgICAgICAgICAgICAgZmVlTW9kZWxWZXJzaW9uLFxuICAgICAgICAgICAgICAgICAgICBnYXNGZWVBbW91bnQ6IG5ldyBCaWdOdW1iZXIoMCksXG4gICAgICAgICAgICAgICAgICAgIGdhc1ByaWNlOiBuZXcgQmlnTnVtYmVyKDApLFxuICAgICAgICAgICAgICAgICAgICB6ZXJvRXhGZWVBbW91bnQ6IGV4cGVjdGVkWmVyb0V4RmVlQW1vdW50LFxuICAgICAgICAgICAgICAgICAgICB0cmFkZVNpemVCcHMsXG4gICAgICAgICAgICAgICAgICAgIGZlZVRva2VuQmFzZVVuaXRQcmljZVVzZDogZmVlVG9rZW5QcmljZSxcbiAgICAgICAgICAgICAgICAgICAgdGFrZXJUb2tlbkJhc2VVbml0UHJpY2VVc2Q6IHRha2VyVG9rZW5QcmljZSxcbiAgICAgICAgICAgICAgICAgICAgbWFrZXJUb2tlbkJhc2VVbml0UHJpY2VVc2Q6IG51bGwsXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBicmVha2Rvd246IHtcbiAgICAgICAgICAgICAgICAgICAgemVyb0V4OiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhbW91bnQ6IGV4cGVjdGVkWmVyb0V4RmVlQW1vdW50LFxuICAgICAgICAgICAgICAgICAgICAgICAgZGV0YWlsczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGtpbmQ6ICd2b2x1bWUnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyYWRlU2l6ZUJwcyxcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBjb252ZXJzaW9uUmF0ZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgbmF0aXZlVG9rZW5CYXNlVW5pdFByaWNlVXNkOiBmZWVUb2tlblByaWNlLFxuICAgICAgICAgICAgICAgICAgICBmZWVUb2tlbkJhc2VVbml0UHJpY2VVc2Q6IGZlZVRva2VuUHJpY2UsXG4gICAgICAgICAgICAgICAgICAgIHRha2VyVG9rZW5CYXNlVW5pdFByaWNlVXNkOiB0YWtlclRva2VuUHJpY2UsXG4gICAgICAgICAgICAgICAgICAgIG1ha2VyVG9rZW5CYXNlVW5pdFByaWNlVXNkOiBudWxsLFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgZXhwZWN0KGZlZSkudG9NYXRjaE9iamVjdChleHBlY3RlZEZlZSk7XG4gICAgICAgIH0pO1xuICAgICAgICBpdCgnc2hvdWxkIG5vdCBpbmNsdWRlIHplcm9FeCBmZWUgZm9yIG5vbi1jb25maWd1cmVkIHBhaXJzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgLy8gR2l2ZW5cbiAgICAgICAgICAgIGNvbnN0IGlzU2VsbGluZyA9IHRydWU7XG4gICAgICAgICAgICBjb25zdCBpc1Vud3JhcCA9IGZhbHNlO1xuICAgICAgICAgICAgY29uc3QgYXNzZXRGaWxsQW1vdW50ID0gbmV3IEJpZ051bWJlcigwLjM0NWUxOCk7XG5cbiAgICAgICAgICAgIGNvbnN0IGZlZVNlcnZpY2U6IEZlZVNlcnZpY2UgPSBidWlsZEZlZVNlcnZpY2Uoe1xuICAgICAgICAgICAgICAgIGdhc1ByaWNlLFxuICAgICAgICAgICAgICAgIHRyYWRlVG9rZW5QcmljZTogdGFrZXJUb2tlblByaWNlLFxuICAgICAgICAgICAgICAgIGZlZVRva2VuUHJpY2UsXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgLy8gV2hlblxuICAgICAgICAgICAgY29uc3QgeyBmZWVXaXRoRGV0YWlsczogZmVlIH0gPSBhd2FpdCBmZWVTZXJ2aWNlLmNhbGN1bGF0ZUZlZUFzeW5jKHtcbiAgICAgICAgICAgICAgICB3b3JrZmxvdyxcbiAgICAgICAgICAgICAgICBjaGFpbklkOiAxMzM3LFxuICAgICAgICAgICAgICAgIGZlZU1vZGVsVmVyc2lvbixcbiAgICAgICAgICAgICAgICBtYWtlclRva2VuLFxuICAgICAgICAgICAgICAgIHRha2VyVG9rZW4sXG4gICAgICAgICAgICAgICAgb3JpZ2luYWxNYWtlclRva2VuOiBtYWtlclRva2VuLFxuICAgICAgICAgICAgICAgIG1ha2VyVG9rZW5EZWNpbWFscyxcbiAgICAgICAgICAgICAgICB0YWtlclRva2VuRGVjaW1hbHMsXG4gICAgICAgICAgICAgICAgaXNVbndyYXAsXG4gICAgICAgICAgICAgICAgaXNTZWxsaW5nLFxuICAgICAgICAgICAgICAgIGFzc2V0RmlsbEFtb3VudCxcbiAgICAgICAgICAgICAgICB0YWtlckFtb3VudDogYXNzZXRGaWxsQW1vdW50LFxuICAgICAgICAgICAgICAgIGlzRmlybTogZmFsc2UsXG4gICAgICAgICAgICAgICAgdGFrZXJBZGRyZXNzLFxuICAgICAgICAgICAgICAgIGludGVncmF0b3IsXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgLy8gVGhlblxuICAgICAgICAgICAgY29uc3QgZXhwZWN0ZWRHYXNGZWVBbW91bnQgPSBnYXNQcmljZS50aW1lcyhnYXNFc3RpbWF0ZSk7XG5cbiAgICAgICAgICAgIGNvbnN0IGV4cGVjdGVkRmVlOiBGZWVXaXRoRGV0YWlscyA9IHtcbiAgICAgICAgICAgICAgICB0eXBlOiAnZml4ZWQnLFxuICAgICAgICAgICAgICAgIHRva2VuOiBmZWVUb2tlbkFkZHJlc3MsXG4gICAgICAgICAgICAgICAgYW1vdW50OiBleHBlY3RlZEdhc0ZlZUFtb3VudCxcbiAgICAgICAgICAgICAgICBkZXRhaWxzOiB7XG4gICAgICAgICAgICAgICAgICAgIGtpbmQ6ICdkZWZhdWx0JyxcbiAgICAgICAgICAgICAgICAgICAgZmVlTW9kZWxWZXJzaW9uLFxuICAgICAgICAgICAgICAgICAgICBnYXNGZWVBbW91bnQ6IGV4cGVjdGVkR2FzRmVlQW1vdW50LFxuICAgICAgICAgICAgICAgICAgICBnYXNQcmljZSxcbiAgICAgICAgICAgICAgICAgICAgemVyb0V4RmVlQW1vdW50OiBuZXcgQmlnTnVtYmVyKDApLFxuICAgICAgICAgICAgICAgICAgICB0cmFkZVNpemVCcHM6IDAsXG4gICAgICAgICAgICAgICAgICAgIGZlZVRva2VuQmFzZVVuaXRQcmljZVVzZDogbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgdGFrZXJUb2tlbkJhc2VVbml0UHJpY2VVc2Q6IG51bGwsXG4gICAgICAgICAgICAgICAgICAgIG1ha2VyVG9rZW5CYXNlVW5pdFByaWNlVXNkOiBudWxsLFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgYnJlYWtkb3duOiB7XG4gICAgICAgICAgICAgICAgICAgIGdhczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgYW1vdW50OiBleHBlY3RlZEdhc0ZlZUFtb3VudCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGRldGFpbHM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnYXNQcmljZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlc3RpbWF0ZWRHYXM6IG5ldyBCaWdOdW1iZXIoZ2FzRXN0aW1hdGUpLFxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgemVyb0V4OiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhbW91bnQ6IG5ldyBCaWdOdW1iZXIoMCksXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXRhaWxzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAga2luZDogJ3ZvbHVtZScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJhZGVTaXplQnBzOiAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGNvbnZlcnNpb25SYXRlczoge1xuICAgICAgICAgICAgICAgICAgICBuYXRpdmVUb2tlbkJhc2VVbml0UHJpY2VVc2Q6IG51bGwsXG4gICAgICAgICAgICAgICAgICAgIGZlZVRva2VuQmFzZVVuaXRQcmljZVVzZDogbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgdGFrZXJUb2tlbkJhc2VVbml0UHJpY2VVc2Q6IG51bGwsXG4gICAgICAgICAgICAgICAgICAgIG1ha2VyVG9rZW5CYXNlVW5pdFByaWNlVXNkOiBudWxsLFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgZXhwZWN0KGZlZSkudG9NYXRjaE9iamVjdChleHBlY3RlZEZlZSk7XG4gICAgICAgIH0pO1xuICAgICAgICBpdCgnc2hvdWxkIG5vdCBpbmNsdWRlIHplcm9FeCBmZWUgaWYgcHJpY2Ugb3JhY2xlIGlzIGRvd24nLCBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAvLyBHaXZlblxuICAgICAgICAgICAgY29uc3QgaXNTZWxsaW5nID0gZmFsc2U7XG4gICAgICAgICAgICBjb25zdCBpc1Vud3JhcCA9IGZhbHNlO1xuICAgICAgICAgICAgY29uc3QgYXNzZXRGaWxsQW1vdW50ID0gbmV3IEJpZ051bWJlcig1MDAwZTYpO1xuICAgICAgICAgICAgY29uc3QgdHJhZGVTaXplQnBzID0gNDtcblxuICAgICAgICAgICAgY29uc3QgZmVlU2VydmljZTogRmVlU2VydmljZSA9IGJ1aWxkRmVlU2VydmljZSh7XG4gICAgICAgICAgICAgICAgZmVlTW9kZWxDb25maWd1cmF0aW9uOiB7XG4gICAgICAgICAgICAgICAgICAgIG1hcmdpblJha2VSYXRpbzogMCxcbiAgICAgICAgICAgICAgICAgICAgdHJhZGVTaXplQnBzLFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgZ2FzUHJpY2UsXG4gICAgICAgICAgICAgICAgdHJhZGVUb2tlblByaWNlOiBtYWtlclRva2VuUHJpY2UsXG4gICAgICAgICAgICAgICAgZmVlVG9rZW5QcmljZTogbnVsbCxcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAvLyBXaGVuXG4gICAgICAgICAgICBjb25zdCB7IGZlZVdpdGhEZXRhaWxzOiBmZWUgfSA9IGF3YWl0IGZlZVNlcnZpY2UuY2FsY3VsYXRlRmVlQXN5bmMoe1xuICAgICAgICAgICAgICAgIHdvcmtmbG93LFxuICAgICAgICAgICAgICAgIGNoYWluSWQ6IDEzMzcsXG4gICAgICAgICAgICAgICAgZmVlTW9kZWxWZXJzaW9uLFxuICAgICAgICAgICAgICAgIHR4T3JpZ2luLFxuICAgICAgICAgICAgICAgIG1ha2VyVG9rZW4sXG4gICAgICAgICAgICAgICAgdGFrZXJUb2tlbixcbiAgICAgICAgICAgICAgICBvcmlnaW5hbE1ha2VyVG9rZW46IG1ha2VyVG9rZW4sXG4gICAgICAgICAgICAgICAgbWFrZXJUb2tlbkRlY2ltYWxzLFxuICAgICAgICAgICAgICAgIHRha2VyVG9rZW5EZWNpbWFscyxcbiAgICAgICAgICAgICAgICBpc1Vud3JhcCxcbiAgICAgICAgICAgICAgICBpc1NlbGxpbmcsXG4gICAgICAgICAgICAgICAgYXNzZXRGaWxsQW1vdW50LFxuICAgICAgICAgICAgICAgIG1ha2VyQW1vdW50OiBhc3NldEZpbGxBbW91bnQsXG4gICAgICAgICAgICAgICAgaXNGaXJtOiB0cnVlLFxuICAgICAgICAgICAgICAgIHRha2VyQWRkcmVzcyxcbiAgICAgICAgICAgICAgICB0cmFkZXI6IHRha2VyQWRkcmVzcyxcbiAgICAgICAgICAgICAgICBpbnRlZ3JhdG9yLFxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIC8vIFRoZW5cbiAgICAgICAgICAgIGNvbnN0IGV4cGVjdGVkR2FzRmVlQW1vdW50ID0gZ2FzUHJpY2UudGltZXMoZ2FzRXN0aW1hdGUpO1xuXG4gICAgICAgICAgICBjb25zdCBleHBlY3RlZEZlZTogRmVlV2l0aERldGFpbHMgPSB7XG4gICAgICAgICAgICAgICAgdHlwZTogJ2ZpeGVkJyxcbiAgICAgICAgICAgICAgICB0b2tlbjogZmVlVG9rZW5BZGRyZXNzLFxuICAgICAgICAgICAgICAgIGFtb3VudDogZXhwZWN0ZWRHYXNGZWVBbW91bnQsXG4gICAgICAgICAgICAgICAgZGV0YWlsczoge1xuICAgICAgICAgICAgICAgICAgICBraW5kOiAnZ2FzT25seScsXG4gICAgICAgICAgICAgICAgICAgIGZlZU1vZGVsVmVyc2lvbixcbiAgICAgICAgICAgICAgICAgICAgZ2FzRmVlQW1vdW50OiBleHBlY3RlZEdhc0ZlZUFtb3VudCxcbiAgICAgICAgICAgICAgICAgICAgZ2FzUHJpY2UsXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBicmVha2Rvd246IHtcbiAgICAgICAgICAgICAgICAgICAgZ2FzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhbW91bnQ6IGV4cGVjdGVkR2FzRmVlQW1vdW50LFxuICAgICAgICAgICAgICAgICAgICAgICAgZGV0YWlsczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdhc1ByaWNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVzdGltYXRlZEdhczogbmV3IEJpZ051bWJlcihnYXNFc3RpbWF0ZSksXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgY29udmVyc2lvblJhdGVzOiB7XG4gICAgICAgICAgICAgICAgICAgIG5hdGl2ZVRva2VuQmFzZVVuaXRQcmljZVVzZDogbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgZmVlVG9rZW5CYXNlVW5pdFByaWNlVXNkOiBudWxsLFxuICAgICAgICAgICAgICAgICAgICB0YWtlclRva2VuQmFzZVVuaXRQcmljZVVzZDogbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgbWFrZXJUb2tlbkJhc2VVbml0UHJpY2VVc2Q6IG51bGwsXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBleHBlY3QoZmVlKS50b01hdGNoT2JqZWN0KGV4cGVjdGVkRmVlKTtcbiAgICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBkZXNjcmliZSgnY2FsY3VsYXRlRmVlQXN5bmMgdjInLCAoKSA9PiB7XG4gICAgICAgIGNvbnN0IGZlZU1vZGVsVmVyc2lvbiA9IDI7XG4gICAgICAgIGl0KCdzaG91bGQgY2FsY3VsYXRlIHYyIGBwcmljZSBpbXByb3ZlbWVudGAgYmFzZWQgZmVlIGZvciBzZWxsIGNvcnJlY3RseSBpZiBwcmljZSBpbXByb3ZlbWVudCBkZXRlY3Rpb24gc3VjY2VlZGVkJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgLy8gR2l2ZW5cbiAgICAgICAgICAgIGNvbnN0IGlzU2VsbGluZyA9IHRydWU7XG4gICAgICAgICAgICBjb25zdCBpc1Vud3JhcCA9IGZhbHNlO1xuICAgICAgICAgICAgY29uc3QgYXNzZXRGaWxsQW1vdW50ID0gbmV3IEJpZ051bWJlcigxZTE4KTtcbiAgICAgICAgICAgIGNvbnN0IG1hcmdpblJha2VSYXRpbyA9IDAuNTtcblxuICAgICAgICAgICAgY29uc3QgYW1tTWFrZXJBbW91bnQgPSBuZXcgQmlnTnVtYmVyKDM0NTBlNik7XG4gICAgICAgICAgICBjb25zdCBleHBlY3RlZFNsaXBwYWdlID0gbmV3IEJpZ051bWJlcigtMC4wMSk7XG4gICAgICAgICAgICBjb25zdCBlc3RpbWF0ZWRBbW1HYXNGZWVXZWkgPSBuZXcgQmlnTnVtYmVyKDEwMGU5KTtcbiAgICAgICAgICAgIGNvbnN0IGRlY29kZWRVbmlxdWVJZCA9ICcxMjM0LTU2NzgnO1xuICAgICAgICAgICAgY29uc3QgYW1tUXVvdGU6IEFtbVF1b3RlID0ge1xuICAgICAgICAgICAgICAgIG1ha2VyQW1vdW50OiBhbW1NYWtlckFtb3VudCxcbiAgICAgICAgICAgICAgICB0YWtlckFtb3VudDogYXNzZXRGaWxsQW1vdW50LFxuICAgICAgICAgICAgICAgIGV4cGVjdGVkU2xpcHBhZ2UsXG4gICAgICAgICAgICAgICAgZXN0aW1hdGVkR2FzRmVlV2VpOiBlc3RpbWF0ZWRBbW1HYXNGZWVXZWksXG4gICAgICAgICAgICAgICAgZGVjb2RlZFVuaXF1ZUlkLFxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgY29uc3QgbW0xTWFrZXJBbW91bnQgPSBuZXcgQmlnTnVtYmVyKDM1NTBlNik7XG4gICAgICAgICAgICBjb25zdCBtbTJNYWtlckFtb3VudCA9IG5ldyBCaWdOdW1iZXIoMzYwMGU2KTtcbiAgICAgICAgICAgIGNvbnN0IG1tUXVvdGVzOiBJbmRpY2F0aXZlUXVvdGVbXSA9IFtcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIG1ha2VyOiAnbWFrZXIxQWRkcmVzcycsXG4gICAgICAgICAgICAgICAgICAgIG1ha2VyVXJpOiAnaHR0cDovL21ha2VyMS5jb20nLFxuICAgICAgICAgICAgICAgICAgICBtYWtlclRva2VuLFxuICAgICAgICAgICAgICAgICAgICB0YWtlclRva2VuLFxuICAgICAgICAgICAgICAgICAgICBtYWtlckFtb3VudDogbW0xTWFrZXJBbW91bnQsXG4gICAgICAgICAgICAgICAgICAgIHRha2VyQW1vdW50OiBhc3NldEZpbGxBbW91bnQsXG4gICAgICAgICAgICAgICAgICAgIGV4cGlyeTogbmV3IEJpZ051bWJlcigxNjUyNzIyNzY3KSxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgbWFrZXI6ICdtYWtlcjJBZGRyZXNzJyxcbiAgICAgICAgICAgICAgICAgICAgbWFrZXJVcmk6ICdodHRwOi8vbWFrZXIyLmNvbScsXG4gICAgICAgICAgICAgICAgICAgIG1ha2VyVG9rZW4sXG4gICAgICAgICAgICAgICAgICAgIHRha2VyVG9rZW4sXG4gICAgICAgICAgICAgICAgICAgIG1ha2VyQW1vdW50OiBtbTJNYWtlckFtb3VudCxcbiAgICAgICAgICAgICAgICAgICAgdGFrZXJBbW91bnQ6IGFzc2V0RmlsbEFtb3VudCxcbiAgICAgICAgICAgICAgICAgICAgZXhwaXJ5OiBuZXcgQmlnTnVtYmVyKDE2NTI3MjI3NjcpLFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBdO1xuXG4gICAgICAgICAgICBjb25zdCBmZWVTZXJ2aWNlOiBGZWVTZXJ2aWNlID0gYnVpbGRGZWVTZXJ2aWNlKHtcbiAgICAgICAgICAgICAgICBmZWVNb2RlbENvbmZpZ3VyYXRpb246IHtcbiAgICAgICAgICAgICAgICAgICAgbWFyZ2luUmFrZVJhdGlvLFxuICAgICAgICAgICAgICAgICAgICB0cmFkZVNpemVCcHM6IDAsXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBnYXNQcmljZSxcbiAgICAgICAgICAgICAgICB0cmFkZVRva2VuUHJpY2U6IG1ha2VyVG9rZW5QcmljZSxcbiAgICAgICAgICAgICAgICBmZWVUb2tlblByaWNlLFxuICAgICAgICAgICAgICAgIGFtbVF1b3RlLFxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGNvbnN0IHF1b3RlQ29udGV4dDogUXVvdGVDb250ZXh0ID0ge1xuICAgICAgICAgICAgICAgIHdvcmtmbG93LFxuICAgICAgICAgICAgICAgIGNoYWluSWQ6IDEzMzcsXG4gICAgICAgICAgICAgICAgaXNGaXJtOiB0cnVlLFxuICAgICAgICAgICAgICAgIGZlZU1vZGVsVmVyc2lvbixcbiAgICAgICAgICAgICAgICB0eE9yaWdpbixcbiAgICAgICAgICAgICAgICBtYWtlclRva2VuLFxuICAgICAgICAgICAgICAgIHRha2VyVG9rZW4sXG4gICAgICAgICAgICAgICAgb3JpZ2luYWxNYWtlclRva2VuOiBtYWtlclRva2VuLFxuICAgICAgICAgICAgICAgIG1ha2VyVG9rZW5EZWNpbWFscyxcbiAgICAgICAgICAgICAgICB0YWtlclRva2VuRGVjaW1hbHMsXG4gICAgICAgICAgICAgICAgaXNVbndyYXAsXG4gICAgICAgICAgICAgICAgaXNTZWxsaW5nLFxuICAgICAgICAgICAgICAgIGFzc2V0RmlsbEFtb3VudCxcbiAgICAgICAgICAgICAgICB0YWtlckFtb3VudDogYXNzZXRGaWxsQW1vdW50LFxuICAgICAgICAgICAgICAgIHRha2VyQWRkcmVzcyxcbiAgICAgICAgICAgICAgICB0cmFkZXI6IHRha2VyQWRkcmVzcyxcbiAgICAgICAgICAgICAgICBpbnRlZ3JhdG9yLFxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgLy8gV2hlblxuICAgICAgICAgICAgamVzdC51c2VGYWtlVGltZXJzKCkuc2V0U3lzdGVtVGltZSgxNjUwMDAwMDAwMDAwKTtcbiAgICAgICAgICAgIGNvbnN0IHsgZmVlV2l0aERldGFpbHMsIHF1b3Rlc1dpdGhHYXNGZWUsIGFtbVF1b3RlVW5pcXVlSWQgfSA9IGF3YWl0IGZlZVNlcnZpY2UuY2FsY3VsYXRlRmVlQXN5bmMoXG4gICAgICAgICAgICAgICAgcXVvdGVDb250ZXh0LFxuICAgICAgICAgICAgICAgIGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShtbVF1b3Rlcyk7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgIC8vIFRoZW5cbiAgICAgICAgICAgIGNvbnN0IGV4cGVjdGVkR2FzRmVlQW1vdW50ID0gZ2FzUHJpY2UudGltZXMoZ2FzRXN0aW1hdGUpO1xuICAgICAgICAgICAgY29uc3QgZXhwZWN0ZWRNYXJnaW4gPSBtbTJNYWtlckFtb3VudFxuICAgICAgICAgICAgICAgIC5taW51cyhhbW1NYWtlckFtb3VudC50aW1lcyhuZXcgQmlnTnVtYmVyKDEpLnBsdXMoZXhwZWN0ZWRTbGlwcGFnZSkpKVxuICAgICAgICAgICAgICAgIC50aW1lcyhtYWtlclRva2VuUHJpY2UpXG4gICAgICAgICAgICAgICAgLmRpdihmZWVUb2tlblByaWNlKVxuICAgICAgICAgICAgICAgIC5wbHVzKGVzdGltYXRlZEFtbUdhc0ZlZVdlaSlcbiAgICAgICAgICAgICAgICAuaW50ZWdlclZhbHVlKCk7XG4gICAgICAgICAgICBjb25zdCBleHBlY3RlZFplcm9FeEZlZUFtb3VudCA9IGV4cGVjdGVkTWFyZ2luLnRpbWVzKG1hcmdpblJha2VSYXRpbykuaW50ZWdlclZhbHVlKCk7XG4gICAgICAgICAgICBjb25zdCBleHBlY3RlZFRvdGFsRmVlQW1vdW50ID0gZXhwZWN0ZWRaZXJvRXhGZWVBbW91bnQucGx1cyhleHBlY3RlZEdhc0ZlZUFtb3VudCk7XG5cbiAgICAgICAgICAgIGNvbnN0IGV4cGVjdGVkRmVlOiBGZWVXaXRoRGV0YWlscyA9IHtcbiAgICAgICAgICAgICAgICB0eXBlOiAnZml4ZWQnLFxuICAgICAgICAgICAgICAgIHRva2VuOiBmZWVUb2tlbkFkZHJlc3MsXG4gICAgICAgICAgICAgICAgYW1vdW50OiBleHBlY3RlZFRvdGFsRmVlQW1vdW50LFxuICAgICAgICAgICAgICAgIGRldGFpbHM6IHtcbiAgICAgICAgICAgICAgICAgICAga2luZDogJ21hcmdpbicsXG4gICAgICAgICAgICAgICAgICAgIGZlZU1vZGVsVmVyc2lvbixcbiAgICAgICAgICAgICAgICAgICAgZ2FzRmVlQW1vdW50OiBleHBlY3RlZEdhc0ZlZUFtb3VudCxcbiAgICAgICAgICAgICAgICAgICAgZ2FzUHJpY2UsXG4gICAgICAgICAgICAgICAgICAgIHplcm9FeEZlZUFtb3VudDogZXhwZWN0ZWRaZXJvRXhGZWVBbW91bnQsXG4gICAgICAgICAgICAgICAgICAgIG1hcmdpbjogZXhwZWN0ZWRNYXJnaW4sXG4gICAgICAgICAgICAgICAgICAgIG1hcmdpblJha2VSYXRpbyxcbiAgICAgICAgICAgICAgICAgICAgZmVlVG9rZW5CYXNlVW5pdFByaWNlVXNkOiBmZWVUb2tlblByaWNlLFxuICAgICAgICAgICAgICAgICAgICB0YWtlclRva2VuQmFzZVVuaXRQcmljZVVzZDogbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgbWFrZXJUb2tlbkJhc2VVbml0UHJpY2VVc2Q6IG1ha2VyVG9rZW5QcmljZSxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGJyZWFrZG93bjoge1xuICAgICAgICAgICAgICAgICAgICBnYXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFtb3VudDogZXhwZWN0ZWRHYXNGZWVBbW91bnQsXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXRhaWxzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2FzUHJpY2UsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXN0aW1hdGVkR2FzOiBuZXcgQmlnTnVtYmVyKGdhc0VzdGltYXRlKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHplcm9FeDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgYW1vdW50OiBleHBlY3RlZFplcm9FeEZlZUFtb3VudCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGRldGFpbHM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBraW5kOiAncHJpY2VfaW1wcm92ZW1lbnQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByaWNlSW1wcm92ZW1lbnQ6IGV4cGVjdGVkTWFyZ2luLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJha2VSYXRpbzogbWFyZ2luUmFrZVJhdGlvLFxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGNvbnZlcnNpb25SYXRlczoge1xuICAgICAgICAgICAgICAgICAgICBuYXRpdmVUb2tlbkJhc2VVbml0UHJpY2VVc2Q6IGZlZVRva2VuUHJpY2UsXG4gICAgICAgICAgICAgICAgICAgIGZlZVRva2VuQmFzZVVuaXRQcmljZVVzZDogZmVlVG9rZW5QcmljZSxcbiAgICAgICAgICAgICAgICAgICAgdGFrZXJUb2tlbkJhc2VVbml0UHJpY2VVc2Q6IG51bGwsXG4gICAgICAgICAgICAgICAgICAgIG1ha2VyVG9rZW5CYXNlVW5pdFByaWNlVXNkOiBtYWtlclRva2VuUHJpY2UsXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBleHBlY3QoZmVlV2l0aERldGFpbHMpLnRvTWF0Y2hPYmplY3QoZXhwZWN0ZWRGZWUpO1xuICAgICAgICAgICAgZXhwZWN0KHF1b3Rlc1dpdGhHYXNGZWUpLnRvTWF0Y2hPYmplY3QobW1RdW90ZXMpO1xuICAgICAgICAgICAgZXhwZWN0KGFtbVF1b3RlVW5pcXVlSWQpLnRvQmUoZGVjb2RlZFVuaXF1ZUlkKTtcblxuICAgICAgICAgICAgLy8gV2hlblxuICAgICAgICAgICAgY29uc3QgcmV2aXNlZFF1b3RlcyA9IGF3YWl0IGZlZVNlcnZpY2UucmV2aXNlUXVvdGVzQXN5bmMoXG4gICAgICAgICAgICAgICAgLy8gJGVzbGludC1maXgtbWUgaHR0cHM6Ly9naXRodWIuY29tL3JoaW5vZGF2aWQvZXNsaW50LWZpeC1tZVxuICAgICAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tbm9uLW51bGwtYXNzZXJ0aW9uXG4gICAgICAgICAgICAgICAgcXVvdGVzV2l0aEdhc0ZlZSEsXG4gICAgICAgICAgICAgICAgZXhwZWN0ZWRaZXJvRXhGZWVBbW91bnQsXG4gICAgICAgICAgICAgICAgcXVvdGVDb250ZXh0LFxuICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgLy8gVGhlblxuICAgICAgICAgICAgY29uc3QgZXhwZWN0ZWRSZXZpc2VkUXVvdGVzID0gbW1RdW90ZXMubWFwKChxdW90ZSkgPT5cbiAgICAgICAgICAgICAgICByZXZpc2VRdW90ZVdpdGhGZWVzKHF1b3RlLCBleHBlY3RlZFplcm9FeEZlZUFtb3VudCwgaXNTZWxsaW5nLCBtYWtlclRva2VuUHJpY2UsIGZlZVRva2VuUHJpY2UpLFxuICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgZXhwZWN0KHJldmlzZWRRdW90ZXMpLnRvTWF0Y2hPYmplY3QoZXhwZWN0ZWRSZXZpc2VkUXVvdGVzKTtcbiAgICAgICAgfSk7XG4gICAgICAgIGl0KCdzaG91bGQgY2FsY3VsYXRlIHYyIGBwcmljZSBpbXByb3ZlbWVudGAgYmFzZWQgZmVlIGZvciBidXkgY29ycmVjdGx5IGlmIHByaWNlIGltcHJvdmVtZW50IGRldGVjdGlvbiBzdWNjZWVkZWQnLCBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAvLyBHaXZlblxuICAgICAgICAgICAgY29uc3QgaXNTZWxsaW5nID0gZmFsc2U7XG4gICAgICAgICAgICBjb25zdCBpc1Vud3JhcCA9IGZhbHNlO1xuICAgICAgICAgICAgY29uc3QgYXNzZXRGaWxsQW1vdW50ID0gbmV3IEJpZ051bWJlcigxZTE4KTtcbiAgICAgICAgICAgIGNvbnN0IG1hcmdpblJha2VSYXRpbyA9IDAuNDtcblxuICAgICAgICAgICAgY29uc3QgYW1tVGFrZXJBbW91bnQgPSBuZXcgQmlnTnVtYmVyKDM0NTBlNik7XG4gICAgICAgICAgICBjb25zdCBleHBlY3RlZFNsaXBwYWdlID0gbmV3IEJpZ051bWJlcigtMC4xKTtcbiAgICAgICAgICAgIGNvbnN0IGVzdGltYXRlZEFtbUdhc0ZlZVdlaSA9IG5ldyBCaWdOdW1iZXIoMTAwZTkpO1xuICAgICAgICAgICAgY29uc3QgZGVjb2RlZFVuaXF1ZUlkID0gJzEyMzQtNTY3OCc7XG4gICAgICAgICAgICBjb25zdCBhbW1RdW90ZTogQW1tUXVvdGUgPSB7XG4gICAgICAgICAgICAgICAgbWFrZXJBbW91bnQ6IGFzc2V0RmlsbEFtb3VudCxcbiAgICAgICAgICAgICAgICB0YWtlckFtb3VudDogYW1tVGFrZXJBbW91bnQsXG4gICAgICAgICAgICAgICAgZXhwZWN0ZWRTbGlwcGFnZSxcbiAgICAgICAgICAgICAgICBlc3RpbWF0ZWRHYXNGZWVXZWk6IGVzdGltYXRlZEFtbUdhc0ZlZVdlaSxcbiAgICAgICAgICAgICAgICBkZWNvZGVkVW5pcXVlSWQsXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBjb25zdCBtbTFUYWtlckFtb3VudCA9IG5ldyBCaWdOdW1iZXIoMzQwMGU2KTtcbiAgICAgICAgICAgIGNvbnN0IG1tMlRha2VyQW1vdW50ID0gbmV3IEJpZ051bWJlcigzMzUwZTYpO1xuICAgICAgICAgICAgY29uc3QgbW1RdW90ZXM6IEluZGljYXRpdmVRdW90ZVtdID0gW1xuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgbWFrZXI6ICdtYWtlcjFBZGRyZXNzJyxcbiAgICAgICAgICAgICAgICAgICAgbWFrZXJVcmk6ICdodHRwOi8vbWFrZXIxLmNvbScsXG4gICAgICAgICAgICAgICAgICAgIG1ha2VyVG9rZW4sXG4gICAgICAgICAgICAgICAgICAgIHRha2VyVG9rZW4sXG4gICAgICAgICAgICAgICAgICAgIG1ha2VyQW1vdW50OiBhc3NldEZpbGxBbW91bnQsXG4gICAgICAgICAgICAgICAgICAgIHRha2VyQW1vdW50OiBtbTFUYWtlckFtb3VudCxcbiAgICAgICAgICAgICAgICAgICAgZXhwaXJ5OiBuZXcgQmlnTnVtYmVyKDE2NTI3MjI3NjcpLFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBtYWtlcjogJ21ha2VyMkFkZHJlc3MnLFxuICAgICAgICAgICAgICAgICAgICBtYWtlclVyaTogJ2h0dHA6Ly9tYWtlcjIuY29tJyxcbiAgICAgICAgICAgICAgICAgICAgbWFrZXJUb2tlbixcbiAgICAgICAgICAgICAgICAgICAgdGFrZXJUb2tlbixcbiAgICAgICAgICAgICAgICAgICAgbWFrZXJBbW91bnQ6IGFzc2V0RmlsbEFtb3VudCxcbiAgICAgICAgICAgICAgICAgICAgdGFrZXJBbW91bnQ6IG1tMlRha2VyQW1vdW50LFxuICAgICAgICAgICAgICAgICAgICBleHBpcnk6IG5ldyBCaWdOdW1iZXIoMTY1MjcyMjc2NyksXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIF07XG5cbiAgICAgICAgICAgIGNvbnN0IGZlZVNlcnZpY2U6IEZlZVNlcnZpY2UgPSBidWlsZEZlZVNlcnZpY2Uoe1xuICAgICAgICAgICAgICAgIGZlZU1vZGVsQ29uZmlndXJhdGlvbjoge1xuICAgICAgICAgICAgICAgICAgICBtYXJnaW5SYWtlUmF0aW8sXG4gICAgICAgICAgICAgICAgICAgIHRyYWRlU2l6ZUJwczogMCxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGdhc1ByaWNlLFxuICAgICAgICAgICAgICAgIHRyYWRlVG9rZW5QcmljZTogdGFrZXJUb2tlblByaWNlLFxuICAgICAgICAgICAgICAgIGZlZVRva2VuUHJpY2UsXG4gICAgICAgICAgICAgICAgYW1tUXVvdGUsXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgY29uc3QgcXVvdGVDb250ZXh0OiBRdW90ZUNvbnRleHQgPSB7XG4gICAgICAgICAgICAgICAgd29ya2Zsb3csXG4gICAgICAgICAgICAgICAgY2hhaW5JZDogMTMzNyxcbiAgICAgICAgICAgICAgICBmZWVNb2RlbFZlcnNpb24sXG4gICAgICAgICAgICAgICAgbWFrZXJUb2tlbixcbiAgICAgICAgICAgICAgICB0YWtlclRva2VuLFxuICAgICAgICAgICAgICAgIG9yaWdpbmFsTWFrZXJUb2tlbjogbWFrZXJUb2tlbixcbiAgICAgICAgICAgICAgICBtYWtlclRva2VuRGVjaW1hbHMsXG4gICAgICAgICAgICAgICAgdGFrZXJUb2tlbkRlY2ltYWxzLFxuICAgICAgICAgICAgICAgIGlzVW53cmFwLFxuICAgICAgICAgICAgICAgIGlzU2VsbGluZyxcbiAgICAgICAgICAgICAgICBhc3NldEZpbGxBbW91bnQsXG4gICAgICAgICAgICAgICAgbWFrZXJBbW91bnQ6IGFzc2V0RmlsbEFtb3VudCxcbiAgICAgICAgICAgICAgICBpc0Zpcm06IGZhbHNlLFxuICAgICAgICAgICAgICAgIHRha2VyQWRkcmVzcyxcbiAgICAgICAgICAgICAgICBpbnRlZ3JhdG9yLFxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgLy8gV2hlblxuICAgICAgICAgICAgamVzdC51c2VGYWtlVGltZXJzKCkuc2V0U3lzdGVtVGltZSgxNjUwMDAwMDAwMDAwKTtcbiAgICAgICAgICAgIGNvbnN0IHsgZmVlV2l0aERldGFpbHMsIHF1b3Rlc1dpdGhHYXNGZWUsIGFtbVF1b3RlVW5pcXVlSWQgfSA9IGF3YWl0IGZlZVNlcnZpY2UuY2FsY3VsYXRlRmVlQXN5bmMoXG4gICAgICAgICAgICAgICAgcXVvdGVDb250ZXh0LFxuICAgICAgICAgICAgICAgIGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShtbVF1b3Rlcyk7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgIC8vIFRoZW5cbiAgICAgICAgICAgIGNvbnN0IGV4cGVjdGVkR2FzRmVlQW1vdW50ID0gZ2FzUHJpY2UudGltZXMoZ2FzRXN0aW1hdGUpO1xuICAgICAgICAgICAgY29uc3QgZXhwZWN0ZWRNYXJnaW4gPSBhbW1UYWtlckFtb3VudFxuICAgICAgICAgICAgICAgIC50aW1lcyhuZXcgQmlnTnVtYmVyKDEpLm1pbnVzKGV4cGVjdGVkU2xpcHBhZ2UpKVxuICAgICAgICAgICAgICAgIC5taW51cyhtbTJUYWtlckFtb3VudClcbiAgICAgICAgICAgICAgICAudGltZXModGFrZXJUb2tlblByaWNlKVxuICAgICAgICAgICAgICAgIC5kaXYoZmVlVG9rZW5QcmljZSlcbiAgICAgICAgICAgICAgICAucGx1cyhlc3RpbWF0ZWRBbW1HYXNGZWVXZWkpXG4gICAgICAgICAgICAgICAgLmludGVnZXJWYWx1ZSgpO1xuICAgICAgICAgICAgY29uc3QgZXhwZWN0ZWRaZXJvRXhGZWVBbW91bnQgPSBleHBlY3RlZE1hcmdpbi50aW1lcyhtYXJnaW5SYWtlUmF0aW8pLmludGVnZXJWYWx1ZSgpO1xuICAgICAgICAgICAgY29uc3QgZXhwZWN0ZWRUb3RhbEZlZUFtb3VudCA9IGV4cGVjdGVkWmVyb0V4RmVlQW1vdW50LnBsdXMoZXhwZWN0ZWRHYXNGZWVBbW91bnQpO1xuXG4gICAgICAgICAgICBjb25zdCBleHBlY3RlZEZlZTogRmVlV2l0aERldGFpbHMgPSB7XG4gICAgICAgICAgICAgICAgdHlwZTogJ2ZpeGVkJyxcbiAgICAgICAgICAgICAgICB0b2tlbjogZmVlVG9rZW5BZGRyZXNzLFxuICAgICAgICAgICAgICAgIGFtb3VudDogZXhwZWN0ZWRUb3RhbEZlZUFtb3VudCxcbiAgICAgICAgICAgICAgICBkZXRhaWxzOiB7XG4gICAgICAgICAgICAgICAgICAgIGtpbmQ6ICdtYXJnaW4nLFxuICAgICAgICAgICAgICAgICAgICBmZWVNb2RlbFZlcnNpb24sXG4gICAgICAgICAgICAgICAgICAgIGdhc0ZlZUFtb3VudDogZXhwZWN0ZWRHYXNGZWVBbW91bnQsXG4gICAgICAgICAgICAgICAgICAgIGdhc1ByaWNlLFxuICAgICAgICAgICAgICAgICAgICB6ZXJvRXhGZWVBbW91bnQ6IGV4cGVjdGVkWmVyb0V4RmVlQW1vdW50LFxuICAgICAgICAgICAgICAgICAgICBtYXJnaW46IGV4cGVjdGVkTWFyZ2luLFxuICAgICAgICAgICAgICAgICAgICBtYXJnaW5SYWtlUmF0aW8sXG4gICAgICAgICAgICAgICAgICAgIGZlZVRva2VuQmFzZVVuaXRQcmljZVVzZDogZmVlVG9rZW5QcmljZSxcbiAgICAgICAgICAgICAgICAgICAgdGFrZXJUb2tlbkJhc2VVbml0UHJpY2VVc2Q6IHRha2VyVG9rZW5QcmljZSxcbiAgICAgICAgICAgICAgICAgICAgbWFrZXJUb2tlbkJhc2VVbml0UHJpY2VVc2Q6IG51bGwsXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBicmVha2Rvd246IHtcbiAgICAgICAgICAgICAgICAgICAgZ2FzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhbW91bnQ6IGV4cGVjdGVkR2FzRmVlQW1vdW50LFxuICAgICAgICAgICAgICAgICAgICAgICAgZGV0YWlsczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdhc1ByaWNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVzdGltYXRlZEdhczogbmV3IEJpZ051bWJlcihnYXNFc3RpbWF0ZSksXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB6ZXJvRXg6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFtb3VudDogZXhwZWN0ZWRaZXJvRXhGZWVBbW91bnQsXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXRhaWxzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAga2luZDogJ3ByaWNlX2ltcHJvdmVtZW50JyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmljZUltcHJvdmVtZW50OiBleHBlY3RlZE1hcmdpbixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByYWtlUmF0aW86IG1hcmdpblJha2VSYXRpbyxcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBjb252ZXJzaW9uUmF0ZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgbmF0aXZlVG9rZW5CYXNlVW5pdFByaWNlVXNkOiBmZWVUb2tlblByaWNlLFxuICAgICAgICAgICAgICAgICAgICBmZWVUb2tlbkJhc2VVbml0UHJpY2VVc2Q6IGZlZVRva2VuUHJpY2UsXG4gICAgICAgICAgICAgICAgICAgIHRha2VyVG9rZW5CYXNlVW5pdFByaWNlVXNkOiB0YWtlclRva2VuUHJpY2UsXG4gICAgICAgICAgICAgICAgICAgIG1ha2VyVG9rZW5CYXNlVW5pdFByaWNlVXNkOiBudWxsLFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgZXhwZWN0KGZlZVdpdGhEZXRhaWxzKS50b01hdGNoT2JqZWN0KGV4cGVjdGVkRmVlKTtcbiAgICAgICAgICAgIGV4cGVjdChxdW90ZXNXaXRoR2FzRmVlKS50b01hdGNoT2JqZWN0KG1tUXVvdGVzKTtcbiAgICAgICAgICAgIGV4cGVjdChhbW1RdW90ZVVuaXF1ZUlkKS50b0JlKGRlY29kZWRVbmlxdWVJZCk7XG5cbiAgICAgICAgICAgIC8vIFdoZW5cbiAgICAgICAgICAgIGNvbnN0IHJldmlzZWRRdW90ZXMgPSBhd2FpdCBmZWVTZXJ2aWNlLnJldmlzZVF1b3Rlc0FzeW5jKFxuICAgICAgICAgICAgICAgIC8vICRlc2xpbnQtZml4LW1lIGh0dHBzOi8vZ2l0aHViLmNvbS9yaGlub2RhdmlkL2VzbGludC1maXgtbWVcbiAgICAgICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLW5vbi1udWxsLWFzc2VydGlvblxuICAgICAgICAgICAgICAgIHF1b3Rlc1dpdGhHYXNGZWUhLFxuICAgICAgICAgICAgICAgIGV4cGVjdGVkWmVyb0V4RmVlQW1vdW50LFxuICAgICAgICAgICAgICAgIHF1b3RlQ29udGV4dCxcbiAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgIC8vIFRoZW5cbiAgICAgICAgICAgIGNvbnN0IGV4cGVjdGVkUmV2aXNlZFF1b3RlcyA9IG1tUXVvdGVzLm1hcCgocXVvdGUpID0+XG4gICAgICAgICAgICAgICAgcmV2aXNlUXVvdGVXaXRoRmVlcyhxdW90ZSwgZXhwZWN0ZWRaZXJvRXhGZWVBbW91bnQsIGlzU2VsbGluZywgdGFrZXJUb2tlblByaWNlLCBmZWVUb2tlblByaWNlKSxcbiAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgIGV4cGVjdChyZXZpc2VkUXVvdGVzKS50b01hdGNoT2JqZWN0KGV4cGVjdGVkUmV2aXNlZFF1b3Rlcyk7XG4gICAgICAgIH0pO1xuICAgICAgICBpdCgnc2hvdWxkIGNhbGN1bGF0ZSB2MiBgZGVmYXVsdGAgZmVlIGNvcnJlY3RseSBpZiB0b2tlbiBwcmljZSBxdWVyeSBzdWNjZWVkZWQgYnV0IDB4LWFwaSBxdWVyeSBmYWlsZWQnLCBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAvLyBHaXZlblxuICAgICAgICAgICAgY29uc3QgaXNTZWxsaW5nID0gdHJ1ZTtcbiAgICAgICAgICAgIGNvbnN0IGlzVW53cmFwID0gZmFsc2U7XG4gICAgICAgICAgICBjb25zdCBhc3NldEZpbGxBbW91bnQgPSBuZXcgQmlnTnVtYmVyKDFlMTgpO1xuICAgICAgICAgICAgY29uc3QgbWFyZ2luUmFrZVJhdGlvID0gMC41O1xuICAgICAgICAgICAgY29uc3QgdHJhZGVTaXplQnBzID0gNTtcblxuICAgICAgICAgICAgY29uc3QgYW1tUXVvdGUgPSBudWxsO1xuXG4gICAgICAgICAgICBjb25zdCBtbTFNYWtlckFtb3VudCA9IG5ldyBCaWdOdW1iZXIoMzU1MGU2KTtcbiAgICAgICAgICAgIGNvbnN0IG1tMk1ha2VyQW1vdW50ID0gbmV3IEJpZ051bWJlcigzNjAwZTYpO1xuICAgICAgICAgICAgY29uc3QgbW1RdW90ZXM6IEluZGljYXRpdmVRdW90ZVtdID0gW1xuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgbWFrZXI6ICdtYWtlcjFBZGRyZXNzJyxcbiAgICAgICAgICAgICAgICAgICAgbWFrZXJVcmk6ICdodHRwOi8vbWFrZXIxLmNvbScsXG4gICAgICAgICAgICAgICAgICAgIG1ha2VyVG9rZW4sXG4gICAgICAgICAgICAgICAgICAgIHRha2VyVG9rZW4sXG4gICAgICAgICAgICAgICAgICAgIG1ha2VyQW1vdW50OiBtbTFNYWtlckFtb3VudCxcbiAgICAgICAgICAgICAgICAgICAgdGFrZXJBbW91bnQ6IGFzc2V0RmlsbEFtb3VudCxcbiAgICAgICAgICAgICAgICAgICAgZXhwaXJ5OiBuZXcgQmlnTnVtYmVyKDE2NTI3MjI3NjcpLFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBtYWtlcjogJ21ha2VyMkFkZHJlc3MnLFxuICAgICAgICAgICAgICAgICAgICBtYWtlclVyaTogJ2h0dHA6Ly9tYWtlcjIuY29tJyxcbiAgICAgICAgICAgICAgICAgICAgbWFrZXJUb2tlbixcbiAgICAgICAgICAgICAgICAgICAgdGFrZXJUb2tlbixcbiAgICAgICAgICAgICAgICAgICAgbWFrZXJBbW91bnQ6IG1tMk1ha2VyQW1vdW50LFxuICAgICAgICAgICAgICAgICAgICB0YWtlckFtb3VudDogYXNzZXRGaWxsQW1vdW50LFxuICAgICAgICAgICAgICAgICAgICBleHBpcnk6IG5ldyBCaWdOdW1iZXIoMTY1MjcyMjc2NyksXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIF07XG5cbiAgICAgICAgICAgIGNvbnN0IGZlZVNlcnZpY2U6IEZlZVNlcnZpY2UgPSBidWlsZEZlZVNlcnZpY2Uoe1xuICAgICAgICAgICAgICAgIGZlZU1vZGVsQ29uZmlndXJhdGlvbjoge1xuICAgICAgICAgICAgICAgICAgICBtYXJnaW5SYWtlUmF0aW8sXG4gICAgICAgICAgICAgICAgICAgIHRyYWRlU2l6ZUJwcyxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGdhc1ByaWNlLFxuICAgICAgICAgICAgICAgIHRyYWRlVG9rZW5QcmljZTogbWFrZXJUb2tlblByaWNlLFxuICAgICAgICAgICAgICAgIGZlZVRva2VuUHJpY2UsXG4gICAgICAgICAgICAgICAgYW1tUXVvdGUsXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgY29uc3QgcXVvdGVDb250ZXh0OiBRdW90ZUNvbnRleHQgPSB7XG4gICAgICAgICAgICAgICAgd29ya2Zsb3csXG4gICAgICAgICAgICAgICAgY2hhaW5JZDogMTMzNyxcbiAgICAgICAgICAgICAgICBmZWVNb2RlbFZlcnNpb24sXG4gICAgICAgICAgICAgICAgdHhPcmlnaW4sXG4gICAgICAgICAgICAgICAgbWFrZXJUb2tlbixcbiAgICAgICAgICAgICAgICB0YWtlclRva2VuLFxuICAgICAgICAgICAgICAgIG9yaWdpbmFsTWFrZXJUb2tlbjogbWFrZXJUb2tlbixcbiAgICAgICAgICAgICAgICBtYWtlclRva2VuRGVjaW1hbHMsXG4gICAgICAgICAgICAgICAgdGFrZXJUb2tlbkRlY2ltYWxzLFxuICAgICAgICAgICAgICAgIGlzVW53cmFwLFxuICAgICAgICAgICAgICAgIGlzU2VsbGluZyxcbiAgICAgICAgICAgICAgICBhc3NldEZpbGxBbW91bnQsXG4gICAgICAgICAgICAgICAgdGFrZXJBbW91bnQ6IGFzc2V0RmlsbEFtb3VudCxcbiAgICAgICAgICAgICAgICBpc0Zpcm06IHRydWUsXG4gICAgICAgICAgICAgICAgdGFrZXJBZGRyZXNzLFxuICAgICAgICAgICAgICAgIHRyYWRlcjogdGFrZXJBZGRyZXNzLFxuICAgICAgICAgICAgICAgIGludGVncmF0b3IsXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAvLyBXaGVuXG4gICAgICAgICAgICBqZXN0LnVzZUZha2VUaW1lcnMoKS5zZXRTeXN0ZW1UaW1lKDE2NTAwMDAwMDAwMDApO1xuICAgICAgICAgICAgY29uc3QgeyBmZWVXaXRoRGV0YWlscywgcXVvdGVzV2l0aEdhc0ZlZSwgYW1tUXVvdGVVbmlxdWVJZCB9ID0gYXdhaXQgZmVlU2VydmljZS5jYWxjdWxhdGVGZWVBc3luYyhcbiAgICAgICAgICAgICAgICBxdW90ZUNvbnRleHQsXG4gICAgICAgICAgICAgICAgYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKG1tUXVvdGVzKTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgLy8gVGhlblxuICAgICAgICAgICAgY29uc3QgZXhwZWN0ZWRHYXNGZWVBbW91bnQgPSBnYXNQcmljZS50aW1lcyhnYXNFc3RpbWF0ZSk7XG4gICAgICAgICAgICBjb25zdCBleHBlY3RlZFplcm9FeEZlZUFtb3VudCA9IGNhbGN1bGF0ZURlZmF1bHRGZWVBbW91bnQoXG4gICAgICAgICAgICAgICAgbW0yTWFrZXJBbW91bnQsXG4gICAgICAgICAgICAgICAgdHJhZGVTaXplQnBzLFxuICAgICAgICAgICAgICAgIG1ha2VyVG9rZW5QcmljZSxcbiAgICAgICAgICAgICAgICBmZWVUb2tlblByaWNlLFxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIGNvbnN0IGV4cGVjdGVkVG90YWxGZWVBbW91bnQgPSBleHBlY3RlZFplcm9FeEZlZUFtb3VudC5wbHVzKGV4cGVjdGVkR2FzRmVlQW1vdW50KTtcblxuICAgICAgICAgICAgY29uc3QgZXhwZWN0ZWRGZWU6IEZlZVdpdGhEZXRhaWxzID0ge1xuICAgICAgICAgICAgICAgIHR5cGU6ICdmaXhlZCcsXG4gICAgICAgICAgICAgICAgdG9rZW46IGZlZVRva2VuQWRkcmVzcyxcbiAgICAgICAgICAgICAgICBhbW91bnQ6IGV4cGVjdGVkVG90YWxGZWVBbW91bnQsXG4gICAgICAgICAgICAgICAgZGV0YWlsczoge1xuICAgICAgICAgICAgICAgICAgICBraW5kOiAnZGVmYXVsdCcsXG4gICAgICAgICAgICAgICAgICAgIGZlZU1vZGVsVmVyc2lvbixcbiAgICAgICAgICAgICAgICAgICAgZ2FzRmVlQW1vdW50OiBleHBlY3RlZEdhc0ZlZUFtb3VudCxcbiAgICAgICAgICAgICAgICAgICAgZ2FzUHJpY2UsXG4gICAgICAgICAgICAgICAgICAgIHplcm9FeEZlZUFtb3VudDogZXhwZWN0ZWRaZXJvRXhGZWVBbW91bnQsXG4gICAgICAgICAgICAgICAgICAgIHRyYWRlU2l6ZUJwcyxcbiAgICAgICAgICAgICAgICAgICAgZmVlVG9rZW5CYXNlVW5pdFByaWNlVXNkOiBmZWVUb2tlblByaWNlLFxuICAgICAgICAgICAgICAgICAgICB0YWtlclRva2VuQmFzZVVuaXRQcmljZVVzZDogbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgbWFrZXJUb2tlbkJhc2VVbml0UHJpY2VVc2Q6IG1ha2VyVG9rZW5QcmljZSxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGJyZWFrZG93bjoge1xuICAgICAgICAgICAgICAgICAgICBnYXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFtb3VudDogZXhwZWN0ZWRHYXNGZWVBbW91bnQsXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXRhaWxzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2FzUHJpY2UsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXN0aW1hdGVkR2FzOiBuZXcgQmlnTnVtYmVyKGdhc0VzdGltYXRlKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHplcm9FeDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgYW1vdW50OiBleHBlY3RlZFplcm9FeEZlZUFtb3VudCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGRldGFpbHM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBraW5kOiAndm9sdW1lJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cmFkZVNpemVCcHMsXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgY29udmVyc2lvblJhdGVzOiB7XG4gICAgICAgICAgICAgICAgICAgIG5hdGl2ZVRva2VuQmFzZVVuaXRQcmljZVVzZDogZmVlVG9rZW5QcmljZSxcbiAgICAgICAgICAgICAgICAgICAgZmVlVG9rZW5CYXNlVW5pdFByaWNlVXNkOiBmZWVUb2tlblByaWNlLFxuICAgICAgICAgICAgICAgICAgICB0YWtlclRva2VuQmFzZVVuaXRQcmljZVVzZDogbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgbWFrZXJUb2tlbkJhc2VVbml0UHJpY2VVc2Q6IG1ha2VyVG9rZW5QcmljZSxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGV4cGVjdChmZWVXaXRoRGV0YWlscykudG9NYXRjaE9iamVjdChleHBlY3RlZEZlZSk7XG4gICAgICAgICAgICBleHBlY3QocXVvdGVzV2l0aEdhc0ZlZSkudG9NYXRjaE9iamVjdChtbVF1b3Rlcyk7XG4gICAgICAgICAgICBleHBlY3QoYW1tUXVvdGVVbmlxdWVJZCkudG9CZSh1bmRlZmluZWQpO1xuXG4gICAgICAgICAgICAvLyBXaGVuXG4gICAgICAgICAgICBjb25zdCByZXZpc2VkUXVvdGVzID0gYXdhaXQgZmVlU2VydmljZS5yZXZpc2VRdW90ZXNBc3luYyhcbiAgICAgICAgICAgICAgICAvLyAkZXNsaW50LWZpeC1tZSBodHRwczovL2dpdGh1Yi5jb20vcmhpbm9kYXZpZC9lc2xpbnQtZml4LW1lXG4gICAgICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1ub24tbnVsbC1hc3NlcnRpb25cbiAgICAgICAgICAgICAgICBxdW90ZXNXaXRoR2FzRmVlISxcbiAgICAgICAgICAgICAgICBleHBlY3RlZFplcm9FeEZlZUFtb3VudCxcbiAgICAgICAgICAgICAgICBxdW90ZUNvbnRleHQsXG4gICAgICAgICAgICApO1xuXG4gICAgICAgICAgICAvLyBUaGVuXG4gICAgICAgICAgICBjb25zdCBleHBlY3RlZFJldmlzZWRRdW90ZXMgPSBtbVF1b3Rlcy5tYXAoKHF1b3RlKSA9PlxuICAgICAgICAgICAgICAgIHJldmlzZVF1b3RlV2l0aEZlZXMocXVvdGUsIGV4cGVjdGVkWmVyb0V4RmVlQW1vdW50LCBpc1NlbGxpbmcsIG1ha2VyVG9rZW5QcmljZSwgZmVlVG9rZW5QcmljZSksXG4gICAgICAgICAgICApO1xuXG4gICAgICAgICAgICBleHBlY3QocmV2aXNlZFF1b3RlcykudG9NYXRjaE9iamVjdChleHBlY3RlZFJldmlzZWRRdW90ZXMpO1xuICAgICAgICB9KTtcbiAgICAgICAgaXQoJ3Nob3VsZCBjYWxjdWxhdGUgdjIgYGdhc09ubHlgIGZlZSBjb3JyZWN0bHkgaWYgdG9rZW4gcHJpY2UgcXVlcnkgZmFpbGVkJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgLy8gR2l2ZW5cbiAgICAgICAgICAgIGNvbnN0IGlzU2VsbGluZyA9IHRydWU7XG4gICAgICAgICAgICBjb25zdCBpc1Vud3JhcCA9IGZhbHNlO1xuICAgICAgICAgICAgY29uc3QgYXNzZXRGaWxsQW1vdW50ID0gbmV3IEJpZ051bWJlcigxZTE4KTtcbiAgICAgICAgICAgIGNvbnN0IG1hcmdpblJha2VSYXRpbyA9IDAuNTtcbiAgICAgICAgICAgIGNvbnN0IHRyYWRlU2l6ZUJwcyA9IDU7XG5cbiAgICAgICAgICAgIGNvbnN0IGFtbU1ha2VyQW1vdW50ID0gbmV3IEJpZ051bWJlcigzNDUwZTYpO1xuICAgICAgICAgICAgY29uc3QgZXhwZWN0ZWRTbGlwcGFnZSA9IG5ldyBCaWdOdW1iZXIoLTAuMDEpO1xuICAgICAgICAgICAgY29uc3QgZXN0aW1hdGVkQW1tR2FzRmVlV2VpID0gbmV3IEJpZ051bWJlcigxMDBlOSk7XG4gICAgICAgICAgICBjb25zdCBkZWNvZGVkVW5pcXVlSWQgPSAnMTIzNC01Njc4JztcbiAgICAgICAgICAgIGNvbnN0IGFtbVF1b3RlOiBBbW1RdW90ZSA9IHtcbiAgICAgICAgICAgICAgICBtYWtlckFtb3VudDogYW1tTWFrZXJBbW91bnQsXG4gICAgICAgICAgICAgICAgdGFrZXJBbW91bnQ6IGFzc2V0RmlsbEFtb3VudCxcbiAgICAgICAgICAgICAgICBleHBlY3RlZFNsaXBwYWdlLFxuICAgICAgICAgICAgICAgIGVzdGltYXRlZEdhc0ZlZVdlaTogZXN0aW1hdGVkQW1tR2FzRmVlV2VpLFxuICAgICAgICAgICAgICAgIGRlY29kZWRVbmlxdWVJZCxcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGNvbnN0IG1tMU1ha2VyQW1vdW50ID0gbmV3IEJpZ051bWJlcigzNTUwZTYpO1xuICAgICAgICAgICAgY29uc3QgbW0yTWFrZXJBbW91bnQgPSBuZXcgQmlnTnVtYmVyKDM2MDBlNik7XG4gICAgICAgICAgICBjb25zdCBtbVF1b3RlczogSW5kaWNhdGl2ZVF1b3RlW10gPSBbXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBtYWtlcjogJ21ha2VyMUFkZHJlc3MnLFxuICAgICAgICAgICAgICAgICAgICBtYWtlclVyaTogJ2h0dHA6Ly9tYWtlcjEuY29tJyxcbiAgICAgICAgICAgICAgICAgICAgbWFrZXJUb2tlbixcbiAgICAgICAgICAgICAgICAgICAgdGFrZXJUb2tlbixcbiAgICAgICAgICAgICAgICAgICAgbWFrZXJBbW91bnQ6IG1tMU1ha2VyQW1vdW50LFxuICAgICAgICAgICAgICAgICAgICB0YWtlckFtb3VudDogYXNzZXRGaWxsQW1vdW50LFxuICAgICAgICAgICAgICAgICAgICBleHBpcnk6IG5ldyBCaWdOdW1iZXIoMTY1MjcyMjc2NyksXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIG1ha2VyOiAnbWFrZXIyQWRkcmVzcycsXG4gICAgICAgICAgICAgICAgICAgIG1ha2VyVXJpOiAnaHR0cDovL21ha2VyMi5jb20nLFxuICAgICAgICAgICAgICAgICAgICBtYWtlclRva2VuLFxuICAgICAgICAgICAgICAgICAgICB0YWtlclRva2VuLFxuICAgICAgICAgICAgICAgICAgICBtYWtlckFtb3VudDogbW0yTWFrZXJBbW91bnQsXG4gICAgICAgICAgICAgICAgICAgIHRha2VyQW1vdW50OiBhc3NldEZpbGxBbW91bnQsXG4gICAgICAgICAgICAgICAgICAgIGV4cGlyeTogbmV3IEJpZ051bWJlcigxNjUyNzIyNzY3KSxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgXTtcblxuICAgICAgICAgICAgY29uc3QgZmVlU2VydmljZTogRmVlU2VydmljZSA9IGJ1aWxkRmVlU2VydmljZSh7XG4gICAgICAgICAgICAgICAgZmVlTW9kZWxDb25maWd1cmF0aW9uOiB7XG4gICAgICAgICAgICAgICAgICAgIG1hcmdpblJha2VSYXRpbyxcbiAgICAgICAgICAgICAgICAgICAgdHJhZGVTaXplQnBzLFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgZ2FzUHJpY2UsXG4gICAgICAgICAgICAgICAgdHJhZGVUb2tlblByaWNlOiBtYWtlclRva2VuUHJpY2UsXG4gICAgICAgICAgICAgICAgZmVlVG9rZW5QcmljZTogbnVsbCxcbiAgICAgICAgICAgICAgICBhbW1RdW90ZSxcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAvLyBXaGVuXG4gICAgICAgICAgICBqZXN0LnVzZUZha2VUaW1lcnMoKS5zZXRTeXN0ZW1UaW1lKDE2NTAwMDAwMDAwMDApO1xuICAgICAgICAgICAgY29uc3QgeyBmZWVXaXRoRGV0YWlscywgcXVvdGVzV2l0aEdhc0ZlZSwgYW1tUXVvdGVVbmlxdWVJZCB9ID0gYXdhaXQgZmVlU2VydmljZS5jYWxjdWxhdGVGZWVBc3luYyhcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIHdvcmtmbG93LFxuICAgICAgICAgICAgICAgICAgICBjaGFpbklkOiAxMzM3LFxuICAgICAgICAgICAgICAgICAgICBmZWVNb2RlbFZlcnNpb24sXG4gICAgICAgICAgICAgICAgICAgIHR4T3JpZ2luLFxuICAgICAgICAgICAgICAgICAgICBtYWtlclRva2VuLFxuICAgICAgICAgICAgICAgICAgICB0YWtlclRva2VuLFxuICAgICAgICAgICAgICAgICAgICBvcmlnaW5hbE1ha2VyVG9rZW46IG1ha2VyVG9rZW4sXG4gICAgICAgICAgICAgICAgICAgIG1ha2VyVG9rZW5EZWNpbWFscyxcbiAgICAgICAgICAgICAgICAgICAgdGFrZXJUb2tlbkRlY2ltYWxzLFxuICAgICAgICAgICAgICAgICAgICBpc1Vud3JhcCxcbiAgICAgICAgICAgICAgICAgICAgaXNTZWxsaW5nLFxuICAgICAgICAgICAgICAgICAgICBhc3NldEZpbGxBbW91bnQsXG4gICAgICAgICAgICAgICAgICAgIHRha2VyQW1vdW50OiBhc3NldEZpbGxBbW91bnQsXG4gICAgICAgICAgICAgICAgICAgIGlzRmlybTogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgdGFrZXJBZGRyZXNzLFxuICAgICAgICAgICAgICAgICAgICB0cmFkZXI6IHRha2VyQWRkcmVzcyxcbiAgICAgICAgICAgICAgICAgICAgaW50ZWdyYXRvcixcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShtbVF1b3Rlcyk7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgIC8vIFRoZW5cbiAgICAgICAgICAgIGNvbnN0IGV4cGVjdGVkR2FzRmVlQW1vdW50ID0gZ2FzUHJpY2UudGltZXMoZ2FzRXN0aW1hdGUpO1xuXG4gICAgICAgICAgICBjb25zdCBleHBlY3RlZEZlZTogRmVlV2l0aERldGFpbHMgPSB7XG4gICAgICAgICAgICAgICAgdHlwZTogJ2ZpeGVkJyxcbiAgICAgICAgICAgICAgICB0b2tlbjogZmVlVG9rZW5BZGRyZXNzLFxuICAgICAgICAgICAgICAgIGFtb3VudDogZXhwZWN0ZWRHYXNGZWVBbW91bnQsXG4gICAgICAgICAgICAgICAgZGV0YWlsczoge1xuICAgICAgICAgICAgICAgICAgICBraW5kOiAnZ2FzT25seScsXG4gICAgICAgICAgICAgICAgICAgIGZlZU1vZGVsVmVyc2lvbixcbiAgICAgICAgICAgICAgICAgICAgZ2FzRmVlQW1vdW50OiBleHBlY3RlZEdhc0ZlZUFtb3VudCxcbiAgICAgICAgICAgICAgICAgICAgZ2FzUHJpY2UsXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBicmVha2Rvd246IHtcbiAgICAgICAgICAgICAgICAgICAgZ2FzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhbW91bnQ6IGV4cGVjdGVkR2FzRmVlQW1vdW50LFxuICAgICAgICAgICAgICAgICAgICAgICAgZGV0YWlsczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdhc1ByaWNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVzdGltYXRlZEdhczogbmV3IEJpZ051bWJlcihnYXNFc3RpbWF0ZSksXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgY29udmVyc2lvblJhdGVzOiB7XG4gICAgICAgICAgICAgICAgICAgIG5hdGl2ZVRva2VuQmFzZVVuaXRQcmljZVVzZDogbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgZmVlVG9rZW5CYXNlVW5pdFByaWNlVXNkOiBudWxsLFxuICAgICAgICAgICAgICAgICAgICB0YWtlclRva2VuQmFzZVVuaXRQcmljZVVzZDogbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgbWFrZXJUb2tlbkJhc2VVbml0UHJpY2VVc2Q6IG51bGwsXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBleHBlY3QoZmVlV2l0aERldGFpbHMpLnRvTWF0Y2hPYmplY3QoZXhwZWN0ZWRGZWUpO1xuICAgICAgICAgICAgZXhwZWN0KHF1b3Rlc1dpdGhHYXNGZWUpLnRvTWF0Y2hPYmplY3QobW1RdW90ZXMpO1xuICAgICAgICAgICAgZXhwZWN0KGFtbVF1b3RlVW5pcXVlSWQpLnRvQmUoZGVjb2RlZFVuaXF1ZUlkKTtcbiAgICAgICAgfSk7XG4gICAgICAgIGl0KCdzaG91bGQgY2FsY3VsYXRlIHYyIGBwcmljZSBpbXByb3ZlbWVudGAgYmFzZWQgZmVlIHdpdGggemVybyB6ZXJvRXhGZWUgaWYgcHJpY2UgaW1wcm92ZW1lbnQgaXMgemVybycsIGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIC8vIEdpdmVuXG4gICAgICAgICAgICBjb25zdCBpc1NlbGxpbmcgPSB0cnVlO1xuICAgICAgICAgICAgY29uc3QgaXNVbndyYXAgPSBmYWxzZTtcbiAgICAgICAgICAgIGNvbnN0IGFzc2V0RmlsbEFtb3VudCA9IG5ldyBCaWdOdW1iZXIoMWUxOCk7XG4gICAgICAgICAgICBjb25zdCBtYXJnaW5SYWtlUmF0aW8gPSAwLjU7XG5cbiAgICAgICAgICAgIGNvbnN0IGFtbU1ha2VyQW1vdW50ID0gbmV3IEJpZ051bWJlcig0MDAwZTYpO1xuICAgICAgICAgICAgY29uc3QgZXhwZWN0ZWRTbGlwcGFnZSA9IG5ldyBCaWdOdW1iZXIoLTAuMDEpO1xuICAgICAgICAgICAgY29uc3QgZXN0aW1hdGVkQW1tR2FzRmVlV2VpID0gbmV3IEJpZ051bWJlcigxMDBlOSk7XG4gICAgICAgICAgICBjb25zdCBkZWNvZGVkVW5pcXVlSWQgPSAnMTIzNC01Njc4JztcbiAgICAgICAgICAgIGNvbnN0IGFtbVF1b3RlOiBBbW1RdW90ZSA9IHtcbiAgICAgICAgICAgICAgICBtYWtlckFtb3VudDogYW1tTWFrZXJBbW91bnQsXG4gICAgICAgICAgICAgICAgdGFrZXJBbW91bnQ6IGFzc2V0RmlsbEFtb3VudCxcbiAgICAgICAgICAgICAgICBleHBlY3RlZFNsaXBwYWdlLFxuICAgICAgICAgICAgICAgIGVzdGltYXRlZEdhc0ZlZVdlaTogZXN0aW1hdGVkQW1tR2FzRmVlV2VpLFxuICAgICAgICAgICAgICAgIGRlY29kZWRVbmlxdWVJZCxcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGNvbnN0IG1tMU1ha2VyQW1vdW50ID0gbmV3IEJpZ051bWJlcigzNTUwZTYpO1xuICAgICAgICAgICAgY29uc3QgbW0yTWFrZXJBbW91bnQgPSBuZXcgQmlnTnVtYmVyKDM2MDBlNik7XG4gICAgICAgICAgICBjb25zdCBtbVF1b3RlczogSW5kaWNhdGl2ZVF1b3RlW10gPSBbXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBtYWtlcjogJ21ha2VyMUFkZHJlc3MnLFxuICAgICAgICAgICAgICAgICAgICBtYWtlclVyaTogJ2h0dHA6Ly9tYWtlcjEuY29tJyxcbiAgICAgICAgICAgICAgICAgICAgbWFrZXJUb2tlbixcbiAgICAgICAgICAgICAgICAgICAgdGFrZXJUb2tlbixcbiAgICAgICAgICAgICAgICAgICAgbWFrZXJBbW91bnQ6IG1tMU1ha2VyQW1vdW50LFxuICAgICAgICAgICAgICAgICAgICB0YWtlckFtb3VudDogYXNzZXRGaWxsQW1vdW50LFxuICAgICAgICAgICAgICAgICAgICBleHBpcnk6IG5ldyBCaWdOdW1iZXIoMTY1MjcyMjc2NyksXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIG1ha2VyOiAnbWFrZXIyQWRkcmVzcycsXG4gICAgICAgICAgICAgICAgICAgIG1ha2VyVXJpOiAnaHR0cDovL21ha2VyMi5jb20nLFxuICAgICAgICAgICAgICAgICAgICBtYWtlclRva2VuLFxuICAgICAgICAgICAgICAgICAgICB0YWtlclRva2VuLFxuICAgICAgICAgICAgICAgICAgICBtYWtlckFtb3VudDogbW0yTWFrZXJBbW91bnQsXG4gICAgICAgICAgICAgICAgICAgIHRha2VyQW1vdW50OiBhc3NldEZpbGxBbW91bnQsXG4gICAgICAgICAgICAgICAgICAgIGV4cGlyeTogbmV3IEJpZ051bWJlcigxNjUyNzIyNzY3KSxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgXTtcblxuICAgICAgICAgICAgY29uc3QgZmVlU2VydmljZTogRmVlU2VydmljZSA9IGJ1aWxkRmVlU2VydmljZSh7XG4gICAgICAgICAgICAgICAgZmVlTW9kZWxDb25maWd1cmF0aW9uOiB7XG4gICAgICAgICAgICAgICAgICAgIG1hcmdpblJha2VSYXRpbyxcbiAgICAgICAgICAgICAgICAgICAgdHJhZGVTaXplQnBzOiAwLFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgZ2FzUHJpY2UsXG4gICAgICAgICAgICAgICAgdHJhZGVUb2tlblByaWNlOiBtYWtlclRva2VuUHJpY2UsXG4gICAgICAgICAgICAgICAgZmVlVG9rZW5QcmljZSxcbiAgICAgICAgICAgICAgICBhbW1RdW90ZSxcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAvLyBXaGVuXG4gICAgICAgICAgICBqZXN0LnVzZUZha2VUaW1lcnMoKS5zZXRTeXN0ZW1UaW1lKDE2NTAwMDAwMDAwMDApO1xuICAgICAgICAgICAgY29uc3QgeyBmZWVXaXRoRGV0YWlscywgcXVvdGVzV2l0aEdhc0ZlZSwgYW1tUXVvdGVVbmlxdWVJZCB9ID0gYXdhaXQgZmVlU2VydmljZS5jYWxjdWxhdGVGZWVBc3luYyhcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIHdvcmtmbG93LFxuICAgICAgICAgICAgICAgICAgICBjaGFpbklkOiAxMzM3LFxuICAgICAgICAgICAgICAgICAgICBmZWVNb2RlbFZlcnNpb24sXG4gICAgICAgICAgICAgICAgICAgIHR4T3JpZ2luLFxuICAgICAgICAgICAgICAgICAgICBtYWtlclRva2VuLFxuICAgICAgICAgICAgICAgICAgICB0YWtlclRva2VuLFxuICAgICAgICAgICAgICAgICAgICBvcmlnaW5hbE1ha2VyVG9rZW46IG1ha2VyVG9rZW4sXG4gICAgICAgICAgICAgICAgICAgIG1ha2VyVG9rZW5EZWNpbWFscyxcbiAgICAgICAgICAgICAgICAgICAgdGFrZXJUb2tlbkRlY2ltYWxzLFxuICAgICAgICAgICAgICAgICAgICBpc1Vud3JhcCxcbiAgICAgICAgICAgICAgICAgICAgaXNTZWxsaW5nLFxuICAgICAgICAgICAgICAgICAgICBhc3NldEZpbGxBbW91bnQsXG4gICAgICAgICAgICAgICAgICAgIHRha2VyQW1vdW50OiBhc3NldEZpbGxBbW91bnQsXG4gICAgICAgICAgICAgICAgICAgIGlzRmlybTogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgdGFrZXJBZGRyZXNzLFxuICAgICAgICAgICAgICAgICAgICB0cmFkZXI6IHRha2VyQWRkcmVzcyxcbiAgICAgICAgICAgICAgICAgICAgaW50ZWdyYXRvcixcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShtbVF1b3Rlcyk7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgIC8vIFRoZW5cbiAgICAgICAgICAgIGNvbnN0IGV4cGVjdGVkR2FzRmVlQW1vdW50ID0gZ2FzUHJpY2UudGltZXMoZ2FzRXN0aW1hdGUpO1xuXG4gICAgICAgICAgICBjb25zdCBleHBlY3RlZEZlZTogRmVlV2l0aERldGFpbHMgPSB7XG4gICAgICAgICAgICAgICAgdHlwZTogJ2ZpeGVkJyxcbiAgICAgICAgICAgICAgICB0b2tlbjogZmVlVG9rZW5BZGRyZXNzLFxuICAgICAgICAgICAgICAgIGFtb3VudDogZXhwZWN0ZWRHYXNGZWVBbW91bnQsXG4gICAgICAgICAgICAgICAgZGV0YWlsczoge1xuICAgICAgICAgICAgICAgICAgICBraW5kOiAnbWFyZ2luJyxcbiAgICAgICAgICAgICAgICAgICAgZmVlTW9kZWxWZXJzaW9uLFxuICAgICAgICAgICAgICAgICAgICBnYXNGZWVBbW91bnQ6IGV4cGVjdGVkR2FzRmVlQW1vdW50LFxuICAgICAgICAgICAgICAgICAgICBnYXNQcmljZSxcbiAgICAgICAgICAgICAgICAgICAgemVyb0V4RmVlQW1vdW50OiBaRVJPLFxuICAgICAgICAgICAgICAgICAgICBtYXJnaW46IFpFUk8sXG4gICAgICAgICAgICAgICAgICAgIG1hcmdpblJha2VSYXRpbyxcbiAgICAgICAgICAgICAgICAgICAgZmVlVG9rZW5CYXNlVW5pdFByaWNlVXNkOiBmZWVUb2tlblByaWNlLFxuICAgICAgICAgICAgICAgICAgICB0YWtlclRva2VuQmFzZVVuaXRQcmljZVVzZDogbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgbWFrZXJUb2tlbkJhc2VVbml0UHJpY2VVc2Q6IG1ha2VyVG9rZW5QcmljZSxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGJyZWFrZG93bjoge1xuICAgICAgICAgICAgICAgICAgICBnYXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFtb3VudDogZXhwZWN0ZWRHYXNGZWVBbW91bnQsXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXRhaWxzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2FzUHJpY2UsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXN0aW1hdGVkR2FzOiBuZXcgQmlnTnVtYmVyKGdhc0VzdGltYXRlKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHplcm9FeDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgYW1vdW50OiBaRVJPLFxuICAgICAgICAgICAgICAgICAgICAgICAgZGV0YWlsczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGtpbmQ6ICdwcmljZV9pbXByb3ZlbWVudCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJpY2VJbXByb3ZlbWVudDogWkVSTyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByYWtlUmF0aW86IG1hcmdpblJha2VSYXRpbyxcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBjb252ZXJzaW9uUmF0ZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgbmF0aXZlVG9rZW5CYXNlVW5pdFByaWNlVXNkOiBmZWVUb2tlblByaWNlLFxuICAgICAgICAgICAgICAgICAgICBmZWVUb2tlbkJhc2VVbml0UHJpY2VVc2Q6IGZlZVRva2VuUHJpY2UsXG4gICAgICAgICAgICAgICAgICAgIHRha2VyVG9rZW5CYXNlVW5pdFByaWNlVXNkOiBudWxsLFxuICAgICAgICAgICAgICAgICAgICBtYWtlclRva2VuQmFzZVVuaXRQcmljZVVzZDogbWFrZXJUb2tlblByaWNlLFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgZXhwZWN0KGZlZVdpdGhEZXRhaWxzKS50b01hdGNoT2JqZWN0KGV4cGVjdGVkRmVlKTtcbiAgICAgICAgICAgIGV4cGVjdChxdW90ZXNXaXRoR2FzRmVlKS50b01hdGNoT2JqZWN0KG1tUXVvdGVzKTtcbiAgICAgICAgICAgIGV4cGVjdChhbW1RdW90ZVVuaXF1ZUlkKS50b0JlKGRlY29kZWRVbmlxdWVJZCk7XG4gICAgICAgIH0pO1xuICAgICAgICBpdCgnc2hvdWxkIHRocm93IGlmIGNhbGxlZCBmcm9tIFJGUXQgd29ya2Zsb3cnLCBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAvLyBHaXZlblxuICAgICAgICAgICAgY29uc3QgaXNTZWxsaW5nID0gdHJ1ZTtcbiAgICAgICAgICAgIGNvbnN0IGlzVW53cmFwID0gZmFsc2U7XG4gICAgICAgICAgICBjb25zdCBhc3NldEZpbGxBbW91bnQgPSBuZXcgQmlnTnVtYmVyKDFlMTgpO1xuICAgICAgICAgICAgY29uc3QgbWFyZ2luUmFrZVJhdGlvID0gMC41O1xuXG4gICAgICAgICAgICBjb25zdCBhbW1NYWtlckFtb3VudCA9IG5ldyBCaWdOdW1iZXIoMzQ1MGU2KTtcbiAgICAgICAgICAgIGNvbnN0IGV4cGVjdGVkU2xpcHBhZ2UgPSBuZXcgQmlnTnVtYmVyKC0wLjAxKTtcbiAgICAgICAgICAgIGNvbnN0IGVzdGltYXRlZEFtbUdhc0ZlZVdlaSA9IG5ldyBCaWdOdW1iZXIoMTAwZTkpO1xuICAgICAgICAgICAgY29uc3QgZGVjb2RlZFVuaXF1ZUlkID0gJzEyMzQtNTY3OCc7XG4gICAgICAgICAgICBjb25zdCBhbW1RdW90ZTogQW1tUXVvdGUgPSB7XG4gICAgICAgICAgICAgICAgbWFrZXJBbW91bnQ6IGFtbU1ha2VyQW1vdW50LFxuICAgICAgICAgICAgICAgIHRha2VyQW1vdW50OiBhc3NldEZpbGxBbW91bnQsXG4gICAgICAgICAgICAgICAgZXhwZWN0ZWRTbGlwcGFnZSxcbiAgICAgICAgICAgICAgICBlc3RpbWF0ZWRHYXNGZWVXZWk6IGVzdGltYXRlZEFtbUdhc0ZlZVdlaSxcbiAgICAgICAgICAgICAgICBkZWNvZGVkVW5pcXVlSWQsXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBjb25zdCBmZWVTZXJ2aWNlOiBGZWVTZXJ2aWNlID0gYnVpbGRGZWVTZXJ2aWNlKHtcbiAgICAgICAgICAgICAgICBmZWVNb2RlbENvbmZpZ3VyYXRpb246IHtcbiAgICAgICAgICAgICAgICAgICAgbWFyZ2luUmFrZVJhdGlvLFxuICAgICAgICAgICAgICAgICAgICB0cmFkZVNpemVCcHM6IDAsXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBnYXNQcmljZSxcbiAgICAgICAgICAgICAgICB0cmFkZVRva2VuUHJpY2U6IG1ha2VyVG9rZW5QcmljZSxcbiAgICAgICAgICAgICAgICBmZWVUb2tlblByaWNlLFxuICAgICAgICAgICAgICAgIGFtbVF1b3RlLFxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGNvbnN0IHF1b3RlQ29udGV4dDogUXVvdGVDb250ZXh0ID0ge1xuICAgICAgICAgICAgICAgIHdvcmtmbG93OiAncmZxdCcsXG4gICAgICAgICAgICAgICAgY2hhaW5JZDogMTMzNyxcbiAgICAgICAgICAgICAgICBpc0Zpcm06IHRydWUsXG4gICAgICAgICAgICAgICAgZmVlTW9kZWxWZXJzaW9uLFxuICAgICAgICAgICAgICAgIHR4T3JpZ2luLFxuICAgICAgICAgICAgICAgIG1ha2VyVG9rZW4sXG4gICAgICAgICAgICAgICAgdGFrZXJUb2tlbixcbiAgICAgICAgICAgICAgICBvcmlnaW5hbE1ha2VyVG9rZW46IG1ha2VyVG9rZW4sXG4gICAgICAgICAgICAgICAgbWFrZXJUb2tlbkRlY2ltYWxzLFxuICAgICAgICAgICAgICAgIHRha2VyVG9rZW5EZWNpbWFscyxcbiAgICAgICAgICAgICAgICBpc1Vud3JhcCxcbiAgICAgICAgICAgICAgICBpc1NlbGxpbmcsXG4gICAgICAgICAgICAgICAgYXNzZXRGaWxsQW1vdW50LFxuICAgICAgICAgICAgICAgIHRha2VyQW1vdW50OiBhc3NldEZpbGxBbW91bnQsXG4gICAgICAgICAgICAgICAgdGFrZXJBZGRyZXNzLFxuICAgICAgICAgICAgICAgIHRyYWRlcjogdGFrZXJBZGRyZXNzLFxuICAgICAgICAgICAgICAgIGludGVncmF0b3IsXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAvLyBXaGVuXG4gICAgICAgICAgICBhd2FpdCBleHBlY3QoKCkgPT4gZmVlU2VydmljZS5jYWxjdWxhdGVGZWVBc3luYyhxdW90ZUNvbnRleHQpKS5yZWplY3RzLnRvVGhyb3coJ05vdCBpbXBsZW1lbnRlZCcpO1xuICAgICAgICB9KTtcbiAgICB9KTtcblxuICAgIGRlc2NyaWJlKCdwdXJlIGZ1bmN0aW9uIGNhbGN1bGF0ZURlZmF1bHRGZWVBbW91bnQoKScsICgpID0+IHtcbiAgICAgICAgaXQoJ3Nob3VsZCBjYWxjdWxhdGUgZGVmYXVsdCBmZWUgYW1vdW50IGNvcnJlY3RseScsIGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIC8vIEdpdmVuXG4gICAgICAgICAgICBjb25zdCB0cmFkZVRva2VuQW1vdW50ID0gbmV3IEJpZ051bWJlcigxZTE4KTtcbiAgICAgICAgICAgIGNvbnN0IGZlZVJhdGVCcHMgPSA1O1xuICAgICAgICAgICAgY29uc3QgdHJhZGVUb2tlbkJhc2VVbml0UHJpY2VVc2QgPSBuZXcgQmlnTnVtYmVyKDZlLTE0KTtcbiAgICAgICAgICAgIGNvbnN0IGZlZVRva2VuQmFzZVVuaXRQcmljZVVzZCA9IG5ldyBCaWdOdW1iZXIoM2UtMTUpO1xuXG4gICAgICAgICAgICAvLyBXaGVuXG4gICAgICAgICAgICBjb25zdCBkZWZhdWx0RmVlQW1vdW50ID0gY2FsY3VsYXRlRGVmYXVsdEZlZUFtb3VudChcbiAgICAgICAgICAgICAgICB0cmFkZVRva2VuQW1vdW50LFxuICAgICAgICAgICAgICAgIGZlZVJhdGVCcHMsXG4gICAgICAgICAgICAgICAgdHJhZGVUb2tlbkJhc2VVbml0UHJpY2VVc2QsXG4gICAgICAgICAgICAgICAgZmVlVG9rZW5CYXNlVW5pdFByaWNlVXNkLFxuICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgLy8gVGhlblxuICAgICAgICAgICAgY29uc3QgZXhwZWN0ZWREZWZhdWx0RmVlQW1vdW50ID0gbmV3IEJpZ051bWJlcigxZTE2KTtcbiAgICAgICAgICAgIGV4cGVjdChkZWZhdWx0RmVlQW1vdW50KS50b01hdGNoT2JqZWN0KGV4cGVjdGVkRGVmYXVsdEZlZUFtb3VudCk7XG4gICAgICAgIH0pO1xuICAgICAgICBpdCgnc2hvdWxkIHJldHVybiB6ZXJvIGlmIGJwcyBpcyB6ZXJvJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgLy8gR2l2ZW5cbiAgICAgICAgICAgIGNvbnN0IHRyYWRlVG9rZW5BbW91bnQgPSBuZXcgQmlnTnVtYmVyKDFlMTgpO1xuICAgICAgICAgICAgY29uc3QgZmVlUmF0ZUJwcyA9IDA7XG4gICAgICAgICAgICBjb25zdCB0cmFkZVRva2VuQmFzZVVuaXRQcmljZVVzZCA9IG5ldyBCaWdOdW1iZXIoNmUtMTQpO1xuICAgICAgICAgICAgY29uc3QgZmVlVG9rZW5CYXNlVW5pdFByaWNlVXNkID0gbmV3IEJpZ051bWJlcigzZS0xNSk7XG5cbiAgICAgICAgICAgIC8vIFdoZW5cbiAgICAgICAgICAgIGNvbnN0IGRlZmF1bHRGZWVBbW91bnQgPSBjYWxjdWxhdGVEZWZhdWx0RmVlQW1vdW50KFxuICAgICAgICAgICAgICAgIHRyYWRlVG9rZW5BbW91bnQsXG4gICAgICAgICAgICAgICAgZmVlUmF0ZUJwcyxcbiAgICAgICAgICAgICAgICB0cmFkZVRva2VuQmFzZVVuaXRQcmljZVVzZCxcbiAgICAgICAgICAgICAgICBmZWVUb2tlbkJhc2VVbml0UHJpY2VVc2QsXG4gICAgICAgICAgICApO1xuXG4gICAgICAgICAgICAvLyBUaGVuXG4gICAgICAgICAgICBleHBlY3QoZGVmYXVsdEZlZUFtb3VudCkudG9NYXRjaE9iamVjdChaRVJPKTtcbiAgICAgICAgfSk7XG4gICAgICAgIGl0KCdzaG91bGQgcmV0dXJuIHplcm8gaWYgZWl0aGVyIHRyYWRlIHRva2VuIHByaWNlIG9yIGZlZSB0b2tlbiBwcmljZSBpcyBudWxsJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgLy8gR2l2ZW5cbiAgICAgICAgICAgIGNvbnN0IHRyYWRlVG9rZW5BbW91bnQgPSBuZXcgQmlnTnVtYmVyKDFlMTgpO1xuICAgICAgICAgICAgY29uc3QgZmVlUmF0ZUJwcyA9IDU7XG4gICAgICAgICAgICBjb25zdCB0cmFkZVRva2VuQmFzZVVuaXRQcmljZVVzZCA9IG5ldyBCaWdOdW1iZXIoNmUtMTQpO1xuICAgICAgICAgICAgY29uc3QgZmVlVG9rZW5CYXNlVW5pdFByaWNlVXNkID0gbmV3IEJpZ051bWJlcigzZS0xNSk7XG5cbiAgICAgICAgICAgIC8vIFdoZW5cbiAgICAgICAgICAgIGNvbnN0IGRlZmF1bHRGZWVBbW91bnQxID0gY2FsY3VsYXRlRGVmYXVsdEZlZUFtb3VudChcbiAgICAgICAgICAgICAgICB0cmFkZVRva2VuQW1vdW50LFxuICAgICAgICAgICAgICAgIGZlZVJhdGVCcHMsXG4gICAgICAgICAgICAgICAgbnVsbCxcbiAgICAgICAgICAgICAgICBmZWVUb2tlbkJhc2VVbml0UHJpY2VVc2QsXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgY29uc3QgZGVmYXVsdEZlZUFtb3VudDIgPSBjYWxjdWxhdGVEZWZhdWx0RmVlQW1vdW50KFxuICAgICAgICAgICAgICAgIHRyYWRlVG9rZW5BbW91bnQsXG4gICAgICAgICAgICAgICAgZmVlUmF0ZUJwcyxcbiAgICAgICAgICAgICAgICB0cmFkZVRva2VuQmFzZVVuaXRQcmljZVVzZCxcbiAgICAgICAgICAgICAgICBudWxsLFxuICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgLy8gVGhlblxuICAgICAgICAgICAgZXhwZWN0KGRlZmF1bHRGZWVBbW91bnQxKS50b01hdGNoT2JqZWN0KFpFUk8pO1xuICAgICAgICAgICAgZXhwZWN0KGRlZmF1bHRGZWVBbW91bnQyKS50b01hdGNoT2JqZWN0KFpFUk8pO1xuICAgICAgICB9KTtcbiAgICB9KTtcbiAgICBkZXNjcmliZSgncHVyZSBmdW5jdGlvbiBjYWxjdWxhdGVQcmljZUltcHJvdmVtZW50QW1vdW50KCknLCAoKSA9PiB7XG4gICAgICAgIGl0KCdzaG91bGQgY2FsY3VsYXRlIHByaWNlIGltcHJvdmVtZW50IGFtb3VudCBmb3Igc2VsbGluZyBjb3JyZWN0bHknLCBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAvLyBHaXZlblxuICAgICAgICAgICAgY29uc3QgaXNTZWxsaW5nID0gdHJ1ZTtcbiAgICAgICAgICAgIGNvbnN0IGFzc2V0RmlsbEFtb3VudCA9IG5ldyBCaWdOdW1iZXIoM2UxNyk7XG4gICAgICAgICAgICBjb25zdCBtYWtlclF1b3RlV2l0aEdhc0ZlZTogSW5kaWNhdGl2ZVF1b3RlID0ge1xuICAgICAgICAgICAgICAgIG1ha2VyOiAnbWFrZXIxQWRkcmVzcycsXG4gICAgICAgICAgICAgICAgbWFrZXJVcmk6ICdodHRwOi8vbWFrZXIxLmNvbScsXG4gICAgICAgICAgICAgICAgbWFrZXJUb2tlbixcbiAgICAgICAgICAgICAgICB0YWtlclRva2VuLFxuICAgICAgICAgICAgICAgIG1ha2VyQW1vdW50OiBuZXcgQmlnTnVtYmVyKDExMDBlNiksXG4gICAgICAgICAgICAgICAgdGFrZXJBbW91bnQ6IGFzc2V0RmlsbEFtb3VudCxcbiAgICAgICAgICAgICAgICBleHBpcnk6IG5ldyBCaWdOdW1iZXIoMTY1MjcyMjc2NyksXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBjb25zdCBhbW1RdW90ZTogQW1tUXVvdGUgPSB7XG4gICAgICAgICAgICAgICAgbWFrZXJBbW91bnQ6IG5ldyBCaWdOdW1iZXIoMTAwMGU2KSxcbiAgICAgICAgICAgICAgICB0YWtlckFtb3VudDogYXNzZXRGaWxsQW1vdW50LFxuICAgICAgICAgICAgICAgIGV4cGVjdGVkU2xpcHBhZ2U6IG5ldyBCaWdOdW1iZXIoLTAuMDIpLFxuICAgICAgICAgICAgICAgIGVzdGltYXRlZEdhc0ZlZVdlaTogbmV3IEJpZ051bWJlcigxMGUxNSksXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBjb25zdCBxdW90ZVRva2VuQmFzZVVuaXRQcmljZVVzZCA9IG5ldyBCaWdOdW1iZXIoMWUtNik7XG4gICAgICAgICAgICBjb25zdCBmZWVUb2tlbkJhc2VVbml0UHJpY2VVc2QgPSBuZXcgQmlnTnVtYmVyKDNlLTE1KTtcblxuICAgICAgICAgICAgLy8gV2hlblxuICAgICAgICAgICAgY29uc3QgcHJpY2VJbXByb3ZlbWVudEFtb3VudCA9IGNhbGN1bGF0ZVByaWNlSW1wcm92ZW1lbnRBbW91bnQoXG4gICAgICAgICAgICAgICAgbWFrZXJRdW90ZVdpdGhHYXNGZWUsXG4gICAgICAgICAgICAgICAgYW1tUXVvdGUsXG4gICAgICAgICAgICAgICAgaXNTZWxsaW5nLFxuICAgICAgICAgICAgICAgIHF1b3RlVG9rZW5CYXNlVW5pdFByaWNlVXNkLFxuICAgICAgICAgICAgICAgIGZlZVRva2VuQmFzZVVuaXRQcmljZVVzZCxcbiAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgIC8vIFRoZW5cbiAgICAgICAgICAgIGNvbnN0IGV4cGVjdGVkUHJpY2VJbXByb3ZlbWVudEFtb3VudCA9IG5ldyBCaWdOdW1iZXIoNTBlMTUpO1xuICAgICAgICAgICAgZXhwZWN0KHByaWNlSW1wcm92ZW1lbnRBbW91bnQpLnRvTWF0Y2hPYmplY3QoZXhwZWN0ZWRQcmljZUltcHJvdmVtZW50QW1vdW50KTtcbiAgICAgICAgfSk7XG4gICAgICAgIGl0KCdzaG91bGQgY2FsY3VsYXRlIHByaWNlIGltcHJvdmVtZW50IGFtb3VudCBmb3IgYnV5aW5nIGNvcnJlY3RseScsIGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIC8vIEdpdmVuXG4gICAgICAgICAgICBjb25zdCBpc1NlbGxpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgIGNvbnN0IGFzc2V0RmlsbEFtb3VudCA9IG5ldyBCaWdOdW1iZXIoM2UxNyk7XG4gICAgICAgICAgICBjb25zdCBtYWtlclF1b3RlV2l0aEdhc0ZlZTogSW5kaWNhdGl2ZVF1b3RlID0ge1xuICAgICAgICAgICAgICAgIG1ha2VyOiAnbWFrZXIxQWRkcmVzcycsXG4gICAgICAgICAgICAgICAgbWFrZXJVcmk6ICdodHRwOi8vbWFrZXIxLmNvbScsXG4gICAgICAgICAgICAgICAgbWFrZXJUb2tlbixcbiAgICAgICAgICAgICAgICB0YWtlclRva2VuLFxuICAgICAgICAgICAgICAgIG1ha2VyQW1vdW50OiBhc3NldEZpbGxBbW91bnQsXG4gICAgICAgICAgICAgICAgdGFrZXJBbW91bnQ6IG5ldyBCaWdOdW1iZXIoOTAwZTYpLFxuICAgICAgICAgICAgICAgIGV4cGlyeTogbmV3IEJpZ051bWJlcigxNjUyNzIyNzY3KSxcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGNvbnN0IGFtbVF1b3RlOiBBbW1RdW90ZSA9IHtcbiAgICAgICAgICAgICAgICBtYWtlckFtb3VudDogYXNzZXRGaWxsQW1vdW50LFxuICAgICAgICAgICAgICAgIHRha2VyQW1vdW50OiBuZXcgQmlnTnVtYmVyKDEwMDBlNiksXG4gICAgICAgICAgICAgICAgZXhwZWN0ZWRTbGlwcGFnZTogbmV3IEJpZ051bWJlcigtMC4wMiksXG4gICAgICAgICAgICAgICAgZXN0aW1hdGVkR2FzRmVlV2VpOiBuZXcgQmlnTnVtYmVyKDEwZTE1KSxcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGNvbnN0IHF1b3RlVG9rZW5CYXNlVW5pdFByaWNlVXNkID0gbmV3IEJpZ051bWJlcigxZS02KTtcbiAgICAgICAgICAgIGNvbnN0IGZlZVRva2VuQmFzZVVuaXRQcmljZVVzZCA9IG5ldyBCaWdOdW1iZXIoM2UtMTUpO1xuXG4gICAgICAgICAgICAvLyBXaGVuXG4gICAgICAgICAgICBjb25zdCBwcmljZUltcHJvdmVtZW50QW1vdW50ID0gY2FsY3VsYXRlUHJpY2VJbXByb3ZlbWVudEFtb3VudChcbiAgICAgICAgICAgICAgICBtYWtlclF1b3RlV2l0aEdhc0ZlZSxcbiAgICAgICAgICAgICAgICBhbW1RdW90ZSxcbiAgICAgICAgICAgICAgICBpc1NlbGxpbmcsXG4gICAgICAgICAgICAgICAgcXVvdGVUb2tlbkJhc2VVbml0UHJpY2VVc2QsXG4gICAgICAgICAgICAgICAgZmVlVG9rZW5CYXNlVW5pdFByaWNlVXNkLFxuICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgLy8gVGhlblxuICAgICAgICAgICAgY29uc3QgZXhwZWN0ZWRQcmljZUltcHJvdmVtZW50QW1vdW50ID0gbmV3IEJpZ051bWJlcig1MGUxNSk7XG4gICAgICAgICAgICBleHBlY3QocHJpY2VJbXByb3ZlbWVudEFtb3VudCkudG9NYXRjaE9iamVjdChleHBlY3RlZFByaWNlSW1wcm92ZW1lbnRBbW91bnQpO1xuICAgICAgICB9KTtcbiAgICAgICAgaXQoJ3Nob3VsZCByZXR1cm4gemVybyBpZiB0aGVyZSBpcyBubyBwcmljZSBpbXByb3ZlbWVudCcsIGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIC8vIEdpdmVuXG4gICAgICAgICAgICBjb25zdCBpc1NlbGxpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgIGNvbnN0IGFzc2V0RmlsbEFtb3VudCA9IG5ldyBCaWdOdW1iZXIoM2UxNyk7XG4gICAgICAgICAgICBjb25zdCBtYWtlclF1b3RlV2l0aEdhc0ZlZTogSW5kaWNhdGl2ZVF1b3RlID0ge1xuICAgICAgICAgICAgICAgIG1ha2VyOiAnbWFrZXIxQWRkcmVzcycsXG4gICAgICAgICAgICAgICAgbWFrZXJVcmk6ICdodHRwOi8vbWFrZXIxLmNvbScsXG4gICAgICAgICAgICAgICAgbWFrZXJUb2tlbixcbiAgICAgICAgICAgICAgICB0YWtlclRva2VuLFxuICAgICAgICAgICAgICAgIG1ha2VyQW1vdW50OiBhc3NldEZpbGxBbW91bnQsXG4gICAgICAgICAgICAgICAgdGFrZXJBbW91bnQ6IG5ldyBCaWdOdW1iZXIoMTA1MWU2KSxcbiAgICAgICAgICAgICAgICBleHBpcnk6IG5ldyBCaWdOdW1iZXIoMTY1MjcyMjc2NyksXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBjb25zdCBhbW1RdW90ZTogQW1tUXVvdGUgPSB7XG4gICAgICAgICAgICAgICAgbWFrZXJBbW91bnQ6IGFzc2V0RmlsbEFtb3VudCxcbiAgICAgICAgICAgICAgICB0YWtlckFtb3VudDogbmV3IEJpZ051bWJlcigxMDAwZTYpLFxuICAgICAgICAgICAgICAgIGV4cGVjdGVkU2xpcHBhZ2U6IG5ldyBCaWdOdW1iZXIoLTAuMDIpLFxuICAgICAgICAgICAgICAgIGVzdGltYXRlZEdhc0ZlZVdlaTogbmV3IEJpZ051bWJlcigxMGUxNSksXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBjb25zdCBxdW90ZVRva2VuQmFzZVVuaXRQcmljZVVzZCA9IG5ldyBCaWdOdW1iZXIoMWUtNik7XG4gICAgICAgICAgICBjb25zdCBmZWVUb2tlbkJhc2VVbml0UHJpY2VVc2QgPSBuZXcgQmlnTnVtYmVyKDNlLTE1KTtcblxuICAgICAgICAgICAgLy8gV2hlblxuICAgICAgICAgICAgY29uc3QgcHJpY2VJbXByb3ZlbWVudEFtb3VudCA9IGNhbGN1bGF0ZVByaWNlSW1wcm92ZW1lbnRBbW91bnQoXG4gICAgICAgICAgICAgICAgbWFrZXJRdW90ZVdpdGhHYXNGZWUsXG4gICAgICAgICAgICAgICAgYW1tUXVvdGUsXG4gICAgICAgICAgICAgICAgaXNTZWxsaW5nLFxuICAgICAgICAgICAgICAgIHF1b3RlVG9rZW5CYXNlVW5pdFByaWNlVXNkLFxuICAgICAgICAgICAgICAgIGZlZVRva2VuQmFzZVVuaXRQcmljZVVzZCxcbiAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgIC8vIFRoZW5cbiAgICAgICAgICAgIGV4cGVjdChwcmljZUltcHJvdmVtZW50QW1vdW50KS50b01hdGNoT2JqZWN0KFpFUk8pO1xuICAgICAgICB9KTtcbiAgICB9KTtcbiAgICBkZXNjcmliZSgncHVyZSBmdW5jdGlvbiByZXZpc2VRdW90ZVdpdGhaZXJvRXhGZWUoKScsICgpID0+IHtcbiAgICAgICAgaXQoJ3Nob3VsZCByZXZpc2UgcXVvdGUgY29ycmVjdGx5IGZvciBzZWxsaW5nJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgLy8gR2l2ZW5cbiAgICAgICAgICAgIGNvbnN0IGlzU2VsbGluZyA9IHRydWU7XG4gICAgICAgICAgICBjb25zdCBhc3NldEZpbGxBbW91bnQgPSBuZXcgQmlnTnVtYmVyKDNlMTcpO1xuICAgICAgICAgICAgY29uc3QgbWFrZXJRdW90ZVdpdGhHYXNGZWU6IEluZGljYXRpdmVRdW90ZSA9IHtcbiAgICAgICAgICAgICAgICBtYWtlcjogJ21ha2VyMUFkZHJlc3MnLFxuICAgICAgICAgICAgICAgIG1ha2VyVXJpOiAnaHR0cDovL21ha2VyMS5jb20nLFxuICAgICAgICAgICAgICAgIG1ha2VyVG9rZW4sXG4gICAgICAgICAgICAgICAgdGFrZXJUb2tlbixcbiAgICAgICAgICAgICAgICBtYWtlckFtb3VudDogbmV3IEJpZ051bWJlcigxMDAwZTYpLFxuICAgICAgICAgICAgICAgIHRha2VyQW1vdW50OiBhc3NldEZpbGxBbW91bnQsXG4gICAgICAgICAgICAgICAgZXhwaXJ5OiBuZXcgQmlnTnVtYmVyKDE2NTI3MjI3NjcpLFxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgY29uc3QgemVyb0V4RmVlQW1vdW50ID0gbmV3IEJpZ051bWJlcigxMGUxNSk7XG5cbiAgICAgICAgICAgIGNvbnN0IHF1b3RlVG9rZW5CYXNlVW5pdFByaWNlVXNkID0gbmV3IEJpZ051bWJlcigxZS02KTtcbiAgICAgICAgICAgIGNvbnN0IGZlZVRva2VuQmFzZVVuaXRQcmljZVVzZCA9IG5ldyBCaWdOdW1iZXIoM2UtMTUpO1xuXG4gICAgICAgICAgICAvLyBXaGVuXG4gICAgICAgICAgICBjb25zdCByZXZpc2VkUXVvdGUgPSByZXZpc2VRdW90ZVdpdGhGZWVzKFxuICAgICAgICAgICAgICAgIG1ha2VyUXVvdGVXaXRoR2FzRmVlLFxuICAgICAgICAgICAgICAgIHplcm9FeEZlZUFtb3VudCxcbiAgICAgICAgICAgICAgICBpc1NlbGxpbmcsXG4gICAgICAgICAgICAgICAgcXVvdGVUb2tlbkJhc2VVbml0UHJpY2VVc2QsXG4gICAgICAgICAgICAgICAgZmVlVG9rZW5CYXNlVW5pdFByaWNlVXNkLFxuICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgLy8gVGhlblxuICAgICAgICAgICAgY29uc3QgZXhwZWN0ZWRSZXZpc2VkTWFrZXJBbW91bnQgPSBuZXcgQmlnTnVtYmVyKDk3MGU2KTtcbiAgICAgICAgICAgIGV4cGVjdChyZXZpc2VkUXVvdGUubWFrZXJBbW91bnQpLnRvTWF0Y2hPYmplY3QoZXhwZWN0ZWRSZXZpc2VkTWFrZXJBbW91bnQpO1xuICAgICAgICB9KTtcbiAgICAgICAgaXQoJ3Nob3VsZCByZXZpc2UgcXVvdGUgY29ycmVjdGx5IGZvciBidXlpbmcnLCBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAvLyBHaXZlblxuICAgICAgICAgICAgY29uc3QgaXNTZWxsaW5nID0gZmFsc2U7XG4gICAgICAgICAgICBjb25zdCBhc3NldEZpbGxBbW91bnQgPSBuZXcgQmlnTnVtYmVyKDNlMTcpO1xuICAgICAgICAgICAgY29uc3QgbWFrZXJRdW90ZVdpdGhHYXNGZWU6IEluZGljYXRpdmVRdW90ZSA9IHtcbiAgICAgICAgICAgICAgICBtYWtlcjogJ21ha2VyMUFkZHJlc3MnLFxuICAgICAgICAgICAgICAgIG1ha2VyVXJpOiAnaHR0cDovL21ha2VyMS5jb20nLFxuICAgICAgICAgICAgICAgIG1ha2VyVG9rZW4sXG4gICAgICAgICAgICAgICAgdGFrZXJUb2tlbixcbiAgICAgICAgICAgICAgICBtYWtlckFtb3VudDogYXNzZXRGaWxsQW1vdW50LFxuICAgICAgICAgICAgICAgIHRha2VyQW1vdW50OiBuZXcgQmlnTnVtYmVyKDEwMDBlNiksXG4gICAgICAgICAgICAgICAgZXhwaXJ5OiBuZXcgQmlnTnVtYmVyKDE2NTI3MjI3NjcpLFxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgY29uc3QgemVyb0V4RmVlQW1vdW50ID0gbmV3IEJpZ051bWJlcigxMGUxNSk7XG5cbiAgICAgICAgICAgIGNvbnN0IHF1b3RlVG9rZW5CYXNlVW5pdFByaWNlVXNkID0gbmV3IEJpZ051bWJlcigxZS02KTtcbiAgICAgICAgICAgIGNvbnN0IGZlZVRva2VuQmFzZVVuaXRQcmljZVVzZCA9IG5ldyBCaWdOdW1iZXIoM2UtMTUpO1xuXG4gICAgICAgICAgICAvLyBXaGVuXG4gICAgICAgICAgICBjb25zdCByZXZpc2VkUXVvdGUgPSByZXZpc2VRdW90ZVdpdGhGZWVzKFxuICAgICAgICAgICAgICAgIG1ha2VyUXVvdGVXaXRoR2FzRmVlLFxuICAgICAgICAgICAgICAgIHplcm9FeEZlZUFtb3VudCxcbiAgICAgICAgICAgICAgICBpc1NlbGxpbmcsXG4gICAgICAgICAgICAgICAgcXVvdGVUb2tlbkJhc2VVbml0UHJpY2VVc2QsXG4gICAgICAgICAgICAgICAgZmVlVG9rZW5CYXNlVW5pdFByaWNlVXNkLFxuICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgLy8gVGhlblxuICAgICAgICAgICAgY29uc3QgZXhwZWN0ZWRSZXZpc2VkVGFrZXJBbW91bnQgPSBuZXcgQmlnTnVtYmVyKDEwMzBlNik7XG4gICAgICAgICAgICBleHBlY3QocmV2aXNlZFF1b3RlLnRha2VyQW1vdW50KS50b01hdGNoT2JqZWN0KGV4cGVjdGVkUmV2aXNlZFRha2VyQW1vdW50KTtcbiAgICAgICAgfSk7XG4gICAgICAgIGl0KCdzaG91bGQgbm90IHJldmlzZSBxdW90ZSBjb3JyZWN0bHkgZm9yIHplcm8gemVyb0V4RmVlJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgLy8gR2l2ZW5cbiAgICAgICAgICAgIGNvbnN0IGlzU2VsbGluZyA9IHRydWU7XG4gICAgICAgICAgICBjb25zdCBhc3NldEZpbGxBbW91bnQgPSBuZXcgQmlnTnVtYmVyKDNlMTcpO1xuICAgICAgICAgICAgY29uc3QgbWFrZXJRdW90ZVdpdGhHYXNGZWU6IEluZGljYXRpdmVRdW90ZSA9IHtcbiAgICAgICAgICAgICAgICBtYWtlcjogJ21ha2VyMUFkZHJlc3MnLFxuICAgICAgICAgICAgICAgIG1ha2VyVXJpOiAnaHR0cDovL21ha2VyMS5jb20nLFxuICAgICAgICAgICAgICAgIG1ha2VyVG9rZW4sXG4gICAgICAgICAgICAgICAgdGFrZXJUb2tlbixcbiAgICAgICAgICAgICAgICBtYWtlckFtb3VudDogbmV3IEJpZ051bWJlcigxMDAwZTYpLFxuICAgICAgICAgICAgICAgIHRha2VyQW1vdW50OiBhc3NldEZpbGxBbW91bnQsXG4gICAgICAgICAgICAgICAgZXhwaXJ5OiBuZXcgQmlnTnVtYmVyKDE2NTI3MjI3NjcpLFxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgY29uc3QgemVyb0V4RmVlQW1vdW50ID0gWkVSTztcblxuICAgICAgICAgICAgY29uc3QgcXVvdGVUb2tlbkJhc2VVbml0UHJpY2VVc2QgPSBuZXcgQmlnTnVtYmVyKDFlLTYpO1xuICAgICAgICAgICAgY29uc3QgZmVlVG9rZW5CYXNlVW5pdFByaWNlVXNkID0gbmV3IEJpZ051bWJlcigzZS0xNSk7XG5cbiAgICAgICAgICAgIC8vIFdoZW5cbiAgICAgICAgICAgIGNvbnN0IHJldmlzZWRRdW90ZSA9IHJldmlzZVF1b3RlV2l0aEZlZXMoXG4gICAgICAgICAgICAgICAgbWFrZXJRdW90ZVdpdGhHYXNGZWUsXG4gICAgICAgICAgICAgICAgemVyb0V4RmVlQW1vdW50LFxuICAgICAgICAgICAgICAgIGlzU2VsbGluZyxcbiAgICAgICAgICAgICAgICBxdW90ZVRva2VuQmFzZVVuaXRQcmljZVVzZCxcbiAgICAgICAgICAgICAgICBmZWVUb2tlbkJhc2VVbml0UHJpY2VVc2QsXG4gICAgICAgICAgICApO1xuXG4gICAgICAgICAgICAvLyBUaGVuXG4gICAgICAgICAgICBjb25zdCBleHBlY3RlZFJldmlzZWRNYWtlckFtb3VudCA9IG5ldyBCaWdOdW1iZXIoMTAwMGU2KTtcbiAgICAgICAgICAgIGV4cGVjdChyZXZpc2VkUXVvdGUubWFrZXJBbW91bnQpLnRvTWF0Y2hPYmplY3QoZXhwZWN0ZWRSZXZpc2VkTWFrZXJBbW91bnQpO1xuICAgICAgICAgICAgZXhwZWN0KHJldmlzZWRRdW90ZS50YWtlckFtb3VudCkudG9NYXRjaE9iamVjdChhc3NldEZpbGxBbW91bnQpO1xuICAgICAgICB9KTtcbiAgICB9KTtcbn0pO1xuIl0sInZlcnNpb24iOjN9