a50b22e62b0bab55ceb09cf1e88b9413
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.ENABLE_PROMETHEUS_METRICS = exports.META_TXN_RELAY_EXPECTED_MINED_SEC = exports.RFQ_SIGN_ENDPOINT_TIMEOUT_MS = exports.RFQ_PRICE_ENDPOINT_TIMEOUT_MS = exports.RFQM_MAINTENANCE_MODE = exports.RFQM_WORKER_GROUP_SIZE = exports.RFQM_WORKER_GROUP_INDEX = exports.META_TX_WORKER_MNEMONIC = exports.RFQ_API_KEY_HASH_TO_MAKER_ID = exports.RFQM_MAKER_ID_SET_FOR_OTC_ORDER = exports.RFQT_MAKER_ID_SET_FOR_OTC_ORDER = exports.RFQT_MAKER_ID_SET_FOR_RFQ_ORDER = exports.RFQM_MAKER_ID_SET = exports.TAKER_SPECIFIED_SIDE_ENABLED = exports.REASON_ON_STATUS_ERROR_RESPONSE_ENABLED = exports.ADMIN_API_KEY = exports.RFQM_API_KEY_WHITELIST = exports.ALT_RFQ_MM_PROFILE = exports.ALT_RFQ_MM_API_KEY = exports.ALT_RFQ_MM_ENDPOINT = exports.LOGGER_INCLUDE_TIMESTAMP = exports.BACKGROUND_JOB_TYPES = exports.REDIS_BACKGROUND_JOB_URI = exports.REDIS_URI = exports.SENTRY_TRACES_SAMPLE_RATE = exports.TOKEN_PRICE_ORACLE_TIMEOUT = exports.ZERO_EX_API_KEY = exports.DEFINED_FI_ENDPOINT = exports.DEFINED_FI_API_KEY = exports.SENTRY_DSN = exports.SENTRY_ENVIRONMENT = exports.POSTGRES_READ_REPLICA_URIS = exports.POSTGRES_URI = exports.FEE_RECIPIENT_ADDRESS = exports.KAFKA_BROKERS = exports.CHAIN_ID = exports.HTTP_HEADERS_TIMEOUT = exports.HTTP_KEEP_ALIVE_TIMEOUT = exports.HEALTHCHECK_HTTP_PORT = exports.HTTP_PORT = exports.LOG_LEVEL = exports.RFQ_MAKER_CONFIGS = exports.getMakerIdSetForOrderType = exports.RFQ_MAKER_REFRESH_INTERVAL_MS = exports.getIntegratorIdFromLabel = exports.getApiKeyWhitelistFromIntegratorsAcl = exports.INTEGRATORS_ACL = exports.DEFAULT_FEE_MODEL_CONFIGURATION = exports.FEE_MODEL_CONFIGURATION_MAP = exports.CHAIN_CONFIGURATIONS = void 0;
exports.META_TRANSACTION_SERVICE_RPC_URL = exports.getIntegratorIdForApiKey = exports.getIntegratorByIdOrThrow = exports.defaultHttpServiceConfig = exports.LLR_COOLDOWN_DURATION_SECONDS = exports.ENABLE_LLR_COOLDOWN = exports.RFQ_PROXY_PORT = exports.RFQ_PROXY_ADDRESS = exports.ETH_GAS_STATION_API_URL = exports.PROMETHEUS_PORT = void 0;
const assert_1 = require("@0x/assert");
const contract_addresses_1 = require("@0x/contract-addresses");
const utils_1 = require("@0x/utils");
const fs = require("fs");
const _ = require("lodash");
const validateUUID = require("uuid-validate");
const constants_1 = require("./core/constants");
const schemas_1 = require("./core/schemas");
const pair_utils_1 = require("./core/pair_utils");
const schema_utils_1 = require("./core/schema_utils");
// tslint:disable:no-bitwise
var EnvVarType;
(function (EnvVarType) {
    EnvVarType[EnvVarType["AddressList"] = 0] = "AddressList";
    EnvVarType[EnvVarType["StringList"] = 1] = "StringList";
    EnvVarType[EnvVarType["Integer"] = 2] = "Integer";
    EnvVarType[EnvVarType["Port"] = 3] = "Port";
    EnvVarType[EnvVarType["KeepAliveTimeout"] = 4] = "KeepAliveTimeout";
    EnvVarType[EnvVarType["ChainId"] = 5] = "ChainId";
    EnvVarType[EnvVarType["ETHAddressHex"] = 6] = "ETHAddressHex";
    EnvVarType[EnvVarType["UnitAmount"] = 7] = "UnitAmount";
    EnvVarType[EnvVarType["Rate"] = 8] = "Rate";
    EnvVarType[EnvVarType["Url"] = 9] = "Url";
    EnvVarType[EnvVarType["UrlList"] = 10] = "UrlList";
    EnvVarType[EnvVarType["WhitelistAllTokens"] = 11] = "WhitelistAllTokens";
    EnvVarType[EnvVarType["Boolean"] = 12] = "Boolean";
    EnvVarType[EnvVarType["NonEmptyString"] = 13] = "NonEmptyString";
    EnvVarType[EnvVarType["APIKeys"] = 14] = "APIKeys";
    EnvVarType[EnvVarType["PrivateKeys"] = 15] = "PrivateKeys";
    EnvVarType[EnvVarType["RfqMakerAssetOfferings"] = 16] = "RfqMakerAssetOfferings";
    EnvVarType[EnvVarType["LiquidityProviderRegistry"] = 17] = "LiquidityProviderRegistry";
    EnvVarType[EnvVarType["JsonStringList"] = 18] = "JsonStringList";
})(EnvVarType || (EnvVarType = {}));
/**
 * Configuration which contains information about chains and
 * related resources, like the RPC url.
 */
exports.CHAIN_CONFIGURATIONS = (() => {
    let result;
    try {
        result = resolveEnvVar('CHAIN_CONFIGURATIONS', EnvVarType.JsonStringList, []);
        schema_utils_1.schemaUtils.validateSchema(result, schemas_1.schemas.chainConfigurationsSchema);
    }
    catch (e) {
        throw new Error(`CHAIN_CONFIGURATIONS was defined but is not valid JSON per the schema: ${e}`);
    }
    return result;
})();
/**
 * A nested map providing fee model constants for each token pair.
 * Use chainId as first key and pair key as the second key.
 */
exports.FEE_MODEL_CONFIGURATION_MAP = (() => {
    try {
        const feeModelConfigurations = resolveEnvVar('FEE_MODEL_CONFIGURATIONS', EnvVarType.JsonStringList, []);
        schema_utils_1.schemaUtils.validateSchema(feeModelConfigurations, schemas_1.schemas.feeModelConfigurationsSchema);
        return feeModelConfigurations.reduce((acc, curr) => {
            const { chainId, tokenA, tokenB, marginRakeRatio, tradeSizeBps } = curr;
            if (!acc.has(chainId)) {
                acc.set(chainId, new Map());
            }
            // $eslint-fix-me https://github.com/rhinodavid/eslint-fix-me
            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion
            acc.get(chainId).set((0, pair_utils_1.toPairString)(tokenA, tokenB), { marginRakeRatio, tradeSizeBps });
            return acc;
        }, new Map());
    }
    catch (e) {
        throw new Error(`FEE_MODEL_CONFIGURATIONS was defined but is not valid JSON per the schema: ${e}`);
    }
})();
exports.DEFAULT_FEE_MODEL_CONFIGURATION = { marginRakeRatio: 0, tradeSizeBps: 0 };
/**
 * Configuration which represents taker-integrators of the 0x API. The configuration contains the label, id,
 * api keys, and allowed liquidity sources for each integrator.
 */
exports.INTEGRATORS_ACL = (() => {
    let integrators;
    try {
        integrators = resolveEnvVar('INTEGRATORS_ACL', EnvVarType.JsonStringList, []);
        schema_utils_1.schemaUtils.validateSchema(integrators, schemas_1.schemas.integratorsAclSchema);
    }
    catch (e) {
        throw new Error(`INTEGRATORS_ACL was defined but is not valid JSON per the schema: ${e}`);
    }
    return integrators;
})();
/**
 * Extracts the integrator API keys from the `INTEGRATORS_ACL` environment variable for the provided group type.
 */
const getApiKeyWhitelistFromIntegratorsAcl = (groupType) => {
    return exports.INTEGRATORS_ACL.filter((i) => i[groupType])
        .flatMap((i) => i.apiKeys)
        .sort();
};
exports.getApiKeyWhitelistFromIntegratorsAcl = getApiKeyWhitelistFromIntegratorsAcl;
/**
 * Gets the integrator ID for the provided label.
 */
const getIntegratorIdFromLabel = (label) => {
    for (const integrator of exports.INTEGRATORS_ACL) {
        if (integrator.label === label) {
            return integrator.integratorId;
        }
    }
};
exports.getIntegratorIdFromLabel = getIntegratorIdFromLabel;
exports.RFQ_MAKER_REFRESH_INTERVAL_MS = constants_1.ONE_MINUTE_MS * 1;
/**
 * Generate a set of MakerIds that support a given order type for a given workflow
 */
const getMakerIdSetForOrderType = (orderType, workflow) => {
    const typesField = workflow === 'rfqt' ? 'rfqtOrderTypes' : 'rfqmOrderTypes';
    return exports.RFQ_MAKER_CONFIGS.reduce((acc, curr) => {
        if (orderType === 'any' || curr[typesField].includes(orderType)) {
            acc.add(curr.makerId);
        }
        return acc;
    }, new Set());
};
exports.getMakerIdSetForOrderType = getMakerIdSetForOrderType;
/**
 * A list of type RfqMakerConfig, read from the RFQ_MAKER_CONFIGS env variable
 */
exports.RFQ_MAKER_CONFIGS = (() => {
    try {
        const makerConfigs = resolveEnvVar('RFQ_MAKER_CONFIGS', EnvVarType.JsonStringList, []);
        schema_utils_1.schemaUtils.validateSchema(makerConfigs, schemas_1.schemas.rfqMakerConfigListSchema);
        return makerConfigs;
    }
    catch (e) {
        throw new Error(`RFQ_MAKER_CONFIGS was defined but is not valid JSON per the schema: ${e}`);
    }
})();
// Log level for pino.js
exports.LOG_LEVEL = _.isEmpty(process.env.LOG_LEVEL)
    ? 'info'
    : assertEnvVarType('LOG_LEVEL', process.env.LOG_LEVEL, EnvVarType.NonEmptyString);
// Network port to listen on
exports.HTTP_PORT = _.isEmpty(process.env.HTTP_PORT)
    ? 3000
    : assertEnvVarType('HTTP_PORT', process.env.HTTP_PORT, EnvVarType.Port);
// Network port for the healthcheck service at /healthz, if not provided, it uses the HTTP_PORT value.
exports.HEALTHCHECK_HTTP_PORT = _.isEmpty(process.env.HEALTHCHECK_HTTP_PORT)
    ? exports.HTTP_PORT
    : assertEnvVarType('HEALTHCHECK_HTTP_PORT', process.env.HEALTHCHECK_HTTP_PORT, EnvVarType.Port);
// Number of milliseconds of inactivity the servers waits for additional
// incoming data aftere it finished writing last response before a socket will
// be destroyed.
// Ref: https://nodejs.org/api/http.html#http_server_keepalivetimeout
exports.HTTP_KEEP_ALIVE_TIMEOUT = _.isEmpty(process.env.HTTP_KEEP_ALIVE_TIMEOUT)
    ? 76 * 1000
    : assertEnvVarType('HTTP_KEEP_ALIVE_TIMEOUT', process.env.HTTP_KEEP_ALIVE_TIMEOUT, EnvVarType.KeepAliveTimeout);
// Limit the amount of time the parser will wait to receive the complete HTTP headers.
// NOTE: This value HAS to be higher than HTTP_KEEP_ALIVE_TIMEOUT.
// Ref: https://nodejs.org/api/http.html#http_server_headerstimeout
exports.HTTP_HEADERS_TIMEOUT = _.isEmpty(process.env.HTTP_HEADERS_TIMEOUT)
    ? 77 * 1000
    : assertEnvVarType('HTTP_HEADERS_TIMEOUT', process.env.HTTP_HEADERS_TIMEOUT, EnvVarType.KeepAliveTimeout);
// Default chain id to use when not specified
exports.CHAIN_ID = _.isEmpty(process.env.CHAIN_ID)
    ? contract_addresses_1.ChainId.Kovan
    : assertEnvVarType('CHAIN_ID', process.env.CHAIN_ID, EnvVarType.ChainId);
exports.KAFKA_BROKERS = _.isEmpty(process.env.KAFKA_BROKERS)
    ? undefined
    : assertEnvVarType('KAFKA_BROKERS', process.env.KAFKA_BROKERS, EnvVarType.StringList);
// The fee recipient for orders
exports.FEE_RECIPIENT_ADDRESS = _.isEmpty(process.env.FEE_RECIPIENT_ADDRESS)
    ? constants_1.NULL_ADDRESS
    : assertEnvVarType('FEE_RECIPIENT_ADDRESS', process.env.FEE_RECIPIENT_ADDRESS, EnvVarType.ETHAddressHex);
exports.POSTGRES_URI = _.isEmpty(process.env.POSTGRES_URI)
    ? constants_1.DEFAULT_LOCAL_POSTGRES_URI
    : assertEnvVarType('POSTGRES_URI', process.env.POSTGRES_URI, EnvVarType.Url);
exports.POSTGRES_READ_REPLICA_URIS = _.isEmpty(process.env.POSTGRES_READ_REPLICA_URIS)
    ? undefined
    : assertEnvVarType('POSTGRES_READ_REPLICA_URIS', process.env.POSTGRES_READ_REPLICA_URIS, EnvVarType.UrlList);
// Environment name Sentry used to categorize issues and traces.
exports.SENTRY_ENVIRONMENT = _.isEmpty(process.env.SENTRY_ENVIRONMENT)
    ? constants_1.DEFAULT_SENTRY_ENVIRONMENT
    : assertEnvVarType('SENTRY_ENVIRONMENT', process.env.SENTRY_ENVIRONMENT, EnvVarType.NonEmptyString);
// An Url with client key to access Sentry from client SDK.
exports.SENTRY_DSN = _.isEmpty(process.env.SENTRY_DSN)
    ? undefined
    : assertEnvVarType('SENTRY_DSN', process.env.SENTRY_DSN, EnvVarType.Url);
// API Key for Defined.fi's token price API
exports.DEFINED_FI_API_KEY = _.isEmpty(process.env.DEFINED_FI_API_KEY)
    ? ''
    : assertEnvVarType('DEFINED_FI_API_KEY', process.env.DEFINED_FI_API_KEY, EnvVarType.NonEmptyString);
// Endpoint for Defined.fi's token price API, default to https://api.defined.fi
exports.DEFINED_FI_ENDPOINT = _.isEmpty(process.env.DEFINED_FI_ENDPOINT)
    ? 'https://api.defined.fi'
    : assertEnvVarType('DEFINED_FI_ENDPOINT', process.env.DEFINED_FI_ENDPOINT, EnvVarType.NonEmptyString);
// API Key for 0x API (for ZeroExApiClient)
exports.ZERO_EX_API_KEY = _.isEmpty(process.env.ZERO_EX_API_KEY)
    ? ''
    : assertEnvVarType('ZERO_EX_API_KEY', process.env.ZERO_EX_API_KEY, EnvVarType.NonEmptyString);
// $eslint-fix-me https://github.com/rhinodavid/eslint-fix-me
// eslint-disable-next-line @typescript-eslint/no-inferrable-types
exports.TOKEN_PRICE_ORACLE_TIMEOUT = 1000;
// Sampling rate of traces reported to Sentry. Should be a number between 0.0 and 1.0 (inclusive).
exports.SENTRY_TRACES_SAMPLE_RATE = _.isEmpty(process.env.SENTRY_TRACES_SAMPLE_RATE)
    ? 0
    : assertEnvVarType('SENTRY_TRACES_SAMPLE_RATE', process.env.SENTRY_TRACES_SAMPLE_RATE, EnvVarType.Rate);
exports.REDIS_URI = _.isEmpty(process.env.REDIS_URI) ? constants_1.DEFAULT_LOCAL_REDIS_URI : process.env.REDIS_URI;
exports.REDIS_BACKGROUND_JOB_URI = _.isEmpty(process.env.REDIS_BACKGROUND_JOB_URI)
    ? constants_1.DEFAULT_LOCAL_REDIS_URI
    : process.env.REDIS_BACKGROUND_JOB_URI;
exports.BACKGROUND_JOB_TYPES = _.isEmpty(process.env.BACKGROUND_JOB_TYPES)
    ? constants_1.DEFAULT_BACKGROUND_JOB_TYPES
    : process.env.BACKGROUND_JOB_TYPES;
// Should the logger include time field in the output logs, defaults to true.
exports.LOGGER_INCLUDE_TIMESTAMP = _.isEmpty(process.env.LOGGER_INCLUDE_TIMESTAMP)
    ? constants_1.DEFAULT_LOGGER_INCLUDE_TIMESTAMP
    : assertEnvVarType('LOGGER_INCLUDE_TIMESTAMP', process.env.LOGGER_INCLUDE_TIMESTAMP, EnvVarType.Boolean);
exports.ALT_RFQ_MM_ENDPOINT = _.isEmpty(process.env.ALT_RFQ_MM_ENDPOINT)
    ? undefined
    : assertEnvVarType('ALT_RFQ_MM_ENDPOINT', process.env.ALT_RFQ_MM_ENDPOINT, EnvVarType.Url);
exports.ALT_RFQ_MM_API_KEY = _.isEmpty(process.env.ALT_RFQ_MM_API_KEY)
    ? undefined
    : assertEnvVarType('ALT_RFQ_MM_API_KEY', process.env.ALT_RFQ_MM_API_KEY, EnvVarType.NonEmptyString);
exports.ALT_RFQ_MM_PROFILE = _.isEmpty(process.env.ALT_RFQ_MM_PROFILE)
    ? undefined
    : assertEnvVarType('ALT_RFQ_MM_PROFILE', process.env.ALT_RFQ_MM_PROFILE, EnvVarType.NonEmptyString);
exports.RFQM_API_KEY_WHITELIST = new Set((0, exports.getApiKeyWhitelistFromIntegratorsAcl)('rfqm'));
exports.ADMIN_API_KEY = _.isEmpty(process.env.ADMIN_API_KEY)
    ? undefined
    : assertEnvVarType('ADMIN_API_KEY', process.env.ADMIN_API_KEY, EnvVarType.NonEmptyString);
exports.REASON_ON_STATUS_ERROR_RESPONSE_ENABLED = _.isEmpty(process.env.REASON_ON_STATUS_ERROR_RESPONSE_ENABLED)
    ? false
    : assertEnvVarType('REASON_ON_STATUS_ERROR_RESPONSE_ENABLED', process.env.REASON_ON_STATUS_ERROR_RESPONSE_ENABLED, EnvVarType.Boolean);
exports.TAKER_SPECIFIED_SIDE_ENABLED = _.isEmpty(process.env.TAKER_SPECIFIED_SIDE_ENABLED)
    ? false
    : assertEnvVarType('TAKER_SPECIFIED_SIDE_ENABLED', process.env.TAKER_SPECIFIED_SIDE_ENABLED, EnvVarType.Boolean);
exports.RFQM_MAKER_ID_SET = (0, exports.getMakerIdSetForOrderType)('any', 'rfqm');
exports.RFQT_MAKER_ID_SET_FOR_RFQ_ORDER = (0, exports.getMakerIdSetForOrderType)('rfq', 'rfqt');
exports.RFQT_MAKER_ID_SET_FOR_OTC_ORDER = (0, exports.getMakerIdSetForOrderType)('otc', 'rfqt');
exports.RFQM_MAKER_ID_SET_FOR_OTC_ORDER = (0, exports.getMakerIdSetForOrderType)('otc', 'rfqm');
/**
 * A map from RFQ maker's api key hashes to maker ids.
 * Invalid hashes, which appear more than once in the config file and might resolve to different makers, are removed from the result.
 */
exports.RFQ_API_KEY_HASH_TO_MAKER_ID = (() => {
    const hashToIdCount = exports.RFQ_MAKER_CONFIGS.reduce((result, rfqMakerConfig) => {
        rfqMakerConfig.apiKeyHashes.forEach((hash) => result.set(hash, (result.get(hash) || 0) + 1));
        return result;
    }, new Map());
    return exports.RFQ_MAKER_CONFIGS.reduce((result, mm) => {
        mm.apiKeyHashes.forEach((hash) => {
            // Ignore invalid hashes with more than one appearances
            if (hashToIdCount.get(hash) === 1) {
                result.set(hash, mm.makerId);
            }
        });
        return result;
    }, new Map());
})();
exports.META_TX_WORKER_MNEMONIC = _.isEmpty(process.env.META_TX_WORKER_MNEMONIC)
    ? undefined
    : assertEnvVarType('META_TX_WORKER_MNEMONIC', process.env.META_TX_WORKER_MNEMONIC, EnvVarType.NonEmptyString);
exports.RFQM_WORKER_GROUP_INDEX = _.isEmpty(process.env.RFQM_WORKER_GROUP_INDEX)
    ? undefined
    : assertEnvVarType('RFQM_WORKER_GROUP_INDEX', process.env.RFQM_WORKER_GROUP_INDEX, EnvVarType.Integer);
exports.RFQM_WORKER_GROUP_SIZE = _.isEmpty(process.env.RFQM_WORKER_GROUP_SIZE)
    ? undefined
    : assertEnvVarType('RFQM_WORKER_GROUP_SIZE', process.env.RFQM_WORKER_GROUP_SIZE, EnvVarType.Integer);
// If set to TRUE, system health will change to MAINTENANCE and integrators will be told to not
// send RFQM orders.
// tslint:disable-next-line boolean-naming
exports.RFQM_MAINTENANCE_MODE = _.isEmpty(process.env.RFQM_MAINTENANCE_MODE)
    ? false
    : assertEnvVarType('RFQM_MAINTENANCE_MODE', process.env.RFQM_MAINTENANCE_MODE, EnvVarType.Boolean);
exports.RFQ_PRICE_ENDPOINT_TIMEOUT_MS = _.isEmpty(process.env.RFQ_PRICE_ENDPOINT_TIMEOUT_MS)
    ? 1000
    : assertEnvVarType('RFQ_PRICE_ENDPOINT_TIMEOUT_MS', process.env.RFQ_PRICE_ENDPOINT_TIMEOUT_MS, EnvVarType.Integer);
exports.RFQ_SIGN_ENDPOINT_TIMEOUT_MS = _.isEmpty(process.env.RFQ_SIGN_ENDPOINT_TIMEOUT_MS)
    ? 2000
    : assertEnvVarType('RFQ_SIGN_ENDPOINT_TIMEOUT_MS', process.env.RFQ_SIGN_ENDPOINT_TIMEOUT_MS, EnvVarType.Integer);
// The expected time for a meta-txn to be included in a block.
exports.META_TXN_RELAY_EXPECTED_MINED_SEC = _.isEmpty(process.env.META_TXN_RELAY_EXPECTED_MINED_SEC)
    ? constants_1.DEFAULT_EXPECTED_MINED_SEC
    : assertEnvVarType('META_TXN_RELAY_EXPECTED_MINED_SEC', process.env.META_TXN_RELAY_EXPECTED_MINED_SEC, EnvVarType.Integer);
// Whether or not prometheus metrics should be enabled.
// tslint:disable-next-line:boolean-naming
exports.ENABLE_PROMETHEUS_METRICS = _.isEmpty(process.env.ENABLE_PROMETHEUS_METRICS)
    ? false
    : assertEnvVarType('ENABLE_PROMETHEUS_METRICS', process.env.ENABLE_PROMETHEUS_METRICS, EnvVarType.Boolean);
exports.PROMETHEUS_PORT = _.isEmpty(process.env.PROMETHEUS_PORT)
    ? 8080
    : assertEnvVarType('PROMETHEUS_PORT', process.env.PROMETHEUS_PORT, EnvVarType.Port);
// Eth Gas Station URL
exports.ETH_GAS_STATION_API_URL = _.isEmpty(process.env.ETH_GAS_STATION_API_URL)
    ? constants_1.DEFAULT_ETH_GAS_STATION_API_URL
    : assertEnvVarType('ETH_GAS_STATION_API_URL', process.env.ETH_GAS_STATION_API_URL, EnvVarType.Url);
exports.RFQ_PROXY_ADDRESS = _.isEmpty(process.env.RFQ_PROXY_ADDRESS)
    ? undefined
    : assertEnvVarType('RFQ_PROXY_ADDRESS', process.env.RFQ_PROXY_ADDRESS, EnvVarType.NonEmptyString);
exports.RFQ_PROXY_PORT = _.isEmpty(process.env.RFQ_PROXY_PORT)
    ? undefined
    : assertEnvVarType('RFQ_PROXY_PORT', process.env.RFQ_PROXY_PORT, EnvVarType.Port);
// tslint:disable-next-line boolean-naming
exports.ENABLE_LLR_COOLDOWN = _.isEmpty(process.env.ENABLE_LLR_COOLDOWN)
    ? false
    : assertEnvVarType('ENABLE_LLR_COOLDOWN', process.env.ENABLE_LLR_COOLDOWN, EnvVarType.Boolean);
exports.LLR_COOLDOWN_DURATION_SECONDS = _.isEmpty(process.env.LLR_COOLDOWN_DURATION_SECONDS)
    ? 60
    : assertEnvVarType('LLR_COOLDOWN_DURATION_SECONDS', process.env.LLR_COOLDOWN_DURATION_SECONDS, EnvVarType.Integer);
exports.defaultHttpServiceConfig = {
    httpPort: exports.HTTP_PORT,
    healthcheckHttpPort: exports.HEALTHCHECK_HTTP_PORT,
    healthcheckPath: constants_1.HEALTHCHECK_PATH,
    httpKeepAliveTimeout: exports.HTTP_KEEP_ALIVE_TIMEOUT,
    httpHeadersTimeout: exports.HTTP_HEADERS_TIMEOUT,
    enablePrometheusMetrics: exports.ENABLE_PROMETHEUS_METRICS,
    prometheusPort: exports.PROMETHEUS_PORT,
    prometheusPath: constants_1.METRICS_PATH,
};
exports.getIntegratorByIdOrThrow = ((integratorsMap) => (integratorId) => {
    const integrator = integratorsMap.get(integratorId);
    if (!integrator) {
        throw new Error(`Integrator ${integratorId} does not exist.`);
    }
    return integrator;
})(transformIntegratorsAcl(exports.INTEGRATORS_ACL, 'integratorId'));
/**
 * Gets the integrator ID for a given API key. If the API key is not in the configuration, returns `undefined`.
 */
exports.getIntegratorIdForApiKey = ((integratorsMap) => (apiKey) => {
    const integrator = integratorsMap.get(apiKey);
    return integrator === null || integrator === void 0 ? void 0 : integrator.integratorId;
})(transformIntegratorsAcl(exports.INTEGRATORS_ACL, 'apiKeys'));
/**
 * Utility function to transform INTEGRATORS_ACL into a map of apiKey => integrator. The result can
 * be used to optimize the lookup of the integrator when a request comes in with an api key. Lookup complexity
 * becomes O(1) with the map instead of O(# integrators * # api keys) with the array.
 *
 * @param integrators the integrators map from the environment variable
 * @param keyBy either apiKeys (creates map keyed by every API key) or 'integratorId' (integratorId => Integrator)
 */
function transformIntegratorsAcl(integrators, keyBy) {
    const result = new Map();
    integrators.forEach((integrator) => {
        let mapKeys;
        switch (keyBy) {
            case 'apiKeys':
                mapKeys = integrator.apiKeys;
                break;
            case 'integratorId':
                mapKeys = [integrator.integratorId];
                break;
            default:
                throw new Error(`Parameter "${keyBy}" is misconfigured`);
        }
        mapKeys.forEach((apiKey) => {
            result.set(apiKey, integrator);
        });
    });
    return result;
}
/**
 * RPC
 */
exports.META_TRANSACTION_SERVICE_RPC_URL = _.isEmpty(process.env.META_TRANSACTION_SERVICE_RPC_URL)
    ? ''
    : assertEnvVarType('META_TRANSACTION_SERVICE_RPC_URL', process.env.META_TRANSACTION_SERVICE_RPC_URL, EnvVarType.Url);
/**
 * Resolves a config of type T for an Enviornment Variable. Checks:
 *  - If the env variable is undefined, use the hardcoded fallback
 *  - If the env variable points to a filepath, resolve it
 *  - Otherwise, just use the env variable
 *
 * @param envVar - the name of the Environment Variable
 * @param envVarType - the type
 * @param fallback  - A hardcoded fallback value
 * @returns The config
 */
function resolveEnvVar(envVar, envVarType, fallback) {
    const rawEnvVar = process.env[envVar];
    if (rawEnvVar === undefined || _.isEmpty(rawEnvVar)) {
        return fallback;
    }
    // If the enviornment variable points to a file
    if (fs.existsSync(rawEnvVar)) {
        return JSON.parse(fs.readFileSync(rawEnvVar, 'utf8'));
    }
    return assertEnvVarType(envVar, process.env[envVar], envVarType);
}
// $eslint-fix-me https://github.com/rhinodavid/eslint-fix-me
// eslint-disable-next-line @typescript-eslint/no-explicit-any
function assertEnvVarType(name, value, expectedType) {
    let returnValue;
    switch (expectedType) {
        case EnvVarType.Port:
            returnValue = parseInt(value, 10);
            // $eslint-fix-me https://github.com/rhinodavid/eslint-fix-me
            // eslint-disable-next-line no-case-declarations
            const isWithinRange = returnValue >= 0 && returnValue <= 65535;
            if (isNaN(returnValue) || !isWithinRange) {
                throw new Error(`${name} must be between 0 to 65535, found ${value}.`);
            }
            return returnValue;
        case EnvVarType.ChainId:
        case EnvVarType.KeepAliveTimeout:
        case EnvVarType.Integer:
            returnValue = parseInt(value, 10);
            if (isNaN(returnValue)) {
                throw new Error(`${name} must be a valid integer, found ${value}.`);
            }
            return returnValue;
        case EnvVarType.ETHAddressHex:
            assert_1.assert.isETHAddressHex(name, value);
            return value;
        case EnvVarType.Url:
            assert_1.assert.isUri(name, value);
            return value;
        case EnvVarType.UrlList:
            assert_1.assert.isString(name, value);
            // $eslint-fix-me https://github.com/rhinodavid/eslint-fix-me
            // eslint-disable-next-line no-case-declarations
            const urlList = value.split(',');
            urlList.forEach((url, i) => assert_1.assert.isUri(`${name}[${i}]`, url));
            return urlList;
        case EnvVarType.Boolean:
            return value === 'true';
        case EnvVarType.UnitAmount:
            returnValue = new utils_1.BigNumber(parseFloat(value));
            if (returnValue.isNaN() || returnValue.isNegative()) {
                throw new Error(`${name} must be valid number greater than 0.`);
            }
            return returnValue;
        case EnvVarType.Rate:
            returnValue = parseFloat(value);
            if (returnValue < 0 || returnValue > 1) {
                throw new Error(`${name} must be valid number between 0.0 and 1.0.`);
            }
            return returnValue;
        case EnvVarType.AddressList:
            assert_1.assert.isString(name, value);
            // $eslint-fix-me https://github.com/rhinodavid/eslint-fix-me
            // eslint-disable-next-line no-case-declarations
            const addressList = value.split(',').map((a) => a.toLowerCase());
            addressList.forEach((a, i) => assert_1.assert.isETHAddressHex(`${name}[${i}]`, a));
            return addressList;
        case EnvVarType.StringList:
            assert_1.assert.isString(name, value);
            // $eslint-fix-me https://github.com/rhinodavid/eslint-fix-me
            // eslint-disable-next-line no-case-declarations
            const stringList = value.split(',');
            return stringList;
        case EnvVarType.WhitelistAllTokens:
            return '*';
        case EnvVarType.NonEmptyString:
            assert_1.assert.isString(name, value);
            if (value === '') {
                throw new Error(`${name} must be supplied`);
            }
            return value;
        case EnvVarType.APIKeys:
            assert_1.assert.isString(name, value);
            // $eslint-fix-me https://github.com/rhinodavid/eslint-fix-me
            // eslint-disable-next-line no-case-declarations
            const apiKeys = value.split(',');
            apiKeys.forEach((apiKey) => {
                const isValidUUID = validateUUID(apiKey);
                if (!isValidUUID) {
                    throw new Error(`API Key ${apiKey} isn't UUID compliant`);
                }
            });
            return apiKeys;
        case EnvVarType.JsonStringList:
            assert_1.assert.isString(name, value);
            return JSON.parse(value);
        case EnvVarType.RfqMakerAssetOfferings:
            // $eslint-fix-me https://github.com/rhinodavid/eslint-fix-me
            // eslint-disable-next-line no-case-declarations
            const offerings = JSON.parse(value);
            // tslint:disable-next-line:forin
            for (const makerEndpoint in offerings) {
                assert_1.assert.isWebUri('market maker endpoint', makerEndpoint);
                const assetOffering = offerings[makerEndpoint];
                assert_1.assert.isArray(`value in maker endpoint mapping, for index ${makerEndpoint},`, assetOffering);
                assetOffering.forEach((assetPair, i) => {
                    assert_1.assert.isArray(`asset pair array ${i} for maker endpoint ${makerEndpoint}`, assetPair);
                    assert_1.assert.assert(assetPair.length === 2, `asset pair array ${i} for maker endpoint ${makerEndpoint} does not consist of exactly two elements.`);
                    assert_1.assert.isETHAddressHex(`first token address for asset pair ${i} for maker endpoint ${makerEndpoint}`, assetPair[0]);
                    assert_1.assert.isETHAddressHex(`second token address for asset pair ${i} for maker endpoint ${makerEndpoint}`, assetPair[1]);
                    assert_1.assert.assert(assetPair[0] !== assetPair[1], `asset pair array ${i} for maker endpoint ${makerEndpoint} has identical assets`);
                });
            }
            return offerings;
        case EnvVarType.LiquidityProviderRegistry:
            // $eslint-fix-me https://github.com/rhinodavid/eslint-fix-me
            // eslint-disable-next-line no-case-declarations
            const registry = JSON.parse(value);
            // tslint:disable-next-line:forin
            for (const liquidityProvider in registry) {
                assert_1.assert.isETHAddressHex('liquidity provider address', liquidityProvider);
                const { tokens } = registry[liquidityProvider];
                assert_1.assert.isArray(`token list for liquidity provider ${liquidityProvider}`, tokens);
                tokens.forEach((token, i) => {
                    assert_1.assert.isETHAddressHex(`address of token ${i} for liquidity provider ${liquidityProvider}`, token);
                });
                // TODO jacob validate gas cost callback in registry
                // assert.isNumber(`gas cost for liquidity provider ${liquidityProvider}`, gasCost);
            }
            return registry;
        default:
            throw new Error(`Unrecognised EnvVarType: ${expectedType} encountered for variable ${name}.`);
    }
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL2Rhdmlkd2Fsc2gvY29kZS1sb2NhbC8weC1yZnEtYXBpL3NyYy9jb25maWcudHMiLCJtYXBwaW5ncyI6Ijs7OztBQUVBLHVDQUFvQztBQUdwQywrREFBaUQ7QUFDakQscUNBQXNDO0FBQ3RDLHlCQUF5QjtBQUN6Qiw0QkFBNEI7QUFDNUIsOENBQThDO0FBRTlDLGdEQVkwQjtBQUMxQiw0Q0FBeUM7QUFFekMsa0RBQWlEO0FBQ2pELHNEQUFrRDtBQUVsRCw0QkFBNEI7QUFFNUIsSUFBSyxVQW9CSjtBQXBCRCxXQUFLLFVBQVU7SUFDWCx5REFBVyxDQUFBO0lBQ1gsdURBQVUsQ0FBQTtJQUNWLGlEQUFPLENBQUE7SUFDUCwyQ0FBSSxDQUFBO0lBQ0osbUVBQWdCLENBQUE7SUFDaEIsaURBQU8sQ0FBQTtJQUNQLDZEQUFhLENBQUE7SUFDYix1REFBVSxDQUFBO0lBQ1YsMkNBQUksQ0FBQTtJQUNKLHlDQUFHLENBQUE7SUFDSCxrREFBTyxDQUFBO0lBQ1Asd0VBQWtCLENBQUE7SUFDbEIsa0RBQU8sQ0FBQTtJQUNQLGdFQUFjLENBQUE7SUFDZCxrREFBTyxDQUFBO0lBQ1AsMERBQVcsQ0FBQTtJQUNYLGdGQUFzQixDQUFBO0lBQ3RCLHNGQUF5QixDQUFBO0lBQ3pCLGdFQUFjLENBQUE7QUFDbEIsQ0FBQyxFQXBCSSxVQUFVLEtBQVYsVUFBVSxRQW9CZDtBQXNERDs7O0dBR0c7QUFDVSxRQUFBLG9CQUFvQixHQUF3QixDQUFDLEdBQUcsRUFBRTtJQUMzRCxJQUFJLE1BQTJCLENBQUM7SUFDaEMsSUFBSTtRQUNBLE1BQU0sR0FBRyxhQUFhLENBQXNCLHNCQUFzQixFQUFFLFVBQVUsQ0FBQyxjQUFjLEVBQUUsRUFBRSxDQUFDLENBQUM7UUFDbkcsMEJBQVcsQ0FBQyxjQUFjLENBQUMsTUFBTSxFQUFFLGlCQUFPLENBQUMseUJBQXlCLENBQUMsQ0FBQztLQUN6RTtJQUFDLE9BQU8sQ0FBQyxFQUFFO1FBQ1IsTUFBTSxJQUFJLEtBQUssQ0FBQywwRUFBMEUsQ0FBQyxFQUFFLENBQUMsQ0FBQztLQUNsRztJQUNELE9BQU8sTUFBTSxDQUFDO0FBQ2xCLENBQUMsQ0FBQyxFQUFFLENBQUM7QUF1Qkw7OztHQUdHO0FBQ1UsUUFBQSwyQkFBMkIsR0FBNkIsQ0FBQyxHQUFHLEVBQUU7SUFDdkUsSUFBSTtRQUNBLE1BQU0sc0JBQXNCLEdBQW1DLGFBQWEsQ0FDeEUsMEJBQTBCLEVBQzFCLFVBQVUsQ0FBQyxjQUFjLEVBQ3pCLEVBQUUsQ0FDTCxDQUFDO1FBQ0YsMEJBQVcsQ0FBQyxjQUFjLENBQUMsc0JBQXNCLEVBQUUsaUJBQU8sQ0FBQyw0QkFBNEIsQ0FBQyxDQUFDO1FBRXpGLE9BQU8sc0JBQXNCLENBQUMsTUFBTSxDQUFDLENBQUMsR0FBRyxFQUFFLElBQUksRUFBRSxFQUFFO1lBQy9DLE1BQU0sRUFBRSxPQUFPLEVBQUUsTUFBTSxFQUFFLE1BQU0sRUFBRSxlQUFlLEVBQUUsWUFBWSxFQUFFLEdBQUcsSUFBSSxDQUFDO1lBQ3hFLElBQUksQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLE9BQU8sQ0FBQyxFQUFFO2dCQUNuQixHQUFHLENBQUMsR0FBRyxDQUFDLE9BQU8sRUFBRSxJQUFJLEdBQUcsRUFBaUMsQ0FBQyxDQUFDO2FBQzlEO1lBQ0QsNkRBQTZEO1lBQzdELG9FQUFvRTtZQUNwRSxHQUFHLENBQUMsR0FBRyxDQUFDLE9BQU8sQ0FBRSxDQUFDLEdBQUcsQ0FBQyxJQUFBLHlCQUFZLEVBQUMsTUFBTSxFQUFFLE1BQU0sQ0FBQyxFQUFFLEVBQUUsZUFBZSxFQUFFLFlBQVksRUFBRSxDQUFDLENBQUM7WUFDdkYsT0FBTyxHQUFHLENBQUM7UUFDZixDQUFDLEVBQUUsSUFBSSxHQUFHLEVBQTBFLENBQUMsQ0FBQztLQUN6RjtJQUFDLE9BQU8sQ0FBQyxFQUFFO1FBQ1IsTUFBTSxJQUFJLEtBQUssQ0FBQyw4RUFBOEUsQ0FBQyxFQUFFLENBQUMsQ0FBQztLQUN0RztBQUNMLENBQUMsQ0FBQyxFQUFFLENBQUM7QUFFUSxRQUFBLCtCQUErQixHQUEwQixFQUFFLGVBQWUsRUFBRSxDQUFDLEVBQUUsWUFBWSxFQUFFLENBQUMsRUFBRSxDQUFDO0FBb0I5Rzs7O0dBR0c7QUFDVSxRQUFBLGVBQWUsR0FBbUIsQ0FBQyxHQUFHLEVBQUU7SUFDakQsSUFBSSxXQUEyQixDQUFDO0lBQ2hDLElBQUk7UUFDQSxXQUFXLEdBQUcsYUFBYSxDQUFpQixpQkFBaUIsRUFBRSxVQUFVLENBQUMsY0FBYyxFQUFFLEVBQUUsQ0FBQyxDQUFDO1FBQzlGLDBCQUFXLENBQUMsY0FBYyxDQUFDLFdBQVcsRUFBRSxpQkFBTyxDQUFDLG9CQUFvQixDQUFDLENBQUM7S0FDekU7SUFBQyxPQUFPLENBQUMsRUFBRTtRQUNSLE1BQU0sSUFBSSxLQUFLLENBQUMscUVBQXFFLENBQUMsRUFBRSxDQUFDLENBQUM7S0FDN0Y7SUFDRCxPQUFPLFdBQVcsQ0FBQztBQUN2QixDQUFDLENBQUMsRUFBRSxDQUFDO0FBRUw7O0dBRUc7QUFDSSxNQUFNLG9DQUFvQyxHQUFHLENBQUMsU0FBa0MsRUFBWSxFQUFFO0lBQ2pHLE9BQU8sdUJBQWUsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLEVBQUUsRUFBRSxDQUFDLENBQUMsQ0FBQyxTQUFTLENBQUMsQ0FBQztTQUM3QyxPQUFPLENBQUMsQ0FBQyxDQUFDLEVBQUUsRUFBRSxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUM7U0FDekIsSUFBSSxFQUFFLENBQUM7QUFDaEIsQ0FBQyxDQUFDO0FBSlcsUUFBQSxvQ0FBb0Msd0NBSS9DO0FBRUY7O0dBRUc7QUFDSSxNQUFNLHdCQUF3QixHQUFHLENBQUMsS0FBYSxFQUFzQixFQUFFO0lBQzFFLEtBQUssTUFBTSxVQUFVLElBQUksdUJBQWUsRUFBRTtRQUN0QyxJQUFJLFVBQVUsQ0FBQyxLQUFLLEtBQUssS0FBSyxFQUFFO1lBQzVCLE9BQU8sVUFBVSxDQUFDLFlBQVksQ0FBQztTQUNsQztLQUNKO0FBQ0wsQ0FBQyxDQUFDO0FBTlcsUUFBQSx3QkFBd0IsNEJBTW5DO0FBS1csUUFBQSw2QkFBNkIsR0FBVyx5QkFBYSxHQUFHLENBQUMsQ0FBQztBQWtCdkU7O0dBRUc7QUFDSSxNQUFNLHlCQUF5QixHQUFHLENBQUMsU0FBK0IsRUFBRSxRQUF5QixFQUFjLEVBQUU7SUFDaEgsTUFBTSxVQUFVLEdBQUcsUUFBUSxLQUFLLE1BQU0sQ0FBQyxDQUFDLENBQUMsZ0JBQWdCLENBQUMsQ0FBQyxDQUFDLGdCQUFnQixDQUFDO0lBQzdFLE9BQU8seUJBQWlCLENBQUMsTUFBTSxDQUFDLENBQUMsR0FBRyxFQUFFLElBQUksRUFBRSxFQUFFO1FBQzFDLElBQUksU0FBUyxLQUFLLEtBQUssSUFBSSxJQUFJLENBQUMsVUFBVSxDQUFDLENBQUMsUUFBUSxDQUFDLFNBQVMsQ0FBQyxFQUFFO1lBQzdELEdBQUcsQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDO1NBQ3pCO1FBQ0QsT0FBTyxHQUFHLENBQUM7SUFDZixDQUFDLEVBQUUsSUFBSSxHQUFHLEVBQXdCLENBQUMsQ0FBQztBQUN4QyxDQUFDLENBQUM7QUFSVyxRQUFBLHlCQUF5Qiw2QkFRcEM7QUFFRjs7R0FFRztBQUNVLFFBQUEsaUJBQWlCLEdBQXFCLENBQUMsR0FBRyxFQUFFO0lBQ3JELElBQUk7UUFDQSxNQUFNLFlBQVksR0FBRyxhQUFhLENBQW1CLG1CQUFtQixFQUFFLFVBQVUsQ0FBQyxjQUFjLEVBQUUsRUFBRSxDQUFDLENBQUM7UUFDekcsMEJBQVcsQ0FBQyxjQUFjLENBQUMsWUFBWSxFQUFFLGlCQUFPLENBQUMsd0JBQXdCLENBQUMsQ0FBQztRQUMzRSxPQUFPLFlBQVksQ0FBQztLQUN2QjtJQUFDLE9BQU8sQ0FBQyxFQUFFO1FBQ1IsTUFBTSxJQUFJLEtBQUssQ0FBQyx1RUFBdUUsQ0FBQyxFQUFFLENBQUMsQ0FBQztLQUMvRjtBQUNMLENBQUMsQ0FBQyxFQUFFLENBQUM7QUFFTCx3QkFBd0I7QUFDWCxRQUFBLFNBQVMsR0FBVyxDQUFDLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsU0FBUyxDQUFDO0lBQzdELENBQUMsQ0FBQyxNQUFNO0lBQ1IsQ0FBQyxDQUFDLGdCQUFnQixDQUFDLFdBQVcsRUFBRSxPQUFPLENBQUMsR0FBRyxDQUFDLFNBQVMsRUFBRSxVQUFVLENBQUMsY0FBYyxDQUFDLENBQUM7QUFFdEYsNEJBQTRCO0FBQ2YsUUFBQSxTQUFTLEdBQUcsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLFNBQVMsQ0FBQztJQUNyRCxDQUFDLENBQUMsSUFBSTtJQUNOLENBQUMsQ0FBQyxnQkFBZ0IsQ0FBQyxXQUFXLEVBQUUsT0FBTyxDQUFDLEdBQUcsQ0FBQyxTQUFTLEVBQUUsVUFBVSxDQUFDLElBQUksQ0FBQyxDQUFDO0FBRTVFLHNHQUFzRztBQUN6RixRQUFBLHFCQUFxQixHQUFHLENBQUMsQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxxQkFBcUIsQ0FBQztJQUM3RSxDQUFDLENBQUMsaUJBQVM7SUFDWCxDQUFDLENBQUMsZ0JBQWdCLENBQUMsdUJBQXVCLEVBQUUsT0FBTyxDQUFDLEdBQUcsQ0FBQyxxQkFBcUIsRUFBRSxVQUFVLENBQUMsSUFBSSxDQUFDLENBQUM7QUFFcEcsd0VBQXdFO0FBQ3hFLDhFQUE4RTtBQUM5RSxnQkFBZ0I7QUFDaEIscUVBQXFFO0FBQ3hELFFBQUEsdUJBQXVCLEdBQUcsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLHVCQUF1QixDQUFDO0lBQ2pGLENBQUMsQ0FBQyxFQUFFLEdBQUcsSUFBSTtJQUNYLENBQUMsQ0FBQyxnQkFBZ0IsQ0FBQyx5QkFBeUIsRUFBRSxPQUFPLENBQUMsR0FBRyxDQUFDLHVCQUF1QixFQUFFLFVBQVUsQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDO0FBRXBILHNGQUFzRjtBQUN0RixrRUFBa0U7QUFDbEUsbUVBQW1FO0FBQ3RELFFBQUEsb0JBQW9CLEdBQUcsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLG9CQUFvQixDQUFDO0lBQzNFLENBQUMsQ0FBQyxFQUFFLEdBQUcsSUFBSTtJQUNYLENBQUMsQ0FBQyxnQkFBZ0IsQ0FBQyxzQkFBc0IsRUFBRSxPQUFPLENBQUMsR0FBRyxDQUFDLG9CQUFvQixFQUFFLFVBQVUsQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDO0FBRTlHLDZDQUE2QztBQUNoQyxRQUFBLFFBQVEsR0FBWSxDQUFDLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsUUFBUSxDQUFDO0lBQzVELENBQUMsQ0FBQyw0QkFBTyxDQUFDLEtBQUs7SUFDZixDQUFDLENBQUMsZ0JBQWdCLENBQUMsVUFBVSxFQUFFLE9BQU8sQ0FBQyxHQUFHLENBQUMsUUFBUSxFQUFFLFVBQVUsQ0FBQyxPQUFPLENBQUMsQ0FBQztBQUVoRSxRQUFBLGFBQWEsR0FBRyxDQUFDLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsYUFBYSxDQUFDO0lBQzdELENBQUMsQ0FBQyxTQUFTO0lBQ1gsQ0FBQyxDQUFDLGdCQUFnQixDQUFDLGVBQWUsRUFBRSxPQUFPLENBQUMsR0FBRyxDQUFDLGFBQWEsRUFBRSxVQUFVLENBQUMsVUFBVSxDQUFDLENBQUM7QUFFMUYsK0JBQStCO0FBQ2xCLFFBQUEscUJBQXFCLEdBQUcsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLHFCQUFxQixDQUFDO0lBQzdFLENBQUMsQ0FBQyx3QkFBWTtJQUNkLENBQUMsQ0FBQyxnQkFBZ0IsQ0FBQyx1QkFBdUIsRUFBRSxPQUFPLENBQUMsR0FBRyxDQUFDLHFCQUFxQixFQUFFLFVBQVUsQ0FBQyxhQUFhLENBQUMsQ0FBQztBQUVoRyxRQUFBLFlBQVksR0FBRyxDQUFDLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsWUFBWSxDQUFDO0lBQzNELENBQUMsQ0FBQyxzQ0FBMEI7SUFDNUIsQ0FBQyxDQUFDLGdCQUFnQixDQUFDLGNBQWMsRUFBRSxPQUFPLENBQUMsR0FBRyxDQUFDLFlBQVksRUFBRSxVQUFVLENBQUMsR0FBRyxDQUFDLENBQUM7QUFFcEUsUUFBQSwwQkFBMEIsR0FBeUIsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLDBCQUEwQixDQUFDO0lBQzdHLENBQUMsQ0FBQyxTQUFTO0lBQ1gsQ0FBQyxDQUFDLGdCQUFnQixDQUFDLDRCQUE0QixFQUFFLE9BQU8sQ0FBQyxHQUFHLENBQUMsMEJBQTBCLEVBQUUsVUFBVSxDQUFDLE9BQU8sQ0FBQyxDQUFDO0FBRWpILGdFQUFnRTtBQUNuRCxRQUFBLGtCQUFrQixHQUFHLENBQUMsQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxrQkFBa0IsQ0FBQztJQUN2RSxDQUFDLENBQUMsc0NBQTBCO0lBQzVCLENBQUMsQ0FBQyxnQkFBZ0IsQ0FBQyxvQkFBb0IsRUFBRSxPQUFPLENBQUMsR0FBRyxDQUFDLGtCQUFrQixFQUFFLFVBQVUsQ0FBQyxjQUFjLENBQUMsQ0FBQztBQUV4RywyREFBMkQ7QUFDOUMsUUFBQSxVQUFVLEdBQUcsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLFVBQVUsQ0FBQztJQUN2RCxDQUFDLENBQUMsU0FBUztJQUNYLENBQUMsQ0FBQyxnQkFBZ0IsQ0FBQyxZQUFZLEVBQUUsT0FBTyxDQUFDLEdBQUcsQ0FBQyxVQUFVLEVBQUUsVUFBVSxDQUFDLEdBQUcsQ0FBQyxDQUFDO0FBRTdFLDJDQUEyQztBQUM5QixRQUFBLGtCQUFrQixHQUFXLENBQUMsQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxrQkFBa0IsQ0FBQztJQUMvRSxDQUFDLENBQUMsRUFBRTtJQUNKLENBQUMsQ0FBQyxnQkFBZ0IsQ0FBQyxvQkFBb0IsRUFBRSxPQUFPLENBQUMsR0FBRyxDQUFDLGtCQUFrQixFQUFFLFVBQVUsQ0FBQyxjQUFjLENBQUMsQ0FBQztBQUV4RywrRUFBK0U7QUFDbEUsUUFBQSxtQkFBbUIsR0FBVyxDQUFDLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsbUJBQW1CLENBQUM7SUFDakYsQ0FBQyxDQUFDLHdCQUF3QjtJQUMxQixDQUFDLENBQUMsZ0JBQWdCLENBQUMscUJBQXFCLEVBQUUsT0FBTyxDQUFDLEdBQUcsQ0FBQyxtQkFBbUIsRUFBRSxVQUFVLENBQUMsY0FBYyxDQUFDLENBQUM7QUFFMUcsMkNBQTJDO0FBQzlCLFFBQUEsZUFBZSxHQUFXLENBQUMsQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxlQUFlLENBQUM7SUFDekUsQ0FBQyxDQUFDLEVBQUU7SUFDSixDQUFDLENBQUMsZ0JBQWdCLENBQUMsaUJBQWlCLEVBQUUsT0FBTyxDQUFDLEdBQUcsQ0FBQyxlQUFlLEVBQUUsVUFBVSxDQUFDLGNBQWMsQ0FBQyxDQUFDO0FBRWxHLDZEQUE2RDtBQUM3RCxrRUFBa0U7QUFDckQsUUFBQSwwQkFBMEIsR0FBVyxJQUFJLENBQUM7QUFFdkQsa0dBQWtHO0FBQ3JGLFFBQUEseUJBQXlCLEdBQUcsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLHlCQUF5QixDQUFDO0lBQ3JGLENBQUMsQ0FBQyxDQUFDO0lBQ0gsQ0FBQyxDQUFDLGdCQUFnQixDQUFDLDJCQUEyQixFQUFFLE9BQU8sQ0FBQyxHQUFHLENBQUMseUJBQXlCLEVBQUUsVUFBVSxDQUFDLElBQUksQ0FBQyxDQUFDO0FBRS9GLFFBQUEsU0FBUyxHQUFHLENBQUMsQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDLENBQUMsbUNBQXVCLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsU0FBUyxDQUFDO0FBRS9GLFFBQUEsd0JBQXdCLEdBQUcsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLHdCQUF3QixDQUFDO0lBQ25GLENBQUMsQ0FBQyxtQ0FBdUI7SUFDekIsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsd0JBQXdCLENBQUM7QUFFOUIsUUFBQSxvQkFBb0IsR0FBRyxDQUFDLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsb0JBQW9CLENBQUM7SUFDM0UsQ0FBQyxDQUFDLHdDQUE0QjtJQUM5QixDQUFDLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxvQkFBb0IsQ0FBQztBQUV2Qyw2RUFBNkU7QUFDaEUsUUFBQSx3QkFBd0IsR0FBRyxDQUFDLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsd0JBQXdCLENBQUM7SUFDbkYsQ0FBQyxDQUFDLDRDQUFnQztJQUNsQyxDQUFDLENBQUMsZ0JBQWdCLENBQUMsMEJBQTBCLEVBQUUsT0FBTyxDQUFDLEdBQUcsQ0FBQyx3QkFBd0IsRUFBRSxVQUFVLENBQUMsT0FBTyxDQUFDLENBQUM7QUFFaEcsUUFBQSxtQkFBbUIsR0FBdUIsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLG1CQUFtQixDQUFDO0lBQzdGLENBQUMsQ0FBQyxTQUFTO0lBQ1gsQ0FBQyxDQUFDLGdCQUFnQixDQUFDLHFCQUFxQixFQUFFLE9BQU8sQ0FBQyxHQUFHLENBQUMsbUJBQW1CLEVBQUUsVUFBVSxDQUFDLEdBQUcsQ0FBQyxDQUFDO0FBQ2xGLFFBQUEsa0JBQWtCLEdBQXVCLENBQUMsQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxrQkFBa0IsQ0FBQztJQUMzRixDQUFDLENBQUMsU0FBUztJQUNYLENBQUMsQ0FBQyxnQkFBZ0IsQ0FBQyxvQkFBb0IsRUFBRSxPQUFPLENBQUMsR0FBRyxDQUFDLGtCQUFrQixFQUFFLFVBQVUsQ0FBQyxjQUFjLENBQUMsQ0FBQztBQUMzRixRQUFBLGtCQUFrQixHQUF1QixDQUFDLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsa0JBQWtCLENBQUM7SUFDM0YsQ0FBQyxDQUFDLFNBQVM7SUFDWCxDQUFDLENBQUMsZ0JBQWdCLENBQUMsb0JBQW9CLEVBQUUsT0FBTyxDQUFDLEdBQUcsQ0FBQyxrQkFBa0IsRUFBRSxVQUFVLENBQUMsY0FBYyxDQUFDLENBQUM7QUFFM0YsUUFBQSxzQkFBc0IsR0FBZ0IsSUFBSSxHQUFHLENBQUMsSUFBQSw0Q0FBb0MsRUFBQyxNQUFNLENBQUMsQ0FBQyxDQUFDO0FBRTVGLFFBQUEsYUFBYSxHQUF1QixDQUFDLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsYUFBYSxDQUFDO0lBQ2pGLENBQUMsQ0FBQyxTQUFTO0lBQ1gsQ0FBQyxDQUFDLGdCQUFnQixDQUFDLGVBQWUsRUFBRSxPQUFPLENBQUMsR0FBRyxDQUFDLGFBQWEsRUFBRSxVQUFVLENBQUMsY0FBYyxDQUFDLENBQUM7QUFFakYsUUFBQSx1Q0FBdUMsR0FBWSxDQUFDLENBQUMsT0FBTyxDQUNyRSxPQUFPLENBQUMsR0FBRyxDQUFDLHVDQUF1QyxDQUN0RDtJQUNHLENBQUMsQ0FBQyxLQUFLO0lBQ1AsQ0FBQyxDQUFDLGdCQUFnQixDQUNaLHlDQUF5QyxFQUN6QyxPQUFPLENBQUMsR0FBRyxDQUFDLHVDQUF1QyxFQUNuRCxVQUFVLENBQUMsT0FBTyxDQUNyQixDQUFDO0FBRUssUUFBQSw0QkFBNEIsR0FBWSxDQUFDLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsNEJBQTRCLENBQUM7SUFDcEcsQ0FBQyxDQUFDLEtBQUs7SUFDUCxDQUFDLENBQUMsZ0JBQWdCLENBQUMsOEJBQThCLEVBQUUsT0FBTyxDQUFDLEdBQUcsQ0FBQyw0QkFBNEIsRUFBRSxVQUFVLENBQUMsT0FBTyxDQUFDLENBQUM7QUFFeEcsUUFBQSxpQkFBaUIsR0FBZSxJQUFBLGlDQUF5QixFQUFDLEtBQUssRUFBRSxNQUFNLENBQUMsQ0FBQztBQUN6RSxRQUFBLCtCQUErQixHQUFlLElBQUEsaUNBQXlCLEVBQUMsS0FBSyxFQUFFLE1BQU0sQ0FBQyxDQUFDO0FBQ3ZGLFFBQUEsK0JBQStCLEdBQWUsSUFBQSxpQ0FBeUIsRUFBQyxLQUFLLEVBQUUsTUFBTSxDQUFDLENBQUM7QUFDdkYsUUFBQSwrQkFBK0IsR0FBZSxJQUFBLGlDQUF5QixFQUFDLEtBQUssRUFBRSxNQUFNLENBQUMsQ0FBQztBQUVwRzs7O0dBR0c7QUFDVSxRQUFBLDRCQUE0QixHQUF3QixDQUFDLEdBQUcsRUFBRTtJQUNuRSxNQUFNLGFBQWEsR0FBRyx5QkFBaUIsQ0FBQyxNQUFNLENBQUMsQ0FBQyxNQUFNLEVBQUUsY0FBYyxFQUFFLEVBQUU7UUFDdEUsY0FBYyxDQUFDLFlBQVksQ0FBQyxPQUFPLENBQUMsQ0FBQyxJQUFJLEVBQUUsRUFBRSxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMsSUFBSSxFQUFFLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQzdGLE9BQU8sTUFBTSxDQUFDO0lBQ2xCLENBQUMsRUFBRSxJQUFJLEdBQUcsRUFBa0IsQ0FBQyxDQUFDO0lBRTlCLE9BQU8seUJBQWlCLENBQUMsTUFBTSxDQUFDLENBQUMsTUFBTSxFQUFFLEVBQUUsRUFBRSxFQUFFO1FBQzNDLEVBQUUsQ0FBQyxZQUFZLENBQUMsT0FBTyxDQUFDLENBQUMsSUFBSSxFQUFFLEVBQUU7WUFDN0IsdURBQXVEO1lBQ3ZELElBQUksYUFBYSxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLEVBQUU7Z0JBQy9CLE1BQU0sQ0FBQyxHQUFHLENBQUMsSUFBSSxFQUFFLEVBQUUsQ0FBQyxPQUFPLENBQUMsQ0FBQzthQUNoQztRQUNMLENBQUMsQ0FBQyxDQUFDO1FBQ0gsT0FBTyxNQUFNLENBQUM7SUFDbEIsQ0FBQyxFQUFFLElBQUksR0FBRyxFQUFrQixDQUFDLENBQUM7QUFDbEMsQ0FBQyxDQUFDLEVBQUUsQ0FBQztBQUVRLFFBQUEsdUJBQXVCLEdBQXVCLENBQUMsQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyx1QkFBdUIsQ0FBQztJQUNyRyxDQUFDLENBQUMsU0FBUztJQUNYLENBQUMsQ0FBQyxnQkFBZ0IsQ0FBQyx5QkFBeUIsRUFBRSxPQUFPLENBQUMsR0FBRyxDQUFDLHVCQUF1QixFQUFFLFVBQVUsQ0FBQyxjQUFjLENBQUMsQ0FBQztBQUVyRyxRQUFBLHVCQUF1QixHQUF1QixDQUFDLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsdUJBQXVCLENBQUM7SUFDckcsQ0FBQyxDQUFDLFNBQVM7SUFDWCxDQUFDLENBQUMsZ0JBQWdCLENBQUMseUJBQXlCLEVBQUUsT0FBTyxDQUFDLEdBQUcsQ0FBQyx1QkFBdUIsRUFBRSxVQUFVLENBQUMsT0FBTyxDQUFDLENBQUM7QUFFOUYsUUFBQSxzQkFBc0IsR0FBdUIsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLHNCQUFzQixDQUFDO0lBQ25HLENBQUMsQ0FBQyxTQUFTO0lBQ1gsQ0FBQyxDQUFDLGdCQUFnQixDQUFDLHdCQUF3QixFQUFFLE9BQU8sQ0FBQyxHQUFHLENBQUMsc0JBQXNCLEVBQUUsVUFBVSxDQUFDLE9BQU8sQ0FBQyxDQUFDO0FBRXpHLCtGQUErRjtBQUMvRixvQkFBb0I7QUFDcEIsMENBQTBDO0FBQzdCLFFBQUEscUJBQXFCLEdBQVksQ0FBQyxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLHFCQUFxQixDQUFDO0lBQ3RGLENBQUMsQ0FBQyxLQUFLO0lBQ1AsQ0FBQyxDQUFDLGdCQUFnQixDQUFDLHVCQUF1QixFQUFFLE9BQU8sQ0FBQyxHQUFHLENBQUMscUJBQXFCLEVBQUUsVUFBVSxDQUFDLE9BQU8sQ0FBQyxDQUFDO0FBRTFGLFFBQUEsNkJBQTZCLEdBQVcsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLDZCQUE2QixDQUFDO0lBQ3JHLENBQUMsQ0FBQyxJQUFJO0lBQ04sQ0FBQyxDQUFDLGdCQUFnQixDQUFDLCtCQUErQixFQUFFLE9BQU8sQ0FBQyxHQUFHLENBQUMsNkJBQTZCLEVBQUUsVUFBVSxDQUFDLE9BQU8sQ0FBQyxDQUFDO0FBRTFHLFFBQUEsNEJBQTRCLEdBQUcsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLDRCQUE0QixDQUFDO0lBQzNGLENBQUMsQ0FBQyxJQUFJO0lBQ04sQ0FBQyxDQUFDLGdCQUFnQixDQUFDLDhCQUE4QixFQUFFLE9BQU8sQ0FBQyxHQUFHLENBQUMsNEJBQTRCLEVBQUUsVUFBVSxDQUFDLE9BQU8sQ0FBQyxDQUFDO0FBRXJILDhEQUE4RDtBQUNqRCxRQUFBLGlDQUFpQyxHQUFXLENBQUMsQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxpQ0FBaUMsQ0FBQztJQUM3RyxDQUFDLENBQUMsc0NBQTBCO0lBQzVCLENBQUMsQ0FBQyxnQkFBZ0IsQ0FDWixtQ0FBbUMsRUFDbkMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxpQ0FBaUMsRUFDN0MsVUFBVSxDQUFDLE9BQU8sQ0FDckIsQ0FBQztBQUVSLHVEQUF1RDtBQUN2RCwwQ0FBMEM7QUFDN0IsUUFBQSx5QkFBeUIsR0FBWSxDQUFDLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMseUJBQXlCLENBQUM7SUFDOUYsQ0FBQyxDQUFDLEtBQUs7SUFDUCxDQUFDLENBQUMsZ0JBQWdCLENBQUMsMkJBQTJCLEVBQUUsT0FBTyxDQUFDLEdBQUcsQ0FBQyx5QkFBeUIsRUFBRSxVQUFVLENBQUMsT0FBTyxDQUFDLENBQUM7QUFFbEcsUUFBQSxlQUFlLEdBQVcsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLGVBQWUsQ0FBQztJQUN6RSxDQUFDLENBQUMsSUFBSTtJQUNOLENBQUMsQ0FBQyxnQkFBZ0IsQ0FBQyxpQkFBaUIsRUFBRSxPQUFPLENBQUMsR0FBRyxDQUFDLGVBQWUsRUFBRSxVQUFVLENBQUMsSUFBSSxDQUFDLENBQUM7QUFFeEYsc0JBQXNCO0FBQ1QsUUFBQSx1QkFBdUIsR0FBVyxDQUFDLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsdUJBQXVCLENBQUM7SUFDekYsQ0FBQyxDQUFDLDJDQUErQjtJQUNqQyxDQUFDLENBQUMsZ0JBQWdCLENBQUMseUJBQXlCLEVBQUUsT0FBTyxDQUFDLEdBQUcsQ0FBQyx1QkFBdUIsRUFBRSxVQUFVLENBQUMsR0FBRyxDQUFDLENBQUM7QUFFMUYsUUFBQSxpQkFBaUIsR0FBdUIsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLGlCQUFpQixDQUFDO0lBQ3pGLENBQUMsQ0FBQyxTQUFTO0lBQ1gsQ0FBQyxDQUFDLGdCQUFnQixDQUFDLG1CQUFtQixFQUFFLE9BQU8sQ0FBQyxHQUFHLENBQUMsaUJBQWlCLEVBQUUsVUFBVSxDQUFDLGNBQWMsQ0FBQyxDQUFDO0FBRXpGLFFBQUEsY0FBYyxHQUF1QixDQUFDLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsY0FBYyxDQUFDO0lBQ25GLENBQUMsQ0FBQyxTQUFTO0lBQ1gsQ0FBQyxDQUFDLGdCQUFnQixDQUFDLGdCQUFnQixFQUFFLE9BQU8sQ0FBQyxHQUFHLENBQUMsY0FBYyxFQUFFLFVBQVUsQ0FBQyxJQUFJLENBQUMsQ0FBQztBQUV0RiwwQ0FBMEM7QUFDN0IsUUFBQSxtQkFBbUIsR0FBWSxDQUFDLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsbUJBQW1CLENBQUM7SUFDbEYsQ0FBQyxDQUFDLEtBQUs7SUFDUCxDQUFDLENBQUMsZ0JBQWdCLENBQUMscUJBQXFCLEVBQUUsT0FBTyxDQUFDLEdBQUcsQ0FBQyxtQkFBbUIsRUFBRSxVQUFVLENBQUMsT0FBTyxDQUFDLENBQUM7QUFFdEYsUUFBQSw2QkFBNkIsR0FBVyxDQUFDLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsNkJBQTZCLENBQUM7SUFDckcsQ0FBQyxDQUFDLEVBQUU7SUFDSixDQUFDLENBQUMsZ0JBQWdCLENBQUMsK0JBQStCLEVBQUUsT0FBTyxDQUFDLEdBQUcsQ0FBQyw2QkFBNkIsRUFBRSxVQUFVLENBQUMsT0FBTyxDQUFDLENBQUM7QUFFMUcsUUFBQSx3QkFBd0IsR0FBc0I7SUFDdkQsUUFBUSxFQUFFLGlCQUFTO0lBQ25CLG1CQUFtQixFQUFFLDZCQUFxQjtJQUMxQyxlQUFlLEVBQUUsNEJBQWdCO0lBQ2pDLG9CQUFvQixFQUFFLCtCQUF1QjtJQUM3QyxrQkFBa0IsRUFBRSw0QkFBb0I7SUFDeEMsdUJBQXVCLEVBQUUsaUNBQXlCO0lBQ2xELGNBQWMsRUFBRSx1QkFBZTtJQUMvQixjQUFjLEVBQUUsd0JBQVk7Q0FDL0IsQ0FBQztBQUVXLFFBQUEsd0JBQXdCLEdBQUcsQ0FDcEMsQ0FBQyxjQUF1QyxFQUFFLEVBQUUsQ0FDNUMsQ0FBQyxZQUFvQixFQUFjLEVBQUU7SUFDakMsTUFBTSxVQUFVLEdBQUcsY0FBYyxDQUFDLEdBQUcsQ0FBQyxZQUFZLENBQUMsQ0FBQztJQUNwRCxJQUFJLENBQUMsVUFBVSxFQUFFO1FBQ2IsTUFBTSxJQUFJLEtBQUssQ0FBQyxjQUFjLFlBQVksa0JBQWtCLENBQUMsQ0FBQztLQUNqRTtJQUNELE9BQU8sVUFBVSxDQUFDO0FBQ3RCLENBQUMsQ0FDSixDQUFDLHVCQUF1QixDQUFDLHVCQUFlLEVBQUUsY0FBYyxDQUFDLENBQUMsQ0FBQztBQUU1RDs7R0FFRztBQUNVLFFBQUEsd0JBQXdCLEdBQUcsQ0FDcEMsQ0FBQyxjQUF1QyxFQUFFLEVBQUUsQ0FDNUMsQ0FBQyxNQUFjLEVBQXNCLEVBQUU7SUFDbkMsTUFBTSxVQUFVLEdBQUcsY0FBYyxDQUFDLEdBQUcsQ0FBQyxNQUFNLENBQUMsQ0FBQztJQUM5QyxPQUFPLFVBQVUsYUFBVixVQUFVLHVCQUFWLFVBQVUsQ0FBRSxZQUFZLENBQUM7QUFDcEMsQ0FBQyxDQUNKLENBQUMsdUJBQXVCLENBQUMsdUJBQWUsRUFBRSxTQUFTLENBQUMsQ0FBQyxDQUFDO0FBRXZEOzs7Ozs7O0dBT0c7QUFDSCxTQUFTLHVCQUF1QixDQUM1QixXQUEyQixFQUMzQixLQUFpQztJQUVqQyxNQUFNLE1BQU0sR0FBRyxJQUFJLEdBQUcsRUFBc0IsQ0FBQztJQUM3QyxXQUFXLENBQUMsT0FBTyxDQUFDLENBQUMsVUFBVSxFQUFFLEVBQUU7UUFDL0IsSUFBSSxPQUFpQixDQUFDO1FBQ3RCLFFBQVEsS0FBSyxFQUFFO1lBQ1gsS0FBSyxTQUFTO2dCQUNWLE9BQU8sR0FBRyxVQUFVLENBQUMsT0FBTyxDQUFDO2dCQUM3QixNQUFNO1lBQ1YsS0FBSyxjQUFjO2dCQUNmLE9BQU8sR0FBRyxDQUFDLFVBQVUsQ0FBQyxZQUFZLENBQUMsQ0FBQztnQkFDcEMsTUFBTTtZQUNWO2dCQUNJLE1BQU0sSUFBSSxLQUFLLENBQUMsY0FBYyxLQUFLLG9CQUFvQixDQUFDLENBQUM7U0FDaEU7UUFDRCxPQUFPLENBQUMsT0FBTyxDQUFDLENBQUMsTUFBTSxFQUFFLEVBQUU7WUFDdkIsTUFBTSxDQUFDLEdBQUcsQ0FBQyxNQUFNLEVBQUUsVUFBVSxDQUFDLENBQUM7UUFDbkMsQ0FBQyxDQUFDLENBQUM7SUFDUCxDQUFDLENBQUMsQ0FBQztJQUNILE9BQU8sTUFBTSxDQUFDO0FBQ2xCLENBQUM7QUFFRDs7R0FFRztBQUNVLFFBQUEsZ0NBQWdDLEdBQVcsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLGdDQUFnQyxDQUFDO0lBQzNHLENBQUMsQ0FBQyxFQUFFO0lBQ0osQ0FBQyxDQUFDLGdCQUFnQixDQUNaLGtDQUFrQyxFQUNsQyxPQUFPLENBQUMsR0FBRyxDQUFDLGdDQUFnQyxFQUM1QyxVQUFVLENBQUMsR0FBRyxDQUNqQixDQUFDO0FBRVI7Ozs7Ozs7Ozs7R0FVRztBQUNILFNBQVMsYUFBYSxDQUFJLE1BQWMsRUFBRSxVQUFzQixFQUFFLFFBQVc7SUFDekUsTUFBTSxTQUFTLEdBQUcsT0FBTyxDQUFDLEdBQUcsQ0FBQyxNQUFNLENBQUMsQ0FBQztJQUN0QyxJQUFJLFNBQVMsS0FBSyxTQUFTLElBQUksQ0FBQyxDQUFDLE9BQU8sQ0FBQyxTQUFTLENBQUMsRUFBRTtRQUNqRCxPQUFPLFFBQVEsQ0FBQztLQUNuQjtJQUVELCtDQUErQztJQUMvQyxJQUFJLEVBQUUsQ0FBQyxVQUFVLENBQUMsU0FBUyxDQUFDLEVBQUU7UUFDMUIsT0FBTyxJQUFJLENBQUMsS0FBSyxDQUFDLEVBQUUsQ0FBQyxZQUFZLENBQUMsU0FBUyxFQUFFLE1BQU0sQ0FBQyxDQUFDLENBQUM7S0FDekQ7SUFFRCxPQUFPLGdCQUFnQixDQUFDLE1BQU0sRUFBRSxPQUFPLENBQUMsR0FBRyxDQUFDLE1BQU0sQ0FBQyxFQUFFLFVBQVUsQ0FBQyxDQUFDO0FBQ3JFLENBQUM7QUFFRCw2REFBNkQ7QUFDN0QsOERBQThEO0FBQzlELFNBQVMsZ0JBQWdCLENBQUMsSUFBWSxFQUFFLEtBQVUsRUFBRSxZQUF3QjtJQUN4RSxJQUFJLFdBQVcsQ0FBQztJQUNoQixRQUFRLFlBQVksRUFBRTtRQUNsQixLQUFLLFVBQVUsQ0FBQyxJQUFJO1lBQ2hCLFdBQVcsR0FBRyxRQUFRLENBQUMsS0FBSyxFQUFFLEVBQUUsQ0FBQyxDQUFDO1lBQ2xDLDZEQUE2RDtZQUM3RCxnREFBZ0Q7WUFDaEQsTUFBTSxhQUFhLEdBQUcsV0FBVyxJQUFJLENBQUMsSUFBSSxXQUFXLElBQUksS0FBSyxDQUFDO1lBQy9ELElBQUksS0FBSyxDQUFDLFdBQVcsQ0FBQyxJQUFJLENBQUMsYUFBYSxFQUFFO2dCQUN0QyxNQUFNLElBQUksS0FBSyxDQUFDLEdBQUcsSUFBSSxzQ0FBc0MsS0FBSyxHQUFHLENBQUMsQ0FBQzthQUMxRTtZQUNELE9BQU8sV0FBVyxDQUFDO1FBQ3ZCLEtBQUssVUFBVSxDQUFDLE9BQU8sQ0FBQztRQUN4QixLQUFLLFVBQVUsQ0FBQyxnQkFBZ0IsQ0FBQztRQUNqQyxLQUFLLFVBQVUsQ0FBQyxPQUFPO1lBQ25CLFdBQVcsR0FBRyxRQUFRLENBQUMsS0FBSyxFQUFFLEVBQUUsQ0FBQyxDQUFDO1lBQ2xDLElBQUksS0FBSyxDQUFDLFdBQVcsQ0FBQyxFQUFFO2dCQUNwQixNQUFNLElBQUksS0FBSyxDQUFDLEdBQUcsSUFBSSxtQ0FBbUMsS0FBSyxHQUFHLENBQUMsQ0FBQzthQUN2RTtZQUNELE9BQU8sV0FBVyxDQUFDO1FBQ3ZCLEtBQUssVUFBVSxDQUFDLGFBQWE7WUFDekIsZUFBTSxDQUFDLGVBQWUsQ0FBQyxJQUFJLEVBQUUsS0FBSyxDQUFDLENBQUM7WUFDcEMsT0FBTyxLQUFLLENBQUM7UUFDakIsS0FBSyxVQUFVLENBQUMsR0FBRztZQUNmLGVBQU0sQ0FBQyxLQUFLLENBQUMsSUFBSSxFQUFFLEtBQUssQ0FBQyxDQUFDO1lBQzFCLE9BQU8sS0FBSyxDQUFDO1FBQ2pCLEtBQUssVUFBVSxDQUFDLE9BQU87WUFDbkIsZUFBTSxDQUFDLFFBQVEsQ0FBQyxJQUFJLEVBQUUsS0FBSyxDQUFDLENBQUM7WUFDN0IsNkRBQTZEO1lBQzdELGdEQUFnRDtZQUNoRCxNQUFNLE9BQU8sR0FBSSxLQUFnQixDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQztZQUM3QyxPQUFPLENBQUMsT0FBTyxDQUFDLENBQUMsR0FBRyxFQUFFLENBQUMsRUFBRSxFQUFFLENBQUMsZUFBTSxDQUFDLEtBQUssQ0FBQyxHQUFHLElBQUksSUFBSSxDQUFDLEdBQUcsRUFBRSxHQUFHLENBQUMsQ0FBQyxDQUFDO1lBQ2hFLE9BQU8sT0FBTyxDQUFDO1FBQ25CLEtBQUssVUFBVSxDQUFDLE9BQU87WUFDbkIsT0FBTyxLQUFLLEtBQUssTUFBTSxDQUFDO1FBQzVCLEtBQUssVUFBVSxDQUFDLFVBQVU7WUFDdEIsV0FBVyxHQUFHLElBQUksaUJBQVMsQ0FBQyxVQUFVLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQztZQUMvQyxJQUFJLFdBQVcsQ0FBQyxLQUFLLEVBQUUsSUFBSSxXQUFXLENBQUMsVUFBVSxFQUFFLEVBQUU7Z0JBQ2pELE1BQU0sSUFBSSxLQUFLLENBQUMsR0FBRyxJQUFJLHVDQUF1QyxDQUFDLENBQUM7YUFDbkU7WUFDRCxPQUFPLFdBQVcsQ0FBQztRQUN2QixLQUFLLFVBQVUsQ0FBQyxJQUFJO1lBQ2hCLFdBQVcsR0FBRyxVQUFVLENBQUMsS0FBSyxDQUFDLENBQUM7WUFDaEMsSUFBSSxXQUFXLEdBQUcsQ0FBQyxJQUFJLFdBQVcsR0FBRyxDQUFDLEVBQUU7Z0JBQ3BDLE1BQU0sSUFBSSxLQUFLLENBQUMsR0FBRyxJQUFJLDRDQUE0QyxDQUFDLENBQUM7YUFDeEU7WUFDRCxPQUFPLFdBQVcsQ0FBQztRQUN2QixLQUFLLFVBQVUsQ0FBQyxXQUFXO1lBQ3ZCLGVBQU0sQ0FBQyxRQUFRLENBQUMsSUFBSSxFQUFFLEtBQUssQ0FBQyxDQUFDO1lBQzdCLDZEQUE2RDtZQUM3RCxnREFBZ0Q7WUFDaEQsTUFBTSxXQUFXLEdBQUksS0FBZ0IsQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxDQUFDLENBQUMsV0FBVyxFQUFFLENBQUMsQ0FBQztZQUM3RSxXQUFXLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxFQUFFLENBQUMsZUFBTSxDQUFDLGVBQWUsQ0FBQyxHQUFHLElBQUksSUFBSSxDQUFDLEdBQUcsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBQzFFLE9BQU8sV0FBVyxDQUFDO1FBQ3ZCLEtBQUssVUFBVSxDQUFDLFVBQVU7WUFDdEIsZUFBTSxDQUFDLFFBQVEsQ0FBQyxJQUFJLEVBQUUsS0FBSyxDQUFDLENBQUM7WUFDN0IsNkRBQTZEO1lBQzdELGdEQUFnRDtZQUNoRCxNQUFNLFVBQVUsR0FBSSxLQUFnQixDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQztZQUNoRCxPQUFPLFVBQVUsQ0FBQztRQUN0QixLQUFLLFVBQVUsQ0FBQyxrQkFBa0I7WUFDOUIsT0FBTyxHQUFHLENBQUM7UUFDZixLQUFLLFVBQVUsQ0FBQyxjQUFjO1lBQzFCLGVBQU0sQ0FBQyxRQUFRLENBQUMsSUFBSSxFQUFFLEtBQUssQ0FBQyxDQUFDO1lBQzdCLElBQUksS0FBSyxLQUFLLEVBQUUsRUFBRTtnQkFDZCxNQUFNLElBQUksS0FBSyxDQUFDLEdBQUcsSUFBSSxtQkFBbUIsQ0FBQyxDQUFDO2FBQy9DO1lBQ0QsT0FBTyxLQUFLLENBQUM7UUFDakIsS0FBSyxVQUFVLENBQUMsT0FBTztZQUNuQixlQUFNLENBQUMsUUFBUSxDQUFDLElBQUksRUFBRSxLQUFLLENBQUMsQ0FBQztZQUM3Qiw2REFBNkQ7WUFDN0QsZ0RBQWdEO1lBQ2hELE1BQU0sT0FBTyxHQUFJLEtBQWdCLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDO1lBQzdDLE9BQU8sQ0FBQyxPQUFPLENBQUMsQ0FBQyxNQUFNLEVBQUUsRUFBRTtnQkFDdkIsTUFBTSxXQUFXLEdBQUcsWUFBWSxDQUFDLE1BQU0sQ0FBQyxDQUFDO2dCQUN6QyxJQUFJLENBQUMsV0FBVyxFQUFFO29CQUNkLE1BQU0sSUFBSSxLQUFLLENBQUMsV0FBVyxNQUFNLHVCQUF1QixDQUFDLENBQUM7aUJBQzdEO1lBQ0wsQ0FBQyxDQUFDLENBQUM7WUFDSCxPQUFPLE9BQU8sQ0FBQztRQUNuQixLQUFLLFVBQVUsQ0FBQyxjQUFjO1lBQzFCLGVBQU0sQ0FBQyxRQUFRLENBQUMsSUFBSSxFQUFFLEtBQUssQ0FBQyxDQUFDO1lBQzdCLE9BQU8sSUFBSSxDQUFDLEtBQUssQ0FBQyxLQUFLLENBQUMsQ0FBQztRQUM3QixLQUFLLFVBQVUsQ0FBQyxzQkFBc0I7WUFDbEMsNkRBQTZEO1lBQzdELGdEQUFnRDtZQUNoRCxNQUFNLFNBQVMsR0FBMkIsSUFBSSxDQUFDLEtBQUssQ0FBQyxLQUFLLENBQUMsQ0FBQztZQUM1RCxpQ0FBaUM7WUFDakMsS0FBSyxNQUFNLGFBQWEsSUFBSSxTQUFTLEVBQUU7Z0JBQ25DLGVBQU0sQ0FBQyxRQUFRLENBQUMsdUJBQXVCLEVBQUUsYUFBYSxDQUFDLENBQUM7Z0JBRXhELE1BQU0sYUFBYSxHQUFHLFNBQVMsQ0FBQyxhQUFhLENBQUMsQ0FBQztnQkFDL0MsZUFBTSxDQUFDLE9BQU8sQ0FBQyw4Q0FBOEMsYUFBYSxHQUFHLEVBQUUsYUFBYSxDQUFDLENBQUM7Z0JBQzlGLGFBQWEsQ0FBQyxPQUFPLENBQUMsQ0FBQyxTQUFTLEVBQUUsQ0FBQyxFQUFFLEVBQUU7b0JBQ25DLGVBQU0sQ0FBQyxPQUFPLENBQUMsb0JBQW9CLENBQUMsdUJBQXVCLGFBQWEsRUFBRSxFQUFFLFNBQVMsQ0FBQyxDQUFDO29CQUN2RixlQUFNLENBQUMsTUFBTSxDQUNULFNBQVMsQ0FBQyxNQUFNLEtBQUssQ0FBQyxFQUN0QixvQkFBb0IsQ0FBQyx1QkFBdUIsYUFBYSw0Q0FBNEMsQ0FDeEcsQ0FBQztvQkFDRixlQUFNLENBQUMsZUFBZSxDQUNsQixzQ0FBc0MsQ0FBQyx1QkFBdUIsYUFBYSxFQUFFLEVBQzdFLFNBQVMsQ0FBQyxDQUFDLENBQUMsQ0FDZixDQUFDO29CQUNGLGVBQU0sQ0FBQyxlQUFlLENBQ2xCLHVDQUF1QyxDQUFDLHVCQUF1QixhQUFhLEVBQUUsRUFDOUUsU0FBUyxDQUFDLENBQUMsQ0FBQyxDQUNmLENBQUM7b0JBQ0YsZUFBTSxDQUFDLE1BQU0sQ0FDVCxTQUFTLENBQUMsQ0FBQyxDQUFDLEtBQUssU0FBUyxDQUFDLENBQUMsQ0FBQyxFQUM3QixvQkFBb0IsQ0FBQyx1QkFBdUIsYUFBYSx1QkFBdUIsQ0FDbkYsQ0FBQztnQkFDTixDQUFDLENBQUMsQ0FBQzthQUNOO1lBQ0QsT0FBTyxTQUFTLENBQUM7UUFDckIsS0FBSyxVQUFVLENBQUMseUJBQXlCO1lBQ3JDLDZEQUE2RDtZQUM3RCxnREFBZ0Q7WUFDaEQsTUFBTSxRQUFRLEdBQThCLElBQUksQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLENBQUM7WUFDOUQsaUNBQWlDO1lBQ2pDLEtBQUssTUFBTSxpQkFBaUIsSUFBSSxRQUFRLEVBQUU7Z0JBQ3RDLGVBQU0sQ0FBQyxlQUFlLENBQUMsNEJBQTRCLEVBQUUsaUJBQWlCLENBQUMsQ0FBQztnQkFFeEUsTUFBTSxFQUFFLE1BQU0sRUFBRSxHQUFHLFFBQVEsQ0FBQyxpQkFBaUIsQ0FBQyxDQUFDO2dCQUMvQyxlQUFNLENBQUMsT0FBTyxDQUFDLHFDQUFxQyxpQkFBaUIsRUFBRSxFQUFFLE1BQU0sQ0FBQyxDQUFDO2dCQUNqRixNQUFNLENBQUMsT0FBTyxDQUFDLENBQUMsS0FBSyxFQUFFLENBQUMsRUFBRSxFQUFFO29CQUN4QixlQUFNLENBQUMsZUFBZSxDQUFDLG9CQUFvQixDQUFDLDJCQUEyQixpQkFBaUIsRUFBRSxFQUFFLEtBQUssQ0FBQyxDQUFDO2dCQUN2RyxDQUFDLENBQUMsQ0FBQztnQkFDSCxvREFBb0Q7Z0JBQ3BELG9GQUFvRjthQUN2RjtZQUNELE9BQU8sUUFBUSxDQUFDO1FBRXBCO1lBQ0ksTUFBTSxJQUFJLEtBQUssQ0FBQyw0QkFBNEIsWUFBWSw2QkFBNkIsSUFBSSxHQUFHLENBQUMsQ0FBQztLQUNyRztBQUNMLENBQUMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiL1VzZXJzL2Rhdmlkd2Fsc2gvY29kZS1sb2NhbC8weC1yZnEtYXBpL3NyYy9jb25maWcudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gdHNsaW50OmRpc2FibGU6Y3VzdG9tLW5vLW1hZ2ljLW51bWJlcnMgbWF4LWZpbGUtbGluZS1jb3VudFxyXG5pbXBvcnQgeyBIdHRwU2VydmljZUNvbmZpZyB9IGZyb20gJ0AweC9hcGktdXRpbHMnO1xyXG5pbXBvcnQgeyBhc3NlcnQgfSBmcm9tICdAMHgvYXNzZXJ0JztcclxuaW1wb3J0IHsgUmZxTWFrZXJBc3NldE9mZmVyaW5ncyB9IGZyb20gJ0AweC9hc3NldC1zd2FwcGVyL2xpYi9zcmMvdHlwZXMnO1xyXG5pbXBvcnQgeyBMaXF1aWRpdHlQcm92aWRlclJlZ2lzdHJ5IH0gZnJvbSAnQDB4L2Fzc2V0LXN3YXBwZXIvbGliL3NyYy91dGlscy9tYXJrZXRfb3BlcmF0aW9uX3V0aWxzL3R5cGVzJztcclxuaW1wb3J0IHsgQ2hhaW5JZCB9IGZyb20gJ0AweC9jb250cmFjdC1hZGRyZXNzZXMnO1xyXG5pbXBvcnQgeyBCaWdOdW1iZXIgfSBmcm9tICdAMHgvdXRpbHMnO1xyXG5pbXBvcnQgKiBhcyBmcyBmcm9tICdmcyc7XHJcbmltcG9ydCAqIGFzIF8gZnJvbSAnbG9kYXNoJztcclxuaW1wb3J0ICogYXMgdmFsaWRhdGVVVUlEIGZyb20gJ3V1aWQtdmFsaWRhdGUnO1xyXG5cclxuaW1wb3J0IHtcclxuICAgIERFRkFVTFRfQkFDS0dST1VORF9KT0JfVFlQRVMsXHJcbiAgICBERUZBVUxUX0VUSF9HQVNfU1RBVElPTl9BUElfVVJMLFxyXG4gICAgREVGQVVMVF9FWFBFQ1RFRF9NSU5FRF9TRUMsXHJcbiAgICBERUZBVUxUX0xPQ0FMX1BPU1RHUkVTX1VSSSxcclxuICAgIERFRkFVTFRfTE9DQUxfUkVESVNfVVJJLFxyXG4gICAgREVGQVVMVF9MT0dHRVJfSU5DTFVERV9USU1FU1RBTVAsXHJcbiAgICBERUZBVUxUX1NFTlRSWV9FTlZJUk9OTUVOVCxcclxuICAgIEhFQUxUSENIRUNLX1BBVEgsXHJcbiAgICBNRVRSSUNTX1BBVEgsXHJcbiAgICBOVUxMX0FERFJFU1MsXHJcbiAgICBPTkVfTUlOVVRFX01TLFxyXG59IGZyb20gJy4vY29yZS9jb25zdGFudHMnO1xyXG5pbXBvcnQgeyBzY2hlbWFzIH0gZnJvbSAnLi9jb3JlL3NjaGVtYXMnO1xyXG5pbXBvcnQgeyBGZWVNb2RlbFZlcnNpb24gfSBmcm9tICcuL2NvcmUvdHlwZXMnO1xyXG5pbXBvcnQgeyB0b1BhaXJTdHJpbmcgfSBmcm9tICcuL2NvcmUvcGFpcl91dGlscyc7XHJcbmltcG9ydCB7IHNjaGVtYVV0aWxzIH0gZnJvbSAnLi9jb3JlL3NjaGVtYV91dGlscyc7XHJcblxyXG4vLyB0c2xpbnQ6ZGlzYWJsZTpuby1iaXR3aXNlXHJcblxyXG5lbnVtIEVudlZhclR5cGUge1xyXG4gICAgQWRkcmVzc0xpc3QsXHJcbiAgICBTdHJpbmdMaXN0LFxyXG4gICAgSW50ZWdlcixcclxuICAgIFBvcnQsXHJcbiAgICBLZWVwQWxpdmVUaW1lb3V0LFxyXG4gICAgQ2hhaW5JZCxcclxuICAgIEVUSEFkZHJlc3NIZXgsXHJcbiAgICBVbml0QW1vdW50LFxyXG4gICAgUmF0ZSxcclxuICAgIFVybCxcclxuICAgIFVybExpc3QsXHJcbiAgICBXaGl0ZWxpc3RBbGxUb2tlbnMsXHJcbiAgICBCb29sZWFuLFxyXG4gICAgTm9uRW1wdHlTdHJpbmcsXHJcbiAgICBBUElLZXlzLFxyXG4gICAgUHJpdmF0ZUtleXMsXHJcbiAgICBSZnFNYWtlckFzc2V0T2ZmZXJpbmdzLFxyXG4gICAgTGlxdWlkaXR5UHJvdmlkZXJSZWdpc3RyeSxcclxuICAgIEpzb25TdHJpbmdMaXN0LFxyXG59XHJcblxyXG4vKipcclxuICogVmFsdWVzIHJlYWQgZnJvbSBjb25maWd1cmF0aW9uIGZpbGVzIHdoaWNoIGVuYWJsZVxyXG4gKiByZnEtYXBpIHRvIG9wZXJhdGUgb24gYSBjaGFpbi5cclxuICovXHJcbmV4cG9ydCBpbnRlcmZhY2UgQ2hhaW5Db25maWd1cmF0aW9uIHtcclxuICAgIGNoYWluSWQ6IG51bWJlcjtcclxuICAgIGdhc1N0YXRpb25Vcmw6IHN0cmluZztcclxuICAgIG5hbWU6IHN0cmluZzsgLy8gaHVtYW4gcmVhZGFibGUsIGZvciBsb2dnaW5nIGFuZCBzdWNoXHJcbiAgICByZWdpc3RyeUFkZHJlc3M6IHN0cmluZztcclxuICAgIHJwY1VybDogc3RyaW5nO1xyXG4gICAgc3FzVXJsOiBzdHJpbmc7XHJcbiAgICB6ZXJvRXhDbGllbnRCYXNlVXJsOiBzdHJpbmc7XHJcbiAgICAvLyBFbmFibGVzIGNhY2hpbmcgZm9yIG1ha2VyIGJhbGFuY2VzIG9uIG9ic2VydmVkIHRva2Vuc1xyXG4gICAgZW5hYmxlTWFrZXJCYWxhbmNlQ2FjaGU/OiBib29sZWFuO1xyXG4gICAgLy8gVXNlIHRoaXMgY29uZmlnIHRvIG92ZXJyaWRlIHRoZSAweCBFeGNoYW5nZSBQcm94eSBjb250cmFjdCBhZGRyZXNzLlxyXG4gICAgLy8gVGhlcmUgbWlnaHQgYmUgYSBjYXNlIHdoZW4gd2Ugd2FudCBhIGRpZmZlcmVudCBleGNoYW5nZVxyXG4gICAgLy8gcHJveHkgY29udHJhY3QgdGhhbiB3aGF0IGlzIGRlZmluZWQgZnJvbSBAMHgvY29udHJhY3QtYWRkcmVzc2VzIHJlcG8uXHJcbiAgICAvL1xyXG4gICAgLy8gaS5lLiB0ZXN0aW5nIGEgbmV3IGZlYXR1cmUgdGhhdCBoYXNuJ3QgYmVlbiBkZXBsb3llZCB0byB0aGUgb2ZmaWNpYWxcclxuICAgIC8vIGNvbnRyYWN0IHlldFxyXG4gICAgZXhjaGFuZ2VQcm94eUNvbnRyYWN0QWRkcmVzc092ZXJyaWRlPzogc3RyaW5nO1xyXG4gICAgLy8gU2VydmljZSBjb25maWd1cmF0aW9uIG5lZWRzIHRvIGJlIHByZXNlbnQgdG8gcnVuIHRoZSBjb3JyZXNwb25kaW5nIHNlcnZpY2UuXHJcbiAgICBnYXNsZXNzPzoge1xyXG4gICAgICAgIG1ldGFUcmFuc2FjdGlvblNlcnZpY2VVcmw6IHN0cmluZztcclxuICAgIH07XHJcbiAgICByZnFtPzoge1xyXG4gICAgICAgIG1pbkV4cGlyeUR1cmF0aW9uTXM/OiBudW1iZXI7XHJcbiAgICAgICAgcXVvdGVSZXBvcnRUb3BpYz86IHN0cmluZztcclxuICAgICAgICBmZWVNb2RlbFZlcnNpb24/OiBGZWVNb2RlbFZlcnNpb247XHJcbiAgICB9O1xyXG4gICAgcmZxdD86IHtcclxuICAgICAgICBtaW5FeHBpcnlEdXJhdGlvbk1zPzogbnVtYmVyO1xyXG4gICAgICAgIGZlZUV2ZW50VG9waWM/OiBzdHJpbmc7XHJcbiAgICAgICAgZmVlTW9kZWxWZXJzaW9uPzogRmVlTW9kZWxWZXJzaW9uO1xyXG4gICAgfTtcclxuICAgIHdvcmtlcj86IHtcclxuICAgICAgICAvLyBUaGUgdmFsdWUgb2YgdGhlIFwidGlwXCIgdGhlIHdvcmtlciB3aWxsIHVzZSB3aGVuIGl0IHN0YXJ0c1xyXG4gICAgICAgIC8vIHN1Ym1pdHRpbmcgdHJhbnNhY3Rpb25zXHJcbiAgICAgICAgaW5pdGlhbE1heFByaW9yaXR5RmVlUGVyR2FzR3dlaTogbnVtYmVyO1xyXG4gICAgICAgIC8vIFRoZSBtYXggZmVlIHBlciBnYXMgKGluIGd3ZWkpIHRoZSB3b3JrZXIgaXMgd2lsbGluZyB0byBwYXkgZm9yIGEgdHJhbnNhY3Rpb25cclxuICAgICAgICBtYXhGZWVQZXJHYXNDYXBHd2VpOiBudW1iZXI7XHJcbiAgICAgICAgLy8gVXNlIHRoaXMgY29uZmlnIHRvIGNoYW5nZSB0aGUgc2xlZXAgdGltZSBiZXR3ZWVuIGEgdHJhbnNhY2lvbidzIG9uLWNoYWluIHN0YXR1cyBjaGVjay5cclxuICAgICAgICAvLyBZb3Ugc2hvdWxkIHNldCB0aGUgc2xlZXAgdGltZSBjbG9zZSB0byB0aGUgY2hhaW4ncyBibG9jayB0aW1lLlxyXG4gICAgICAgIC8vIFRoZSBzbWFsbGVyIHNsZWVwIHRpbWUsIHRoZSBtb3JlIGZyZXF1ZW50IGEgdHJhbnNhY3Rpb24gaXMgY2hlY2tlZCB0byBzZWUgaXQgaGFzIGJlZW5cclxuICAgICAgICAvLyBzZXR0bGVkIG9uLWNoYWluIGJ1dCBpdCBhbHNvIGNvbnN1bWVzIG1vcmUgUlBDIGNhbGxzLlxyXG4gICAgICAgIHRyYW5zYWN0aW9uV2F0Y2hlclNsZWVwVGltZU1zPzogbnVtYmVyO1xyXG4gICAgICAgIGVuYWJsZUFjY2Vzc0xpc3Q/OiBib29sZWFuO1xyXG4gICAgfTtcclxufVxyXG5cclxuZXhwb3J0IHR5cGUgQ2hhaW5Db25maWd1cmF0aW9ucyA9IENoYWluQ29uZmlndXJhdGlvbltdO1xyXG5cclxuLyoqXHJcbiAqIENvbmZpZ3VyYXRpb24gd2hpY2ggY29udGFpbnMgaW5mb3JtYXRpb24gYWJvdXQgY2hhaW5zIGFuZFxyXG4gKiByZWxhdGVkIHJlc291cmNlcywgbGlrZSB0aGUgUlBDIHVybC5cclxuICovXHJcbmV4cG9ydCBjb25zdCBDSEFJTl9DT05GSUdVUkFUSU9OUzogQ2hhaW5Db25maWd1cmF0aW9ucyA9ICgoKSA9PiB7XHJcbiAgICBsZXQgcmVzdWx0OiBDaGFpbkNvbmZpZ3VyYXRpb25zO1xyXG4gICAgdHJ5IHtcclxuICAgICAgICByZXN1bHQgPSByZXNvbHZlRW52VmFyPENoYWluQ29uZmlndXJhdGlvbnM+KCdDSEFJTl9DT05GSUdVUkFUSU9OUycsIEVudlZhclR5cGUuSnNvblN0cmluZ0xpc3QsIFtdKTtcclxuICAgICAgICBzY2hlbWFVdGlscy52YWxpZGF0ZVNjaGVtYShyZXN1bHQsIHNjaGVtYXMuY2hhaW5Db25maWd1cmF0aW9uc1NjaGVtYSk7XHJcbiAgICB9IGNhdGNoIChlKSB7XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBDSEFJTl9DT05GSUdVUkFUSU9OUyB3YXMgZGVmaW5lZCBidXQgaXMgbm90IHZhbGlkIEpTT04gcGVyIHRoZSBzY2hlbWE6ICR7ZX1gKTtcclxuICAgIH1cclxuICAgIHJldHVybiByZXN1bHQ7XHJcbn0pKCk7XHJcblxyXG4vKipcclxuICogVmFsdWVzIHJlYWQgZnJvbSBjb25maWd1cmF0aW9uIGZpbGVzIHdoaWNoIHByb3ZpZGVcclxuICogcGVyIHBhaXIgZmVlIG1vZGVsIGNvbnN0YW50cy5cclxuICovXHJcbmV4cG9ydCBpbnRlcmZhY2UgRmVlTW9kZWxDb25maWd1cmF0aW9uIHtcclxuICAgIG1hcmdpblJha2VSYXRpbzogbnVtYmVyOyAvLyBSYWtlIGJhc2VkIG9uIG1hcmdpbiBiZXR3ZWVuIFJGUW0gYW5kIEFNTSBwcmljZXMuIEUuZy4gbWFyZ2luUmFrZVJhdGlvID0gMC41IGlmIHdlIHdhbnQgdG8gY2hhcmdlIDUwJSBvZiB0aGUgbWFyZ2luLlxyXG4gICAgdHJhZGVTaXplQnBzOiBudW1iZXI7IC8vIEJhc2UgcG9pbnRzIG9mIGZlZSBiYXNlZCBvbiB0cmFkZSBzaXplLiAxIGJwcyA9IDAuMDElLlxyXG59XHJcblxyXG4vKipcclxuICogVGhpcyBpbnRlcmZhY2UgaXMgdXNlZCB0byByZXByZXNlbnQgYW4gaW5kaXZpZHVhbCBKU09OIG9iamVjdCBmb3IgYSBnaXZlbiBjaGFpbiBhbmQgcGFpci5cclxuICogSXQgaXMgb25seSB1c2VkIHdoZW4gd2UgcmVhZCB0aGUgSlNPTiBvYmplY3QgZnJvbSBhIGZpbGUsIGFuZCBzaG91bGQgbm90IGJlIHVzZWQgZWxzZXdoZXJlLlxyXG4gKi9cclxuaW50ZXJmYWNlIEZlZU1vZGVsQ29uZmlndXJhdGlvbldpdGhLZXkgZXh0ZW5kcyBGZWVNb2RlbENvbmZpZ3VyYXRpb24ge1xyXG4gICAgY2hhaW5JZDogbnVtYmVyO1xyXG4gICAgdG9rZW5BOiBzdHJpbmc7XHJcbiAgICB0b2tlbkI6IHN0cmluZztcclxufVxyXG5cclxuZXhwb3J0IHR5cGUgRmVlTW9kZWxDb25maWd1cmF0aW9uTWFwID0gTWFwPG51bWJlciwgTWFwPHN0cmluZywgRmVlTW9kZWxDb25maWd1cmF0aW9uPj47XHJcblxyXG4vKipcclxuICogQSBuZXN0ZWQgbWFwIHByb3ZpZGluZyBmZWUgbW9kZWwgY29uc3RhbnRzIGZvciBlYWNoIHRva2VuIHBhaXIuXHJcbiAqIFVzZSBjaGFpbklkIGFzIGZpcnN0IGtleSBhbmQgcGFpciBrZXkgYXMgdGhlIHNlY29uZCBrZXkuXHJcbiAqL1xyXG5leHBvcnQgY29uc3QgRkVFX01PREVMX0NPTkZJR1VSQVRJT05fTUFQOiBGZWVNb2RlbENvbmZpZ3VyYXRpb25NYXAgPSAoKCkgPT4ge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCBmZWVNb2RlbENvbmZpZ3VyYXRpb25zOiBGZWVNb2RlbENvbmZpZ3VyYXRpb25XaXRoS2V5W10gPSByZXNvbHZlRW52VmFyPEZlZU1vZGVsQ29uZmlndXJhdGlvbldpdGhLZXlbXT4oXHJcbiAgICAgICAgICAgICdGRUVfTU9ERUxfQ09ORklHVVJBVElPTlMnLFxyXG4gICAgICAgICAgICBFbnZWYXJUeXBlLkpzb25TdHJpbmdMaXN0LFxyXG4gICAgICAgICAgICBbXSxcclxuICAgICAgICApO1xyXG4gICAgICAgIHNjaGVtYVV0aWxzLnZhbGlkYXRlU2NoZW1hKGZlZU1vZGVsQ29uZmlndXJhdGlvbnMsIHNjaGVtYXMuZmVlTW9kZWxDb25maWd1cmF0aW9uc1NjaGVtYSk7XHJcblxyXG4gICAgICAgIHJldHVybiBmZWVNb2RlbENvbmZpZ3VyYXRpb25zLnJlZHVjZSgoYWNjLCBjdXJyKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHsgY2hhaW5JZCwgdG9rZW5BLCB0b2tlbkIsIG1hcmdpblJha2VSYXRpbywgdHJhZGVTaXplQnBzIH0gPSBjdXJyO1xyXG4gICAgICAgICAgICBpZiAoIWFjYy5oYXMoY2hhaW5JZCkpIHtcclxuICAgICAgICAgICAgICAgIGFjYy5zZXQoY2hhaW5JZCwgbmV3IE1hcDxzdHJpbmcsIEZlZU1vZGVsQ29uZmlndXJhdGlvbj4oKSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy8gJGVzbGludC1maXgtbWUgaHR0cHM6Ly9naXRodWIuY29tL3JoaW5vZGF2aWQvZXNsaW50LWZpeC1tZVxyXG4gICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLW5vbi1udWxsLWFzc2VydGlvblxyXG4gICAgICAgICAgICBhY2MuZ2V0KGNoYWluSWQpIS5zZXQodG9QYWlyU3RyaW5nKHRva2VuQSwgdG9rZW5CKSwgeyBtYXJnaW5SYWtlUmF0aW8sIHRyYWRlU2l6ZUJwcyB9KTtcclxuICAgICAgICAgICAgcmV0dXJuIGFjYztcclxuICAgICAgICB9LCBuZXcgTWFwPC8qIGNoYWluSWQgKi8gbnVtYmVyLCBNYXA8LyogcGFpcktleSAqLyBzdHJpbmcsIEZlZU1vZGVsQ29uZmlndXJhdGlvbj4+KCkpO1xyXG4gICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgRkVFX01PREVMX0NPTkZJR1VSQVRJT05TIHdhcyBkZWZpbmVkIGJ1dCBpcyBub3QgdmFsaWQgSlNPTiBwZXIgdGhlIHNjaGVtYTogJHtlfWApO1xyXG4gICAgfVxyXG59KSgpO1xyXG5cclxuZXhwb3J0IGNvbnN0IERFRkFVTFRfRkVFX01PREVMX0NPTkZJR1VSQVRJT046IEZlZU1vZGVsQ29uZmlndXJhdGlvbiA9IHsgbWFyZ2luUmFrZVJhdGlvOiAwLCB0cmFkZVNpemVCcHM6IDAgfTtcclxuXHJcbi8qKlxyXG4gKiBBIHRha2VyLWludGVncmF0b3Igb2YgdGhlIDB4IEFQSS5cclxuICovXHJcbmV4cG9ydCBpbnRlcmZhY2UgSW50ZWdyYXRvciB7XHJcbiAgICBhZmZpbGlhdGVBZGRyZXNzPzogc3RyaW5nOyAvLyBVc2VkIGlmIHByZXNlbnQgYW5kIG5vIGFmZmlsaWF0ZSBhZGRyZXNzIGlzIHNlbnQgaW4gdGhlIHF1b3RlIHJlcXVlc3RcclxuICAgIGFwaUtleXM6IHN0cmluZ1tdO1xyXG4gICAgaW50ZWdyYXRvcklkOiBzdHJpbmc7XHJcbiAgICAvKiBJRHMgZm9yIGNoYWlucyB0aGUgaW50ZWdyYXRvciBpcyBhbGxvd2VkIHRvIGFjY2VzcyBSRlEgbGlxdWlkaXR5IG9uICovXHJcbiAgICBhbGxvd2VkQ2hhaW5JZHM6IG51bWJlcltdO1xyXG4gICAgd2hpdGVsaXN0SW50ZWdyYXRvclVybHM/OiBzdHJpbmdbXTtcclxuICAgIHdoaXRlbGlzdE1ha2VySWRzPzogc3RyaW5nW107XHJcbiAgICBsYWJlbDogc3RyaW5nO1xyXG4gICAgcGxwOiBib29sZWFuO1xyXG4gICAgcmZxbTogYm9vbGVhbjtcclxuICAgIHJmcXQ6IGJvb2xlYW47XHJcbn1cclxuZXhwb3J0IHR5cGUgSW50ZWdyYXRvcnNBY2wgPSBJbnRlZ3JhdG9yW107XHJcblxyXG4vKipcclxuICogQ29uZmlndXJhdGlvbiB3aGljaCByZXByZXNlbnRzIHRha2VyLWludGVncmF0b3JzIG9mIHRoZSAweCBBUEkuIFRoZSBjb25maWd1cmF0aW9uIGNvbnRhaW5zIHRoZSBsYWJlbCwgaWQsXHJcbiAqIGFwaSBrZXlzLCBhbmQgYWxsb3dlZCBsaXF1aWRpdHkgc291cmNlcyBmb3IgZWFjaCBpbnRlZ3JhdG9yLlxyXG4gKi9cclxuZXhwb3J0IGNvbnN0IElOVEVHUkFUT1JTX0FDTDogSW50ZWdyYXRvcnNBY2wgPSAoKCkgPT4ge1xyXG4gICAgbGV0IGludGVncmF0b3JzOiBJbnRlZ3JhdG9yc0FjbDtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgaW50ZWdyYXRvcnMgPSByZXNvbHZlRW52VmFyPEludGVncmF0b3JzQWNsPignSU5URUdSQVRPUlNfQUNMJywgRW52VmFyVHlwZS5Kc29uU3RyaW5nTGlzdCwgW10pO1xyXG4gICAgICAgIHNjaGVtYVV0aWxzLnZhbGlkYXRlU2NoZW1hKGludGVncmF0b3JzLCBzY2hlbWFzLmludGVncmF0b3JzQWNsU2NoZW1hKTtcclxuICAgIH0gY2F0Y2ggKGUpIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYElOVEVHUkFUT1JTX0FDTCB3YXMgZGVmaW5lZCBidXQgaXMgbm90IHZhbGlkIEpTT04gcGVyIHRoZSBzY2hlbWE6ICR7ZX1gKTtcclxuICAgIH1cclxuICAgIHJldHVybiBpbnRlZ3JhdG9ycztcclxufSkoKTtcclxuXHJcbi8qKlxyXG4gKiBFeHRyYWN0cyB0aGUgaW50ZWdyYXRvciBBUEkga2V5cyBmcm9tIHRoZSBgSU5URUdSQVRPUlNfQUNMYCBlbnZpcm9ubWVudCB2YXJpYWJsZSBmb3IgdGhlIHByb3ZpZGVkIGdyb3VwIHR5cGUuXHJcbiAqL1xyXG5leHBvcnQgY29uc3QgZ2V0QXBpS2V5V2hpdGVsaXN0RnJvbUludGVncmF0b3JzQWNsID0gKGdyb3VwVHlwZTogJ3JmcXQnIHwgJ3BscCcgfCAncmZxbScpOiBzdHJpbmdbXSA9PiB7XHJcbiAgICByZXR1cm4gSU5URUdSQVRPUlNfQUNMLmZpbHRlcigoaSkgPT4gaVtncm91cFR5cGVdKVxyXG4gICAgICAgIC5mbGF0TWFwKChpKSA9PiBpLmFwaUtleXMpXHJcbiAgICAgICAgLnNvcnQoKTtcclxufTtcclxuXHJcbi8qKlxyXG4gKiBHZXRzIHRoZSBpbnRlZ3JhdG9yIElEIGZvciB0aGUgcHJvdmlkZWQgbGFiZWwuXHJcbiAqL1xyXG5leHBvcnQgY29uc3QgZ2V0SW50ZWdyYXRvcklkRnJvbUxhYmVsID0gKGxhYmVsOiBzdHJpbmcpOiBzdHJpbmcgfCB1bmRlZmluZWQgPT4ge1xyXG4gICAgZm9yIChjb25zdCBpbnRlZ3JhdG9yIG9mIElOVEVHUkFUT1JTX0FDTCkge1xyXG4gICAgICAgIGlmIChpbnRlZ3JhdG9yLmxhYmVsID09PSBsYWJlbCkge1xyXG4gICAgICAgICAgICByZXR1cm4gaW50ZWdyYXRvci5pbnRlZ3JhdG9ySWQ7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59O1xyXG5cclxuZXhwb3J0IHR5cGUgUmZxV29ya0Zsb3dUeXBlID0gJ3JmcXQnIHwgJ3JmcW0nO1xyXG5leHBvcnQgdHlwZSBSZnFPcmRlclR5cGUgPSAncmZxJyB8ICdvdGMnO1xyXG5cclxuZXhwb3J0IGNvbnN0IFJGUV9NQUtFUl9SRUZSRVNIX0lOVEVSVkFMX01TOiBudW1iZXIgPSBPTkVfTUlOVVRFX01TICogMTtcclxuXHJcbi8qKlxyXG4gKiBUaGUgSlNPTiBjb25maWcgZm9yIGVhY2ggTWFya2V0IE1ha2VyLCBwcm92aWRpbmcgaW5mb3JtYXRpb24gaW5jbHVkaW5nIFVSTHMsIHR5cGUgb2Ygb3JkZXIgc3VwcG9ydGVkIGFuZCBhdXRoZW50aWNhdGlvbi5cclxuICovXHJcbmV4cG9ydCBpbnRlcmZhY2UgUmZxTWFrZXJDb25maWcge1xyXG4gICAgbWFrZXJJZDogc3RyaW5nO1xyXG4gICAgbGFiZWw6IHN0cmluZztcclxuICAgIHJmcW1PcmRlclR5cGVzOiBSZnFPcmRlclR5cGVbXTtcclxuICAgIHJmcXRPcmRlclR5cGVzOiBSZnFPcmRlclR5cGVbXTtcclxuICAgIGFwaUtleUhhc2hlczogc3RyaW5nW107XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBBIE1hcCB0eXBlIHdoaWNoIG1hcCB0aGUgbWFrZXJJZCB0byB0aGUgY29uZmlnIG9iamVjdC5cclxuICovXHJcbmV4cG9ydCB0eXBlIE1ha2VySWRTZXQgPSBTZXQ8LyogbWFrZXJJZCAqLyBzdHJpbmc+O1xyXG5cclxuLyoqXHJcbiAqIEdlbmVyYXRlIGEgc2V0IG9mIE1ha2VySWRzIHRoYXQgc3VwcG9ydCBhIGdpdmVuIG9yZGVyIHR5cGUgZm9yIGEgZ2l2ZW4gd29ya2Zsb3dcclxuICovXHJcbmV4cG9ydCBjb25zdCBnZXRNYWtlcklkU2V0Rm9yT3JkZXJUeXBlID0gKG9yZGVyVHlwZTogUmZxT3JkZXJUeXBlIHwgJ2FueScsIHdvcmtmbG93OiBSZnFXb3JrRmxvd1R5cGUpOiBNYWtlcklkU2V0ID0+IHtcclxuICAgIGNvbnN0IHR5cGVzRmllbGQgPSB3b3JrZmxvdyA9PT0gJ3JmcXQnID8gJ3JmcXRPcmRlclR5cGVzJyA6ICdyZnFtT3JkZXJUeXBlcyc7XHJcbiAgICByZXR1cm4gUkZRX01BS0VSX0NPTkZJR1MucmVkdWNlKChhY2MsIGN1cnIpID0+IHtcclxuICAgICAgICBpZiAob3JkZXJUeXBlID09PSAnYW55JyB8fCBjdXJyW3R5cGVzRmllbGRdLmluY2x1ZGVzKG9yZGVyVHlwZSkpIHtcclxuICAgICAgICAgICAgYWNjLmFkZChjdXJyLm1ha2VySWQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gYWNjO1xyXG4gICAgfSwgbmV3IFNldDwvKiBtYWtlcklkICovIHN0cmluZz4oKSk7XHJcbn07XHJcblxyXG4vKipcclxuICogQSBsaXN0IG9mIHR5cGUgUmZxTWFrZXJDb25maWcsIHJlYWQgZnJvbSB0aGUgUkZRX01BS0VSX0NPTkZJR1MgZW52IHZhcmlhYmxlXHJcbiAqL1xyXG5leHBvcnQgY29uc3QgUkZRX01BS0VSX0NPTkZJR1M6IFJmcU1ha2VyQ29uZmlnW10gPSAoKCkgPT4ge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCBtYWtlckNvbmZpZ3MgPSByZXNvbHZlRW52VmFyPFJmcU1ha2VyQ29uZmlnW10+KCdSRlFfTUFLRVJfQ09ORklHUycsIEVudlZhclR5cGUuSnNvblN0cmluZ0xpc3QsIFtdKTtcclxuICAgICAgICBzY2hlbWFVdGlscy52YWxpZGF0ZVNjaGVtYShtYWtlckNvbmZpZ3MsIHNjaGVtYXMucmZxTWFrZXJDb25maWdMaXN0U2NoZW1hKTtcclxuICAgICAgICByZXR1cm4gbWFrZXJDb25maWdzO1xyXG4gICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgUkZRX01BS0VSX0NPTkZJR1Mgd2FzIGRlZmluZWQgYnV0IGlzIG5vdCB2YWxpZCBKU09OIHBlciB0aGUgc2NoZW1hOiAke2V9YCk7XHJcbiAgICB9XHJcbn0pKCk7XHJcblxyXG4vLyBMb2cgbGV2ZWwgZm9yIHBpbm8uanNcclxuZXhwb3J0IGNvbnN0IExPR19MRVZFTDogc3RyaW5nID0gXy5pc0VtcHR5KHByb2Nlc3MuZW52LkxPR19MRVZFTClcclxuICAgID8gJ2luZm8nXHJcbiAgICA6IGFzc2VydEVudlZhclR5cGUoJ0xPR19MRVZFTCcsIHByb2Nlc3MuZW52LkxPR19MRVZFTCwgRW52VmFyVHlwZS5Ob25FbXB0eVN0cmluZyk7XHJcblxyXG4vLyBOZXR3b3JrIHBvcnQgdG8gbGlzdGVuIG9uXHJcbmV4cG9ydCBjb25zdCBIVFRQX1BPUlQgPSBfLmlzRW1wdHkocHJvY2Vzcy5lbnYuSFRUUF9QT1JUKVxyXG4gICAgPyAzMDAwXHJcbiAgICA6IGFzc2VydEVudlZhclR5cGUoJ0hUVFBfUE9SVCcsIHByb2Nlc3MuZW52LkhUVFBfUE9SVCwgRW52VmFyVHlwZS5Qb3J0KTtcclxuXHJcbi8vIE5ldHdvcmsgcG9ydCBmb3IgdGhlIGhlYWx0aGNoZWNrIHNlcnZpY2UgYXQgL2hlYWx0aHosIGlmIG5vdCBwcm92aWRlZCwgaXQgdXNlcyB0aGUgSFRUUF9QT1JUIHZhbHVlLlxyXG5leHBvcnQgY29uc3QgSEVBTFRIQ0hFQ0tfSFRUUF9QT1JUID0gXy5pc0VtcHR5KHByb2Nlc3MuZW52LkhFQUxUSENIRUNLX0hUVFBfUE9SVClcclxuICAgID8gSFRUUF9QT1JUXHJcbiAgICA6IGFzc2VydEVudlZhclR5cGUoJ0hFQUxUSENIRUNLX0hUVFBfUE9SVCcsIHByb2Nlc3MuZW52LkhFQUxUSENIRUNLX0hUVFBfUE9SVCwgRW52VmFyVHlwZS5Qb3J0KTtcclxuXHJcbi8vIE51bWJlciBvZiBtaWxsaXNlY29uZHMgb2YgaW5hY3Rpdml0eSB0aGUgc2VydmVycyB3YWl0cyBmb3IgYWRkaXRpb25hbFxyXG4vLyBpbmNvbWluZyBkYXRhIGFmdGVyZSBpdCBmaW5pc2hlZCB3cml0aW5nIGxhc3QgcmVzcG9uc2UgYmVmb3JlIGEgc29ja2V0IHdpbGxcclxuLy8gYmUgZGVzdHJveWVkLlxyXG4vLyBSZWY6IGh0dHBzOi8vbm9kZWpzLm9yZy9hcGkvaHR0cC5odG1sI2h0dHBfc2VydmVyX2tlZXBhbGl2ZXRpbWVvdXRcclxuZXhwb3J0IGNvbnN0IEhUVFBfS0VFUF9BTElWRV9USU1FT1VUID0gXy5pc0VtcHR5KHByb2Nlc3MuZW52LkhUVFBfS0VFUF9BTElWRV9USU1FT1VUKVxyXG4gICAgPyA3NiAqIDEwMDBcclxuICAgIDogYXNzZXJ0RW52VmFyVHlwZSgnSFRUUF9LRUVQX0FMSVZFX1RJTUVPVVQnLCBwcm9jZXNzLmVudi5IVFRQX0tFRVBfQUxJVkVfVElNRU9VVCwgRW52VmFyVHlwZS5LZWVwQWxpdmVUaW1lb3V0KTtcclxuXHJcbi8vIExpbWl0IHRoZSBhbW91bnQgb2YgdGltZSB0aGUgcGFyc2VyIHdpbGwgd2FpdCB0byByZWNlaXZlIHRoZSBjb21wbGV0ZSBIVFRQIGhlYWRlcnMuXHJcbi8vIE5PVEU6IFRoaXMgdmFsdWUgSEFTIHRvIGJlIGhpZ2hlciB0aGFuIEhUVFBfS0VFUF9BTElWRV9USU1FT1VULlxyXG4vLyBSZWY6IGh0dHBzOi8vbm9kZWpzLm9yZy9hcGkvaHR0cC5odG1sI2h0dHBfc2VydmVyX2hlYWRlcnN0aW1lb3V0XHJcbmV4cG9ydCBjb25zdCBIVFRQX0hFQURFUlNfVElNRU9VVCA9IF8uaXNFbXB0eShwcm9jZXNzLmVudi5IVFRQX0hFQURFUlNfVElNRU9VVClcclxuICAgID8gNzcgKiAxMDAwXHJcbiAgICA6IGFzc2VydEVudlZhclR5cGUoJ0hUVFBfSEVBREVSU19USU1FT1VUJywgcHJvY2Vzcy5lbnYuSFRUUF9IRUFERVJTX1RJTUVPVVQsIEVudlZhclR5cGUuS2VlcEFsaXZlVGltZW91dCk7XHJcblxyXG4vLyBEZWZhdWx0IGNoYWluIGlkIHRvIHVzZSB3aGVuIG5vdCBzcGVjaWZpZWRcclxuZXhwb3J0IGNvbnN0IENIQUlOX0lEOiBDaGFpbklkID0gXy5pc0VtcHR5KHByb2Nlc3MuZW52LkNIQUlOX0lEKVxyXG4gICAgPyBDaGFpbklkLktvdmFuXHJcbiAgICA6IGFzc2VydEVudlZhclR5cGUoJ0NIQUlOX0lEJywgcHJvY2Vzcy5lbnYuQ0hBSU5fSUQsIEVudlZhclR5cGUuQ2hhaW5JZCk7XHJcblxyXG5leHBvcnQgY29uc3QgS0FGS0FfQlJPS0VSUyA9IF8uaXNFbXB0eShwcm9jZXNzLmVudi5LQUZLQV9CUk9LRVJTKVxyXG4gICAgPyB1bmRlZmluZWRcclxuICAgIDogYXNzZXJ0RW52VmFyVHlwZSgnS0FGS0FfQlJPS0VSUycsIHByb2Nlc3MuZW52LktBRktBX0JST0tFUlMsIEVudlZhclR5cGUuU3RyaW5nTGlzdCk7XHJcblxyXG4vLyBUaGUgZmVlIHJlY2lwaWVudCBmb3Igb3JkZXJzXHJcbmV4cG9ydCBjb25zdCBGRUVfUkVDSVBJRU5UX0FERFJFU1MgPSBfLmlzRW1wdHkocHJvY2Vzcy5lbnYuRkVFX1JFQ0lQSUVOVF9BRERSRVNTKVxyXG4gICAgPyBOVUxMX0FERFJFU1NcclxuICAgIDogYXNzZXJ0RW52VmFyVHlwZSgnRkVFX1JFQ0lQSUVOVF9BRERSRVNTJywgcHJvY2Vzcy5lbnYuRkVFX1JFQ0lQSUVOVF9BRERSRVNTLCBFbnZWYXJUeXBlLkVUSEFkZHJlc3NIZXgpO1xyXG5cclxuZXhwb3J0IGNvbnN0IFBPU1RHUkVTX1VSSSA9IF8uaXNFbXB0eShwcm9jZXNzLmVudi5QT1NUR1JFU19VUkkpXHJcbiAgICA/IERFRkFVTFRfTE9DQUxfUE9TVEdSRVNfVVJJXHJcbiAgICA6IGFzc2VydEVudlZhclR5cGUoJ1BPU1RHUkVTX1VSSScsIHByb2Nlc3MuZW52LlBPU1RHUkVTX1VSSSwgRW52VmFyVHlwZS5VcmwpO1xyXG5cclxuZXhwb3J0IGNvbnN0IFBPU1RHUkVTX1JFQURfUkVQTElDQV9VUklTOiBzdHJpbmdbXSB8IHVuZGVmaW5lZCA9IF8uaXNFbXB0eShwcm9jZXNzLmVudi5QT1NUR1JFU19SRUFEX1JFUExJQ0FfVVJJUylcclxuICAgID8gdW5kZWZpbmVkXHJcbiAgICA6IGFzc2VydEVudlZhclR5cGUoJ1BPU1RHUkVTX1JFQURfUkVQTElDQV9VUklTJywgcHJvY2Vzcy5lbnYuUE9TVEdSRVNfUkVBRF9SRVBMSUNBX1VSSVMsIEVudlZhclR5cGUuVXJsTGlzdCk7XHJcblxyXG4vLyBFbnZpcm9ubWVudCBuYW1lIFNlbnRyeSB1c2VkIHRvIGNhdGVnb3JpemUgaXNzdWVzIGFuZCB0cmFjZXMuXHJcbmV4cG9ydCBjb25zdCBTRU5UUllfRU5WSVJPTk1FTlQgPSBfLmlzRW1wdHkocHJvY2Vzcy5lbnYuU0VOVFJZX0VOVklST05NRU5UKVxyXG4gICAgPyBERUZBVUxUX1NFTlRSWV9FTlZJUk9OTUVOVFxyXG4gICAgOiBhc3NlcnRFbnZWYXJUeXBlKCdTRU5UUllfRU5WSVJPTk1FTlQnLCBwcm9jZXNzLmVudi5TRU5UUllfRU5WSVJPTk1FTlQsIEVudlZhclR5cGUuTm9uRW1wdHlTdHJpbmcpO1xyXG5cclxuLy8gQW4gVXJsIHdpdGggY2xpZW50IGtleSB0byBhY2Nlc3MgU2VudHJ5IGZyb20gY2xpZW50IFNESy5cclxuZXhwb3J0IGNvbnN0IFNFTlRSWV9EU04gPSBfLmlzRW1wdHkocHJvY2Vzcy5lbnYuU0VOVFJZX0RTTilcclxuICAgID8gdW5kZWZpbmVkXHJcbiAgICA6IGFzc2VydEVudlZhclR5cGUoJ1NFTlRSWV9EU04nLCBwcm9jZXNzLmVudi5TRU5UUllfRFNOLCBFbnZWYXJUeXBlLlVybCk7XHJcblxyXG4vLyBBUEkgS2V5IGZvciBEZWZpbmVkLmZpJ3MgdG9rZW4gcHJpY2UgQVBJXHJcbmV4cG9ydCBjb25zdCBERUZJTkVEX0ZJX0FQSV9LRVk6IHN0cmluZyA9IF8uaXNFbXB0eShwcm9jZXNzLmVudi5ERUZJTkVEX0ZJX0FQSV9LRVkpXHJcbiAgICA/ICcnXHJcbiAgICA6IGFzc2VydEVudlZhclR5cGUoJ0RFRklORURfRklfQVBJX0tFWScsIHByb2Nlc3MuZW52LkRFRklORURfRklfQVBJX0tFWSwgRW52VmFyVHlwZS5Ob25FbXB0eVN0cmluZyk7XHJcblxyXG4vLyBFbmRwb2ludCBmb3IgRGVmaW5lZC5maSdzIHRva2VuIHByaWNlIEFQSSwgZGVmYXVsdCB0byBodHRwczovL2FwaS5kZWZpbmVkLmZpXHJcbmV4cG9ydCBjb25zdCBERUZJTkVEX0ZJX0VORFBPSU5UOiBzdHJpbmcgPSBfLmlzRW1wdHkocHJvY2Vzcy5lbnYuREVGSU5FRF9GSV9FTkRQT0lOVClcclxuICAgID8gJ2h0dHBzOi8vYXBpLmRlZmluZWQuZmknXHJcbiAgICA6IGFzc2VydEVudlZhclR5cGUoJ0RFRklORURfRklfRU5EUE9JTlQnLCBwcm9jZXNzLmVudi5ERUZJTkVEX0ZJX0VORFBPSU5ULCBFbnZWYXJUeXBlLk5vbkVtcHR5U3RyaW5nKTtcclxuXHJcbi8vIEFQSSBLZXkgZm9yIDB4IEFQSSAoZm9yIFplcm9FeEFwaUNsaWVudClcclxuZXhwb3J0IGNvbnN0IFpFUk9fRVhfQVBJX0tFWTogc3RyaW5nID0gXy5pc0VtcHR5KHByb2Nlc3MuZW52LlpFUk9fRVhfQVBJX0tFWSlcclxuICAgID8gJydcclxuICAgIDogYXNzZXJ0RW52VmFyVHlwZSgnWkVST19FWF9BUElfS0VZJywgcHJvY2Vzcy5lbnYuWkVST19FWF9BUElfS0VZLCBFbnZWYXJUeXBlLk5vbkVtcHR5U3RyaW5nKTtcclxuXHJcbi8vICRlc2xpbnQtZml4LW1lIGh0dHBzOi8vZ2l0aHViLmNvbS9yaGlub2RhdmlkL2VzbGludC1maXgtbWVcclxuLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1pbmZlcnJhYmxlLXR5cGVzXHJcbmV4cG9ydCBjb25zdCBUT0tFTl9QUklDRV9PUkFDTEVfVElNRU9VVDogbnVtYmVyID0gMTAwMDtcclxuXHJcbi8vIFNhbXBsaW5nIHJhdGUgb2YgdHJhY2VzIHJlcG9ydGVkIHRvIFNlbnRyeS4gU2hvdWxkIGJlIGEgbnVtYmVyIGJldHdlZW4gMC4wIGFuZCAxLjAgKGluY2x1c2l2ZSkuXHJcbmV4cG9ydCBjb25zdCBTRU5UUllfVFJBQ0VTX1NBTVBMRV9SQVRFID0gXy5pc0VtcHR5KHByb2Nlc3MuZW52LlNFTlRSWV9UUkFDRVNfU0FNUExFX1JBVEUpXHJcbiAgICA/IDBcclxuICAgIDogYXNzZXJ0RW52VmFyVHlwZSgnU0VOVFJZX1RSQUNFU19TQU1QTEVfUkFURScsIHByb2Nlc3MuZW52LlNFTlRSWV9UUkFDRVNfU0FNUExFX1JBVEUsIEVudlZhclR5cGUuUmF0ZSk7XHJcblxyXG5leHBvcnQgY29uc3QgUkVESVNfVVJJID0gXy5pc0VtcHR5KHByb2Nlc3MuZW52LlJFRElTX1VSSSkgPyBERUZBVUxUX0xPQ0FMX1JFRElTX1VSSSA6IHByb2Nlc3MuZW52LlJFRElTX1VSSTtcclxuXHJcbmV4cG9ydCBjb25zdCBSRURJU19CQUNLR1JPVU5EX0pPQl9VUkkgPSBfLmlzRW1wdHkocHJvY2Vzcy5lbnYuUkVESVNfQkFDS0dST1VORF9KT0JfVVJJKVxyXG4gICAgPyBERUZBVUxUX0xPQ0FMX1JFRElTX1VSSVxyXG4gICAgOiBwcm9jZXNzLmVudi5SRURJU19CQUNLR1JPVU5EX0pPQl9VUkk7XHJcblxyXG5leHBvcnQgY29uc3QgQkFDS0dST1VORF9KT0JfVFlQRVMgPSBfLmlzRW1wdHkocHJvY2Vzcy5lbnYuQkFDS0dST1VORF9KT0JfVFlQRVMpXHJcbiAgICA/IERFRkFVTFRfQkFDS0dST1VORF9KT0JfVFlQRVNcclxuICAgIDogcHJvY2Vzcy5lbnYuQkFDS0dST1VORF9KT0JfVFlQRVM7XHJcblxyXG4vLyBTaG91bGQgdGhlIGxvZ2dlciBpbmNsdWRlIHRpbWUgZmllbGQgaW4gdGhlIG91dHB1dCBsb2dzLCBkZWZhdWx0cyB0byB0cnVlLlxyXG5leHBvcnQgY29uc3QgTE9HR0VSX0lOQ0xVREVfVElNRVNUQU1QID0gXy5pc0VtcHR5KHByb2Nlc3MuZW52LkxPR0dFUl9JTkNMVURFX1RJTUVTVEFNUClcclxuICAgID8gREVGQVVMVF9MT0dHRVJfSU5DTFVERV9USU1FU1RBTVBcclxuICAgIDogYXNzZXJ0RW52VmFyVHlwZSgnTE9HR0VSX0lOQ0xVREVfVElNRVNUQU1QJywgcHJvY2Vzcy5lbnYuTE9HR0VSX0lOQ0xVREVfVElNRVNUQU1QLCBFbnZWYXJUeXBlLkJvb2xlYW4pO1xyXG5cclxuZXhwb3J0IGNvbnN0IEFMVF9SRlFfTU1fRU5EUE9JTlQ6IHN0cmluZyB8IHVuZGVmaW5lZCA9IF8uaXNFbXB0eShwcm9jZXNzLmVudi5BTFRfUkZRX01NX0VORFBPSU5UKVxyXG4gICAgPyB1bmRlZmluZWRcclxuICAgIDogYXNzZXJ0RW52VmFyVHlwZSgnQUxUX1JGUV9NTV9FTkRQT0lOVCcsIHByb2Nlc3MuZW52LkFMVF9SRlFfTU1fRU5EUE9JTlQsIEVudlZhclR5cGUuVXJsKTtcclxuZXhwb3J0IGNvbnN0IEFMVF9SRlFfTU1fQVBJX0tFWTogc3RyaW5nIHwgdW5kZWZpbmVkID0gXy5pc0VtcHR5KHByb2Nlc3MuZW52LkFMVF9SRlFfTU1fQVBJX0tFWSlcclxuICAgID8gdW5kZWZpbmVkXHJcbiAgICA6IGFzc2VydEVudlZhclR5cGUoJ0FMVF9SRlFfTU1fQVBJX0tFWScsIHByb2Nlc3MuZW52LkFMVF9SRlFfTU1fQVBJX0tFWSwgRW52VmFyVHlwZS5Ob25FbXB0eVN0cmluZyk7XHJcbmV4cG9ydCBjb25zdCBBTFRfUkZRX01NX1BST0ZJTEU6IHN0cmluZyB8IHVuZGVmaW5lZCA9IF8uaXNFbXB0eShwcm9jZXNzLmVudi5BTFRfUkZRX01NX1BST0ZJTEUpXHJcbiAgICA/IHVuZGVmaW5lZFxyXG4gICAgOiBhc3NlcnRFbnZWYXJUeXBlKCdBTFRfUkZRX01NX1BST0ZJTEUnLCBwcm9jZXNzLmVudi5BTFRfUkZRX01NX1BST0ZJTEUsIEVudlZhclR5cGUuTm9uRW1wdHlTdHJpbmcpO1xyXG5cclxuZXhwb3J0IGNvbnN0IFJGUU1fQVBJX0tFWV9XSElURUxJU1Q6IFNldDxzdHJpbmc+ID0gbmV3IFNldChnZXRBcGlLZXlXaGl0ZWxpc3RGcm9tSW50ZWdyYXRvcnNBY2woJ3JmcW0nKSk7XHJcblxyXG5leHBvcnQgY29uc3QgQURNSU5fQVBJX0tFWTogc3RyaW5nIHwgdW5kZWZpbmVkID0gXy5pc0VtcHR5KHByb2Nlc3MuZW52LkFETUlOX0FQSV9LRVkpXHJcbiAgICA/IHVuZGVmaW5lZFxyXG4gICAgOiBhc3NlcnRFbnZWYXJUeXBlKCdBRE1JTl9BUElfS0VZJywgcHJvY2Vzcy5lbnYuQURNSU5fQVBJX0tFWSwgRW52VmFyVHlwZS5Ob25FbXB0eVN0cmluZyk7XHJcblxyXG5leHBvcnQgY29uc3QgUkVBU09OX09OX1NUQVRVU19FUlJPUl9SRVNQT05TRV9FTkFCTEVEOiBib29sZWFuID0gXy5pc0VtcHR5KFxyXG4gICAgcHJvY2Vzcy5lbnYuUkVBU09OX09OX1NUQVRVU19FUlJPUl9SRVNQT05TRV9FTkFCTEVELFxyXG4pXHJcbiAgICA/IGZhbHNlXHJcbiAgICA6IGFzc2VydEVudlZhclR5cGUoXHJcbiAgICAgICAgICAnUkVBU09OX09OX1NUQVRVU19FUlJPUl9SRVNQT05TRV9FTkFCTEVEJyxcclxuICAgICAgICAgIHByb2Nlc3MuZW52LlJFQVNPTl9PTl9TVEFUVVNfRVJST1JfUkVTUE9OU0VfRU5BQkxFRCxcclxuICAgICAgICAgIEVudlZhclR5cGUuQm9vbGVhbixcclxuICAgICAgKTtcclxuXHJcbmV4cG9ydCBjb25zdCBUQUtFUl9TUEVDSUZJRURfU0lERV9FTkFCTEVEOiBib29sZWFuID0gXy5pc0VtcHR5KHByb2Nlc3MuZW52LlRBS0VSX1NQRUNJRklFRF9TSURFX0VOQUJMRUQpXHJcbiAgICA/IGZhbHNlXHJcbiAgICA6IGFzc2VydEVudlZhclR5cGUoJ1RBS0VSX1NQRUNJRklFRF9TSURFX0VOQUJMRUQnLCBwcm9jZXNzLmVudi5UQUtFUl9TUEVDSUZJRURfU0lERV9FTkFCTEVELCBFbnZWYXJUeXBlLkJvb2xlYW4pO1xyXG5cclxuZXhwb3J0IGNvbnN0IFJGUU1fTUFLRVJfSURfU0VUOiBNYWtlcklkU2V0ID0gZ2V0TWFrZXJJZFNldEZvck9yZGVyVHlwZSgnYW55JywgJ3JmcW0nKTtcclxuZXhwb3J0IGNvbnN0IFJGUVRfTUFLRVJfSURfU0VUX0ZPUl9SRlFfT1JERVI6IE1ha2VySWRTZXQgPSBnZXRNYWtlcklkU2V0Rm9yT3JkZXJUeXBlKCdyZnEnLCAncmZxdCcpO1xyXG5leHBvcnQgY29uc3QgUkZRVF9NQUtFUl9JRF9TRVRfRk9SX09UQ19PUkRFUjogTWFrZXJJZFNldCA9IGdldE1ha2VySWRTZXRGb3JPcmRlclR5cGUoJ290YycsICdyZnF0Jyk7XHJcbmV4cG9ydCBjb25zdCBSRlFNX01BS0VSX0lEX1NFVF9GT1JfT1RDX09SREVSOiBNYWtlcklkU2V0ID0gZ2V0TWFrZXJJZFNldEZvck9yZGVyVHlwZSgnb3RjJywgJ3JmcW0nKTtcclxuXHJcbi8qKlxyXG4gKiBBIG1hcCBmcm9tIFJGUSBtYWtlcidzIGFwaSBrZXkgaGFzaGVzIHRvIG1ha2VyIGlkcy5cclxuICogSW52YWxpZCBoYXNoZXMsIHdoaWNoIGFwcGVhciBtb3JlIHRoYW4gb25jZSBpbiB0aGUgY29uZmlnIGZpbGUgYW5kIG1pZ2h0IHJlc29sdmUgdG8gZGlmZmVyZW50IG1ha2VycywgYXJlIHJlbW92ZWQgZnJvbSB0aGUgcmVzdWx0LlxyXG4gKi9cclxuZXhwb3J0IGNvbnN0IFJGUV9BUElfS0VZX0hBU0hfVE9fTUFLRVJfSUQ6IE1hcDxzdHJpbmcsIHN0cmluZz4gPSAoKCkgPT4ge1xyXG4gICAgY29uc3QgaGFzaFRvSWRDb3VudCA9IFJGUV9NQUtFUl9DT05GSUdTLnJlZHVjZSgocmVzdWx0LCByZnFNYWtlckNvbmZpZykgPT4ge1xyXG4gICAgICAgIHJmcU1ha2VyQ29uZmlnLmFwaUtleUhhc2hlcy5mb3JFYWNoKChoYXNoKSA9PiByZXN1bHQuc2V0KGhhc2gsIChyZXN1bHQuZ2V0KGhhc2gpIHx8IDApICsgMSkpO1xyXG4gICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICB9LCBuZXcgTWFwPHN0cmluZywgbnVtYmVyPigpKTtcclxuXHJcbiAgICByZXR1cm4gUkZRX01BS0VSX0NPTkZJR1MucmVkdWNlKChyZXN1bHQsIG1tKSA9PiB7XHJcbiAgICAgICAgbW0uYXBpS2V5SGFzaGVzLmZvckVhY2goKGhhc2gpID0+IHtcclxuICAgICAgICAgICAgLy8gSWdub3JlIGludmFsaWQgaGFzaGVzIHdpdGggbW9yZSB0aGFuIG9uZSBhcHBlYXJhbmNlc1xyXG4gICAgICAgICAgICBpZiAoaGFzaFRvSWRDb3VudC5nZXQoaGFzaCkgPT09IDEpIHtcclxuICAgICAgICAgICAgICAgIHJlc3VsdC5zZXQoaGFzaCwgbW0ubWFrZXJJZCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgfSwgbmV3IE1hcDxzdHJpbmcsIHN0cmluZz4oKSk7XHJcbn0pKCk7XHJcblxyXG5leHBvcnQgY29uc3QgTUVUQV9UWF9XT1JLRVJfTU5FTU9OSUM6IHN0cmluZyB8IHVuZGVmaW5lZCA9IF8uaXNFbXB0eShwcm9jZXNzLmVudi5NRVRBX1RYX1dPUktFUl9NTkVNT05JQylcclxuICAgID8gdW5kZWZpbmVkXHJcbiAgICA6IGFzc2VydEVudlZhclR5cGUoJ01FVEFfVFhfV09SS0VSX01ORU1PTklDJywgcHJvY2Vzcy5lbnYuTUVUQV9UWF9XT1JLRVJfTU5FTU9OSUMsIEVudlZhclR5cGUuTm9uRW1wdHlTdHJpbmcpO1xyXG5cclxuZXhwb3J0IGNvbnN0IFJGUU1fV09SS0VSX0dST1VQX0lOREVYOiBudW1iZXIgfCB1bmRlZmluZWQgPSBfLmlzRW1wdHkocHJvY2Vzcy5lbnYuUkZRTV9XT1JLRVJfR1JPVVBfSU5ERVgpXHJcbiAgICA/IHVuZGVmaW5lZFxyXG4gICAgOiBhc3NlcnRFbnZWYXJUeXBlKCdSRlFNX1dPUktFUl9HUk9VUF9JTkRFWCcsIHByb2Nlc3MuZW52LlJGUU1fV09SS0VSX0dST1VQX0lOREVYLCBFbnZWYXJUeXBlLkludGVnZXIpO1xyXG5cclxuZXhwb3J0IGNvbnN0IFJGUU1fV09SS0VSX0dST1VQX1NJWkU6IG51bWJlciB8IHVuZGVmaW5lZCA9IF8uaXNFbXB0eShwcm9jZXNzLmVudi5SRlFNX1dPUktFUl9HUk9VUF9TSVpFKVxyXG4gICAgPyB1bmRlZmluZWRcclxuICAgIDogYXNzZXJ0RW52VmFyVHlwZSgnUkZRTV9XT1JLRVJfR1JPVVBfU0laRScsIHByb2Nlc3MuZW52LlJGUU1fV09SS0VSX0dST1VQX1NJWkUsIEVudlZhclR5cGUuSW50ZWdlcik7XHJcblxyXG4vLyBJZiBzZXQgdG8gVFJVRSwgc3lzdGVtIGhlYWx0aCB3aWxsIGNoYW5nZSB0byBNQUlOVEVOQU5DRSBhbmQgaW50ZWdyYXRvcnMgd2lsbCBiZSB0b2xkIHRvIG5vdFxyXG4vLyBzZW5kIFJGUU0gb3JkZXJzLlxyXG4vLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmUgYm9vbGVhbi1uYW1pbmdcclxuZXhwb3J0IGNvbnN0IFJGUU1fTUFJTlRFTkFOQ0VfTU9ERTogYm9vbGVhbiA9IF8uaXNFbXB0eShwcm9jZXNzLmVudi5SRlFNX01BSU5URU5BTkNFX01PREUpXHJcbiAgICA/IGZhbHNlXHJcbiAgICA6IGFzc2VydEVudlZhclR5cGUoJ1JGUU1fTUFJTlRFTkFOQ0VfTU9ERScsIHByb2Nlc3MuZW52LlJGUU1fTUFJTlRFTkFOQ0VfTU9ERSwgRW52VmFyVHlwZS5Cb29sZWFuKTtcclxuXHJcbmV4cG9ydCBjb25zdCBSRlFfUFJJQ0VfRU5EUE9JTlRfVElNRU9VVF9NUzogbnVtYmVyID0gXy5pc0VtcHR5KHByb2Nlc3MuZW52LlJGUV9QUklDRV9FTkRQT0lOVF9USU1FT1VUX01TKVxyXG4gICAgPyAxMDAwXHJcbiAgICA6IGFzc2VydEVudlZhclR5cGUoJ1JGUV9QUklDRV9FTkRQT0lOVF9USU1FT1VUX01TJywgcHJvY2Vzcy5lbnYuUkZRX1BSSUNFX0VORFBPSU5UX1RJTUVPVVRfTVMsIEVudlZhclR5cGUuSW50ZWdlcik7XHJcblxyXG5leHBvcnQgY29uc3QgUkZRX1NJR05fRU5EUE9JTlRfVElNRU9VVF9NUyA9IF8uaXNFbXB0eShwcm9jZXNzLmVudi5SRlFfU0lHTl9FTkRQT0lOVF9USU1FT1VUX01TKVxyXG4gICAgPyAyMDAwXHJcbiAgICA6IGFzc2VydEVudlZhclR5cGUoJ1JGUV9TSUdOX0VORFBPSU5UX1RJTUVPVVRfTVMnLCBwcm9jZXNzLmVudi5SRlFfU0lHTl9FTkRQT0lOVF9USU1FT1VUX01TLCBFbnZWYXJUeXBlLkludGVnZXIpO1xyXG5cclxuLy8gVGhlIGV4cGVjdGVkIHRpbWUgZm9yIGEgbWV0YS10eG4gdG8gYmUgaW5jbHVkZWQgaW4gYSBibG9jay5cclxuZXhwb3J0IGNvbnN0IE1FVEFfVFhOX1JFTEFZX0VYUEVDVEVEX01JTkVEX1NFQzogbnVtYmVyID0gXy5pc0VtcHR5KHByb2Nlc3MuZW52Lk1FVEFfVFhOX1JFTEFZX0VYUEVDVEVEX01JTkVEX1NFQylcclxuICAgID8gREVGQVVMVF9FWFBFQ1RFRF9NSU5FRF9TRUNcclxuICAgIDogYXNzZXJ0RW52VmFyVHlwZShcclxuICAgICAgICAgICdNRVRBX1RYTl9SRUxBWV9FWFBFQ1RFRF9NSU5FRF9TRUMnLFxyXG4gICAgICAgICAgcHJvY2Vzcy5lbnYuTUVUQV9UWE5fUkVMQVlfRVhQRUNURURfTUlORURfU0VDLFxyXG4gICAgICAgICAgRW52VmFyVHlwZS5JbnRlZ2VyLFxyXG4gICAgICApO1xyXG5cclxuLy8gV2hldGhlciBvciBub3QgcHJvbWV0aGV1cyBtZXRyaWNzIHNob3VsZCBiZSBlbmFibGVkLlxyXG4vLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6Ym9vbGVhbi1uYW1pbmdcclxuZXhwb3J0IGNvbnN0IEVOQUJMRV9QUk9NRVRIRVVTX01FVFJJQ1M6IGJvb2xlYW4gPSBfLmlzRW1wdHkocHJvY2Vzcy5lbnYuRU5BQkxFX1BST01FVEhFVVNfTUVUUklDUylcclxuICAgID8gZmFsc2VcclxuICAgIDogYXNzZXJ0RW52VmFyVHlwZSgnRU5BQkxFX1BST01FVEhFVVNfTUVUUklDUycsIHByb2Nlc3MuZW52LkVOQUJMRV9QUk9NRVRIRVVTX01FVFJJQ1MsIEVudlZhclR5cGUuQm9vbGVhbik7XHJcblxyXG5leHBvcnQgY29uc3QgUFJPTUVUSEVVU19QT1JUOiBudW1iZXIgPSBfLmlzRW1wdHkocHJvY2Vzcy5lbnYuUFJPTUVUSEVVU19QT1JUKVxyXG4gICAgPyA4MDgwXHJcbiAgICA6IGFzc2VydEVudlZhclR5cGUoJ1BST01FVEhFVVNfUE9SVCcsIHByb2Nlc3MuZW52LlBST01FVEhFVVNfUE9SVCwgRW52VmFyVHlwZS5Qb3J0KTtcclxuXHJcbi8vIEV0aCBHYXMgU3RhdGlvbiBVUkxcclxuZXhwb3J0IGNvbnN0IEVUSF9HQVNfU1RBVElPTl9BUElfVVJMOiBzdHJpbmcgPSBfLmlzRW1wdHkocHJvY2Vzcy5lbnYuRVRIX0dBU19TVEFUSU9OX0FQSV9VUkwpXHJcbiAgICA/IERFRkFVTFRfRVRIX0dBU19TVEFUSU9OX0FQSV9VUkxcclxuICAgIDogYXNzZXJ0RW52VmFyVHlwZSgnRVRIX0dBU19TVEFUSU9OX0FQSV9VUkwnLCBwcm9jZXNzLmVudi5FVEhfR0FTX1NUQVRJT05fQVBJX1VSTCwgRW52VmFyVHlwZS5VcmwpO1xyXG5cclxuZXhwb3J0IGNvbnN0IFJGUV9QUk9YWV9BRERSRVNTOiBzdHJpbmcgfCB1bmRlZmluZWQgPSBfLmlzRW1wdHkocHJvY2Vzcy5lbnYuUkZRX1BST1hZX0FERFJFU1MpXHJcbiAgICA/IHVuZGVmaW5lZFxyXG4gICAgOiBhc3NlcnRFbnZWYXJUeXBlKCdSRlFfUFJPWFlfQUREUkVTUycsIHByb2Nlc3MuZW52LlJGUV9QUk9YWV9BRERSRVNTLCBFbnZWYXJUeXBlLk5vbkVtcHR5U3RyaW5nKTtcclxuXHJcbmV4cG9ydCBjb25zdCBSRlFfUFJPWFlfUE9SVDogbnVtYmVyIHwgdW5kZWZpbmVkID0gXy5pc0VtcHR5KHByb2Nlc3MuZW52LlJGUV9QUk9YWV9QT1JUKVxyXG4gICAgPyB1bmRlZmluZWRcclxuICAgIDogYXNzZXJ0RW52VmFyVHlwZSgnUkZRX1BST1hZX1BPUlQnLCBwcm9jZXNzLmVudi5SRlFfUFJPWFlfUE9SVCwgRW52VmFyVHlwZS5Qb3J0KTtcclxuXHJcbi8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZSBib29sZWFuLW5hbWluZ1xyXG5leHBvcnQgY29uc3QgRU5BQkxFX0xMUl9DT09MRE9XTjogYm9vbGVhbiA9IF8uaXNFbXB0eShwcm9jZXNzLmVudi5FTkFCTEVfTExSX0NPT0xET1dOKVxyXG4gICAgPyBmYWxzZVxyXG4gICAgOiBhc3NlcnRFbnZWYXJUeXBlKCdFTkFCTEVfTExSX0NPT0xET1dOJywgcHJvY2Vzcy5lbnYuRU5BQkxFX0xMUl9DT09MRE9XTiwgRW52VmFyVHlwZS5Cb29sZWFuKTtcclxuXHJcbmV4cG9ydCBjb25zdCBMTFJfQ09PTERPV05fRFVSQVRJT05fU0VDT05EUzogbnVtYmVyID0gXy5pc0VtcHR5KHByb2Nlc3MuZW52LkxMUl9DT09MRE9XTl9EVVJBVElPTl9TRUNPTkRTKVxyXG4gICAgPyA2MFxyXG4gICAgOiBhc3NlcnRFbnZWYXJUeXBlKCdMTFJfQ09PTERPV05fRFVSQVRJT05fU0VDT05EUycsIHByb2Nlc3MuZW52LkxMUl9DT09MRE9XTl9EVVJBVElPTl9TRUNPTkRTLCBFbnZWYXJUeXBlLkludGVnZXIpO1xyXG5cclxuZXhwb3J0IGNvbnN0IGRlZmF1bHRIdHRwU2VydmljZUNvbmZpZzogSHR0cFNlcnZpY2VDb25maWcgPSB7XHJcbiAgICBodHRwUG9ydDogSFRUUF9QT1JULFxyXG4gICAgaGVhbHRoY2hlY2tIdHRwUG9ydDogSEVBTFRIQ0hFQ0tfSFRUUF9QT1JULFxyXG4gICAgaGVhbHRoY2hlY2tQYXRoOiBIRUFMVEhDSEVDS19QQVRILFxyXG4gICAgaHR0cEtlZXBBbGl2ZVRpbWVvdXQ6IEhUVFBfS0VFUF9BTElWRV9USU1FT1VULFxyXG4gICAgaHR0cEhlYWRlcnNUaW1lb3V0OiBIVFRQX0hFQURFUlNfVElNRU9VVCxcclxuICAgIGVuYWJsZVByb21ldGhldXNNZXRyaWNzOiBFTkFCTEVfUFJPTUVUSEVVU19NRVRSSUNTLFxyXG4gICAgcHJvbWV0aGV1c1BvcnQ6IFBST01FVEhFVVNfUE9SVCxcclxuICAgIHByb21ldGhldXNQYXRoOiBNRVRSSUNTX1BBVEgsXHJcbn07XHJcblxyXG5leHBvcnQgY29uc3QgZ2V0SW50ZWdyYXRvckJ5SWRPclRocm93ID0gKFxyXG4gICAgKGludGVncmF0b3JzTWFwOiBNYXA8c3RyaW5nLCBJbnRlZ3JhdG9yPikgPT5cclxuICAgIChpbnRlZ3JhdG9ySWQ6IHN0cmluZyk6IEludGVncmF0b3IgPT4ge1xyXG4gICAgICAgIGNvbnN0IGludGVncmF0b3IgPSBpbnRlZ3JhdG9yc01hcC5nZXQoaW50ZWdyYXRvcklkKTtcclxuICAgICAgICBpZiAoIWludGVncmF0b3IpIHtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBJbnRlZ3JhdG9yICR7aW50ZWdyYXRvcklkfSBkb2VzIG5vdCBleGlzdC5gKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGludGVncmF0b3I7XHJcbiAgICB9XHJcbikodHJhbnNmb3JtSW50ZWdyYXRvcnNBY2woSU5URUdSQVRPUlNfQUNMLCAnaW50ZWdyYXRvcklkJykpO1xyXG5cclxuLyoqXHJcbiAqIEdldHMgdGhlIGludGVncmF0b3IgSUQgZm9yIGEgZ2l2ZW4gQVBJIGtleS4gSWYgdGhlIEFQSSBrZXkgaXMgbm90IGluIHRoZSBjb25maWd1cmF0aW9uLCByZXR1cm5zIGB1bmRlZmluZWRgLlxyXG4gKi9cclxuZXhwb3J0IGNvbnN0IGdldEludGVncmF0b3JJZEZvckFwaUtleSA9IChcclxuICAgIChpbnRlZ3JhdG9yc01hcDogTWFwPHN0cmluZywgSW50ZWdyYXRvcj4pID0+XHJcbiAgICAoYXBpS2V5OiBzdHJpbmcpOiBzdHJpbmcgfCB1bmRlZmluZWQgPT4ge1xyXG4gICAgICAgIGNvbnN0IGludGVncmF0b3IgPSBpbnRlZ3JhdG9yc01hcC5nZXQoYXBpS2V5KTtcclxuICAgICAgICByZXR1cm4gaW50ZWdyYXRvcj8uaW50ZWdyYXRvcklkO1xyXG4gICAgfVxyXG4pKHRyYW5zZm9ybUludGVncmF0b3JzQWNsKElOVEVHUkFUT1JTX0FDTCwgJ2FwaUtleXMnKSk7XHJcblxyXG4vKipcclxuICogVXRpbGl0eSBmdW5jdGlvbiB0byB0cmFuc2Zvcm0gSU5URUdSQVRPUlNfQUNMIGludG8gYSBtYXAgb2YgYXBpS2V5ID0+IGludGVncmF0b3IuIFRoZSByZXN1bHQgY2FuXHJcbiAqIGJlIHVzZWQgdG8gb3B0aW1pemUgdGhlIGxvb2t1cCBvZiB0aGUgaW50ZWdyYXRvciB3aGVuIGEgcmVxdWVzdCBjb21lcyBpbiB3aXRoIGFuIGFwaSBrZXkuIExvb2t1cCBjb21wbGV4aXR5XHJcbiAqIGJlY29tZXMgTygxKSB3aXRoIHRoZSBtYXAgaW5zdGVhZCBvZiBPKCMgaW50ZWdyYXRvcnMgKiAjIGFwaSBrZXlzKSB3aXRoIHRoZSBhcnJheS5cclxuICpcclxuICogQHBhcmFtIGludGVncmF0b3JzIHRoZSBpbnRlZ3JhdG9ycyBtYXAgZnJvbSB0aGUgZW52aXJvbm1lbnQgdmFyaWFibGVcclxuICogQHBhcmFtIGtleUJ5IGVpdGhlciBhcGlLZXlzIChjcmVhdGVzIG1hcCBrZXllZCBieSBldmVyeSBBUEkga2V5KSBvciAnaW50ZWdyYXRvcklkJyAoaW50ZWdyYXRvcklkID0+IEludGVncmF0b3IpXHJcbiAqL1xyXG5mdW5jdGlvbiB0cmFuc2Zvcm1JbnRlZ3JhdG9yc0FjbChcclxuICAgIGludGVncmF0b3JzOiBJbnRlZ3JhdG9yc0FjbCxcclxuICAgIGtleUJ5OiAnYXBpS2V5cycgfCAnaW50ZWdyYXRvcklkJyxcclxuKTogTWFwPHN0cmluZywgSW50ZWdyYXRvcj4ge1xyXG4gICAgY29uc3QgcmVzdWx0ID0gbmV3IE1hcDxzdHJpbmcsIEludGVncmF0b3I+KCk7XHJcbiAgICBpbnRlZ3JhdG9ycy5mb3JFYWNoKChpbnRlZ3JhdG9yKSA9PiB7XHJcbiAgICAgICAgbGV0IG1hcEtleXM6IHN0cmluZ1tdO1xyXG4gICAgICAgIHN3aXRjaCAoa2V5QnkpIHtcclxuICAgICAgICAgICAgY2FzZSAnYXBpS2V5cyc6XHJcbiAgICAgICAgICAgICAgICBtYXBLZXlzID0gaW50ZWdyYXRvci5hcGlLZXlzO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgJ2ludGVncmF0b3JJZCc6XHJcbiAgICAgICAgICAgICAgICBtYXBLZXlzID0gW2ludGVncmF0b3IuaW50ZWdyYXRvcklkXTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBQYXJhbWV0ZXIgXCIke2tleUJ5fVwiIGlzIG1pc2NvbmZpZ3VyZWRgKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgbWFwS2V5cy5mb3JFYWNoKChhcGlLZXkpID0+IHtcclxuICAgICAgICAgICAgcmVzdWx0LnNldChhcGlLZXksIGludGVncmF0b3IpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgICByZXR1cm4gcmVzdWx0O1xyXG59XHJcblxyXG4vKipcclxuICogUlBDXHJcbiAqL1xyXG5leHBvcnQgY29uc3QgTUVUQV9UUkFOU0FDVElPTl9TRVJWSUNFX1JQQ19VUkw6IHN0cmluZyA9IF8uaXNFbXB0eShwcm9jZXNzLmVudi5NRVRBX1RSQU5TQUNUSU9OX1NFUlZJQ0VfUlBDX1VSTClcclxuICAgID8gJydcclxuICAgIDogYXNzZXJ0RW52VmFyVHlwZShcclxuICAgICAgICAgICdNRVRBX1RSQU5TQUNUSU9OX1NFUlZJQ0VfUlBDX1VSTCcsXHJcbiAgICAgICAgICBwcm9jZXNzLmVudi5NRVRBX1RSQU5TQUNUSU9OX1NFUlZJQ0VfUlBDX1VSTCxcclxuICAgICAgICAgIEVudlZhclR5cGUuVXJsLFxyXG4gICAgICApO1xyXG5cclxuLyoqXHJcbiAqIFJlc29sdmVzIGEgY29uZmlnIG9mIHR5cGUgVCBmb3IgYW4gRW52aW9ybm1lbnQgVmFyaWFibGUuIENoZWNrczpcclxuICogIC0gSWYgdGhlIGVudiB2YXJpYWJsZSBpcyB1bmRlZmluZWQsIHVzZSB0aGUgaGFyZGNvZGVkIGZhbGxiYWNrXHJcbiAqICAtIElmIHRoZSBlbnYgdmFyaWFibGUgcG9pbnRzIHRvIGEgZmlsZXBhdGgsIHJlc29sdmUgaXRcclxuICogIC0gT3RoZXJ3aXNlLCBqdXN0IHVzZSB0aGUgZW52IHZhcmlhYmxlXHJcbiAqXHJcbiAqIEBwYXJhbSBlbnZWYXIgLSB0aGUgbmFtZSBvZiB0aGUgRW52aXJvbm1lbnQgVmFyaWFibGVcclxuICogQHBhcmFtIGVudlZhclR5cGUgLSB0aGUgdHlwZVxyXG4gKiBAcGFyYW0gZmFsbGJhY2sgIC0gQSBoYXJkY29kZWQgZmFsbGJhY2sgdmFsdWVcclxuICogQHJldHVybnMgVGhlIGNvbmZpZ1xyXG4gKi9cclxuZnVuY3Rpb24gcmVzb2x2ZUVudlZhcjxUPihlbnZWYXI6IHN0cmluZywgZW52VmFyVHlwZTogRW52VmFyVHlwZSwgZmFsbGJhY2s6IFQpOiBUIHtcclxuICAgIGNvbnN0IHJhd0VudlZhciA9IHByb2Nlc3MuZW52W2VudlZhcl07XHJcbiAgICBpZiAocmF3RW52VmFyID09PSB1bmRlZmluZWQgfHwgXy5pc0VtcHR5KHJhd0VudlZhcikpIHtcclxuICAgICAgICByZXR1cm4gZmFsbGJhY2s7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gSWYgdGhlIGVudmlvcm5tZW50IHZhcmlhYmxlIHBvaW50cyB0byBhIGZpbGVcclxuICAgIGlmIChmcy5leGlzdHNTeW5jKHJhd0VudlZhcikpIHtcclxuICAgICAgICByZXR1cm4gSlNPTi5wYXJzZShmcy5yZWFkRmlsZVN5bmMocmF3RW52VmFyLCAndXRmOCcpKTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gYXNzZXJ0RW52VmFyVHlwZShlbnZWYXIsIHByb2Nlc3MuZW52W2VudlZhcl0sIGVudlZhclR5cGUpO1xyXG59XHJcblxyXG4vLyAkZXNsaW50LWZpeC1tZSBodHRwczovL2dpdGh1Yi5jb20vcmhpbm9kYXZpZC9lc2xpbnQtZml4LW1lXHJcbi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XHJcbmZ1bmN0aW9uIGFzc2VydEVudlZhclR5cGUobmFtZTogc3RyaW5nLCB2YWx1ZTogYW55LCBleHBlY3RlZFR5cGU6IEVudlZhclR5cGUpOiBhbnkge1xyXG4gICAgbGV0IHJldHVyblZhbHVlO1xyXG4gICAgc3dpdGNoIChleHBlY3RlZFR5cGUpIHtcclxuICAgICAgICBjYXNlIEVudlZhclR5cGUuUG9ydDpcclxuICAgICAgICAgICAgcmV0dXJuVmFsdWUgPSBwYXJzZUludCh2YWx1ZSwgMTApO1xyXG4gICAgICAgICAgICAvLyAkZXNsaW50LWZpeC1tZSBodHRwczovL2dpdGh1Yi5jb20vcmhpbm9kYXZpZC9lc2xpbnQtZml4LW1lXHJcbiAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1jYXNlLWRlY2xhcmF0aW9uc1xyXG4gICAgICAgICAgICBjb25zdCBpc1dpdGhpblJhbmdlID0gcmV0dXJuVmFsdWUgPj0gMCAmJiByZXR1cm5WYWx1ZSA8PSA2NTUzNTtcclxuICAgICAgICAgICAgaWYgKGlzTmFOKHJldHVyblZhbHVlKSB8fCAhaXNXaXRoaW5SYW5nZSkge1xyXG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGAke25hbWV9IG11c3QgYmUgYmV0d2VlbiAwIHRvIDY1NTM1LCBmb3VuZCAke3ZhbHVlfS5gKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gcmV0dXJuVmFsdWU7XHJcbiAgICAgICAgY2FzZSBFbnZWYXJUeXBlLkNoYWluSWQ6XHJcbiAgICAgICAgY2FzZSBFbnZWYXJUeXBlLktlZXBBbGl2ZVRpbWVvdXQ6XHJcbiAgICAgICAgY2FzZSBFbnZWYXJUeXBlLkludGVnZXI6XHJcbiAgICAgICAgICAgIHJldHVyblZhbHVlID0gcGFyc2VJbnQodmFsdWUsIDEwKTtcclxuICAgICAgICAgICAgaWYgKGlzTmFOKHJldHVyblZhbHVlKSkge1xyXG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGAke25hbWV9IG11c3QgYmUgYSB2YWxpZCBpbnRlZ2VyLCBmb3VuZCAke3ZhbHVlfS5gKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gcmV0dXJuVmFsdWU7XHJcbiAgICAgICAgY2FzZSBFbnZWYXJUeXBlLkVUSEFkZHJlc3NIZXg6XHJcbiAgICAgICAgICAgIGFzc2VydC5pc0VUSEFkZHJlc3NIZXgobmFtZSwgdmFsdWUpO1xyXG4gICAgICAgICAgICByZXR1cm4gdmFsdWU7XHJcbiAgICAgICAgY2FzZSBFbnZWYXJUeXBlLlVybDpcclxuICAgICAgICAgICAgYXNzZXJ0LmlzVXJpKG5hbWUsIHZhbHVlKTtcclxuICAgICAgICAgICAgcmV0dXJuIHZhbHVlO1xyXG4gICAgICAgIGNhc2UgRW52VmFyVHlwZS5VcmxMaXN0OlxyXG4gICAgICAgICAgICBhc3NlcnQuaXNTdHJpbmcobmFtZSwgdmFsdWUpO1xyXG4gICAgICAgICAgICAvLyAkZXNsaW50LWZpeC1tZSBodHRwczovL2dpdGh1Yi5jb20vcmhpbm9kYXZpZC9lc2xpbnQtZml4LW1lXHJcbiAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1jYXNlLWRlY2xhcmF0aW9uc1xyXG4gICAgICAgICAgICBjb25zdCB1cmxMaXN0ID0gKHZhbHVlIGFzIHN0cmluZykuc3BsaXQoJywnKTtcclxuICAgICAgICAgICAgdXJsTGlzdC5mb3JFYWNoKCh1cmwsIGkpID0+IGFzc2VydC5pc1VyaShgJHtuYW1lfVske2l9XWAsIHVybCkpO1xyXG4gICAgICAgICAgICByZXR1cm4gdXJsTGlzdDtcclxuICAgICAgICBjYXNlIEVudlZhclR5cGUuQm9vbGVhbjpcclxuICAgICAgICAgICAgcmV0dXJuIHZhbHVlID09PSAndHJ1ZSc7XHJcbiAgICAgICAgY2FzZSBFbnZWYXJUeXBlLlVuaXRBbW91bnQ6XHJcbiAgICAgICAgICAgIHJldHVyblZhbHVlID0gbmV3IEJpZ051bWJlcihwYXJzZUZsb2F0KHZhbHVlKSk7XHJcbiAgICAgICAgICAgIGlmIChyZXR1cm5WYWx1ZS5pc05hTigpIHx8IHJldHVyblZhbHVlLmlzTmVnYXRpdmUoKSkge1xyXG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGAke25hbWV9IG11c3QgYmUgdmFsaWQgbnVtYmVyIGdyZWF0ZXIgdGhhbiAwLmApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiByZXR1cm5WYWx1ZTtcclxuICAgICAgICBjYXNlIEVudlZhclR5cGUuUmF0ZTpcclxuICAgICAgICAgICAgcmV0dXJuVmFsdWUgPSBwYXJzZUZsb2F0KHZhbHVlKTtcclxuICAgICAgICAgICAgaWYgKHJldHVyblZhbHVlIDwgMCB8fCByZXR1cm5WYWx1ZSA+IDEpIHtcclxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgJHtuYW1lfSBtdXN0IGJlIHZhbGlkIG51bWJlciBiZXR3ZWVuIDAuMCBhbmQgMS4wLmApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiByZXR1cm5WYWx1ZTtcclxuICAgICAgICBjYXNlIEVudlZhclR5cGUuQWRkcmVzc0xpc3Q6XHJcbiAgICAgICAgICAgIGFzc2VydC5pc1N0cmluZyhuYW1lLCB2YWx1ZSk7XHJcbiAgICAgICAgICAgIC8vICRlc2xpbnQtZml4LW1lIGh0dHBzOi8vZ2l0aHViLmNvbS9yaGlub2RhdmlkL2VzbGludC1maXgtbWVcclxuICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWNhc2UtZGVjbGFyYXRpb25zXHJcbiAgICAgICAgICAgIGNvbnN0IGFkZHJlc3NMaXN0ID0gKHZhbHVlIGFzIHN0cmluZykuc3BsaXQoJywnKS5tYXAoKGEpID0+IGEudG9Mb3dlckNhc2UoKSk7XHJcbiAgICAgICAgICAgIGFkZHJlc3NMaXN0LmZvckVhY2goKGEsIGkpID0+IGFzc2VydC5pc0VUSEFkZHJlc3NIZXgoYCR7bmFtZX1bJHtpfV1gLCBhKSk7XHJcbiAgICAgICAgICAgIHJldHVybiBhZGRyZXNzTGlzdDtcclxuICAgICAgICBjYXNlIEVudlZhclR5cGUuU3RyaW5nTGlzdDpcclxuICAgICAgICAgICAgYXNzZXJ0LmlzU3RyaW5nKG5hbWUsIHZhbHVlKTtcclxuICAgICAgICAgICAgLy8gJGVzbGludC1maXgtbWUgaHR0cHM6Ly9naXRodWIuY29tL3JoaW5vZGF2aWQvZXNsaW50LWZpeC1tZVxyXG4gICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tY2FzZS1kZWNsYXJhdGlvbnNcclxuICAgICAgICAgICAgY29uc3Qgc3RyaW5nTGlzdCA9ICh2YWx1ZSBhcyBzdHJpbmcpLnNwbGl0KCcsJyk7XHJcbiAgICAgICAgICAgIHJldHVybiBzdHJpbmdMaXN0O1xyXG4gICAgICAgIGNhc2UgRW52VmFyVHlwZS5XaGl0ZWxpc3RBbGxUb2tlbnM6XHJcbiAgICAgICAgICAgIHJldHVybiAnKic7XHJcbiAgICAgICAgY2FzZSBFbnZWYXJUeXBlLk5vbkVtcHR5U3RyaW5nOlxyXG4gICAgICAgICAgICBhc3NlcnQuaXNTdHJpbmcobmFtZSwgdmFsdWUpO1xyXG4gICAgICAgICAgICBpZiAodmFsdWUgPT09ICcnKSB7XHJcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYCR7bmFtZX0gbXVzdCBiZSBzdXBwbGllZGApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiB2YWx1ZTtcclxuICAgICAgICBjYXNlIEVudlZhclR5cGUuQVBJS2V5czpcclxuICAgICAgICAgICAgYXNzZXJ0LmlzU3RyaW5nKG5hbWUsIHZhbHVlKTtcclxuICAgICAgICAgICAgLy8gJGVzbGludC1maXgtbWUgaHR0cHM6Ly9naXRodWIuY29tL3JoaW5vZGF2aWQvZXNsaW50LWZpeC1tZVxyXG4gICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tY2FzZS1kZWNsYXJhdGlvbnNcclxuICAgICAgICAgICAgY29uc3QgYXBpS2V5cyA9ICh2YWx1ZSBhcyBzdHJpbmcpLnNwbGl0KCcsJyk7XHJcbiAgICAgICAgICAgIGFwaUtleXMuZm9yRWFjaCgoYXBpS2V5KSA9PiB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpc1ZhbGlkVVVJRCA9IHZhbGlkYXRlVVVJRChhcGlLZXkpO1xyXG4gICAgICAgICAgICAgICAgaWYgKCFpc1ZhbGlkVVVJRCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgQVBJIEtleSAke2FwaUtleX0gaXNuJ3QgVVVJRCBjb21wbGlhbnRgKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHJldHVybiBhcGlLZXlzO1xyXG4gICAgICAgIGNhc2UgRW52VmFyVHlwZS5Kc29uU3RyaW5nTGlzdDpcclxuICAgICAgICAgICAgYXNzZXJ0LmlzU3RyaW5nKG5hbWUsIHZhbHVlKTtcclxuICAgICAgICAgICAgcmV0dXJuIEpTT04ucGFyc2UodmFsdWUpO1xyXG4gICAgICAgIGNhc2UgRW52VmFyVHlwZS5SZnFNYWtlckFzc2V0T2ZmZXJpbmdzOlxyXG4gICAgICAgICAgICAvLyAkZXNsaW50LWZpeC1tZSBodHRwczovL2dpdGh1Yi5jb20vcmhpbm9kYXZpZC9lc2xpbnQtZml4LW1lXHJcbiAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1jYXNlLWRlY2xhcmF0aW9uc1xyXG4gICAgICAgICAgICBjb25zdCBvZmZlcmluZ3M6IFJmcU1ha2VyQXNzZXRPZmZlcmluZ3MgPSBKU09OLnBhcnNlKHZhbHVlKTtcclxuICAgICAgICAgICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOmZvcmluXHJcbiAgICAgICAgICAgIGZvciAoY29uc3QgbWFrZXJFbmRwb2ludCBpbiBvZmZlcmluZ3MpIHtcclxuICAgICAgICAgICAgICAgIGFzc2VydC5pc1dlYlVyaSgnbWFya2V0IG1ha2VyIGVuZHBvaW50JywgbWFrZXJFbmRwb2ludCk7XHJcblxyXG4gICAgICAgICAgICAgICAgY29uc3QgYXNzZXRPZmZlcmluZyA9IG9mZmVyaW5nc1ttYWtlckVuZHBvaW50XTtcclxuICAgICAgICAgICAgICAgIGFzc2VydC5pc0FycmF5KGB2YWx1ZSBpbiBtYWtlciBlbmRwb2ludCBtYXBwaW5nLCBmb3IgaW5kZXggJHttYWtlckVuZHBvaW50fSxgLCBhc3NldE9mZmVyaW5nKTtcclxuICAgICAgICAgICAgICAgIGFzc2V0T2ZmZXJpbmcuZm9yRWFjaCgoYXNzZXRQYWlyLCBpKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgYXNzZXJ0LmlzQXJyYXkoYGFzc2V0IHBhaXIgYXJyYXkgJHtpfSBmb3IgbWFrZXIgZW5kcG9pbnQgJHttYWtlckVuZHBvaW50fWAsIGFzc2V0UGFpcik7XHJcbiAgICAgICAgICAgICAgICAgICAgYXNzZXJ0LmFzc2VydChcclxuICAgICAgICAgICAgICAgICAgICAgICAgYXNzZXRQYWlyLmxlbmd0aCA9PT0gMixcclxuICAgICAgICAgICAgICAgICAgICAgICAgYGFzc2V0IHBhaXIgYXJyYXkgJHtpfSBmb3IgbWFrZXIgZW5kcG9pbnQgJHttYWtlckVuZHBvaW50fSBkb2VzIG5vdCBjb25zaXN0IG9mIGV4YWN0bHkgdHdvIGVsZW1lbnRzLmAsXHJcbiAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgICAgICBhc3NlcnQuaXNFVEhBZGRyZXNzSGV4KFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBgZmlyc3QgdG9rZW4gYWRkcmVzcyBmb3IgYXNzZXQgcGFpciAke2l9IGZvciBtYWtlciBlbmRwb2ludCAke21ha2VyRW5kcG9pbnR9YCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYXNzZXRQYWlyWzBdLFxyXG4gICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICAgICAgYXNzZXJ0LmlzRVRIQWRkcmVzc0hleChcclxuICAgICAgICAgICAgICAgICAgICAgICAgYHNlY29uZCB0b2tlbiBhZGRyZXNzIGZvciBhc3NldCBwYWlyICR7aX0gZm9yIG1ha2VyIGVuZHBvaW50ICR7bWFrZXJFbmRwb2ludH1gLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhc3NldFBhaXJbMV0sXHJcbiAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgICAgICBhc3NlcnQuYXNzZXJ0KFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhc3NldFBhaXJbMF0gIT09IGFzc2V0UGFpclsxXSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYGFzc2V0IHBhaXIgYXJyYXkgJHtpfSBmb3IgbWFrZXIgZW5kcG9pbnQgJHttYWtlckVuZHBvaW50fSBoYXMgaWRlbnRpY2FsIGFzc2V0c2AsXHJcbiAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBvZmZlcmluZ3M7XHJcbiAgICAgICAgY2FzZSBFbnZWYXJUeXBlLkxpcXVpZGl0eVByb3ZpZGVyUmVnaXN0cnk6XHJcbiAgICAgICAgICAgIC8vICRlc2xpbnQtZml4LW1lIGh0dHBzOi8vZ2l0aHViLmNvbS9yaGlub2RhdmlkL2VzbGludC1maXgtbWVcclxuICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWNhc2UtZGVjbGFyYXRpb25zXHJcbiAgICAgICAgICAgIGNvbnN0IHJlZ2lzdHJ5OiBMaXF1aWRpdHlQcm92aWRlclJlZ2lzdHJ5ID0gSlNPTi5wYXJzZSh2YWx1ZSk7XHJcbiAgICAgICAgICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTpmb3JpblxyXG4gICAgICAgICAgICBmb3IgKGNvbnN0IGxpcXVpZGl0eVByb3ZpZGVyIGluIHJlZ2lzdHJ5KSB7XHJcbiAgICAgICAgICAgICAgICBhc3NlcnQuaXNFVEhBZGRyZXNzSGV4KCdsaXF1aWRpdHkgcHJvdmlkZXIgYWRkcmVzcycsIGxpcXVpZGl0eVByb3ZpZGVyKTtcclxuXHJcbiAgICAgICAgICAgICAgICBjb25zdCB7IHRva2VucyB9ID0gcmVnaXN0cnlbbGlxdWlkaXR5UHJvdmlkZXJdO1xyXG4gICAgICAgICAgICAgICAgYXNzZXJ0LmlzQXJyYXkoYHRva2VuIGxpc3QgZm9yIGxpcXVpZGl0eSBwcm92aWRlciAke2xpcXVpZGl0eVByb3ZpZGVyfWAsIHRva2Vucyk7XHJcbiAgICAgICAgICAgICAgICB0b2tlbnMuZm9yRWFjaCgodG9rZW4sIGkpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBhc3NlcnQuaXNFVEhBZGRyZXNzSGV4KGBhZGRyZXNzIG9mIHRva2VuICR7aX0gZm9yIGxpcXVpZGl0eSBwcm92aWRlciAke2xpcXVpZGl0eVByb3ZpZGVyfWAsIHRva2VuKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgLy8gVE9ETyBqYWNvYiB2YWxpZGF0ZSBnYXMgY29zdCBjYWxsYmFjayBpbiByZWdpc3RyeVxyXG4gICAgICAgICAgICAgICAgLy8gYXNzZXJ0LmlzTnVtYmVyKGBnYXMgY29zdCBmb3IgbGlxdWlkaXR5IHByb3ZpZGVyICR7bGlxdWlkaXR5UHJvdmlkZXJ9YCwgZ2FzQ29zdCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIHJlZ2lzdHJ5O1xyXG5cclxuICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFVucmVjb2duaXNlZCBFbnZWYXJUeXBlOiAke2V4cGVjdGVkVHlwZX0gZW5jb3VudGVyZWQgZm9yIHZhcmlhYmxlICR7bmFtZX0uYCk7XHJcbiAgICB9XHJcbn1cclxuIl0sInZlcnNpb24iOjN9