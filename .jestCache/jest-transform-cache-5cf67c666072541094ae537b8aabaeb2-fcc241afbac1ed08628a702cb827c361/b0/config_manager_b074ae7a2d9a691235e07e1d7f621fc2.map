{"file":"/Users/davidwalsh/code-local/0x-rfq-api/src/utils/config_manager.ts","mappings":";;;AAAA,8CAA8C;AAC9C,mCAAoC;AAEpC,sCAemB;AAEnB,mDAAkD;AAElD,MAAM,aAAa,GAAG,CAAC,MAAc,EAAU,EAAE,CAAC,IAAA,mBAAU,EAAC,QAAQ,CAAC,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC;AAEvG;;;;GAIG;AACH,MAAa,aAAa;IACf,cAAc;QACjB,OAAO,sBAAa,CAAC;IACzB,CAAC;IAEM,sBAAsB;QACzB,OAAO,+BAAsB,CAAC;IAClC,CAAC;IAEM,sBAAsB,CAAC,MAAc;QACxC,OAAO,qCAA4B,CAAC,GAAG,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC,CAAC;IACnE,CAAC;IAEM,wBAAwB,CAAC,YAAoB;QAChD,OAAO,IAAA,iCAAwB,EAAC,YAAY,CAAC,CAAC;IAClD,CAAC;IAEM,wBAAwB,CAAC,MAAc;QAC1C,OAAO,IAAA,iCAAwB,EAAC,MAAM,CAAC,CAAC;IAC5C,CAAC;IAED;;OAEG;IACI,4BAA4B;QAC/B,OAAO,wCAA+B,CAAC;IAC3C,CAAC;IAED;;OAEG;IACI,iBAAiB;QACpB,OAAO,0BAAiB,CAAC;IAC7B,CAAC;IAED;;OAEG;IACI,4BAA4B;QAC/B,OAAO,wCAA+B,CAAC;IAC3C,CAAC;IAED;;OAEG;IACI,4BAA4B;QAC/B,OAAO,wCAA+B,CAAC;IAC3C,CAAC;IAED;;OAEG;IACI,wBAAwB,CAAC,OAAe,EAAE,MAAc,EAAE,MAAc;QAC3E,IAAI,oCAA2B,CAAC,GAAG,CAAC,OAAO,CAAC,EAAE;YAC1C,MAAM,OAAO,GAAG,IAAA,yBAAY,EAAC,MAAM,EAAE,MAAM,CAAC,CAAC;YAC7C,6DAA6D;YAC7D,oEAAoE;YACpE,MAAM,QAAQ,GAAG,oCAA2B,CAAC,GAAG,CAAC,OAAO,CAAE,CAAC;YAC3D,IAAI,QAAQ,CAAC,GAAG,CAAC,OAAO,CAAC,EAAE;gBACvB,6DAA6D;gBAC7D,oEAAoE;gBACpE,OAAO,QAAQ,CAAC,GAAG,CAAC,OAAO,CAAE,CAAC;aACjC;SACJ;QAED,OAAO,wCAA+B,CAAC;IAC3C,CAAC;CACJ;AAnED,sCAmEC","names":[],"sources":["/Users/davidwalsh/code-local/0x-rfq-api/src/utils/config_manager.ts"],"sourcesContent":["// tslint:disable: prefer-function-over-method\r\nimport { createHash } from 'crypto';\r\n\r\nimport {\r\n    ADMIN_API_KEY,\r\n    DEFAULT_FEE_MODEL_CONFIGURATION,\r\n    FeeModelConfiguration,\r\n    FEE_MODEL_CONFIGURATION_MAP,\r\n    getIntegratorByIdOrThrow,\r\n    getIntegratorIdForApiKey,\r\n    Integrator,\r\n    MakerIdSet,\r\n    RFQM_API_KEY_WHITELIST,\r\n    RFQM_MAKER_ID_SET,\r\n    RFQM_MAKER_ID_SET_FOR_OTC_ORDER,\r\n    RFQT_MAKER_ID_SET_FOR_OTC_ORDER,\r\n    RFQT_MAKER_ID_SET_FOR_RFQ_ORDER,\r\n    RFQ_API_KEY_HASH_TO_MAKER_ID,\r\n} from '../config';\r\n\r\nimport { toPairString } from '../core/pair_utils';\r\n\r\nconst getApiKeyHash = (apiKey: string): string => createHash('sha256').update(apiKey).digest('base64');\r\n\r\n/**\r\n * ConfigManager is a simple wrapper around configs.\r\n *\r\n * It exists to provide a layer around our configs which can then be mocked while writing tests\r\n */\r\nexport class ConfigManager {\r\n    public getAdminApiKey(): string | undefined {\r\n        return ADMIN_API_KEY;\r\n    }\r\n\r\n    public getRfqmApiKeyWhitelist(): Set<string> {\r\n        return RFQM_API_KEY_WHITELIST;\r\n    }\r\n\r\n    public getRfqMakerIdForApiKey(apiKey: string): string | undefined {\r\n        return RFQ_API_KEY_HASH_TO_MAKER_ID.get(getApiKeyHash(apiKey));\r\n    }\r\n\r\n    public getIntegratorByIdOrThrow(integratorId: string): Integrator {\r\n        return getIntegratorByIdOrThrow(integratorId);\r\n    }\r\n\r\n    public getIntegratorIdForApiKey(apiKey: string): string | undefined {\r\n        return getIntegratorIdForApiKey(apiKey);\r\n    }\r\n\r\n    /**\r\n     * Get a set of makers that support RFQt workflow with rfq order type\r\n     */\r\n    public getRfqtMakerIdSetForRfqOrder(): MakerIdSet {\r\n        return RFQT_MAKER_ID_SET_FOR_RFQ_ORDER;\r\n    }\r\n\r\n    /**\r\n     * Get a set of makers that support RFQm workflow\r\n     */\r\n    public getRfqmMakerIdSet(): MakerIdSet {\r\n        return RFQM_MAKER_ID_SET;\r\n    }\r\n\r\n    /**\r\n     * Get a set of makers that support RFQt workflow with otc order type\r\n     */\r\n    public getRfqtMakerIdSetForOtcOrder(): MakerIdSet {\r\n        return RFQT_MAKER_ID_SET_FOR_OTC_ORDER;\r\n    }\r\n\r\n    /**\r\n     * Get a set of makers that support RFQm workflow with otc order type\r\n     */\r\n    public getRfqmMakerIdSetForOtcOrder(): MakerIdSet {\r\n        return RFQM_MAKER_ID_SET_FOR_OTC_ORDER;\r\n    }\r\n\r\n    /**\r\n     * Get fee model constant for given pair on a given chain.\r\n     */\r\n    public getFeeModelConfiguration(chainId: number, tokenA: string, tokenB: string): FeeModelConfiguration {\r\n        if (FEE_MODEL_CONFIGURATION_MAP.has(chainId)) {\r\n            const pairKey = toPairString(tokenA, tokenB);\r\n            // $eslint-fix-me https://github.com/rhinodavid/eslint-fix-me\r\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\r\n            const innerMap = FEE_MODEL_CONFIGURATION_MAP.get(chainId)!;\r\n            if (innerMap.has(pairKey)) {\r\n                // $eslint-fix-me https://github.com/rhinodavid/eslint-fix-me\r\n                // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\r\n                return innerMap.get(pairKey)!;\r\n            }\r\n        }\r\n\r\n        return DEFAULT_FEE_MODEL_CONFIGURATION;\r\n    }\r\n}\r\n"],"version":3}