745519a44fd576c058c2b97e4a21ff1b
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.META_TXN_RELAY_EXPECTED_MINED_SEC = exports.RFQ_SIGN_ENDPOINT_TIMEOUT_MS = exports.RFQ_PRICE_ENDPOINT_TIMEOUT_MS = exports.RFQM_MAINTENANCE_MODE = exports.RFQM_WORKER_GROUP_SIZE = exports.RFQM_WORKER_GROUP_INDEX = exports.META_TX_WORKER_MNEMONIC = exports.RFQ_API_KEY_HASH_TO_MAKER_ID = exports.RFQM_MAKER_ID_SET_FOR_OTC_ORDER = exports.RFQT_MAKER_ID_SET_FOR_OTC_ORDER = exports.RFQT_MAKER_ID_SET_FOR_RFQ_ORDER = exports.RFQM_MAKER_ID_SET = exports.TAKER_SPECIFIED_SIDE_ENABLED = exports.REASON_ON_STATUS_ERROR_RESPONSE_ENABLED = exports.ADMIN_API_KEY = exports.RFQM_API_KEY_WHITELIST = exports.ALT_RFQ_MM_PROFILE = exports.ALT_RFQ_MM_API_KEY = exports.ALT_RFQ_MM_ENDPOINT = exports.LOGGER_INCLUDE_TIMESTAMP = exports.BACKGROUND_JOB_TYPES = exports.REDIS_BACKGROUND_JOB_URI = exports.REDIS_URI = exports.SENTRY_TRACES_SAMPLE_RATE = exports.TOKEN_PRICE_ORACLE_TIMEOUT = exports.ZERO_EX_API_KEY = exports.DEFINED_FI_ENDPOINT = exports.DEFINED_FI_API_KEY = exports.SENTRY_DSN = exports.SENTRY_ENVIRONMENT = exports.POSTGRES_READ_REPLICA_URIS = exports.POSTGRES_URI = exports.FEE_RECIPIENT_ADDRESS = exports.KAFKA_BROKERS = exports.CHAIN_ID = exports.HTTP_HEADERS_TIMEOUT = exports.HTTP_KEEP_ALIVE_TIMEOUT = exports.HEALTHCHECK_HTTP_PORT = exports.HTTP_PORT = exports.LOG_LEVEL = exports.RFQ_MAKER_CONFIGS = exports.getMakerIdSetForOrderType = exports.RFQ_MAKER_REFRESH_INTERVAL_MS = exports.getIntegratorIdFromLabel = exports.getApiKeyWhitelistFromIntegratorsAcl = exports.INTEGRATORS_ACL = exports.DEFAULT_FEE_MODEL_CONFIGURATION = exports.FEE_MODEL_CONFIGURATION_MAP = exports.ZERO_EX_FEE_CONFIGURATION_MAP = exports.CHAIN_CONFIGURATIONS = void 0;
exports.META_TRANSACTION_SERVICE_RPC_URL = exports.getIntegratorIdForApiKey = exports.getIntegratorByIdOrThrow = exports.defaultHttpServiceConfig = exports.LLR_COOLDOWN_DURATION_SECONDS = exports.ENABLE_LLR_COOLDOWN = exports.RFQ_PROXY_PORT = exports.RFQ_PROXY_ADDRESS = exports.ETH_GAS_STATION_API_URL = exports.PROMETHEUS_PORT = exports.ENABLE_PROMETHEUS_METRICS = void 0;
const assert_1 = require("@0x/assert");
const contract_addresses_1 = require("@0x/contract-addresses");
const utils_1 = require("@0x/utils");
const fs = require("fs");
const _ = require("lodash");
const validateUUID = require("uuid-validate");
const constants_1 = require("./core/constants");
const schemas_1 = require("./core/schemas");
const pair_utils_1 = require("./core/pair_utils");
const schema_utils_1 = require("./core/schema_utils");
// tslint:disable:no-bitwise
var EnvVarType;
(function (EnvVarType) {
    EnvVarType[EnvVarType["AddressList"] = 0] = "AddressList";
    EnvVarType[EnvVarType["StringList"] = 1] = "StringList";
    EnvVarType[EnvVarType["Integer"] = 2] = "Integer";
    EnvVarType[EnvVarType["Port"] = 3] = "Port";
    EnvVarType[EnvVarType["KeepAliveTimeout"] = 4] = "KeepAliveTimeout";
    EnvVarType[EnvVarType["ChainId"] = 5] = "ChainId";
    EnvVarType[EnvVarType["ETHAddressHex"] = 6] = "ETHAddressHex";
    EnvVarType[EnvVarType["UnitAmount"] = 7] = "UnitAmount";
    EnvVarType[EnvVarType["Rate"] = 8] = "Rate";
    EnvVarType[EnvVarType["Url"] = 9] = "Url";
    EnvVarType[EnvVarType["UrlList"] = 10] = "UrlList";
    EnvVarType[EnvVarType["WhitelistAllTokens"] = 11] = "WhitelistAllTokens";
    EnvVarType[EnvVarType["Boolean"] = 12] = "Boolean";
    EnvVarType[EnvVarType["NonEmptyString"] = 13] = "NonEmptyString";
    EnvVarType[EnvVarType["APIKeys"] = 14] = "APIKeys";
    EnvVarType[EnvVarType["PrivateKeys"] = 15] = "PrivateKeys";
    EnvVarType[EnvVarType["RfqMakerAssetOfferings"] = 16] = "RfqMakerAssetOfferings";
    EnvVarType[EnvVarType["LiquidityProviderRegistry"] = 17] = "LiquidityProviderRegistry";
    EnvVarType[EnvVarType["JsonStringList"] = 18] = "JsonStringList";
})(EnvVarType || (EnvVarType = {}));
/**
 * Configuration which contains information about chains and
 * related resources, like the RPC url.
 */
exports.CHAIN_CONFIGURATIONS = (() => {
    let result;
    try {
        result = resolveEnvVar('CHAIN_CONFIGURATIONS', EnvVarType.JsonStringList, []);
        schema_utils_1.schemaUtils.validateSchema(result, schemas_1.schemas.chainConfigurationsSchema);
    }
    catch (e) {
        throw new Error(`CHAIN_CONFIGURATIONS was defined but is not valid JSON per the schema: ${e}`);
    }
    return result;
})();
exports.ZERO_EX_FEE_CONFIGURATION_MAP = (() => {
    try {
        const zeroExFeeRawConfigurations = resolveEnvVar('ZERO_EX_FEE_CONFIGURATIONS', EnvVarType.JsonStringList, []);
        schema_utils_1.schemaUtils.validateSchema(zeroExFeeRawConfigurations, schemas_1.schemas.zeroExFeeConfigurationsSchema);
        return zeroExFeeRawConfigurations.reduce((acc, curr) => {
            const { integratorId, chainId } = curr;
            if (!acc.get(integratorId)) {
                acc.set(integratorId, new Map());
            }
            const pairsFeeEntries = new Map();
            const cartesianProductFeeEntries = [];
            const tokensEntries = new Map();
            curr.fees.forEach((feeConfig) => {
                let feeParameter;
                switch (curr.feeOn) {
                    case 'volume':
                        if (feeConfig.volumePercentage === undefined) {
                            throw new Error(`volumePercentage not defined for ${curr.integratorId} for fee on volume`);
                        }
                        feeParameter = new utils_1.BigNumber(feeConfig.volumePercentage);
                        break;
                    case 'integrator_share':
                        if (feeConfig.integratorSharePercentage === undefined) {
                            throw new Error(`integratorSharePercentage not defined for ${curr.integratorId} for fee on volume`);
                        }
                        feeParameter = new utils_1.BigNumber(feeConfig.integratorSharePercentage);
                        break;
                    default:
                        ((_x) => {
                            throw new Error('unreachable');
                        })(curr.feeOn);
                }
                if (feeConfig.kind === 'pairs') {
                    // parse config entries that are of kind `pairs`
                    feeConfig.pairs.forEach(({ tokenA, tokenB }) => {
                        pairsFeeEntries.set((0, pair_utils_1.toPairString)(tokenA, tokenB), feeParameter);
                    });
                }
                else if (feeConfig.kind === 'cartesian_product') {
                    // parse config entries that are of kind `cartesian_product`
                    cartesianProductFeeEntries.push({
                        setA: new Set(feeConfig.setA.map((tokenAndLabel) => tokenAndLabel.token.toLocaleLowerCase())),
                        setB: new Set(feeConfig.setB.map((tokenAndLabel) => tokenAndLabel.token.toLocaleLowerCase())),
                        parameter: feeParameter,
                    });
                }
                else if (feeConfig.kind === 'tokens') {
                    // parse config entries that are of kind `tokens`
                    feeConfig.tokens.forEach((tokenAndLabel) => {
                        tokensEntries.set(tokenAndLabel.token.toLocaleLowerCase(), feeParameter);
                    });
                }
            });
            // Compiler can't track the state of TypeScript map. We need to perform a undefined check even if
            // the value has been set for the integratorId previously. More discussion: https://stackoverflow.com/a/70726571
            const feeConfigByChainId = acc.get(integratorId);
            if (!feeConfigByChainId) {
                // This should never happen
                throw new Error(`${integratorId} is not set`);
            }
            feeConfigByChainId.set(chainId, {
                name: curr.name,
                feeOn: curr.feeOn,
                zeroEx: {
                    feeRecipient: curr.zeroEx.feeRecipient,
                    billingType: curr.zeroEx.billingType,
                },
                gas: {
                    feeRecipient: curr.gas.feeRecipient,
                    billingType: curr.gas.billingType,
                },
                pairsFeeEntries,
                cartesianProductFeeEntries,
                tokensEntries,
            });
            return acc;
        }, new Map());
    }
    catch (e) {
        throw new Error(`ZERO_EX_FEE_CONFIGURATIONS was defined but is not valid JSON per the schema: ${e}`);
    }
})();
/**
 * A nested map providing fee model constants for each token pair.
 * Use chainId as first key and pair key as the second key.
 */
exports.FEE_MODEL_CONFIGURATION_MAP = (() => {
    try {
        const feeModelConfigurations = resolveEnvVar('FEE_MODEL_CONFIGURATIONS', EnvVarType.JsonStringList, []);
        schema_utils_1.schemaUtils.validateSchema(feeModelConfigurations, schemas_1.schemas.feeModelConfigurationsSchema);
        return feeModelConfigurations.reduce((acc, curr) => {
            const { chainId, tokenA, tokenB, marginRakeRatio, tradeSizeBps } = curr;
            if (!acc.has(chainId)) {
                acc.set(chainId, new Map());
            }
            // $eslint-fix-me https://github.com/rhinodavid/eslint-fix-me
            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion
            acc.get(chainId).set((0, pair_utils_1.toPairString)(tokenA, tokenB), { marginRakeRatio, tradeSizeBps });
            return acc;
        }, new Map());
    }
    catch (e) {
        throw new Error(`FEE_MODEL_CONFIGURATIONS was defined but is not valid JSON per the schema: ${e}`);
    }
})();
exports.DEFAULT_FEE_MODEL_CONFIGURATION = { marginRakeRatio: 0, tradeSizeBps: 0 };
/**
 * Configuration which represents taker-integrators of the 0x API. The configuration contains the label, id,
 * api keys, and allowed liquidity sources for each integrator.
 */
exports.INTEGRATORS_ACL = (() => {
    let integrators;
    try {
        integrators = resolveEnvVar('INTEGRATORS_ACL', EnvVarType.JsonStringList, []);
        schema_utils_1.schemaUtils.validateSchema(integrators, schemas_1.schemas.integratorsAclSchema);
    }
    catch (e) {
        throw new Error(`INTEGRATORS_ACL was defined but is not valid JSON per the schema: ${e}`);
    }
    return integrators;
})();
/**
 * Extracts the integrator API keys from the `INTEGRATORS_ACL` environment variable for the provided group type.
 */
const getApiKeyWhitelistFromIntegratorsAcl = (groupType) => {
    return exports.INTEGRATORS_ACL.filter((i) => i[groupType])
        .flatMap((i) => i.apiKeys)
        .sort();
};
exports.getApiKeyWhitelistFromIntegratorsAcl = getApiKeyWhitelistFromIntegratorsAcl;
/**
 * Gets the integrator ID for the provided label.
 */
const getIntegratorIdFromLabel = (label) => {
    for (const integrator of exports.INTEGRATORS_ACL) {
        if (integrator.label === label) {
            return integrator.integratorId;
        }
    }
};
exports.getIntegratorIdFromLabel = getIntegratorIdFromLabel;
exports.RFQ_MAKER_REFRESH_INTERVAL_MS = constants_1.ONE_MINUTE_MS * 1;
/**
 * Generate a set of MakerIds that support a given order type for a given workflow
 */
const getMakerIdSetForOrderType = (orderType, workflow) => {
    const typesField = workflow === 'rfqt' ? 'rfqtOrderTypes' : 'rfqmOrderTypes';
    return exports.RFQ_MAKER_CONFIGS.reduce((acc, curr) => {
        if (orderType === 'any' || curr[typesField].includes(orderType)) {
            acc.add(curr.makerId);
        }
        return acc;
    }, new Set());
};
exports.getMakerIdSetForOrderType = getMakerIdSetForOrderType;
/**
 * A list of type RfqMakerConfig, read from the RFQ_MAKER_CONFIGS env variable
 */
exports.RFQ_MAKER_CONFIGS = (() => {
    try {
        const makerConfigs = resolveEnvVar('RFQ_MAKER_CONFIGS', EnvVarType.JsonStringList, []);
        schema_utils_1.schemaUtils.validateSchema(makerConfigs, schemas_1.schemas.rfqMakerConfigListSchema);
        return makerConfigs;
    }
    catch (e) {
        throw new Error(`RFQ_MAKER_CONFIGS was defined but is not valid JSON per the schema: ${e}`);
    }
})();
// Log level for pino.js
exports.LOG_LEVEL = _.isEmpty(process.env.LOG_LEVEL)
    ? 'info'
    : assertEnvVarType('LOG_LEVEL', process.env.LOG_LEVEL, EnvVarType.NonEmptyString);
// Network port to listen on
exports.HTTP_PORT = _.isEmpty(process.env.HTTP_PORT)
    ? 3000
    : assertEnvVarType('HTTP_PORT', process.env.HTTP_PORT, EnvVarType.Port);
// Network port for the healthcheck service at /healthz, if not provided, it uses the HTTP_PORT value.
exports.HEALTHCHECK_HTTP_PORT = _.isEmpty(process.env.HEALTHCHECK_HTTP_PORT)
    ? exports.HTTP_PORT
    : assertEnvVarType('HEALTHCHECK_HTTP_PORT', process.env.HEALTHCHECK_HTTP_PORT, EnvVarType.Port);
// Number of milliseconds of inactivity the servers waits for additional
// incoming data aftere it finished writing last response before a socket will
// be destroyed.
// Ref: https://nodejs.org/api/http.html#http_server_keepalivetimeout
exports.HTTP_KEEP_ALIVE_TIMEOUT = _.isEmpty(process.env.HTTP_KEEP_ALIVE_TIMEOUT)
    ? 76 * 1000
    : assertEnvVarType('HTTP_KEEP_ALIVE_TIMEOUT', process.env.HTTP_KEEP_ALIVE_TIMEOUT, EnvVarType.KeepAliveTimeout);
// Limit the amount of time the parser will wait to receive the complete HTTP headers.
// NOTE: This value HAS to be higher than HTTP_KEEP_ALIVE_TIMEOUT.
// Ref: https://nodejs.org/api/http.html#http_server_headerstimeout
exports.HTTP_HEADERS_TIMEOUT = _.isEmpty(process.env.HTTP_HEADERS_TIMEOUT)
    ? 77 * 1000
    : assertEnvVarType('HTTP_HEADERS_TIMEOUT', process.env.HTTP_HEADERS_TIMEOUT, EnvVarType.KeepAliveTimeout);
// Default chain id to use when not specified
exports.CHAIN_ID = _.isEmpty(process.env.CHAIN_ID)
    ? contract_addresses_1.ChainId.Kovan
    : assertEnvVarType('CHAIN_ID', process.env.CHAIN_ID, EnvVarType.ChainId);
exports.KAFKA_BROKERS = _.isEmpty(process.env.KAFKA_BROKERS)
    ? undefined
    : assertEnvVarType('KAFKA_BROKERS', process.env.KAFKA_BROKERS, EnvVarType.StringList);
// The fee recipient for orders
exports.FEE_RECIPIENT_ADDRESS = _.isEmpty(process.env.FEE_RECIPIENT_ADDRESS)
    ? constants_1.NULL_ADDRESS
    : assertEnvVarType('FEE_RECIPIENT_ADDRESS', process.env.FEE_RECIPIENT_ADDRESS, EnvVarType.ETHAddressHex);
exports.POSTGRES_URI = _.isEmpty(process.env.POSTGRES_URI)
    ? constants_1.DEFAULT_LOCAL_POSTGRES_URI
    : assertEnvVarType('POSTGRES_URI', process.env.POSTGRES_URI, EnvVarType.Url);
exports.POSTGRES_READ_REPLICA_URIS = _.isEmpty(process.env.POSTGRES_READ_REPLICA_URIS)
    ? undefined
    : assertEnvVarType('POSTGRES_READ_REPLICA_URIS', process.env.POSTGRES_READ_REPLICA_URIS, EnvVarType.UrlList);
// Environment name Sentry used to categorize issues and traces.
exports.SENTRY_ENVIRONMENT = _.isEmpty(process.env.SENTRY_ENVIRONMENT)
    ? constants_1.DEFAULT_SENTRY_ENVIRONMENT
    : assertEnvVarType('SENTRY_ENVIRONMENT', process.env.SENTRY_ENVIRONMENT, EnvVarType.NonEmptyString);
// An Url with client key to access Sentry from client SDK.
exports.SENTRY_DSN = _.isEmpty(process.env.SENTRY_DSN)
    ? undefined
    : assertEnvVarType('SENTRY_DSN', process.env.SENTRY_DSN, EnvVarType.Url);
// API Key for Defined.fi's token price API
exports.DEFINED_FI_API_KEY = _.isEmpty(process.env.DEFINED_FI_API_KEY)
    ? ''
    : assertEnvVarType('DEFINED_FI_API_KEY', process.env.DEFINED_FI_API_KEY, EnvVarType.NonEmptyString);
// Endpoint for Defined.fi's token price API, default to https://api.defined.fi
exports.DEFINED_FI_ENDPOINT = _.isEmpty(process.env.DEFINED_FI_ENDPOINT)
    ? 'https://api.defined.fi'
    : assertEnvVarType('DEFINED_FI_ENDPOINT', process.env.DEFINED_FI_ENDPOINT, EnvVarType.NonEmptyString);
// API Key for 0x API (for ZeroExApiClient)
exports.ZERO_EX_API_KEY = _.isEmpty(process.env.ZERO_EX_API_KEY)
    ? ''
    : assertEnvVarType('ZERO_EX_API_KEY', process.env.ZERO_EX_API_KEY, EnvVarType.NonEmptyString);
// $eslint-fix-me https://github.com/rhinodavid/eslint-fix-me
// eslint-disable-next-line @typescript-eslint/no-inferrable-types
exports.TOKEN_PRICE_ORACLE_TIMEOUT = 1000;
// Sampling rate of traces reported to Sentry. Should be a number between 0.0 and 1.0 (inclusive).
exports.SENTRY_TRACES_SAMPLE_RATE = _.isEmpty(process.env.SENTRY_TRACES_SAMPLE_RATE)
    ? 0
    : assertEnvVarType('SENTRY_TRACES_SAMPLE_RATE', process.env.SENTRY_TRACES_SAMPLE_RATE, EnvVarType.Rate);
exports.REDIS_URI = _.isEmpty(process.env.REDIS_URI) ? constants_1.DEFAULT_LOCAL_REDIS_URI : process.env.REDIS_URI;
exports.REDIS_BACKGROUND_JOB_URI = _.isEmpty(process.env.REDIS_BACKGROUND_JOB_URI)
    ? constants_1.DEFAULT_LOCAL_REDIS_URI
    : process.env.REDIS_BACKGROUND_JOB_URI;
exports.BACKGROUND_JOB_TYPES = _.isEmpty(process.env.BACKGROUND_JOB_TYPES)
    ? constants_1.DEFAULT_BACKGROUND_JOB_TYPES
    : process.env.BACKGROUND_JOB_TYPES;
// Should the logger include time field in the output logs, defaults to true.
exports.LOGGER_INCLUDE_TIMESTAMP = _.isEmpty(process.env.LOGGER_INCLUDE_TIMESTAMP)
    ? constants_1.DEFAULT_LOGGER_INCLUDE_TIMESTAMP
    : assertEnvVarType('LOGGER_INCLUDE_TIMESTAMP', process.env.LOGGER_INCLUDE_TIMESTAMP, EnvVarType.Boolean);
exports.ALT_RFQ_MM_ENDPOINT = _.isEmpty(process.env.ALT_RFQ_MM_ENDPOINT)
    ? undefined
    : assertEnvVarType('ALT_RFQ_MM_ENDPOINT', process.env.ALT_RFQ_MM_ENDPOINT, EnvVarType.Url);
exports.ALT_RFQ_MM_API_KEY = _.isEmpty(process.env.ALT_RFQ_MM_API_KEY)
    ? undefined
    : assertEnvVarType('ALT_RFQ_MM_API_KEY', process.env.ALT_RFQ_MM_API_KEY, EnvVarType.NonEmptyString);
exports.ALT_RFQ_MM_PROFILE = _.isEmpty(process.env.ALT_RFQ_MM_PROFILE)
    ? undefined
    : assertEnvVarType('ALT_RFQ_MM_PROFILE', process.env.ALT_RFQ_MM_PROFILE, EnvVarType.NonEmptyString);
exports.RFQM_API_KEY_WHITELIST = new Set((0, exports.getApiKeyWhitelistFromIntegratorsAcl)('rfqm'));
exports.ADMIN_API_KEY = _.isEmpty(process.env.ADMIN_API_KEY)
    ? undefined
    : assertEnvVarType('ADMIN_API_KEY', process.env.ADMIN_API_KEY, EnvVarType.NonEmptyString);
exports.REASON_ON_STATUS_ERROR_RESPONSE_ENABLED = _.isEmpty(process.env.REASON_ON_STATUS_ERROR_RESPONSE_ENABLED)
    ? false
    : assertEnvVarType('REASON_ON_STATUS_ERROR_RESPONSE_ENABLED', process.env.REASON_ON_STATUS_ERROR_RESPONSE_ENABLED, EnvVarType.Boolean);
exports.TAKER_SPECIFIED_SIDE_ENABLED = _.isEmpty(process.env.TAKER_SPECIFIED_SIDE_ENABLED)
    ? false
    : assertEnvVarType('TAKER_SPECIFIED_SIDE_ENABLED', process.env.TAKER_SPECIFIED_SIDE_ENABLED, EnvVarType.Boolean);
exports.RFQM_MAKER_ID_SET = (0, exports.getMakerIdSetForOrderType)('any', 'rfqm');
exports.RFQT_MAKER_ID_SET_FOR_RFQ_ORDER = (0, exports.getMakerIdSetForOrderType)('rfq', 'rfqt');
exports.RFQT_MAKER_ID_SET_FOR_OTC_ORDER = (0, exports.getMakerIdSetForOrderType)('otc', 'rfqt');
exports.RFQM_MAKER_ID_SET_FOR_OTC_ORDER = (0, exports.getMakerIdSetForOrderType)('otc', 'rfqm');
/**
 * A map from RFQ maker's api key hashes to maker ids.
 * Invalid hashes, which appear more than once in the config file and might resolve to different makers, are removed from the result.
 */
exports.RFQ_API_KEY_HASH_TO_MAKER_ID = (() => {
    const hashToIdCount = exports.RFQ_MAKER_CONFIGS.reduce((result, rfqMakerConfig) => {
        rfqMakerConfig.apiKeyHashes.forEach((hash) => result.set(hash, (result.get(hash) || 0) + 1));
        return result;
    }, new Map());
    return exports.RFQ_MAKER_CONFIGS.reduce((result, mm) => {
        mm.apiKeyHashes.forEach((hash) => {
            // Ignore invalid hashes with more than one appearances
            if (hashToIdCount.get(hash) === 1) {
                result.set(hash, mm.makerId);
            }
        });
        return result;
    }, new Map());
})();
exports.META_TX_WORKER_MNEMONIC = _.isEmpty(process.env.META_TX_WORKER_MNEMONIC)
    ? undefined
    : assertEnvVarType('META_TX_WORKER_MNEMONIC', process.env.META_TX_WORKER_MNEMONIC, EnvVarType.NonEmptyString);
exports.RFQM_WORKER_GROUP_INDEX = _.isEmpty(process.env.RFQM_WORKER_GROUP_INDEX)
    ? undefined
    : assertEnvVarType('RFQM_WORKER_GROUP_INDEX', process.env.RFQM_WORKER_GROUP_INDEX, EnvVarType.Integer);
exports.RFQM_WORKER_GROUP_SIZE = _.isEmpty(process.env.RFQM_WORKER_GROUP_SIZE)
    ? undefined
    : assertEnvVarType('RFQM_WORKER_GROUP_SIZE', process.env.RFQM_WORKER_GROUP_SIZE, EnvVarType.Integer);
// If set to TRUE, system health will change to MAINTENANCE and integrators will be told to not
// send RFQM orders.
// tslint:disable-next-line boolean-naming
exports.RFQM_MAINTENANCE_MODE = _.isEmpty(process.env.RFQM_MAINTENANCE_MODE)
    ? false
    : assertEnvVarType('RFQM_MAINTENANCE_MODE', process.env.RFQM_MAINTENANCE_MODE, EnvVarType.Boolean);
exports.RFQ_PRICE_ENDPOINT_TIMEOUT_MS = _.isEmpty(process.env.RFQ_PRICE_ENDPOINT_TIMEOUT_MS)
    ? 1000
    : assertEnvVarType('RFQ_PRICE_ENDPOINT_TIMEOUT_MS', process.env.RFQ_PRICE_ENDPOINT_TIMEOUT_MS, EnvVarType.Integer);
exports.RFQ_SIGN_ENDPOINT_TIMEOUT_MS = _.isEmpty(process.env.RFQ_SIGN_ENDPOINT_TIMEOUT_MS)
    ? 2000
    : assertEnvVarType('RFQ_SIGN_ENDPOINT_TIMEOUT_MS', process.env.RFQ_SIGN_ENDPOINT_TIMEOUT_MS, EnvVarType.Integer);
// The expected time for a meta-txn to be included in a block.
exports.META_TXN_RELAY_EXPECTED_MINED_SEC = _.isEmpty(process.env.META_TXN_RELAY_EXPECTED_MINED_SEC)
    ? constants_1.DEFAULT_EXPECTED_MINED_SEC
    : assertEnvVarType('META_TXN_RELAY_EXPECTED_MINED_SEC', process.env.META_TXN_RELAY_EXPECTED_MINED_SEC, EnvVarType.Integer);
// Whether or not prometheus metrics should be enabled.
// tslint:disable-next-line:boolean-naming
exports.ENABLE_PROMETHEUS_METRICS = _.isEmpty(process.env.ENABLE_PROMETHEUS_METRICS)
    ? false
    : assertEnvVarType('ENABLE_PROMETHEUS_METRICS', process.env.ENABLE_PROMETHEUS_METRICS, EnvVarType.Boolean);
exports.PROMETHEUS_PORT = _.isEmpty(process.env.PROMETHEUS_PORT)
    ? 8080
    : assertEnvVarType('PROMETHEUS_PORT', process.env.PROMETHEUS_PORT, EnvVarType.Port);
// Eth Gas Station URL
exports.ETH_GAS_STATION_API_URL = _.isEmpty(process.env.ETH_GAS_STATION_API_URL)
    ? constants_1.DEFAULT_ETH_GAS_STATION_API_URL
    : assertEnvVarType('ETH_GAS_STATION_API_URL', process.env.ETH_GAS_STATION_API_URL, EnvVarType.Url);
exports.RFQ_PROXY_ADDRESS = _.isEmpty(process.env.RFQ_PROXY_ADDRESS)
    ? undefined
    : assertEnvVarType('RFQ_PROXY_ADDRESS', process.env.RFQ_PROXY_ADDRESS, EnvVarType.NonEmptyString);
exports.RFQ_PROXY_PORT = _.isEmpty(process.env.RFQ_PROXY_PORT)
    ? undefined
    : assertEnvVarType('RFQ_PROXY_PORT', process.env.RFQ_PROXY_PORT, EnvVarType.Port);
// tslint:disable-next-line boolean-naming
exports.ENABLE_LLR_COOLDOWN = _.isEmpty(process.env.ENABLE_LLR_COOLDOWN)
    ? false
    : assertEnvVarType('ENABLE_LLR_COOLDOWN', process.env.ENABLE_LLR_COOLDOWN, EnvVarType.Boolean);
exports.LLR_COOLDOWN_DURATION_SECONDS = _.isEmpty(process.env.LLR_COOLDOWN_DURATION_SECONDS)
    ? 60
    : assertEnvVarType('LLR_COOLDOWN_DURATION_SECONDS', process.env.LLR_COOLDOWN_DURATION_SECONDS, EnvVarType.Integer);
exports.defaultHttpServiceConfig = {
    httpPort: exports.HTTP_PORT,
    healthcheckHttpPort: exports.HEALTHCHECK_HTTP_PORT,
    healthcheckPath: constants_1.HEALTHCHECK_PATH,
    httpKeepAliveTimeout: exports.HTTP_KEEP_ALIVE_TIMEOUT,
    httpHeadersTimeout: exports.HTTP_HEADERS_TIMEOUT,
    enablePrometheusMetrics: exports.ENABLE_PROMETHEUS_METRICS,
    prometheusPort: exports.PROMETHEUS_PORT,
    prometheusPath: constants_1.METRICS_PATH,
};
exports.getIntegratorByIdOrThrow = ((integratorsMap) => (integratorId) => {
    const integrator = integratorsMap.get(integratorId);
    if (!integrator) {
        throw new Error(`Integrator ${integratorId} does not exist.`);
    }
    return integrator;
})(transformIntegratorsAcl(exports.INTEGRATORS_ACL, 'integratorId'));
/**
 * Gets the integrator ID for a given API key. If the API key is not in the configuration, returns `undefined`.
 */
exports.getIntegratorIdForApiKey = ((integratorsMap) => (apiKey) => {
    const integrator = integratorsMap.get(apiKey);
    return integrator === null || integrator === void 0 ? void 0 : integrator.integratorId;
})(transformIntegratorsAcl(exports.INTEGRATORS_ACL, 'apiKeys'));
/**
 * Utility function to transform INTEGRATORS_ACL into a map of apiKey => integrator. The result can
 * be used to optimize the lookup of the integrator when a request comes in with an api key. Lookup complexity
 * becomes O(1) with the map instead of O(# integrators * # api keys) with the array.
 *
 * @param integrators the integrators map from the environment variable
 * @param keyBy either apiKeys (creates map keyed by every API key) or 'integratorId' (integratorId => Integrator)
 */
function transformIntegratorsAcl(integrators, keyBy) {
    const result = new Map();
    integrators.forEach((integrator) => {
        let mapKeys;
        switch (keyBy) {
            case 'apiKeys':
                mapKeys = integrator.apiKeys;
                break;
            case 'integratorId':
                mapKeys = [integrator.integratorId];
                break;
            default:
                throw new Error(`Parameter "${keyBy}" is misconfigured`);
        }
        mapKeys.forEach((apiKey) => {
            result.set(apiKey, integrator);
        });
    });
    return result;
}
/**
 * RPC
 */
exports.META_TRANSACTION_SERVICE_RPC_URL = _.isEmpty(process.env.META_TRANSACTION_SERVICE_RPC_URL)
    ? ''
    : assertEnvVarType('META_TRANSACTION_SERVICE_RPC_URL', process.env.META_TRANSACTION_SERVICE_RPC_URL, EnvVarType.Url);
/**
 * Resolves a config of type T for an Enviornment Variable. Checks:
 *  - If the env variable is undefined, use the hardcoded fallback
 *  - If the env variable points to a filepath, resolve it
 *  - Otherwise, just use the env variable
 *
 * @param envVar - the name of the Environment Variable
 * @param envVarType - the type
 * @param fallback  - A hardcoded fallback value
 * @returns The config
 */
function resolveEnvVar(envVar, envVarType, fallback) {
    const rawEnvVar = process.env[envVar];
    if (rawEnvVar === undefined || _.isEmpty(rawEnvVar)) {
        return fallback;
    }
    // If the enviornment variable points to a file
    if (fs.existsSync(rawEnvVar)) {
        return JSON.parse(fs.readFileSync(rawEnvVar, 'utf8'));
    }
    return assertEnvVarType(envVar, process.env[envVar], envVarType);
}
// $eslint-fix-me https://github.com/rhinodavid/eslint-fix-me
// eslint-disable-next-line @typescript-eslint/no-explicit-any
function assertEnvVarType(name, value, expectedType) {
    let returnValue;
    switch (expectedType) {
        case EnvVarType.Port:
            returnValue = parseInt(value, 10);
            // $eslint-fix-me https://github.com/rhinodavid/eslint-fix-me
            // eslint-disable-next-line no-case-declarations
            const isWithinRange = returnValue >= 0 && returnValue <= 65535;
            if (isNaN(returnValue) || !isWithinRange) {
                throw new Error(`${name} must be between 0 to 65535, found ${value}.`);
            }
            return returnValue;
        case EnvVarType.ChainId:
        case EnvVarType.KeepAliveTimeout:
        case EnvVarType.Integer:
            returnValue = parseInt(value, 10);
            if (isNaN(returnValue)) {
                throw new Error(`${name} must be a valid integer, found ${value}.`);
            }
            return returnValue;
        case EnvVarType.ETHAddressHex:
            assert_1.assert.isETHAddressHex(name, value);
            return value;
        case EnvVarType.Url:
            assert_1.assert.isUri(name, value);
            return value;
        case EnvVarType.UrlList:
            assert_1.assert.isString(name, value);
            // $eslint-fix-me https://github.com/rhinodavid/eslint-fix-me
            // eslint-disable-next-line no-case-declarations
            const urlList = value.split(',');
            urlList.forEach((url, i) => assert_1.assert.isUri(`${name}[${i}]`, url));
            return urlList;
        case EnvVarType.Boolean:
            return value === 'true';
        case EnvVarType.UnitAmount:
            returnValue = new utils_1.BigNumber(parseFloat(value));
            if (returnValue.isNaN() || returnValue.isNegative()) {
                throw new Error(`${name} must be valid number greater than 0.`);
            }
            return returnValue;
        case EnvVarType.Rate:
            returnValue = parseFloat(value);
            if (returnValue < 0 || returnValue > 1) {
                throw new Error(`${name} must be valid number between 0.0 and 1.0.`);
            }
            return returnValue;
        case EnvVarType.AddressList:
            assert_1.assert.isString(name, value);
            // $eslint-fix-me https://github.com/rhinodavid/eslint-fix-me
            // eslint-disable-next-line no-case-declarations
            const addressList = value.split(',').map((a) => a.toLowerCase());
            addressList.forEach((a, i) => assert_1.assert.isETHAddressHex(`${name}[${i}]`, a));
            return addressList;
        case EnvVarType.StringList:
            assert_1.assert.isString(name, value);
            // $eslint-fix-me https://github.com/rhinodavid/eslint-fix-me
            // eslint-disable-next-line no-case-declarations
            const stringList = value.split(',');
            return stringList;
        case EnvVarType.WhitelistAllTokens:
            return '*';
        case EnvVarType.NonEmptyString:
            assert_1.assert.isString(name, value);
            if (value === '') {
                throw new Error(`${name} must be supplied`);
            }
            return value;
        case EnvVarType.APIKeys:
            assert_1.assert.isString(name, value);
            // $eslint-fix-me https://github.com/rhinodavid/eslint-fix-me
            // eslint-disable-next-line no-case-declarations
            const apiKeys = value.split(',');
            apiKeys.forEach((apiKey) => {
                const isValidUUID = validateUUID(apiKey);
                if (!isValidUUID) {
                    throw new Error(`API Key ${apiKey} isn't UUID compliant`);
                }
            });
            return apiKeys;
        case EnvVarType.JsonStringList:
            assert_1.assert.isString(name, value);
            return JSON.parse(value);
        default:
            throw new Error(`Unrecognized EnvVarType: ${expectedType} encountered for variable ${name}.`);
    }
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL2Rhdmlkd2Fsc2gvY29kZS1sb2NhbC8weC1yZnEtYXBpL3NyYy9jb25maWcudHMiLCJtYXBwaW5ncyI6Ijs7OztBQUVBLHVDQUFvQztBQUNwQywrREFBaUQ7QUFDakQscUNBQXNDO0FBQ3RDLHlCQUF5QjtBQUN6Qiw0QkFBNEI7QUFDNUIsOENBQThDO0FBRTlDLGdEQVkwQjtBQUMxQiw0Q0FBeUM7QUFFekMsa0RBQWlEO0FBQ2pELHNEQUFrRDtBQUVsRCw0QkFBNEI7QUFFNUIsSUFBSyxVQW9CSjtBQXBCRCxXQUFLLFVBQVU7SUFDWCx5REFBVyxDQUFBO0lBQ1gsdURBQVUsQ0FBQTtJQUNWLGlEQUFPLENBQUE7SUFDUCwyQ0FBSSxDQUFBO0lBQ0osbUVBQWdCLENBQUE7SUFDaEIsaURBQU8sQ0FBQTtJQUNQLDZEQUFhLENBQUE7SUFDYix1REFBVSxDQUFBO0lBQ1YsMkNBQUksQ0FBQTtJQUNKLHlDQUFHLENBQUE7SUFDSCxrREFBTyxDQUFBO0lBQ1Asd0VBQWtCLENBQUE7SUFDbEIsa0RBQU8sQ0FBQTtJQUNQLGdFQUFjLENBQUE7SUFDZCxrREFBTyxDQUFBO0lBQ1AsMERBQVcsQ0FBQTtJQUNYLGdGQUFzQixDQUFBO0lBQ3RCLHNGQUF5QixDQUFBO0lBQ3pCLGdFQUFjLENBQUE7QUFDbEIsQ0FBQyxFQXBCSSxVQUFVLEtBQVYsVUFBVSxRQW9CZDtBQXNERDs7O0dBR0c7QUFDVSxRQUFBLG9CQUFvQixHQUF3QixDQUFDLEdBQUcsRUFBRTtJQUMzRCxJQUFJLE1BQTJCLENBQUM7SUFDaEMsSUFBSTtRQUNBLE1BQU0sR0FBRyxhQUFhLENBQXNCLHNCQUFzQixFQUFFLFVBQVUsQ0FBQyxjQUFjLEVBQUUsRUFBRSxDQUFDLENBQUM7UUFDbkcsMEJBQVcsQ0FBQyxjQUFjLENBQUMsTUFBTSxFQUFFLGlCQUFPLENBQUMseUJBQXlCLENBQUMsQ0FBQztLQUN6RTtJQUFDLE9BQU8sQ0FBQyxFQUFFO1FBQ1IsTUFBTSxJQUFJLEtBQUssQ0FBQywwRUFBMEUsQ0FBQyxFQUFFLENBQUMs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Q0FBQztZQUM3Qiw2REFBNkQ7WUFDN0QsZ0RBQWdEO1lBQ2hELE1BQU0sT0FBTyxHQUFJLEtBQWdCLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDO1lBQzdDLE9BQU8sQ0FBQyxPQUFPLENBQUMsQ0FBQyxNQUFNLEVBQUUsRUFBRTtnQkFDdkIsTUFBTSxXQUFXLEdBQUcsWUFBWSxDQUFDLE1BQU0sQ0FBQyxDQUFDO2dCQUN6QyxJQUFJLENBQUMsV0FBVyxFQUFFO29CQUNkLE1BQU0sSUFBSSxLQUFLLENBQUMsV0FBVyxNQUFNLHVCQUF1QixDQUFDLENBQUM7aUJBQzdEO1lBQ0wsQ0FBQyxDQUFDLENBQUM7WUFDSCxPQUFPLE9BQU8sQ0FBQztRQUNuQixLQUFLLFVBQVUsQ0FBQyxjQUFjO1lBQzFCLGVBQU0sQ0FBQyxRQUFRLENBQUMsSUFBSSxFQUFFLEtBQUssQ0FBQyxDQUFDO1lBQzdCLE9BQU8sSUFBSSxDQUFDLEtBQUssQ0FBQyxLQUFLLENBQUMsQ0FBQztRQUU3QjtZQUNJLE1BQU0sSUFBSSxLQUFLLENBQUMsNEJBQTRCLFlBQVksNkJBQTZCLElBQUksR0FBRyxDQUFDLENBQUM7S0FDckc7QUFDTCxDQUFDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIi9Vc2Vycy9kYXZpZHdhbHNoL2NvZGUtbG9jYWwvMHgtcmZxLWFwaS9zcmMvY29uZmlnLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIHRzbGludDpkaXNhYmxlOmN1c3RvbS1uby1tYWdpYy1udW1iZXJzIG1heC1maWxlLWxpbmUtY291bnRcbmltcG9ydCB7IEh0dHBTZXJ2aWNlQ29uZmlnIH0gZnJvbSAnQDB4L2FwaS11dGlscyc7XG5pbXBvcnQgeyBhc3NlcnQgfSBmcm9tICdAMHgvYXNzZXJ0JztcbmltcG9ydCB7IENoYWluSWQgfSBmcm9tICdAMHgvY29udHJhY3QtYWRkcmVzc2VzJztcbmltcG9ydCB7IEJpZ051bWJlciB9IGZyb20gJ0AweC91dGlscyc7XG5pbXBvcnQgKiBhcyBmcyBmcm9tICdmcyc7XG5pbXBvcnQgKiBhcyBfIGZyb20gJ2xvZGFzaCc7XG5pbXBvcnQgKiBhcyB2YWxpZGF0ZVVVSUQgZnJvbSAndXVpZC12YWxpZGF0ZSc7XG5cbmltcG9ydCB7XG4gICAgREVGQVVMVF9CQUNLR1JPVU5EX0pPQl9UWVBFUyxcbiAgICBERUZBVUxUX0VUSF9HQVNfU1RBVElPTl9BUElfVVJMLFxuICAgIERFRkFVTFRfRVhQRUNURURfTUlORURfU0VDLFxuICAgIERFRkFVTFRfTE9DQUxfUE9TVEdSRVNfVVJJLFxuICAgIERFRkFVTFRfTE9DQUxfUkVESVNfVVJJLFxuICAgIERFRkFVTFRfTE9HR0VSX0lOQ0xVREVfVElNRVNUQU1QLFxuICAgIERFRkFVTFRfU0VOVFJZX0VOVklST05NRU5ULFxuICAgIEhFQUxUSENIRUNLX1BBVEgsXG4gICAgTUVUUklDU19QQVRILFxuICAgIE5VTExfQUREUkVTUyxcbiAgICBPTkVfTUlOVVRFX01TLFxufSBmcm9tICcuL2NvcmUvY29uc3RhbnRzJztcbmltcG9ydCB7IHNjaGVtYXMgfSBmcm9tICcuL2NvcmUvc2NoZW1hcyc7XG5pbXBvcnQgeyBGZWVNb2RlbFZlcnNpb24gfSBmcm9tICcuL2NvcmUvdHlwZXMnO1xuaW1wb3J0IHsgdG9QYWlyU3RyaW5nIH0gZnJvbSAnLi9jb3JlL3BhaXJfdXRpbHMnO1xuaW1wb3J0IHsgc2NoZW1hVXRpbHMgfSBmcm9tICcuL2NvcmUvc2NoZW1hX3V0aWxzJztcblxuLy8gdHNsaW50OmRpc2FibGU6bm8tYml0d2lzZVxuXG5lbnVtIEVudlZhclR5cGUge1xuICAgIEFkZHJlc3NMaXN0LFxuICAgIFN0cmluZ0xpc3QsXG4gICAgSW50ZWdlcixcbiAgICBQb3J0LFxuICAgIEtlZXBBbGl2ZVRpbWVvdXQsXG4gICAgQ2hhaW5JZCxcbiAgICBFVEhBZGRyZXNzSGV4LFxuICAgIFVuaXRBbW91bnQsXG4gICAgUmF0ZSxcbiAgICBVcmwsXG4gICAgVXJsTGlzdCxcbiAgICBXaGl0ZWxpc3RBbGxUb2tlbnMsXG4gICAgQm9vbGVhbixcbiAgICBOb25FbXB0eVN0cmluZyxcbiAgICBBUElLZXlzLFxuICAgIFByaXZhdGVLZXlzLFxuICAgIFJmcU1ha2VyQXNzZXRPZmZlcmluZ3MsXG4gICAgTGlxdWlkaXR5UHJvdmlkZXJSZWdpc3RyeSxcbiAgICBKc29uU3RyaW5nTGlzdCxcbn1cblxuLyoqXG4gKiBWYWx1ZXMgcmVhZCBmcm9tIGNvbmZpZ3VyYXRpb24gZmlsZXMgd2hpY2ggZW5hYmxlXG4gKiByZnEtYXBpIHRvIG9wZXJhdGUgb24gYSBjaGFpbi5cbiAqL1xuZXhwb3J0IGludGVyZmFjZSBDaGFpbkNvbmZpZ3VyYXRpb24ge1xuICAgIGNoYWluSWQ6IG51bWJlcjtcbiAgICBnYXNTdGF0aW9uVXJsOiBzdHJpbmc7XG4gICAgbmFtZTogc3RyaW5nOyAvLyBodW1hbiByZWFkYWJsZSwgZm9yIGxvZ2dpbmcgYW5kIHN1Y2hcbiAgICByZWdpc3RyeUFkZHJlc3M6IHN0cmluZztcbiAgICBycGNVcmw6IHN0cmluZztcbiAgICBzcXNVcmw6IHN0cmluZztcbiAgICB6ZXJvRXhDbGllbnRCYXNlVXJsOiBzdHJpbmc7XG4gICAgLy8gRW5hYmxlcyBjYWNoaW5nIGZvciBtYWtlciBiYWxhbmNlcyBvbiBvYnNlcnZlZCB0b2tlbnNcbiAgICBlbmFibGVNYWtlckJhbGFuY2VDYWNoZT86IGJvb2xlYW47XG4gICAgLy8gVXNlIHRoaXMgY29uZmlnIHRvIG92ZXJyaWRlIHRoZSAweCBFeGNoYW5nZSBQcm94eSBjb250cmFjdCBhZGRyZXNzLlxuICAgIC8vIFRoZXJlIG1pZ2h0IGJlIGEgY2FzZSB3aGVuIHdlIHdhbnQgYSBkaWZmZXJlbnQgZXhjaGFuZ2VcbiAgICAvLyBwcm94eSBjb250cmFjdCB0aGFuIHdoYXQgaXMgZGVmaW5lZCBmcm9tIEAweC9jb250cmFjdC1hZGRyZXNzZXMgcmVwby5cbiAgICAvL1xuICAgIC8vIGkuZS4gdGVzdGluZyBhIG5ldyBmZWF0dXJlIHRoYXQgaGFzbid0IGJlZW4gZGVwbG95ZWQgdG8gdGhlIG9mZmljaWFsXG4gICAgLy8gY29udHJhY3QgeWV0XG4gICAgZXhjaGFuZ2VQcm94eUNvbnRyYWN0QWRkcmVzc092ZXJyaWRlPzogc3RyaW5nO1xuICAgIC8vIFNlcnZpY2UgY29uZmlndXJhdGlvbiBuZWVkcyB0byBiZSBwcmVzZW50IHRvIHJ1biB0aGUgY29ycmVzcG9uZGluZyBzZXJ2aWNlLlxuICAgIGdhc2xlc3M/OiB7XG4gICAgICAgIG1ldGFUcmFuc2FjdGlvblNlcnZpY2VVcmw6IHN0cmluZztcbiAgICB9O1xuICAgIHJmcW0/OiB7XG4gICAgICAgIG1pbkV4cGlyeUR1cmF0aW9uTXM/OiBudW1iZXI7XG4gICAgICAgIHF1b3RlUmVwb3J0VG9waWM/OiBzdHJpbmc7XG4gICAgICAgIGZlZU1vZGVsVmVyc2lvbj86IEZlZU1vZGVsVmVyc2lvbjtcbiAgICB9O1xuICAgIHJmcXQ/OiB7XG4gICAgICAgIG1pbkV4cGlyeUR1cmF0aW9uTXM/OiBudW1iZXI7XG4gICAgICAgIGZlZUV2ZW50VG9waWM/OiBzdHJpbmc7XG4gICAgICAgIGZlZU1vZGVsVmVyc2lvbj86IEZlZU1vZGVsVmVyc2lvbjtcbiAgICB9O1xuICAgIHdvcmtlcj86IHtcbiAgICAgICAgLy8gVGhlIHZhbHVlIG9mIHRoZSBcInRpcFwiIHRoZSB3b3JrZXIgd2lsbCB1c2Ugd2hlbiBpdCBzdGFydHNcbiAgICAgICAgLy8gc3VibWl0dGluZyB0cmFuc2FjdGlvbnNcbiAgICAgICAgaW5pdGlhbE1heFByaW9yaXR5RmVlUGVyR2FzR3dlaTogbnVtYmVyO1xuICAgICAgICAvLyBUaGUgbWF4IGZlZSBwZXIgZ2FzIChpbiBnd2VpKSB0aGUgd29ya2VyIGlzIHdpbGxpbmcgdG8gcGF5IGZvciBhIHRyYW5zYWN0aW9uXG4gICAgICAgIG1heEZlZVBlckdhc0NhcEd3ZWk6IG51bWJlcjtcbiAgICAgICAgLy8gVXNlIHRoaXMgY29uZmlnIHRvIGNoYW5nZSB0aGUgc2xlZXAgdGltZSBiZXR3ZWVuIGEgdHJhbnNhY2lvbidzIG9uLWNoYWluIHN0YXR1cyBjaGVjay5cbiAgICAgICAgLy8gWW91IHNob3VsZCBzZXQgdGhlIHNsZWVwIHRpbWUgY2xvc2UgdG8gdGhlIGNoYWluJ3MgYmxvY2sgdGltZS5cbiAgICAgICAgLy8gVGhlIHNtYWxsZXIgc2xlZXAgdGltZSwgdGhlIG1vcmUgZnJlcXVlbnQgYSB0cmFuc2FjdGlvbiBpcyBjaGVja2VkIHRvIHNlZSBpdCBoYXMgYmVlblxuICAgICAgICAvLyBzZXR0bGVkIG9uLWNoYWluIGJ1dCBpdCBhbHNvIGNvbnN1bWVzIG1vcmUgUlBDIGNhbGxzLlxuICAgICAgICB0cmFuc2FjdGlvbldhdGNoZXJTbGVlcFRpbWVNcz86IG51bWJlcjtcbiAgICAgICAgZW5hYmxlQWNjZXNzTGlzdD86IGJvb2xlYW47XG4gICAgfTtcbn1cblxuZXhwb3J0IHR5cGUgQ2hhaW5Db25maWd1cmF0aW9ucyA9IENoYWluQ29uZmlndXJhdGlvbltdO1xuXG4vKipcbiAqIENvbmZpZ3VyYXRpb24gd2hpY2ggY29udGFpbnMgaW5mb3JtYXRpb24gYWJvdXQgY2hhaW5zIGFuZFxuICogcmVsYXRlZCByZXNvdXJjZXMsIGxpa2UgdGhlIFJQQyB1cmwuXG4gKi9cbmV4cG9ydCBjb25zdCBDSEFJTl9DT05GSUdVUkFUSU9OUzogQ2hhaW5Db25maWd1cmF0aW9ucyA9ICgoKSA9PiB7XG4gICAgbGV0IHJlc3VsdDogQ2hhaW5Db25maWd1cmF0aW9ucztcbiAgICB0cnkge1xuICAgICAgICByZXN1bHQgPSByZXNvbHZlRW52VmFyPENoYWluQ29uZmlndXJhdGlvbnM+KCdDSEFJTl9DT05GSUdVUkFUSU9OUycsIEVudlZhclR5cGUuSnNvblN0cmluZ0xpc3QsIFtdKTtcbiAgICAgICAgc2NoZW1hVXRpbHMudmFsaWRhdGVTY2hlbWEocmVzdWx0LCBzY2hlbWFzLmNoYWluQ29uZmlndXJhdGlvbnNTY2hlbWEpO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBDSEFJTl9DT05GSUdVUkFUSU9OUyB3YXMgZGVmaW5lZCBidXQgaXMgbm90IHZhbGlkIEpTT04gcGVyIHRoZSBzY2hlbWE6ICR7ZX1gKTtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbn0pKCk7XG5cbmV4cG9ydCBpbnRlcmZhY2UgWmVyb0V4RmVlQ29uZmlnRW50cnlCYXNlIHtcbiAgICB2b2x1bWVQZXJjZW50YWdlPzogbnVtYmVyO1xuICAgIGludGVncmF0b3JTaGFyZVBlcmNlbnRhZ2U/OiBudW1iZXI7XG4gICAgLy8gbWFyZ2luUmFrZVBlcmNlbnRhZ2U/OiBudW1iZXI7IC8vIGZvciBSRlEgbGlxaWR1aXR5XG59XG5cbi8qKlxuICogMHggZmVlIGNvbmZpZyBlbnRyeSBmb3IgcGFpcnMuXG4gKlxuICogRm9yIGV4YW1wbGUsIHRoaXMgbWVhbnMgdGhlIGZvbGxvd2luZyBwYWlyIHRha2UgMTAlIHZvbHVtZSBmZWUuXG4gKiAge1xuICogICAgICBraW5kOiAncGFpcicsXG4gKiAgICAgIHBhaXJzOiBbXG4gKiAgICAgICAgICB7XG4gKiAgICAgICAgICAgICAgdG9rZW5BOiAnMHgxMjM0NTYuLi4nLFxuICogICAgICAgICAgICAgIHRva2VuQjogJzB4NjU0MzIxLi4uJyxcbiAqICAgICAgICAgICAgICBsYWJlbDogJ3Rva2VuMS10b2tlbjInLFxuICogICAgICAgICAgfSxcbiAqICAgICAgICAgIHtcbiAqICAgICAgICAgICAgICB0b2tlbkE6ICcweDEzNTc5Li4uJyxcbiAqICAgICAgICAgICAgICB0b2tlbkI6ICcweDI0NjgxLi4uJyxcbiAqICAgICAgICAgICAgICBsYWJlbDogJ3Rva2VuMy10b2tlbjQnLFxuICogICAgICAgICAgfVxuICogICAgICBdLFxuICogICAgICB2b2x1bWVQZXJjZW50YWdlOiAxMFxuICogIH1cbiAqL1xuZXhwb3J0IGludGVyZmFjZSBQYWlycyBleHRlbmRzIFplcm9FeEZlZUNvbmZpZ0VudHJ5QmFzZSB7XG4gICAga2luZDogJ3BhaXJzJztcbiAgICBwYWlyczoge1xuICAgICAgICB0b2tlbkE6IHN0cmluZztcbiAgICAgICAgdG9rZW5COiBzdHJpbmc7XG4gICAgICAgIGxhYmVsOiBzdHJpbmc7XG4gICAgfVtdO1xufVxuXG4vKipcbiAqIDB4IGZlZSBjb25maWcgZW50cnkgZm9yIGNhcnRlc2lhbl9wcm9kdWN0LlxuICpcbiAqIEZvciBleGFtcGxlLCB0aGlzIG1lYW5zIGZvciBhbnkgb2YgdGhlIDQgY29tYmluYXRpb24gYmV0d2VlbiBgc2V0QWAgYW5kIGBzZXRCYCwgdGhlIHBhaXIgdGFrZXMgNSUgdm9sdW1lIGZlZVxuICoge1xuICogICAgICBraW5kOiAnY2FydGVzaWFuX3Byb2R1Y3QnLFxuICogICAgICBzZXRBOiBbXG4gKiAgICAgICAgICB7XG4gKiAgICAgICAgICAgICAgdG9rZW46ICcweDEyMzQ1NS4uLicsXG4gKiAgICAgICAgICAgICAgbGFiZWw6ICd0b2tlbjUnLFxuICogICAgICAgICAgfSxcbiAqICAgICAgICAgIHtcbiAqICAgICAgICAgICAgICB0b2tlbjogJzB4MTIzNDU3Li4uJyxcbiAqICAgICAgICAgICAgICBsYWJlbDogJ3Rva2VuNicsXG4gKiAgICAgICAgICB9XG4gKiAgICAgIF0sXG4gKiAgICAgIHNldEI6IFtcbiAqICAgICAgICAgIHtcbiAqICAgICAgICAgICAgICB0b2tlbjogJzB4MTIzNDU4Li4uJyxcbiAqICAgICAgICAgICAgICBsYWJlbDogJ3Rva2VuNycsXG4gKiAgICAgICAgICB9LFxuICogICAgICAgICAge1xuICogICAgICAgICAgICAgIHRva2VuOiAnMHgxMjM0NTkuLi4nLFxuICogICAgICAgICAgICAgIGxhYmVsOiAndG9rZW44JyxcbiAqICAgICAgICAgIH1cbiAqICAgICAgXSxcbiAqICAgICAgdm9sdW1lUGVyY2VudGFnZTogNVxuICogfVxuICovXG5leHBvcnQgaW50ZXJmYWNlIENhcnRlc2lhblByb2R1Y3QgZXh0ZW5kcyBaZXJvRXhGZWVDb25maWdFbnRyeUJhc2Uge1xuICAgIGtpbmQ6ICdjYXJ0ZXNpYW5fcHJvZHVjdCc7XG4gICAgc2V0QToge1xuICAgICAgICB0b2tlbjogc3RyaW5nO1xuICAgICAgICBsYWJlbDogc3RyaW5nO1xuICAgIH1bXTtcbiAgICBzZXRCOiB7XG4gICAgICAgIHRva2VuOiBzdHJpbmc7XG4gICAgICAgIGxhYmVsOiBzdHJpbmc7XG4gICAgfVtdO1xufVxuXG4vKipcbiAqIDB4IGZlZSBjb25maWcgZW50cnkgZm9yIHRva2Vucy5cbiAqXG4gKiBGb3IgZXhhbXBsZSwgdGhpcyBtZWFucyBpZiB0b2tlbjkgb3IgdG9rZW4xMCBpcyBlaXRoZXIgc2VsbCAvIGJ1eSB0b2tlbiwgdGhlcmUgaXMgYSAyJSB2b2x1bWUgZmVlXG4gKiB7XG4gKiAgICAgIGtpbmQ6ICd0b2tlbnMnLFxuICogICAgICB0b2tlbnM6IFtcbiAqICAgICAgICAgIHtcbiAqICAgICAgICAgICAgICB0b2tlbjogJzB4MTIzNDUxMC4uLicsXG4gKiAgICAgICAgICAgICAgbGFiZWw6ICd0b2tlbjknLFxuICogICAgICAgICAgfSxcbiAqICAgICAgICAgIHtcbiAqICAgICAgICAgICAgICB0b2tlbjogJzB4MTIzNDU3MTEuLi4nLFxuICogICAgICAgICAgICAgIGxhYmVsOiAndG9rZW4xMCcsXG4gKiAgICAgICAgICB9XG4gKiAgICAgIF1cbiAqICAgICAgdm9sdW1lUGVyY2VudGFnZTogMlxuICogfVxuICovXG5leHBvcnQgaW50ZXJmYWNlIFRva2VucyBleHRlbmRzIFplcm9FeEZlZUNvbmZpZ0VudHJ5QmFzZSB7XG4gICAga2luZDogJ3Rva2Vucyc7XG4gICAgdG9rZW5zOiB7XG4gICAgICAgIHRva2VuOiBzdHJpbmc7XG4gICAgICAgIGxhYmVsOiBzdHJpbmc7XG4gICAgfVtdO1xufVxuXG5leHBvcnQgdHlwZSBaZXJvRXhGZWVDb25pZ3VyYXRpb25FbnRyeSA9IFBhaXJzIHwgQ2FydGVzaWFuUHJvZHVjdCB8IFRva2VucztcblxuLy8gUmF3IDB4IGZlZSBjb25maWd1cmF0aW9uIHJlYWQgZGlyZWN0bHkgZnJvbSBjb25maWcgZmlsZVxuaW50ZXJmYWNlIFplcm9FeEZlZVJhd0NvbmZpZ3VyYXRpb24ge1xuICAgIG5hbWU6IHN0cmluZzsgLy8gaHVtYW4gcmVhZGFibGUgaW50ZWdyYXRvciBuYW1lXG4gICAgaW50ZWdyYXRvcklkOiBzdHJpbmc7XG4gICAgY2hhaW5JZDogbnVtYmVyO1xuICAgIGZlZU9uOiAndm9sdW1lJyB8ICdpbnRlZ3JhdG9yX3NoYXJlJyAvKiB8ICdwcmljZV9pbXByb3ZlbWVudCcgKi87IC8vICdwcmljZV9pbXByb3ZlbWVudCcgaXMgZm9yIFJGUSBsaXF1aWRpdHlcbiAgICB6ZXJvRXg6IHtcbiAgICAgICAgLy8gZmVlIHJlY2lwaWVudCBhbmQgYmlsbGluZyB0eXBlIGZvciAweCBmZWVcbiAgICAgICAgZmVlUmVjaXBpZW50OiBzdHJpbmcgfCBudWxsO1xuICAgICAgICBiaWxsaW5nVHlwZTogJ29uLWNoYWluJyB8ICdvZmYtY2hhaW4nO1xuICAgIH07XG4gICAgZ2FzOiB7XG4gICAgICAgIC8vIGZlZSByZWNpcGllbnQgYW5kIGJpbGxpbmcgdHlwZSBmb3IgZ2FzIGZlZVxuICAgICAgICBmZWVSZWNpcGllbnQ6IHN0cmluZyB8IG51bGw7XG4gICAgICAgIGJpbGxpbmdUeXBlOiAnb24tY2hhaW4nIHwgJ29mZi1jaGFpbic7XG4gICAgfTtcbiAgICBmZWVzOiBaZXJvRXhGZWVDb25pZ3VyYXRpb25FbnRyeVtdO1xufVxuXG50eXBlIFplcm9FeEZlZVJhd0NvbmZpZ3VyYXRpb25zID0gWmVyb0V4RmVlUmF3Q29uZmlndXJhdGlvbltdO1xuXG4vLyBQcm9jZXNzZWQgcmF3IDB4IGZlZSBjb25maWd1cmF0aW9uXG5leHBvcnQgaW50ZXJmYWNlIFplcm9FeEZlZUNvbmZpZ3VyYXRpb24ge1xuICAgIG5hbWU6IHN0cmluZztcbiAgICBmZWVPbjogJ3ZvbHVtZScgfCAnaW50ZWdyYXRvcl9zaGFyZScgLyogfCAncHJpY2VfaW1wcm92ZW1lbnQnICovOyAvLyAncHJpY2VfaW1wcm92ZW1lbnQnIGlzIGZvciBSRlEgbGlxdWlkaXR5XG4gICAgemVyb0V4OiB7XG4gICAgICAgIGZlZVJlY2lwaWVudDogc3RyaW5nIHwgbnVsbDtcbiAgICAgICAgYmlsbGluZ1R5cGU6ICdvbi1jaGFpbicgfCAnb2ZmLWNoYWluJztcbiAgICB9O1xuICAgIGdhczoge1xuICAgICAgICBmZWVSZWNpcGllbnQ6IHN0cmluZyB8IG51bGw7XG4gICAgICAgIGJpbGxpbmdUeXBlOiAnb24tY2hhaW4nIHwgJ29mZi1jaGFpbic7XG4gICAgfTtcbiAgICBwYWlyc0ZlZUVudHJpZXM6IE1hcDxzdHJpbmcsIEJpZ051bWJlcj47IC8vIHRva2VuQS10b2tlbkI6IDxmZWVfcGFyYW1ldGVyPjsgdG9rZW5BIDw9IHRva2VuQlxuICAgIGNhcnRlc2lhblByb2R1Y3RGZWVFbnRyaWVzOiB7XG4gICAgICAgIHNldEE6IFNldDxzdHJpbmc+O1xuICAgICAgICBzZXRCOiBTZXQ8c3RyaW5nPjtcbiAgICAgICAgcGFyYW1ldGVyOiBCaWdOdW1iZXI7XG4gICAgfVtdO1xuICAgIHRva2Vuc0VudHJpZXM6IE1hcDxzdHJpbmcsIEJpZ051bWJlcj47IC8vIHRva2VuQS10b2tlbkI6IDxmZWVfcGFyYW1ldGVyPjsgdG9rZW5BIDw9IHRva2VuQlxufVxuXG5leHBvcnQgY29uc3QgWkVST19FWF9GRUVfQ09ORklHVVJBVElPTl9NQVA6IE1hcDxzdHJpbmcsIE1hcDxudW1iZXIsIFplcm9FeEZlZUNvbmZpZ3VyYXRpb24+PiA9ICgoKSA9PiB7XG4gICAgdHJ5IHtcbiAgICAgICAgY29uc3QgemVyb0V4RmVlUmF3Q29uZmlndXJhdGlvbnMgPSByZXNvbHZlRW52VmFyPFplcm9FeEZlZVJhd0NvbmZpZ3VyYXRpb25zPihcbiAgICAgICAgICAgICdaRVJPX0VYX0ZFRV9DT05GSUdVUkFUSU9OUycsXG4gICAgICAgICAgICBFbnZWYXJUeXBlLkpzb25TdHJpbmdMaXN0LFxuICAgICAgICAgICAgW10sXG4gICAgICAgICk7XG4gICAgICAgIHNjaGVtYVV0aWxzLnZhbGlkYXRlU2NoZW1hKHplcm9FeEZlZVJhd0NvbmZpZ3VyYXRpb25zLCBzY2hlbWFzLnplcm9FeEZlZUNvbmZpZ3VyYXRpb25zU2NoZW1hKTtcblxuICAgICAgICByZXR1cm4gemVyb0V4RmVlUmF3Q29uZmlndXJhdGlvbnMucmVkdWNlKChhY2MsIGN1cnIpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHsgaW50ZWdyYXRvcklkLCBjaGFpbklkIH0gPSBjdXJyO1xuICAgICAgICAgICAgaWYgKCFhY2MuZ2V0KGludGVncmF0b3JJZCkpIHtcbiAgICAgICAgICAgICAgICBhY2Muc2V0KGludGVncmF0b3JJZCwgbmV3IE1hcDxudW1iZXIsIFplcm9FeEZlZUNvbmZpZ3VyYXRpb24+KCkpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjb25zdCBwYWlyc0ZlZUVudHJpZXMgPSBuZXcgTWFwPHN0cmluZywgQmlnTnVtYmVyPigpO1xuICAgICAgICAgICAgY29uc3QgY2FydGVzaWFuUHJvZHVjdEZlZUVudHJpZXM6IHtcbiAgICAgICAgICAgICAgICBzZXRBOiBTZXQ8c3RyaW5nPjtcbiAgICAgICAgICAgICAgICBzZXRCOiBTZXQ8c3RyaW5nPjtcbiAgICAgICAgICAgICAgICBwYXJhbWV0ZXI6IEJpZ051bWJlcjtcbiAgICAgICAgICAgIH1bXSA9IFtdO1xuICAgICAgICAgICAgY29uc3QgdG9rZW5zRW50cmllcyA9IG5ldyBNYXA8c3RyaW5nLCBCaWdOdW1iZXI+KCk7XG5cbiAgICAgICAgICAgIGN1cnIuZmVlcy5mb3JFYWNoKChmZWVDb25maWcpID0+IHtcbiAgICAgICAgICAgICAgICBsZXQgZmVlUGFyYW1ldGVyOiBCaWdOdW1iZXI7XG4gICAgICAgICAgICAgICAgc3dpdGNoIChjdXJyLmZlZU9uKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ3ZvbHVtZSc6XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZmVlQ29uZmlnLnZvbHVtZVBlcmNlbnRhZ2UgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgdm9sdW1lUGVyY2VudGFnZSBub3QgZGVmaW5lZCBmb3IgJHtjdXJyLmludGVncmF0b3JJZH0gZm9yIGZlZSBvbiB2b2x1bWVgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGZlZVBhcmFtZXRlciA9IG5ldyBCaWdOdW1iZXIoZmVlQ29uZmlnLnZvbHVtZVBlcmNlbnRhZ2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ2ludGVncmF0b3Jfc2hhcmUnOlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGZlZUNvbmZpZy5pbnRlZ3JhdG9yU2hhcmVQZXJjZW50YWdlID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGBpbnRlZ3JhdG9yU2hhcmVQZXJjZW50YWdlIG5vdCBkZWZpbmVkIGZvciAke2N1cnIuaW50ZWdyYXRvcklkfSBmb3IgZmVlIG9uIHZvbHVtZWAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGZlZVBhcmFtZXRlciA9IG5ldyBCaWdOdW1iZXIoZmVlQ29uZmlnLmludGVncmF0b3JTaGFyZVBlcmNlbnRhZ2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgICAgICAoKF94OiBuZXZlcikgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcigndW5yZWFjaGFibGUnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pKGN1cnIuZmVlT24pO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmIChmZWVDb25maWcua2luZCA9PT0gJ3BhaXJzJykge1xuICAgICAgICAgICAgICAgICAgICAvLyBwYXJzZSBjb25maWcgZW50cmllcyB0aGF0IGFyZSBvZiBraW5kIGBwYWlyc2BcbiAgICAgICAgICAgICAgICAgICAgZmVlQ29uZmlnLnBhaXJzLmZvckVhY2goKHsgdG9rZW5BLCB0b2tlbkIgfSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgcGFpcnNGZWVFbnRyaWVzLnNldCh0b1BhaXJTdHJpbmcodG9rZW5BLCB0b2tlbkIpLCBmZWVQYXJhbWV0ZXIpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGZlZUNvbmZpZy5raW5kID09PSAnY2FydGVzaWFuX3Byb2R1Y3QnKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIHBhcnNlIGNvbmZpZyBlbnRyaWVzIHRoYXQgYXJlIG9mIGtpbmQgYGNhcnRlc2lhbl9wcm9kdWN0YFxuICAgICAgICAgICAgICAgICAgICBjYXJ0ZXNpYW5Qcm9kdWN0RmVlRW50cmllcy5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNldEE6IG5ldyBTZXQoZmVlQ29uZmlnLnNldEEubWFwKCh0b2tlbkFuZExhYmVsKSA9PiB0b2tlbkFuZExhYmVsLnRva2VuLnRvTG9jYWxlTG93ZXJDYXNlKCkpKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHNldEI6IG5ldyBTZXQoZmVlQ29uZmlnLnNldEIubWFwKCh0b2tlbkFuZExhYmVsKSA9PiB0b2tlbkFuZExhYmVsLnRva2VuLnRvTG9jYWxlTG93ZXJDYXNlKCkpKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtZXRlcjogZmVlUGFyYW1ldGVyLFxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGZlZUNvbmZpZy5raW5kID09PSAndG9rZW5zJykge1xuICAgICAgICAgICAgICAgICAgICAvLyBwYXJzZSBjb25maWcgZW50cmllcyB0aGF0IGFyZSBvZiBraW5kIGB0b2tlbnNgXG4gICAgICAgICAgICAgICAgICAgIGZlZUNvbmZpZy50b2tlbnMuZm9yRWFjaCgodG9rZW5BbmRMYWJlbCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgdG9rZW5zRW50cmllcy5zZXQodG9rZW5BbmRMYWJlbC50b2tlbi50b0xvY2FsZUxvd2VyQ2FzZSgpLCBmZWVQYXJhbWV0ZXIpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgLy8gQ29tcGlsZXIgY2FuJ3QgdHJhY2sgdGhlIHN0YXRlIG9mIFR5cGVTY3JpcHQgbWFwLiBXZSBuZWVkIHRvIHBlcmZvcm0gYSB1bmRlZmluZWQgY2hlY2sgZXZlbiBpZlxuICAgICAgICAgICAgLy8gdGhlIHZhbHVlIGhhcyBiZWVuIHNldCBmb3IgdGhlIGludGVncmF0b3JJZCBwcmV2aW91c2x5LiBNb3JlIGRpc2N1c3Npb246IGh0dHBzOi8vc3RhY2tvdmVyZmxvdy5jb20vYS83MDcyNjU3MVxuICAgICAgICAgICAgY29uc3QgZmVlQ29uZmlnQnlDaGFpbklkID0gYWNjLmdldChpbnRlZ3JhdG9ySWQpO1xuICAgICAgICAgICAgaWYgKCFmZWVDb25maWdCeUNoYWluSWQpIHtcbiAgICAgICAgICAgICAgICAvLyBUaGlzIHNob3VsZCBuZXZlciBoYXBwZW5cbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYCR7aW50ZWdyYXRvcklkfSBpcyBub3Qgc2V0YCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZlZUNvbmZpZ0J5Q2hhaW5JZC5zZXQoY2hhaW5JZCwge1xuICAgICAgICAgICAgICAgIG5hbWU6IGN1cnIubmFtZSxcbiAgICAgICAgICAgICAgICBmZWVPbjogY3Vyci5mZWVPbixcbiAgICAgICAgICAgICAgICB6ZXJvRXg6IHtcbiAgICAgICAgICAgICAgICAgICAgZmVlUmVjaXBpZW50OiBjdXJyLnplcm9FeC5mZWVSZWNpcGllbnQsXG4gICAgICAgICAgICAgICAgICAgIGJpbGxpbmdUeXBlOiBjdXJyLnplcm9FeC5iaWxsaW5nVHlwZSxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGdhczoge1xuICAgICAgICAgICAgICAgICAgICBmZWVSZWNpcGllbnQ6IGN1cnIuZ2FzLmZlZVJlY2lwaWVudCxcbiAgICAgICAgICAgICAgICAgICAgYmlsbGluZ1R5cGU6IGN1cnIuZ2FzLmJpbGxpbmdUeXBlLFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgcGFpcnNGZWVFbnRyaWVzLFxuICAgICAgICAgICAgICAgIGNhcnRlc2lhblByb2R1Y3RGZWVFbnRyaWVzLFxuICAgICAgICAgICAgICAgIHRva2Vuc0VudHJpZXMsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiBhY2M7XG4gICAgICAgIH0sIG5ldyBNYXA8LyogaW50ZWdyYXRvcklkICovIHN0cmluZywgTWFwPC8qIGNoYWluSWQgKi8gbnVtYmVyLCBaZXJvRXhGZWVDb25maWd1cmF0aW9uPj4oKSk7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFpFUk9fRVhfRkVFX0NPTkZJR1VSQVRJT05TIHdhcyBkZWZpbmVkIGJ1dCBpcyBub3QgdmFsaWQgSlNPTiBwZXIgdGhlIHNjaGVtYTogJHtlfWApO1xuICAgIH1cbn0pKCk7XG5cbi8qKlxuICogVmFsdWVzIHJlYWQgZnJvbSBjb25maWd1cmF0aW9uIGZpbGVzIHdoaWNoIHByb3ZpZGVcbiAqIHBlciBwYWlyIGZlZSBtb2RlbCBjb25zdGFudHMuXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgRmVlTW9kZWxDb25maWd1cmF0aW9uIHtcbiAgICBtYXJnaW5SYWtlUmF0aW86IG51bWJlcjsgLy8gUmFrZSBiYXNlZCBvbiBtYXJnaW4gYmV0d2VlbiBSRlFtIGFuZCBBTU0gcHJpY2VzLiBFLmcuIG1hcmdpblJha2VSYXRpbyA9IDAuNSBpZiB3ZSB3YW50IHRvIGNoYXJnZSA1MCUgb2YgdGhlIG1hcmdpbi5cbiAgICB0cmFkZVNpemVCcHM6IG51bWJlcjsgLy8gQmFzZSBwb2ludHMgb2YgZmVlIGJhc2VkIG9uIHRyYWRlIHNpemUuIDEgYnBzID0gMC4wMSUuXG59XG5cbi8qKlxuICogVGhpcyBpbnRlcmZhY2UgaXMgdXNlZCB0byByZXByZXNlbnQgYW4gaW5kaXZpZHVhbCBKU09OIG9iamVjdCBmb3IgYSBnaXZlbiBjaGFpbiBhbmQgcGFpci5cbiAqIEl0IGlzIG9ubHkgdXNlZCB3aGVuIHdlIHJlYWQgdGhlIEpTT04gb2JqZWN0IGZyb20gYSBmaWxlLCBhbmQgc2hvdWxkIG5vdCBiZSB1c2VkIGVsc2V3aGVyZS5cbiAqL1xuaW50ZXJmYWNlIEZlZU1vZGVsQ29uZmlndXJhdGlvbldpdGhLZXkgZXh0ZW5kcyBGZWVNb2RlbENvbmZpZ3VyYXRpb24ge1xuICAgIGNoYWluSWQ6IG51bWJlcjtcbiAgICB0b2tlbkE6IHN0cmluZztcbiAgICB0b2tlbkI6IHN0cmluZztcbn1cblxuZXhwb3J0IHR5cGUgRmVlTW9kZWxDb25maWd1cmF0aW9uTWFwID0gTWFwPG51bWJlciwgTWFwPHN0cmluZywgRmVlTW9kZWxDb25maWd1cmF0aW9uPj47XG5cbi8qKlxuICogQSBuZXN0ZWQgbWFwIHByb3ZpZGluZyBmZWUgbW9kZWwgY29uc3RhbnRzIGZvciBlYWNoIHRva2VuIHBhaXIuXG4gKiBVc2UgY2hhaW5JZCBhcyBmaXJzdCBrZXkgYW5kIHBhaXIga2V5IGFzIHRoZSBzZWNvbmQga2V5LlxuICovXG5leHBvcnQgY29uc3QgRkVFX01PREVMX0NPTkZJR1VSQVRJT05fTUFQOiBGZWVNb2RlbENvbmZpZ3VyYXRpb25NYXAgPSAoKCkgPT4ge1xuICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IGZlZU1vZGVsQ29uZmlndXJhdGlvbnM6IEZlZU1vZGVsQ29uZmlndXJhdGlvbldpdGhLZXlbXSA9IHJlc29sdmVFbnZWYXI8RmVlTW9kZWxDb25maWd1cmF0aW9uV2l0aEtleVtdPihcbiAgICAgICAgICAgICdGRUVfTU9ERUxfQ09ORklHVVJBVElPTlMnLFxuICAgICAgICAgICAgRW52VmFyVHlwZS5Kc29uU3RyaW5nTGlzdCxcbiAgICAgICAgICAgIFtdLFxuICAgICAgICApO1xuICAgICAgICBzY2hlbWFVdGlscy52YWxpZGF0ZVNjaGVtYShmZWVNb2RlbENvbmZpZ3VyYXRpb25zLCBzY2hlbWFzLmZlZU1vZGVsQ29uZmlndXJhdGlvbnNTY2hlbWEpO1xuXG4gICAgICAgIHJldHVybiBmZWVNb2RlbENvbmZpZ3VyYXRpb25zLnJlZHVjZSgoYWNjLCBjdXJyKSA9PiB7XG4gICAgICAgICAgICBjb25zdCB7IGNoYWluSWQsIHRva2VuQSwgdG9rZW5CLCBtYXJnaW5SYWtlUmF0aW8sIHRyYWRlU2l6ZUJwcyB9ID0gY3VycjtcbiAgICAgICAgICAgIGlmICghYWNjLmhhcyhjaGFpbklkKSkge1xuICAgICAgICAgICAgICAgIGFjYy5zZXQoY2hhaW5JZCwgbmV3IE1hcDxzdHJpbmcsIEZlZU1vZGVsQ29uZmlndXJhdGlvbj4oKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyAkZXNsaW50LWZpeC1tZSBodHRwczovL2dpdGh1Yi5jb20vcmhpbm9kYXZpZC9lc2xpbnQtZml4LW1lXG4gICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLW5vbi1udWxsLWFzc2VydGlvblxuICAgICAgICAgICAgYWNjLmdldChjaGFpbklkKSEuc2V0KHRvUGFpclN0cmluZyh0b2tlbkEsIHRva2VuQiksIHsgbWFyZ2luUmFrZVJhdGlvLCB0cmFkZVNpemVCcHMgfSk7XG4gICAgICAgICAgICByZXR1cm4gYWNjO1xuICAgICAgICB9LCBuZXcgTWFwPC8qIGNoYWluSWQgKi8gbnVtYmVyLCBNYXA8LyogcGFpcktleSAqLyBzdHJpbmcsIEZlZU1vZGVsQ29uZmlndXJhdGlvbj4+KCkpO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBGRUVfTU9ERUxfQ09ORklHVVJBVElPTlMgd2FzIGRlZmluZWQgYnV0IGlzIG5vdCB2YWxpZCBKU09OIHBlciB0aGUgc2NoZW1hOiAke2V9YCk7XG4gICAgfVxufSkoKTtcblxuZXhwb3J0IGNvbnN0IERFRkFVTFRfRkVFX01PREVMX0NPTkZJR1VSQVRJT046IEZlZU1vZGVsQ29uZmlndXJhdGlvbiA9IHsgbWFyZ2luUmFrZVJhdGlvOiAwLCB0cmFkZVNpemVCcHM6IDAgfTtcblxuLyoqXG4gKiBBIHRha2VyLWludGVncmF0b3Igb2YgdGhlIDB4IEFQSS5cbiAqL1xuZXhwb3J0IGludGVyZmFjZSBJbnRlZ3JhdG9yIHtcbiAgICBhZmZpbGlhdGVBZGRyZXNzPzogc3RyaW5nOyAvLyBVc2VkIGlmIHByZXNlbnQgYW5kIG5vIGFmZmlsaWF0ZSBhZGRyZXNzIGlzIHNlbnQgaW4gdGhlIHF1b3RlIHJlcXVlc3RcbiAgICBhcGlLZXlzOiBzdHJpbmdbXTtcbiAgICBpbnRlZ3JhdG9ySWQ6IHN0cmluZztcbiAgICAvKiBJRHMgZm9yIGNoYWlucyB0aGUgaW50ZWdyYXRvciBpcyBhbGxvd2VkIHRvIGFjY2VzcyBSRlEgbGlxdWlkaXR5IG9uICovXG4gICAgYWxsb3dlZENoYWluSWRzOiBudW1iZXJbXTtcbiAgICB3aGl0ZWxpc3RJbnRlZ3JhdG9yVXJscz86IHN0cmluZ1tdO1xuICAgIHdoaXRlbGlzdE1ha2VySWRzPzogc3RyaW5nW107XG4gICAgbGFiZWw6IHN0cmluZztcbiAgICBwbHA6IGJvb2xlYW47XG4gICAgcmZxbTogYm9vbGVhbjtcbiAgICByZnF0OiBib29sZWFuO1xufVxuZXhwb3J0IHR5cGUgSW50ZWdyYXRvcnNBY2wgPSBJbnRlZ3JhdG9yW107XG5cbi8qKlxuICogQ29uZmlndXJhdGlvbiB3aGljaCByZXByZXNlbnRzIHRha2VyLWludGVncmF0b3JzIG9mIHRoZSAweCBBUEkuIFRoZSBjb25maWd1cmF0aW9uIGNvbnRhaW5zIHRoZSBsYWJlbCwgaWQsXG4gKiBhcGkga2V5cywgYW5kIGFsbG93ZWQgbGlxdWlkaXR5IHNvdXJjZXMgZm9yIGVhY2ggaW50ZWdyYXRvci5cbiAqL1xuZXhwb3J0IGNvbnN0IElOVEVHUkFUT1JTX0FDTDogSW50ZWdyYXRvcnNBY2wgPSAoKCkgPT4ge1xuICAgIGxldCBpbnRlZ3JhdG9yczogSW50ZWdyYXRvcnNBY2w7XG4gICAgdHJ5IHtcbiAgICAgICAgaW50ZWdyYXRvcnMgPSByZXNvbHZlRW52VmFyPEludGVncmF0b3JzQWNsPignSU5URUdSQVRPUlNfQUNMJywgRW52VmFyVHlwZS5Kc29uU3RyaW5nTGlzdCwgW10pO1xuICAgICAgICBzY2hlbWFVdGlscy52YWxpZGF0ZVNjaGVtYShpbnRlZ3JhdG9ycywgc2NoZW1hcy5pbnRlZ3JhdG9yc0FjbFNjaGVtYSk7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYElOVEVHUkFUT1JTX0FDTCB3YXMgZGVmaW5lZCBidXQgaXMgbm90IHZhbGlkIEpTT04gcGVyIHRoZSBzY2hlbWE6ICR7ZX1gKTtcbiAgICB9XG4gICAgcmV0dXJuIGludGVncmF0b3JzO1xufSkoKTtcblxuLyoqXG4gKiBFeHRyYWN0cyB0aGUgaW50ZWdyYXRvciBBUEkga2V5cyBmcm9tIHRoZSBgSU5URUdSQVRPUlNfQUNMYCBlbnZpcm9ubWVudCB2YXJpYWJsZSBmb3IgdGhlIHByb3ZpZGVkIGdyb3VwIHR5cGUuXG4gKi9cbmV4cG9ydCBjb25zdCBnZXRBcGlLZXlXaGl0ZWxpc3RGcm9tSW50ZWdyYXRvcnNBY2wgPSAoZ3JvdXBUeXBlOiAncmZxdCcgfCAncGxwJyB8ICdyZnFtJyk6IHN0cmluZ1tdID0+IHtcbiAgICByZXR1cm4gSU5URUdSQVRPUlNfQUNMLmZpbHRlcigoaSkgPT4gaVtncm91cFR5cGVdKVxuICAgICAgICAuZmxhdE1hcCgoaSkgPT4gaS5hcGlLZXlzKVxuICAgICAgICAuc29ydCgpO1xufTtcblxuLyoqXG4gKiBHZXRzIHRoZSBpbnRlZ3JhdG9yIElEIGZvciB0aGUgcHJvdmlkZWQgbGFiZWwuXG4gKi9cbmV4cG9ydCBjb25zdCBnZXRJbnRlZ3JhdG9ySWRGcm9tTGFiZWwgPSAobGFiZWw6IHN0cmluZyk6IHN0cmluZyB8IHVuZGVmaW5lZCA9PiB7XG4gICAgZm9yIChjb25zdCBpbnRlZ3JhdG9yIG9mIElOVEVHUkFUT1JTX0FDTCkge1xuICAgICAgICBpZiAoaW50ZWdyYXRvci5sYWJlbCA9PT0gbGFiZWwpIHtcbiAgICAgICAgICAgIHJldHVybiBpbnRlZ3JhdG9yLmludGVncmF0b3JJZDtcbiAgICAgICAgfVxuICAgIH1cbn07XG5cbmV4cG9ydCB0eXBlIFJmcVdvcmtGbG93VHlwZSA9ICdyZnF0JyB8ICdyZnFtJztcbmV4cG9ydCB0eXBlIFJmcU9yZGVyVHlwZSA9ICdyZnEnIHwgJ290Yyc7XG5cbmV4cG9ydCBjb25zdCBSRlFfTUFLRVJfUkVGUkVTSF9JTlRFUlZBTF9NUzogbnVtYmVyID0gT05FX01JTlVURV9NUyAqIDE7XG5cbi8qKlxuICogVGhlIEpTT04gY29uZmlnIGZvciBlYWNoIE1hcmtldCBNYWtlciwgcHJvdmlkaW5nIGluZm9ybWF0aW9uIGluY2x1ZGluZyBVUkxzLCB0eXBlIG9mIG9yZGVyIHN1cHBvcnRlZCBhbmQgYXV0aGVudGljYXRpb24uXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgUmZxTWFrZXJDb25maWcge1xuICAgIG1ha2VySWQ6IHN0cmluZztcbiAgICBsYWJlbDogc3RyaW5nO1xuICAgIHJmcW1PcmRlclR5cGVzOiBSZnFPcmRlclR5cGVbXTtcbiAgICByZnF0T3JkZXJUeXBlczogUmZxT3JkZXJUeXBlW107XG4gICAgYXBpS2V5SGFzaGVzOiBzdHJpbmdbXTtcbn1cblxuLyoqXG4gKiBBIE1hcCB0eXBlIHdoaWNoIG1hcCB0aGUgbWFrZXJJZCB0byB0aGUgY29uZmlnIG9iamVjdC5cbiAqL1xuZXhwb3J0IHR5cGUgTWFrZXJJZFNldCA9IFNldDwvKiBtYWtlcklkICovIHN0cmluZz47XG5cbi8qKlxuICogR2VuZXJhdGUgYSBzZXQgb2YgTWFrZXJJZHMgdGhhdCBzdXBwb3J0IGEgZ2l2ZW4gb3JkZXIgdHlwZSBmb3IgYSBnaXZlbiB3b3JrZmxvd1xuICovXG5leHBvcnQgY29uc3QgZ2V0TWFrZXJJZFNldEZvck9yZGVyVHlwZSA9IChvcmRlclR5cGU6IFJmcU9yZGVyVHlwZSB8ICdhbnknLCB3b3JrZmxvdzogUmZxV29ya0Zsb3dUeXBlKTogTWFrZXJJZFNldCA9PiB7XG4gICAgY29uc3QgdHlwZXNGaWVsZCA9IHdvcmtmbG93ID09PSAncmZxdCcgPyAncmZxdE9yZGVyVHlwZXMnIDogJ3JmcW1PcmRlclR5cGVzJztcbiAgICByZXR1cm4gUkZRX01BS0VSX0NPTkZJR1MucmVkdWNlKChhY2MsIGN1cnIpID0+IHtcbiAgICAgICAgaWYgKG9yZGVyVHlwZSA9PT0gJ2FueScgfHwgY3Vyclt0eXBlc0ZpZWxkXS5pbmNsdWRlcyhvcmRlclR5cGUpKSB7XG4gICAgICAgICAgICBhY2MuYWRkKGN1cnIubWFrZXJJZCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGFjYztcbiAgICB9LCBuZXcgU2V0PC8qIG1ha2VySWQgKi8gc3RyaW5nPigpKTtcbn07XG5cbi8qKlxuICogQSBsaXN0IG9mIHR5cGUgUmZxTWFrZXJDb25maWcsIHJlYWQgZnJvbSB0aGUgUkZRX01BS0VSX0NPTkZJR1MgZW52IHZhcmlhYmxlXG4gKi9cbmV4cG9ydCBjb25zdCBSRlFfTUFLRVJfQ09ORklHUzogUmZxTWFrZXJDb25maWdbXSA9ICgoKSA9PiB7XG4gICAgdHJ5IHtcbiAgICAgICAgY29uc3QgbWFrZXJDb25maWdzID0gcmVzb2x2ZUVudlZhcjxSZnFNYWtlckNvbmZpZ1tdPignUkZRX01BS0VSX0NPTkZJR1MnLCBFbnZWYXJUeXBlLkpzb25TdHJpbmdMaXN0LCBbXSk7XG4gICAgICAgIHNjaGVtYVV0aWxzLnZhbGlkYXRlU2NoZW1hKG1ha2VyQ29uZmlncywgc2NoZW1hcy5yZnFNYWtlckNvbmZpZ0xpc3RTY2hlbWEpO1xuICAgICAgICByZXR1cm4gbWFrZXJDb25maWdzO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBSRlFfTUFLRVJfQ09ORklHUyB3YXMgZGVmaW5lZCBidXQgaXMgbm90IHZhbGlkIEpTT04gcGVyIHRoZSBzY2hlbWE6ICR7ZX1gKTtcbiAgICB9XG59KSgpO1xuXG4vLyBMb2cgbGV2ZWwgZm9yIHBpbm8uanNcbmV4cG9ydCBjb25zdCBMT0dfTEVWRUw6IHN0cmluZyA9IF8uaXNFbXB0eShwcm9jZXNzLmVudi5MT0dfTEVWRUwpXG4gICAgPyAnaW5mbydcbiAgICA6IGFzc2VydEVudlZhclR5cGUoJ0xPR19MRVZFTCcsIHByb2Nlc3MuZW52LkxPR19MRVZFTCwgRW52VmFyVHlwZS5Ob25FbXB0eVN0cmluZyk7XG5cbi8vIE5ldHdvcmsgcG9ydCB0byBsaXN0ZW4gb25cbmV4cG9ydCBjb25zdCBIVFRQX1BPUlQgPSBfLmlzRW1wdHkocHJvY2Vzcy5lbnYuSFRUUF9QT1JUKVxuICAgID8gMzAwMFxuICAgIDogYXNzZXJ0RW52VmFyVHlwZSgnSFRUUF9QT1JUJywgcHJvY2Vzcy5lbnYuSFRUUF9QT1JULCBFbnZWYXJUeXBlLlBvcnQpO1xuXG4vLyBOZXR3b3JrIHBvcnQgZm9yIHRoZSBoZWFsdGhjaGVjayBzZXJ2aWNlIGF0IC9oZWFsdGh6LCBpZiBub3QgcHJvdmlkZWQsIGl0IHVzZXMgdGhlIEhUVFBfUE9SVCB2YWx1ZS5cbmV4cG9ydCBjb25zdCBIRUFMVEhDSEVDS19IVFRQX1BPUlQgPSBfLmlzRW1wdHkocHJvY2Vzcy5lbnYuSEVBTFRIQ0hFQ0tfSFRUUF9QT1JUKVxuICAgID8gSFRUUF9QT1JUXG4gICAgOiBhc3NlcnRFbnZWYXJUeXBlKCdIRUFMVEhDSEVDS19IVFRQX1BPUlQnLCBwcm9jZXNzLmVudi5IRUFMVEhDSEVDS19IVFRQX1BPUlQsIEVudlZhclR5cGUuUG9ydCk7XG5cbi8vIE51bWJlciBvZiBtaWxsaXNlY29uZHMgb2YgaW5hY3Rpdml0eSB0aGUgc2VydmVycyB3YWl0cyBmb3IgYWRkaXRpb25hbFxuLy8gaW5jb21pbmcgZGF0YSBhZnRlcmUgaXQgZmluaXNoZWQgd3JpdGluZyBsYXN0IHJlc3BvbnNlIGJlZm9yZSBhIHNvY2tldCB3aWxsXG4vLyBiZSBkZXN0cm95ZWQuXG4vLyBSZWY6IGh0dHBzOi8vbm9kZWpzLm9yZy9hcGkvaHR0cC5odG1sI2h0dHBfc2VydmVyX2tlZXBhbGl2ZXRpbWVvdXRcbmV4cG9ydCBjb25zdCBIVFRQX0tFRVBfQUxJVkVfVElNRU9VVCA9IF8uaXNFbXB0eShwcm9jZXNzLmVudi5IVFRQX0tFRVBfQUxJVkVfVElNRU9VVClcbiAgICA/IDc2ICogMTAwMFxuICAgIDogYXNzZXJ0RW52VmFyVHlwZSgnSFRUUF9LRUVQX0FMSVZFX1RJTUVPVVQnLCBwcm9jZXNzLmVudi5IVFRQX0tFRVBfQUxJVkVfVElNRU9VVCwgRW52VmFyVHlwZS5LZWVwQWxpdmVUaW1lb3V0KTtcblxuLy8gTGltaXQgdGhlIGFtb3VudCBvZiB0aW1lIHRoZSBwYXJzZXIgd2lsbCB3YWl0IHRvIHJlY2VpdmUgdGhlIGNvbXBsZXRlIEhUVFAgaGVhZGVycy5cbi8vIE5PVEU6IFRoaXMgdmFsdWUgSEFTIHRvIGJlIGhpZ2hlciB0aGFuIEhUVFBfS0VFUF9BTElWRV9USU1FT1VULlxuLy8gUmVmOiBodHRwczovL25vZGVqcy5vcmcvYXBpL2h0dHAuaHRtbCNodHRwX3NlcnZlcl9oZWFkZXJzdGltZW91dFxuZXhwb3J0IGNvbnN0IEhUVFBfSEVBREVSU19USU1FT1VUID0gXy5pc0VtcHR5KHByb2Nlc3MuZW52LkhUVFBfSEVBREVSU19USU1FT1VUKVxuICAgID8gNzcgKiAxMDAwXG4gICAgOiBhc3NlcnRFbnZWYXJUeXBlKCdIVFRQX0hFQURFUlNfVElNRU9VVCcsIHByb2Nlc3MuZW52LkhUVFBfSEVBREVSU19USU1FT1VULCBFbnZWYXJUeXBlLktlZXBBbGl2ZVRpbWVvdXQpO1xuXG4vLyBEZWZhdWx0IGNoYWluIGlkIHRvIHVzZSB3aGVuIG5vdCBzcGVjaWZpZWRcbmV4cG9ydCBjb25zdCBDSEFJTl9JRDogQ2hhaW5JZCA9IF8uaXNFbXB0eShwcm9jZXNzLmVudi5DSEFJTl9JRClcbiAgICA/IENoYWluSWQuS292YW5cbiAgICA6IGFzc2VydEVudlZhclR5cGUoJ0NIQUlOX0lEJywgcHJvY2Vzcy5lbnYuQ0hBSU5fSUQsIEVudlZhclR5cGUuQ2hhaW5JZCk7XG5cbmV4cG9ydCBjb25zdCBLQUZLQV9CUk9LRVJTID0gXy5pc0VtcHR5KHByb2Nlc3MuZW52LktBRktBX0JST0tFUlMpXG4gICAgPyB1bmRlZmluZWRcbiAgICA6IGFzc2VydEVudlZhclR5cGUoJ0tBRktBX0JST0tFUlMnLCBwcm9jZXNzLmVudi5LQUZLQV9CUk9LRVJTLCBFbnZWYXJUeXBlLlN0cmluZ0xpc3QpO1xuXG4vLyBUaGUgZmVlIHJlY2lwaWVudCBmb3Igb3JkZXJzXG5leHBvcnQgY29uc3QgRkVFX1JFQ0lQSUVOVF9BRERSRVNTID0gXy5pc0VtcHR5KHByb2Nlc3MuZW52LkZFRV9SRUNJUElFTlRfQUREUkVTUylcbiAgICA/IE5VTExfQUREUkVTU1xuICAgIDogYXNzZXJ0RW52VmFyVHlwZSgnRkVFX1JFQ0lQSUVOVF9BRERSRVNTJywgcHJvY2Vzcy5lbnYuRkVFX1JFQ0lQSUVOVF9BRERSRVNTLCBFbnZWYXJUeXBlLkVUSEFkZHJlc3NIZXgpO1xuXG5leHBvcnQgY29uc3QgUE9TVEdSRVNfVVJJID0gXy5pc0VtcHR5KHByb2Nlc3MuZW52LlBPU1RHUkVTX1VSSSlcbiAgICA/IERFRkFVTFRfTE9DQUxfUE9TVEdSRVNfVVJJXG4gICAgOiBhc3NlcnRFbnZWYXJUeXBlKCdQT1NUR1JFU19VUkknLCBwcm9jZXNzLmVudi5QT1NUR1JFU19VUkksIEVudlZhclR5cGUuVXJsKTtcblxuZXhwb3J0IGNvbnN0IFBPU1RHUkVTX1JFQURfUkVQTElDQV9VUklTOiBzdHJpbmdbXSB8IHVuZGVmaW5lZCA9IF8uaXNFbXB0eShwcm9jZXNzLmVudi5QT1NUR1JFU19SRUFEX1JFUExJQ0FfVVJJUylcbiAgICA/IHVuZGVmaW5lZFxuICAgIDogYXNzZXJ0RW52VmFyVHlwZSgnUE9TVEdSRVNfUkVBRF9SRVBMSUNBX1VSSVMnLCBwcm9jZXNzLmVudi5QT1NUR1JFU19SRUFEX1JFUExJQ0FfVVJJUywgRW52VmFyVHlwZS5VcmxMaXN0KTtcblxuLy8gRW52aXJvbm1lbnQgbmFtZSBTZW50cnkgdXNlZCB0byBjYXRlZ29yaXplIGlzc3VlcyBhbmQgdHJhY2VzLlxuZXhwb3J0IGNvbnN0IFNFTlRSWV9FTlZJUk9OTUVOVCA9IF8uaXNFbXB0eShwcm9jZXNzLmVudi5TRU5UUllfRU5WSVJPTk1FTlQpXG4gICAgPyBERUZBVUxUX1NFTlRSWV9FTlZJUk9OTUVOVFxuICAgIDogYXNzZXJ0RW52VmFyVHlwZSgnU0VOVFJZX0VOVklST05NRU5UJywgcHJvY2Vzcy5lbnYuU0VOVFJZX0VOVklST05NRU5ULCBFbnZWYXJUeXBlLk5vbkVtcHR5U3RyaW5nKTtcblxuLy8gQW4gVXJsIHdpdGggY2xpZW50IGtleSB0byBhY2Nlc3MgU2VudHJ5IGZyb20gY2xpZW50IFNESy5cbmV4cG9ydCBjb25zdCBTRU5UUllfRFNOID0gXy5pc0VtcHR5KHByb2Nlc3MuZW52LlNFTlRSWV9EU04pXG4gICAgPyB1bmRlZmluZWRcbiAgICA6IGFzc2VydEVudlZhclR5cGUoJ1NFTlRSWV9EU04nLCBwcm9jZXNzLmVudi5TRU5UUllfRFNOLCBFbnZWYXJUeXBlLlVybCk7XG5cbi8vIEFQSSBLZXkgZm9yIERlZmluZWQuZmkncyB0b2tlbiBwcmljZSBBUElcbmV4cG9ydCBjb25zdCBERUZJTkVEX0ZJX0FQSV9LRVk6IHN0cmluZyA9IF8uaXNFbXB0eShwcm9jZXNzLmVudi5ERUZJTkVEX0ZJX0FQSV9LRVkpXG4gICAgPyAnJ1xuICAgIDogYXNzZXJ0RW52VmFyVHlwZSgnREVGSU5FRF9GSV9BUElfS0VZJywgcHJvY2Vzcy5lbnYuREVGSU5FRF9GSV9BUElfS0VZLCBFbnZWYXJUeXBlLk5vbkVtcHR5U3RyaW5nKTtcblxuLy8gRW5kcG9pbnQgZm9yIERlZmluZWQuZmkncyB0b2tlbiBwcmljZSBBUEksIGRlZmF1bHQgdG8gaHR0cHM6Ly9hcGkuZGVmaW5lZC5maVxuZXhwb3J0IGNvbnN0IERFRklORURfRklfRU5EUE9JTlQ6IHN0cmluZyA9IF8uaXNFbXB0eShwcm9jZXNzLmVudi5ERUZJTkVEX0ZJX0VORFBPSU5UKVxuICAgID8gJ2h0dHBzOi8vYXBpLmRlZmluZWQuZmknXG4gICAgOiBhc3NlcnRFbnZWYXJUeXBlKCdERUZJTkVEX0ZJX0VORFBPSU5UJywgcHJvY2Vzcy5lbnYuREVGSU5FRF9GSV9FTkRQT0lOVCwgRW52VmFyVHlwZS5Ob25FbXB0eVN0cmluZyk7XG5cbi8vIEFQSSBLZXkgZm9yIDB4IEFQSSAoZm9yIFplcm9FeEFwaUNsaWVudClcbmV4cG9ydCBjb25zdCBaRVJPX0VYX0FQSV9LRVk6IHN0cmluZyA9IF8uaXNFbXB0eShwcm9jZXNzLmVudi5aRVJPX0VYX0FQSV9LRVkpXG4gICAgPyAnJ1xuICAgIDogYXNzZXJ0RW52VmFyVHlwZSgnWkVST19FWF9BUElfS0VZJywgcHJvY2Vzcy5lbnYuWkVST19FWF9BUElfS0VZLCBFbnZWYXJUeXBlLk5vbkVtcHR5U3RyaW5nKTtcblxuLy8gJGVzbGludC1maXgtbWUgaHR0cHM6Ly9naXRodWIuY29tL3JoaW5vZGF2aWQvZXNsaW50LWZpeC1tZVxuLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1pbmZlcnJhYmxlLXR5cGVzXG5leHBvcnQgY29uc3QgVE9LRU5fUFJJQ0VfT1JBQ0xFX1RJTUVPVVQ6IG51bWJlciA9IDEwMDA7XG5cbi8vIFNhbXBsaW5nIHJhdGUgb2YgdHJhY2VzIHJlcG9ydGVkIHRvIFNlbnRyeS4gU2hvdWxkIGJlIGEgbnVtYmVyIGJldHdlZW4gMC4wIGFuZCAxLjAgKGluY2x1c2l2ZSkuXG5leHBvcnQgY29uc3QgU0VOVFJZX1RSQUNFU19TQU1QTEVfUkFURSA9IF8uaXNFbXB0eShwcm9jZXNzLmVudi5TRU5UUllfVFJBQ0VTX1NBTVBMRV9SQVRFKVxuICAgID8gMFxuICAgIDogYXNzZXJ0RW52VmFyVHlwZSgnU0VOVFJZX1RSQUNFU19TQU1QTEVfUkFURScsIHByb2Nlc3MuZW52LlNFTlRSWV9UUkFDRVNfU0FNUExFX1JBVEUsIEVudlZhclR5cGUuUmF0ZSk7XG5cbmV4cG9ydCBjb25zdCBSRURJU19VUkkgPSBfLmlzRW1wdHkocHJvY2Vzcy5lbnYuUkVESVNfVVJJKSA/IERFRkFVTFRfTE9DQUxfUkVESVNfVVJJIDogcHJvY2Vzcy5lbnYuUkVESVNfVVJJO1xuXG5leHBvcnQgY29uc3QgUkVESVNfQkFDS0dST1VORF9KT0JfVVJJID0gXy5pc0VtcHR5KHByb2Nlc3MuZW52LlJFRElTX0JBQ0tHUk9VTkRfSk9CX1VSSSlcbiAgICA/IERFRkFVTFRfTE9DQUxfUkVESVNfVVJJXG4gICAgOiBwcm9jZXNzLmVudi5SRURJU19CQUNLR1JPVU5EX0pPQl9VUkk7XG5cbmV4cG9ydCBjb25zdCBCQUNLR1JPVU5EX0pPQl9UWVBFUyA9IF8uaXNFbXB0eShwcm9jZXNzLmVudi5CQUNLR1JPVU5EX0pPQl9UWVBFUylcbiAgICA/IERFRkFVTFRfQkFDS0dST1VORF9KT0JfVFlQRVNcbiAgICA6IHByb2Nlc3MuZW52LkJBQ0tHUk9VTkRfSk9CX1RZUEVTO1xuXG4vLyBTaG91bGQgdGhlIGxvZ2dlciBpbmNsdWRlIHRpbWUgZmllbGQgaW4gdGhlIG91dHB1dCBsb2dzLCBkZWZhdWx0cyB0byB0cnVlLlxuZXhwb3J0IGNvbnN0IExPR0dFUl9JTkNMVURFX1RJTUVTVEFNUCA9IF8uaXNFbXB0eShwcm9jZXNzLmVudi5MT0dHRVJfSU5DTFVERV9USU1FU1RBTVApXG4gICAgPyBERUZBVUxUX0xPR0dFUl9JTkNMVURFX1RJTUVTVEFNUFxuICAgIDogYXNzZXJ0RW52VmFyVHlwZSgnTE9HR0VSX0lOQ0xVREVfVElNRVNUQU1QJywgcHJvY2Vzcy5lbnYuTE9HR0VSX0lOQ0xVREVfVElNRVNUQU1QLCBFbnZWYXJUeXBlLkJvb2xlYW4pO1xuXG5leHBvcnQgY29uc3QgQUxUX1JGUV9NTV9FTkRQT0lOVDogc3RyaW5nIHwgdW5kZWZpbmVkID0gXy5pc0VtcHR5KHByb2Nlc3MuZW52LkFMVF9SRlFfTU1fRU5EUE9JTlQpXG4gICAgPyB1bmRlZmluZWRcbiAgICA6IGFzc2VydEVudlZhclR5cGUoJ0FMVF9SRlFfTU1fRU5EUE9JTlQnLCBwcm9jZXNzLmVudi5BTFRfUkZRX01NX0VORFBPSU5ULCBFbnZWYXJUeXBlLlVybCk7XG5leHBvcnQgY29uc3QgQUxUX1JGUV9NTV9BUElfS0VZOiBzdHJpbmcgfCB1bmRlZmluZWQgPSBfLmlzRW1wdHkocHJvY2Vzcy5lbnYuQUxUX1JGUV9NTV9BUElfS0VZKVxuICAgID8gdW5kZWZpbmVkXG4gICAgOiBhc3NlcnRFbnZWYXJUeXBlKCdBTFRfUkZRX01NX0FQSV9LRVknLCBwcm9jZXNzLmVudi5BTFRfUkZRX01NX0FQSV9LRVksIEVudlZhclR5cGUuTm9uRW1wdHlTdHJpbmcpO1xuZXhwb3J0IGNvbnN0IEFMVF9SRlFfTU1fUFJPRklMRTogc3RyaW5nIHwgdW5kZWZpbmVkID0gXy5pc0VtcHR5KHByb2Nlc3MuZW52LkFMVF9SRlFfTU1fUFJPRklMRSlcbiAgICA/IHVuZGVmaW5lZFxuICAgIDogYXNzZXJ0RW52VmFyVHlwZSgnQUxUX1JGUV9NTV9QUk9GSUxFJywgcHJvY2Vzcy5lbnYuQUxUX1JGUV9NTV9QUk9GSUxFLCBFbnZWYXJUeXBlLk5vbkVtcHR5U3RyaW5nKTtcblxuZXhwb3J0IGNvbnN0IFJGUU1fQVBJX0tFWV9XSElURUxJU1Q6IFNldDxzdHJpbmc+ID0gbmV3IFNldChnZXRBcGlLZXlXaGl0ZWxpc3RGcm9tSW50ZWdyYXRvcnNBY2woJ3JmcW0nKSk7XG5cbmV4cG9ydCBjb25zdCBBRE1JTl9BUElfS0VZOiBzdHJpbmcgfCB1bmRlZmluZWQgPSBfLmlzRW1wdHkocHJvY2Vzcy5lbnYuQURNSU5fQVBJX0tFWSlcbiAgICA/IHVuZGVmaW5lZFxuICAgIDogYXNzZXJ0RW52VmFyVHlwZSgnQURNSU5fQVBJX0tFWScsIHByb2Nlc3MuZW52LkFETUlOX0FQSV9LRVksIEVudlZhclR5cGUuTm9uRW1wdHlTdHJpbmcpO1xuXG5leHBvcnQgY29uc3QgUkVBU09OX09OX1NUQVRVU19FUlJPUl9SRVNQT05TRV9FTkFCTEVEOiBib29sZWFuID0gXy5pc0VtcHR5KFxuICAgIHByb2Nlc3MuZW52LlJFQVNPTl9PTl9TVEFUVVNfRVJST1JfUkVTUE9OU0VfRU5BQkxFRCxcbilcbiAgICA/IGZhbHNlXG4gICAgOiBhc3NlcnRFbnZWYXJUeXBlKFxuICAgICAgICAgICdSRUFTT05fT05fU1RBVFVTX0VSUk9SX1JFU1BPTlNFX0VOQUJMRUQnLFxuICAgICAgICAgIHByb2Nlc3MuZW52LlJFQVNPTl9PTl9TVEFUVVNfRVJST1JfUkVTUE9OU0VfRU5BQkxFRCxcbiAgICAgICAgICBFbnZWYXJUeXBlLkJvb2xlYW4sXG4gICAgICApO1xuXG5leHBvcnQgY29uc3QgVEFLRVJfU1BFQ0lGSUVEX1NJREVfRU5BQkxFRDogYm9vbGVhbiA9IF8uaXNFbXB0eShwcm9jZXNzLmVudi5UQUtFUl9TUEVDSUZJRURfU0lERV9FTkFCTEVEKVxuICAgID8gZmFsc2VcbiAgICA6IGFzc2VydEVudlZhclR5cGUoJ1RBS0VSX1NQRUNJRklFRF9TSURFX0VOQUJMRUQnLCBwcm9jZXNzLmVudi5UQUtFUl9TUEVDSUZJRURfU0lERV9FTkFCTEVELCBFbnZWYXJUeXBlLkJvb2xlYW4pO1xuXG5leHBvcnQgY29uc3QgUkZRTV9NQUtFUl9JRF9TRVQ6IE1ha2VySWRTZXQgPSBnZXRNYWtlcklkU2V0Rm9yT3JkZXJUeXBlKCdhbnknLCAncmZxbScpO1xuZXhwb3J0IGNvbnN0IFJGUVRfTUFLRVJfSURfU0VUX0ZPUl9SRlFfT1JERVI6IE1ha2VySWRTZXQgPSBnZXRNYWtlcklkU2V0Rm9yT3JkZXJUeXBlKCdyZnEnLCAncmZxdCcpO1xuZXhwb3J0IGNvbnN0IFJGUVRfTUFLRVJfSURfU0VUX0ZPUl9PVENfT1JERVI6IE1ha2VySWRTZXQgPSBnZXRNYWtlcklkU2V0Rm9yT3JkZXJUeXBlKCdvdGMnLCAncmZxdCcpO1xuZXhwb3J0IGNvbnN0IFJGUU1fTUFLRVJfSURfU0VUX0ZPUl9PVENfT1JERVI6IE1ha2VySWRTZXQgPSBnZXRNYWtlcklkU2V0Rm9yT3JkZXJUeXBlKCdvdGMnLCAncmZxbScpO1xuXG4vKipcbiAqIEEgbWFwIGZyb20gUkZRIG1ha2VyJ3MgYXBpIGtleSBoYXNoZXMgdG8gbWFrZXIgaWRzLlxuICogSW52YWxpZCBoYXNoZXMsIHdoaWNoIGFwcGVhciBtb3JlIHRoYW4gb25jZSBpbiB0aGUgY29uZmlnIGZpbGUgYW5kIG1pZ2h0IHJlc29sdmUgdG8gZGlmZmVyZW50IG1ha2VycywgYXJlIHJlbW92ZWQgZnJvbSB0aGUgcmVzdWx0LlxuICovXG5leHBvcnQgY29uc3QgUkZRX0FQSV9LRVlfSEFTSF9UT19NQUtFUl9JRDogTWFwPHN0cmluZywgc3RyaW5nPiA9ICgoKSA9PiB7XG4gICAgY29uc3QgaGFzaFRvSWRDb3VudCA9IFJGUV9NQUtFUl9DT05GSUdTLnJlZHVjZSgocmVzdWx0LCByZnFNYWtlckNvbmZpZykgPT4ge1xuICAgICAgICByZnFNYWtlckNvbmZpZy5hcGlLZXlIYXNoZXMuZm9yRWFjaCgoaGFzaCkgPT4gcmVzdWx0LnNldChoYXNoLCAocmVzdWx0LmdldChoYXNoKSB8fCAwKSArIDEpKTtcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9LCBuZXcgTWFwPHN0cmluZywgbnVtYmVyPigpKTtcblxuICAgIHJldHVybiBSRlFfTUFLRVJfQ09ORklHUy5yZWR1Y2UoKHJlc3VsdCwgbW0pID0+IHtcbiAgICAgICAgbW0uYXBpS2V5SGFzaGVzLmZvckVhY2goKGhhc2gpID0+IHtcbiAgICAgICAgICAgIC8vIElnbm9yZSBpbnZhbGlkIGhhc2hlcyB3aXRoIG1vcmUgdGhhbiBvbmUgYXBwZWFyYW5jZXNcbiAgICAgICAgICAgIGlmIChoYXNoVG9JZENvdW50LmdldChoYXNoKSA9PT0gMSkge1xuICAgICAgICAgICAgICAgIHJlc3VsdC5zZXQoaGFzaCwgbW0ubWFrZXJJZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH0sIG5ldyBNYXA8c3RyaW5nLCBzdHJpbmc+KCkpO1xufSkoKTtcblxuZXhwb3J0IGNvbnN0IE1FVEFfVFhfV09SS0VSX01ORU1PTklDOiBzdHJpbmcgfCB1bmRlZmluZWQgPSBfLmlzRW1wdHkocHJvY2Vzcy5lbnYuTUVUQV9UWF9XT1JLRVJfTU5FTU9OSUMpXG4gICAgPyB1bmRlZmluZWRcbiAgICA6IGFzc2VydEVudlZhclR5cGUoJ01FVEFfVFhfV09SS0VSX01ORU1PTklDJywgcHJvY2Vzcy5lbnYuTUVUQV9UWF9XT1JLRVJfTU5FTU9OSUMsIEVudlZhclR5cGUuTm9uRW1wdHlTdHJpbmcpO1xuXG5leHBvcnQgY29uc3QgUkZRTV9XT1JLRVJfR1JPVVBfSU5ERVg6IG51bWJlciB8IHVuZGVmaW5lZCA9IF8uaXNFbXB0eShwcm9jZXNzLmVudi5SRlFNX1dPUktFUl9HUk9VUF9JTkRFWClcbiAgICA/IHVuZGVmaW5lZFxuICAgIDogYXNzZXJ0RW52VmFyVHlwZSgnUkZRTV9XT1JLRVJfR1JPVVBfSU5ERVgnLCBwcm9jZXNzLmVudi5SRlFNX1dPUktFUl9HUk9VUF9JTkRFWCwgRW52VmFyVHlwZS5JbnRlZ2VyKTtcblxuZXhwb3J0IGNvbnN0IFJGUU1fV09SS0VSX0dST1VQX1NJWkU6IG51bWJlciB8IHVuZGVmaW5lZCA9IF8uaXNFbXB0eShwcm9jZXNzLmVudi5SRlFNX1dPUktFUl9HUk9VUF9TSVpFKVxuICAgID8gdW5kZWZpbmVkXG4gICAgOiBhc3NlcnRFbnZWYXJUeXBlKCdSRlFNX1dPUktFUl9HUk9VUF9TSVpFJywgcHJvY2Vzcy5lbnYuUkZRTV9XT1JLRVJfR1JPVVBfU0laRSwgRW52VmFyVHlwZS5JbnRlZ2VyKTtcblxuLy8gSWYgc2V0IHRvIFRSVUUsIHN5c3RlbSBoZWFsdGggd2lsbCBjaGFuZ2UgdG8gTUFJTlRFTkFOQ0UgYW5kIGludGVncmF0b3JzIHdpbGwgYmUgdG9sZCB0byBub3Rcbi8vIHNlbmQgUkZRTSBvcmRlcnMuXG4vLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmUgYm9vbGVhbi1uYW1pbmdcbmV4cG9ydCBjb25zdCBSRlFNX01BSU5URU5BTkNFX01PREU6IGJvb2xlYW4gPSBfLmlzRW1wdHkocHJvY2Vzcy5lbnYuUkZRTV9NQUlOVEVOQU5DRV9NT0RFKVxuICAgID8gZmFsc2VcbiAgICA6IGFzc2VydEVudlZhclR5cGUoJ1JGUU1fTUFJTlRFTkFOQ0VfTU9ERScsIHByb2Nlc3MuZW52LlJGUU1fTUFJTlRFTkFOQ0VfTU9ERSwgRW52VmFyVHlwZS5Cb29sZWFuKTtcblxuZXhwb3J0IGNvbnN0IFJGUV9QUklDRV9FTkRQT0lOVF9USU1FT1VUX01TOiBudW1iZXIgPSBfLmlzRW1wdHkocHJvY2Vzcy5lbnYuUkZRX1BSSUNFX0VORFBPSU5UX1RJTUVPVVRfTVMpXG4gICAgPyAxMDAwXG4gICAgOiBhc3NlcnRFbnZWYXJUeXBlKCdSRlFfUFJJQ0VfRU5EUE9JTlRfVElNRU9VVF9NUycsIHByb2Nlc3MuZW52LlJGUV9QUklDRV9FTkRQT0lOVF9USU1FT1VUX01TLCBFbnZWYXJUeXBlLkludGVnZXIpO1xuXG5leHBvcnQgY29uc3QgUkZRX1NJR05fRU5EUE9JTlRfVElNRU9VVF9NUyA9IF8uaXNFbXB0eShwcm9jZXNzLmVudi5SRlFfU0lHTl9FTkRQT0lOVF9USU1FT1VUX01TKVxuICAgID8gMjAwMFxuICAgIDogYXNzZXJ0RW52VmFyVHlwZSgnUkZRX1NJR05fRU5EUE9JTlRfVElNRU9VVF9NUycsIHByb2Nlc3MuZW52LlJGUV9TSUdOX0VORFBPSU5UX1RJTUVPVVRfTVMsIEVudlZhclR5cGUuSW50ZWdlcik7XG5cbi8vIFRoZSBleHBlY3RlZCB0aW1lIGZvciBhIG1ldGEtdHhuIHRvIGJlIGluY2x1ZGVkIGluIGEgYmxvY2suXG5leHBvcnQgY29uc3QgTUVUQV9UWE5fUkVMQVlfRVhQRUNURURfTUlORURfU0VDOiBudW1iZXIgPSBfLmlzRW1wdHkocHJvY2Vzcy5lbnYuTUVUQV9UWE5fUkVMQVlfRVhQRUNURURfTUlORURfU0VDKVxuICAgID8gREVGQVVMVF9FWFBFQ1RFRF9NSU5FRF9TRUNcbiAgICA6IGFzc2VydEVudlZhclR5cGUoXG4gICAgICAgICAgJ01FVEFfVFhOX1JFTEFZX0VYUEVDVEVEX01JTkVEX1NFQycsXG4gICAgICAgICAgcHJvY2Vzcy5lbnYuTUVUQV9UWE5fUkVMQVlfRVhQRUNURURfTUlORURfU0VDLFxuICAgICAgICAgIEVudlZhclR5cGUuSW50ZWdlcixcbiAgICAgICk7XG5cbi8vIFdoZXRoZXIgb3Igbm90IHByb21ldGhldXMgbWV0cmljcyBzaG91bGQgYmUgZW5hYmxlZC5cbi8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTpib29sZWFuLW5hbWluZ1xuZXhwb3J0IGNvbnN0IEVOQUJMRV9QUk9NRVRIRVVTX01FVFJJQ1M6IGJvb2xlYW4gPSBfLmlzRW1wdHkocHJvY2Vzcy5lbnYuRU5BQkxFX1BST01FVEhFVVNfTUVUUklDUylcbiAgICA/IGZhbHNlXG4gICAgOiBhc3NlcnRFbnZWYXJUeXBlKCdFTkFCTEVfUFJPTUVUSEVVU19NRVRSSUNTJywgcHJvY2Vzcy5lbnYuRU5BQkxFX1BST01FVEhFVVNfTUVUUklDUywgRW52VmFyVHlwZS5Cb29sZWFuKTtcblxuZXhwb3J0IGNvbnN0IFBST01FVEhFVVNfUE9SVDogbnVtYmVyID0gXy5pc0VtcHR5KHByb2Nlc3MuZW52LlBST01FVEhFVVNfUE9SVClcbiAgICA/IDgwODBcbiAgICA6IGFzc2VydEVudlZhclR5cGUoJ1BST01FVEhFVVNfUE9SVCcsIHByb2Nlc3MuZW52LlBST01FVEhFVVNfUE9SVCwgRW52VmFyVHlwZS5Qb3J0KTtcblxuLy8gRXRoIEdhcyBTdGF0aW9uIFVSTFxuZXhwb3J0IGNvbnN0IEVUSF9HQVNfU1RBVElPTl9BUElfVVJMOiBzdHJpbmcgPSBfLmlzRW1wdHkocHJvY2Vzcy5lbnYuRVRIX0dBU19TVEFUSU9OX0FQSV9VUkwpXG4gICAgPyBERUZBVUxUX0VUSF9HQVNfU1RBVElPTl9BUElfVVJMXG4gICAgOiBhc3NlcnRFbnZWYXJUeXBlKCdFVEhfR0FTX1NUQVRJT05fQVBJX1VSTCcsIHByb2Nlc3MuZW52LkVUSF9HQVNfU1RBVElPTl9BUElfVVJMLCBFbnZWYXJUeXBlLlVybCk7XG5cbmV4cG9ydCBjb25zdCBSRlFfUFJPWFlfQUREUkVTUzogc3RyaW5nIHwgdW5kZWZpbmVkID0gXy5pc0VtcHR5KHByb2Nlc3MuZW52LlJGUV9QUk9YWV9BRERSRVNTKVxuICAgID8gdW5kZWZpbmVkXG4gICAgOiBhc3NlcnRFbnZWYXJUeXBlKCdSRlFfUFJPWFlfQUREUkVTUycsIHByb2Nlc3MuZW52LlJGUV9QUk9YWV9BRERSRVNTLCBFbnZWYXJUeXBlLk5vbkVtcHR5U3RyaW5nKTtcblxuZXhwb3J0IGNvbnN0IFJGUV9QUk9YWV9QT1JUOiBudW1iZXIgfCB1bmRlZmluZWQgPSBfLmlzRW1wdHkocHJvY2Vzcy5lbnYuUkZRX1BST1hZX1BPUlQpXG4gICAgPyB1bmRlZmluZWRcbiAgICA6IGFzc2VydEVudlZhclR5cGUoJ1JGUV9QUk9YWV9QT1JUJywgcHJvY2Vzcy5lbnYuUkZRX1BST1hZX1BPUlQsIEVudlZhclR5cGUuUG9ydCk7XG5cbi8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZSBib29sZWFuLW5hbWluZ1xuZXhwb3J0IGNvbnN0IEVOQUJMRV9MTFJfQ09PTERPV046IGJvb2xlYW4gPSBfLmlzRW1wdHkocHJvY2Vzcy5lbnYuRU5BQkxFX0xMUl9DT09MRE9XTilcbiAgICA/IGZhbHNlXG4gICAgOiBhc3NlcnRFbnZWYXJUeXBlKCdFTkFCTEVfTExSX0NPT0xET1dOJywgcHJvY2Vzcy5lbnYuRU5BQkxFX0xMUl9DT09MRE9XTiwgRW52VmFyVHlwZS5Cb29sZWFuKTtcblxuZXhwb3J0IGNvbnN0IExMUl9DT09MRE9XTl9EVVJBVElPTl9TRUNPTkRTOiBudW1iZXIgPSBfLmlzRW1wdHkocHJvY2Vzcy5lbnYuTExSX0NPT0xET1dOX0RVUkFUSU9OX1NFQ09ORFMpXG4gICAgPyA2MFxuICAgIDogYXNzZXJ0RW52VmFyVHlwZSgnTExSX0NPT0xET1dOX0RVUkFUSU9OX1NFQ09ORFMnLCBwcm9jZXNzLmVudi5MTFJfQ09PTERPV05fRFVSQVRJT05fU0VDT05EUywgRW52VmFyVHlwZS5JbnRlZ2VyKTtcblxuZXhwb3J0IGNvbnN0IGRlZmF1bHRIdHRwU2VydmljZUNvbmZpZzogSHR0cFNlcnZpY2VDb25maWcgPSB7XG4gICAgaHR0cFBvcnQ6IEhUVFBfUE9SVCxcbiAgICBoZWFsdGhjaGVja0h0dHBQb3J0OiBIRUFMVEhDSEVDS19IVFRQX1BPUlQsXG4gICAgaGVhbHRoY2hlY2tQYXRoOiBIRUFMVEhDSEVDS19QQVRILFxuICAgIGh0dHBLZWVwQWxpdmVUaW1lb3V0OiBIVFRQX0tFRVBfQUxJVkVfVElNRU9VVCxcbiAgICBodHRwSGVhZGVyc1RpbWVvdXQ6IEhUVFBfSEVBREVSU19USU1FT1VULFxuICAgIGVuYWJsZVByb21ldGhldXNNZXRyaWNzOiBFTkFCTEVfUFJPTUVUSEVVU19NRVRSSUNTLFxuICAgIHByb21ldGhldXNQb3J0OiBQUk9NRVRIRVVTX1BPUlQsXG4gICAgcHJvbWV0aGV1c1BhdGg6IE1FVFJJQ1NfUEFUSCxcbn07XG5cbmV4cG9ydCBjb25zdCBnZXRJbnRlZ3JhdG9yQnlJZE9yVGhyb3cgPSAoXG4gICAgKGludGVncmF0b3JzTWFwOiBNYXA8c3RyaW5nLCBJbnRlZ3JhdG9yPikgPT5cbiAgICAoaW50ZWdyYXRvcklkOiBzdHJpbmcpOiBJbnRlZ3JhdG9yID0+IHtcbiAgICAgICAgY29uc3QgaW50ZWdyYXRvciA9IGludGVncmF0b3JzTWFwLmdldChpbnRlZ3JhdG9ySWQpO1xuICAgICAgICBpZiAoIWludGVncmF0b3IpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgSW50ZWdyYXRvciAke2ludGVncmF0b3JJZH0gZG9lcyBub3QgZXhpc3QuYCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGludGVncmF0b3I7XG4gICAgfVxuKSh0cmFuc2Zvcm1JbnRlZ3JhdG9yc0FjbChJTlRFR1JBVE9SU19BQ0wsICdpbnRlZ3JhdG9ySWQnKSk7XG5cbi8qKlxuICogR2V0cyB0aGUgaW50ZWdyYXRvciBJRCBmb3IgYSBnaXZlbiBBUEkga2V5LiBJZiB0aGUgQVBJIGtleSBpcyBub3QgaW4gdGhlIGNvbmZpZ3VyYXRpb24sIHJldHVybnMgYHVuZGVmaW5lZGAuXG4gKi9cbmV4cG9ydCBjb25zdCBnZXRJbnRlZ3JhdG9ySWRGb3JBcGlLZXkgPSAoXG4gICAgKGludGVncmF0b3JzTWFwOiBNYXA8c3RyaW5nLCBJbnRlZ3JhdG9yPikgPT5cbiAgICAoYXBpS2V5OiBzdHJpbmcpOiBzdHJpbmcgfCB1bmRlZmluZWQgPT4ge1xuICAgICAgICBjb25zdCBpbnRlZ3JhdG9yID0gaW50ZWdyYXRvcnNNYXAuZ2V0KGFwaUtleSk7XG4gICAgICAgIHJldHVybiBpbnRlZ3JhdG9yPy5pbnRlZ3JhdG9ySWQ7XG4gICAgfVxuKSh0cmFuc2Zvcm1JbnRlZ3JhdG9yc0FjbChJTlRFR1JBVE9SU19BQ0wsICdhcGlLZXlzJykpO1xuXG4vKipcbiAqIFV0aWxpdHkgZnVuY3Rpb24gdG8gdHJhbnNmb3JtIElOVEVHUkFUT1JTX0FDTCBpbnRvIGEgbWFwIG9mIGFwaUtleSA9PiBpbnRlZ3JhdG9yLiBUaGUgcmVzdWx0IGNhblxuICogYmUgdXNlZCB0byBvcHRpbWl6ZSB0aGUgbG9va3VwIG9mIHRoZSBpbnRlZ3JhdG9yIHdoZW4gYSByZXF1ZXN0IGNvbWVzIGluIHdpdGggYW4gYXBpIGtleS4gTG9va3VwIGNvbXBsZXhpdHlcbiAqIGJlY29tZXMgTygxKSB3aXRoIHRoZSBtYXAgaW5zdGVhZCBvZiBPKCMgaW50ZWdyYXRvcnMgKiAjIGFwaSBrZXlzKSB3aXRoIHRoZSBhcnJheS5cbiAqXG4gKiBAcGFyYW0gaW50ZWdyYXRvcnMgdGhlIGludGVncmF0b3JzIG1hcCBmcm9tIHRoZSBlbnZpcm9ubWVudCB2YXJpYWJsZVxuICogQHBhcmFtIGtleUJ5IGVpdGhlciBhcGlLZXlzIChjcmVhdGVzIG1hcCBrZXllZCBieSBldmVyeSBBUEkga2V5KSBvciAnaW50ZWdyYXRvcklkJyAoaW50ZWdyYXRvcklkID0+IEludGVncmF0b3IpXG4gKi9cbmZ1bmN0aW9uIHRyYW5zZm9ybUludGVncmF0b3JzQWNsKFxuICAgIGludGVncmF0b3JzOiBJbnRlZ3JhdG9yc0FjbCxcbiAgICBrZXlCeTogJ2FwaUtleXMnIHwgJ2ludGVncmF0b3JJZCcsXG4pOiBNYXA8c3RyaW5nLCBJbnRlZ3JhdG9yPiB7XG4gICAgY29uc3QgcmVzdWx0ID0gbmV3IE1hcDxzdHJpbmcsIEludGVncmF0b3I+KCk7XG4gICAgaW50ZWdyYXRvcnMuZm9yRWFjaCgoaW50ZWdyYXRvcikgPT4ge1xuICAgICAgICBsZXQgbWFwS2V5czogc3RyaW5nW107XG4gICAgICAgIHN3aXRjaCAoa2V5QnkpIHtcbiAgICAgICAgICAgIGNhc2UgJ2FwaUtleXMnOlxuICAgICAgICAgICAgICAgIG1hcEtleXMgPSBpbnRlZ3JhdG9yLmFwaUtleXM7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICdpbnRlZ3JhdG9ySWQnOlxuICAgICAgICAgICAgICAgIG1hcEtleXMgPSBbaW50ZWdyYXRvci5pbnRlZ3JhdG9ySWRdO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFBhcmFtZXRlciBcIiR7a2V5Qnl9XCIgaXMgbWlzY29uZmlndXJlZGApO1xuICAgICAgICB9XG4gICAgICAgIG1hcEtleXMuZm9yRWFjaCgoYXBpS2V5KSA9PiB7XG4gICAgICAgICAgICByZXN1bHQuc2V0KGFwaUtleSwgaW50ZWdyYXRvcik7XG4gICAgICAgIH0pO1xuICAgIH0pO1xuICAgIHJldHVybiByZXN1bHQ7XG59XG5cbi8qKlxuICogUlBDXG4gKi9cbmV4cG9ydCBjb25zdCBNRVRBX1RSQU5TQUNUSU9OX1NFUlZJQ0VfUlBDX1VSTDogc3RyaW5nID0gXy5pc0VtcHR5KHByb2Nlc3MuZW52Lk1FVEFfVFJBTlNBQ1RJT05fU0VSVklDRV9SUENfVVJMKVxuICAgID8gJydcbiAgICA6IGFzc2VydEVudlZhclR5cGUoXG4gICAgICAgICAgJ01FVEFfVFJBTlNBQ1RJT05fU0VSVklDRV9SUENfVVJMJyxcbiAgICAgICAgICBwcm9jZXNzLmVudi5NRVRBX1RSQU5TQUNUSU9OX1NFUlZJQ0VfUlBDX1VSTCxcbiAgICAgICAgICBFbnZWYXJUeXBlLlVybCxcbiAgICAgICk7XG5cbi8qKlxuICogUmVzb2x2ZXMgYSBjb25maWcgb2YgdHlwZSBUIGZvciBhbiBFbnZpb3JubWVudCBWYXJpYWJsZS4gQ2hlY2tzOlxuICogIC0gSWYgdGhlIGVudiB2YXJpYWJsZSBpcyB1bmRlZmluZWQsIHVzZSB0aGUgaGFyZGNvZGVkIGZhbGxiYWNrXG4gKiAgLSBJZiB0aGUgZW52IHZhcmlhYmxlIHBvaW50cyB0byBhIGZpbGVwYXRoLCByZXNvbHZlIGl0XG4gKiAgLSBPdGhlcndpc2UsIGp1c3QgdXNlIHRoZSBlbnYgdmFyaWFibGVcbiAqXG4gKiBAcGFyYW0gZW52VmFyIC0gdGhlIG5hbWUgb2YgdGhlIEVudmlyb25tZW50IFZhcmlhYmxlXG4gKiBAcGFyYW0gZW52VmFyVHlwZSAtIHRoZSB0eXBlXG4gKiBAcGFyYW0gZmFsbGJhY2sgIC0gQSBoYXJkY29kZWQgZmFsbGJhY2sgdmFsdWVcbiAqIEByZXR1cm5zIFRoZSBjb25maWdcbiAqL1xuZnVuY3Rpb24gcmVzb2x2ZUVudlZhcjxUPihlbnZWYXI6IHN0cmluZywgZW52VmFyVHlwZTogRW52VmFyVHlwZSwgZmFsbGJhY2s6IFQpOiBUIHtcbiAgICBjb25zdCByYXdFbnZWYXIgPSBwcm9jZXNzLmVudltlbnZWYXJdO1xuICAgIGlmIChyYXdFbnZWYXIgPT09IHVuZGVmaW5lZCB8fCBfLmlzRW1wdHkocmF3RW52VmFyKSkge1xuICAgICAgICByZXR1cm4gZmFsbGJhY2s7XG4gICAgfVxuXG4gICAgLy8gSWYgdGhlIGVudmlvcm5tZW50IHZhcmlhYmxlIHBvaW50cyB0byBhIGZpbGVcbiAgICBpZiAoZnMuZXhpc3RzU3luYyhyYXdFbnZWYXIpKSB7XG4gICAgICAgIHJldHVybiBKU09OLnBhcnNlKGZzLnJlYWRGaWxlU3luYyhyYXdFbnZWYXIsICd1dGY4JykpO1xuICAgIH1cblxuICAgIHJldHVybiBhc3NlcnRFbnZWYXJUeXBlKGVudlZhciwgcHJvY2Vzcy5lbnZbZW52VmFyXSwgZW52VmFyVHlwZSk7XG59XG5cbi8vICRlc2xpbnQtZml4LW1lIGh0dHBzOi8vZ2l0aHViLmNvbS9yaGlub2RhdmlkL2VzbGludC1maXgtbWVcbi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG5mdW5jdGlvbiBhc3NlcnRFbnZWYXJUeXBlKG5hbWU6IHN0cmluZywgdmFsdWU6IGFueSwgZXhwZWN0ZWRUeXBlOiBFbnZWYXJUeXBlKTogYW55IHtcbiAgICBsZXQgcmV0dXJuVmFsdWU7XG4gICAgc3dpdGNoIChleHBlY3RlZFR5cGUpIHtcbiAgICAgICAgY2FzZSBFbnZWYXJUeXBlLlBvcnQ6XG4gICAgICAgICAgICByZXR1cm5WYWx1ZSA9IHBhcnNlSW50KHZhbHVlLCAxMCk7XG4gICAgICAgICAgICAvLyAkZXNsaW50LWZpeC1tZSBodHRwczovL2dpdGh1Yi5jb20vcmhpbm9kYXZpZC9lc2xpbnQtZml4LW1lXG4gICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tY2FzZS1kZWNsYXJhdGlvbnNcbiAgICAgICAgICAgIGNvbnN0IGlzV2l0aGluUmFuZ2UgPSByZXR1cm5WYWx1ZSA+PSAwICYmIHJldHVyblZhbHVlIDw9IDY1NTM1O1xuICAgICAgICAgICAgaWYgKGlzTmFOKHJldHVyblZhbHVlKSB8fCAhaXNXaXRoaW5SYW5nZSkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgJHtuYW1lfSBtdXN0IGJlIGJldHdlZW4gMCB0byA2NTUzNSwgZm91bmQgJHt2YWx1ZX0uYCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcmV0dXJuVmFsdWU7XG4gICAgICAgIGNhc2UgRW52VmFyVHlwZS5DaGFpbklkOlxuICAgICAgICBjYXNlIEVudlZhclR5cGUuS2VlcEFsaXZlVGltZW91dDpcbiAgICAgICAgY2FzZSBFbnZWYXJUeXBlLkludGVnZXI6XG4gICAgICAgICAgICByZXR1cm5WYWx1ZSA9IHBhcnNlSW50KHZhbHVlLCAxMCk7XG4gICAgICAgICAgICBpZiAoaXNOYU4ocmV0dXJuVmFsdWUpKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGAke25hbWV9IG11c3QgYmUgYSB2YWxpZCBpbnRlZ2VyLCBmb3VuZCAke3ZhbHVlfS5gKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiByZXR1cm5WYWx1ZTtcbiAgICAgICAgY2FzZSBFbnZWYXJUeXBlLkVUSEFkZHJlc3NIZXg6XG4gICAgICAgICAgICBhc3NlcnQuaXNFVEhBZGRyZXNzSGV4KG5hbWUsIHZhbHVlKTtcbiAgICAgICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICAgICAgY2FzZSBFbnZWYXJUeXBlLlVybDpcbiAgICAgICAgICAgIGFzc2VydC5pc1VyaShuYW1lLCB2YWx1ZSk7XG4gICAgICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgICAgIGNhc2UgRW52VmFyVHlwZS5VcmxMaXN0OlxuICAgICAgICAgICAgYXNzZXJ0LmlzU3RyaW5nKG5hbWUsIHZhbHVlKTtcbiAgICAgICAgICAgIC8vICRlc2xpbnQtZml4LW1lIGh0dHBzOi8vZ2l0aHViLmNvbS9yaGlub2RhdmlkL2VzbGludC1maXgtbWVcbiAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1jYXNlLWRlY2xhcmF0aW9uc1xuICAgICAgICAgICAgY29uc3QgdXJsTGlzdCA9ICh2YWx1ZSBhcyBzdHJpbmcpLnNwbGl0KCcsJyk7XG4gICAgICAgICAgICB1cmxMaXN0LmZvckVhY2goKHVybCwgaSkgPT4gYXNzZXJ0LmlzVXJpKGAke25hbWV9WyR7aX1dYCwgdXJsKSk7XG4gICAgICAgICAgICByZXR1cm4gdXJsTGlzdDtcbiAgICAgICAgY2FzZSBFbnZWYXJUeXBlLkJvb2xlYW46XG4gICAgICAgICAgICByZXR1cm4gdmFsdWUgPT09ICd0cnVlJztcbiAgICAgICAgY2FzZSBFbnZWYXJUeXBlLlVuaXRBbW91bnQ6XG4gICAgICAgICAgICByZXR1cm5WYWx1ZSA9IG5ldyBCaWdOdW1iZXIocGFyc2VGbG9hdCh2YWx1ZSkpO1xuICAgICAgICAgICAgaWYgKHJldHVyblZhbHVlLmlzTmFOKCkgfHwgcmV0dXJuVmFsdWUuaXNOZWdhdGl2ZSgpKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGAke25hbWV9IG11c3QgYmUgdmFsaWQgbnVtYmVyIGdyZWF0ZXIgdGhhbiAwLmApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHJldHVyblZhbHVlO1xuICAgICAgICBjYXNlIEVudlZhclR5cGUuUmF0ZTpcbiAgICAgICAgICAgIHJldHVyblZhbHVlID0gcGFyc2VGbG9hdCh2YWx1ZSk7XG4gICAgICAgICAgICBpZiAocmV0dXJuVmFsdWUgPCAwIHx8IHJldHVyblZhbHVlID4gMSkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgJHtuYW1lfSBtdXN0IGJlIHZhbGlkIG51bWJlciBiZXR3ZWVuIDAuMCBhbmQgMS4wLmApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHJldHVyblZhbHVlO1xuICAgICAgICBjYXNlIEVudlZhclR5cGUuQWRkcmVzc0xpc3Q6XG4gICAgICAgICAgICBhc3NlcnQuaXNTdHJpbmcobmFtZSwgdmFsdWUpO1xuICAgICAgICAgICAgLy8gJGVzbGludC1maXgtbWUgaHR0cHM6Ly9naXRodWIuY29tL3JoaW5vZGF2aWQvZXNsaW50LWZpeC1tZVxuICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWNhc2UtZGVjbGFyYXRpb25zXG4gICAgICAgICAgICBjb25zdCBhZGRyZXNzTGlzdCA9ICh2YWx1ZSBhcyBzdHJpbmcpLnNwbGl0KCcsJykubWFwKChhKSA9PiBhLnRvTG93ZXJDYXNlKCkpO1xuICAgICAgICAgICAgYWRkcmVzc0xpc3QuZm9yRWFjaCgoYSwgaSkgPT4gYXNzZXJ0LmlzRVRIQWRkcmVzc0hleChgJHtuYW1lfVske2l9XWAsIGEpKTtcbiAgICAgICAgICAgIHJldHVybiBhZGRyZXNzTGlzdDtcbiAgICAgICAgY2FzZSBFbnZWYXJUeXBlLlN0cmluZ0xpc3Q6XG4gICAgICAgICAgICBhc3NlcnQuaXNTdHJpbmcobmFtZSwgdmFsdWUpO1xuICAgICAgICAgICAgLy8gJGVzbGludC1maXgtbWUgaHR0cHM6Ly9naXRodWIuY29tL3JoaW5vZGF2aWQvZXNsaW50LWZpeC1tZVxuICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWNhc2UtZGVjbGFyYXRpb25zXG4gICAgICAgICAgICBjb25zdCBzdHJpbmdMaXN0ID0gKHZhbHVlIGFzIHN0cmluZykuc3BsaXQoJywnKTtcbiAgICAgICAgICAgIHJldHVybiBzdHJpbmdMaXN0O1xuICAgICAgICBjYXNlIEVudlZhclR5cGUuV2hpdGVsaXN0QWxsVG9rZW5zOlxuICAgICAgICAgICAgcmV0dXJuICcqJztcbiAgICAgICAgY2FzZSBFbnZWYXJUeXBlLk5vbkVtcHR5U3RyaW5nOlxuICAgICAgICAgICAgYXNzZXJ0LmlzU3RyaW5nKG5hbWUsIHZhbHVlKTtcbiAgICAgICAgICAgIGlmICh2YWx1ZSA9PT0gJycpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYCR7bmFtZX0gbXVzdCBiZSBzdXBwbGllZGApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgICAgICBjYXNlIEVudlZhclR5cGUuQVBJS2V5czpcbiAgICAgICAgICAgIGFzc2VydC5pc1N0cmluZyhuYW1lLCB2YWx1ZSk7XG4gICAgICAgICAgICAvLyAkZXNsaW50LWZpeC1tZSBodHRwczovL2dpdGh1Yi5jb20vcmhpbm9kYXZpZC9lc2xpbnQtZml4LW1lXG4gICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tY2FzZS1kZWNsYXJhdGlvbnNcbiAgICAgICAgICAgIGNvbnN0IGFwaUtleXMgPSAodmFsdWUgYXMgc3RyaW5nKS5zcGxpdCgnLCcpO1xuICAgICAgICAgICAgYXBpS2V5cy5mb3JFYWNoKChhcGlLZXkpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBpc1ZhbGlkVVVJRCA9IHZhbGlkYXRlVVVJRChhcGlLZXkpO1xuICAgICAgICAgICAgICAgIGlmICghaXNWYWxpZFVVSUQpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBBUEkgS2V5ICR7YXBpS2V5fSBpc24ndCBVVUlEIGNvbXBsaWFudGApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIGFwaUtleXM7XG4gICAgICAgIGNhc2UgRW52VmFyVHlwZS5Kc29uU3RyaW5nTGlzdDpcbiAgICAgICAgICAgIGFzc2VydC5pc1N0cmluZyhuYW1lLCB2YWx1ZSk7XG4gICAgICAgICAgICByZXR1cm4gSlNPTi5wYXJzZSh2YWx1ZSk7XG5cbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgVW5yZWNvZ25pemVkIEVudlZhclR5cGU6ICR7ZXhwZWN0ZWRUeXBlfSBlbmNvdW50ZXJlZCBmb3IgdmFyaWFibGUgJHtuYW1lfS5gKTtcbiAgICB9XG59XG4iXSwidmVyc2lvbiI6M30=