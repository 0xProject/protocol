{"file":"/Users/davidwalsh/code-local/0x-rfq-api/src/utils/rfqm_request_utils.ts","mappings":";;;AACA,qCAAsC;AA0BtC;;GAEG;AACH,SAAgB,kBAAkB,CAAC,OAA8B;IAC7D,OAAO;QACH,aAAa,EAAE,MAAM,CAAC,OAAO,CAAC,aAAa,CAAC;QAC5C,CAAC,EAAE,MAAM,CAAC,OAAO,CAAC,CAAC,CAAC;QACpB,CAAC,EAAE,OAAO,CAAC,CAAC;QACZ,CAAC,EAAE,OAAO,CAAC,CAAC;KACf,CAAC;AACN,CAAC;AAPD,gDAOC;AAED;;;GAGG;AACH,SAAgB,8BAA8B,CAAC,OAAiC;IAC5E,OAAO;QACH,QAAQ,EAAE,OAAO,CAAC,QAAQ;QAC1B,OAAO,EAAE,MAAM,CAAC,OAAO,CAAC,OAAO,CAAC;QAChC,qBAAqB,EAAE,IAAI,iBAAS,CAAC,OAAO,CAAC,qBAAqB,CAAC;QACnE,SAAS,EAAE,IAAI,iBAAS,CAAC,OAAO,CAAC,SAAS,CAAC;QAC3C,QAAQ,EAAE,OAAO,CAAC,QAAQ;QAC1B,WAAW,EAAE,IAAI,iBAAS,CAAC,OAAO,CAAC,WAAW,CAAC;QAC/C,WAAW,EAAE,IAAI,iBAAS,CAAC,OAAO,CAAC,WAAW,CAAC;QAC/C,IAAI,EAAE,IAAI,iBAAS,CAAC,OAAO,CAAC,IAAI,CAAC;QACjC,MAAM,EAAE,OAAO,CAAC,MAAM;QACtB,MAAM,EAAE,OAAO,CAAC,MAAM;QACtB,KAAK,EAAE,IAAI,iBAAS,CAAC,OAAO,CAAC,KAAK,CAAC;QACnC,iBAAiB,EAAE,OAAO,CAAC,iBAAiB;KAC/C,CAAC;AACN,CAAC;AAfD,wEAeC;AAED;;GAEG;AACH,SAAgB,uBAAuB,CAAC,OAA0B;IAC9D,OAAO;QACH,KAAK,EAAE,OAAO,CAAC,KAAK;QACpB,KAAK,EAAE,OAAO,CAAC,KAAK;QACpB,WAAW,EAAE,IAAI,iBAAS,CAAC,OAAO,CAAC,WAAW,CAAC;QAC/C,WAAW,EAAE,IAAI,iBAAS,CAAC,OAAO,CAAC,WAAW,CAAC;QAC/C,UAAU,EAAE,OAAO,CAAC,UAAU;QAC9B,UAAU,EAAE,OAAO,CAAC,UAAU;QAC9B,QAAQ,EAAE,OAAO,CAAC,QAAQ;QAC1B,cAAc,EAAE,IAAI,iBAAS,CAAC,OAAO,CAAC,cAAc,CAAC;QACrD,OAAO,EAAE,MAAM,CAAC,OAAO,CAAC,OAAO,CAAC;QAChC,iBAAiB,EAAE,OAAO,CAAC,iBAAiB;KAC/C,CAAC;AACN,CAAC;AAbD,0DAaC;AAED,4CAA4C;AAC5C,SAAS,sBAAsB,CAAC,OAAyC;IACrE,MAAM,GAAG,GAAiB;QACtB,GAAG,OAAO;QACV,OAAO,EAAE,MAAM,CAAC,OAAO,CAAC,OAAO,CAAC;KACnC,CAAC;IAEF,4BAA4B;IAC5B,IAAI,MAAM,CAAC,KAAK,CAAC,GAAG,CAAC,OAAO,CAAC,EAAE;QAC3B,OAAO,GAAG,CAAC,OAAO,CAAC;KACtB;IAED,OAAO,GAAG,CAAC;AACf,CAAC;AAED;;GAEG;AACH,SAAgB,sBAAsB,CAClC,OAA+B;IAE/B,OAAO;QACH,6DAA6D;QAC7D,8DAA8D;QAC9D,KAAK,EAAE,OAAO,CAAC,KAAY;QAC3B,6DAA6D;QAC7D,8DAA8D;QAC9D,WAAW,EAAE,OAAO,CAAC,WAAkB;QACvC,MAAM,EAAE,sBAAsB,CAAC,OAAO,CAAC,MAAM,CAAC;QAC9C,6DAA6D;QAC7D,8DAA8D;QAC9D,OAAO,EAAE,OAAO,CAAC,OAAc;KAClC,CAAC;AACN,CAAC;AAfD,wDAeC","names":[],"sources":["/Users/davidwalsh/code-local/0x-rfq-api/src/utils/rfqm_request_utils.ts"],"sourcesContent":["import { MetaTransactionFields, OtcOrderFields, Signature } from '@0x/protocol-utils';\r\nimport { BigNumber } from '@0x/utils';\r\n\r\nimport { Eip712DataField, Eip712Domain, ExecuteMetaTransactionEip712Context, PermitEip712Context } from '../core/types';\r\n\r\nexport interface StringSignatureFields {\r\n    signatureType: string;\r\n    v: string;\r\n    r: string;\r\n    s: string;\r\n}\r\n\r\n// $eslint-fix-me https://github.com/rhinodavid/eslint-fix-me\r\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\r\nexport type RawOtcOrderFields = Record<keyof Omit<OtcOrderFields, 'chainId'>, string> & { chainId: any };\r\n// $eslint-fix-me https://github.com/rhinodavid/eslint-fix-me\r\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\r\nexport type RawMetaTransactionFields = Record<keyof Omit<MetaTransactionFields, 'chainId'>, string> & { chainId: any };\r\nexport interface RawEIP712ContextFields {\r\n    types: Record<string, Record<keyof Eip712DataField, string>[]>;\r\n    primaryType: string;\r\n    domain: Record<keyof Eip712Domain, string>;\r\n    // $eslint-fix-me https://github.com/rhinodavid/eslint-fix-me\r\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n    message: Record<string, any>;\r\n}\r\n\r\n/**\r\n * convert a Signature response into the data types expected by protocol-utils\r\n */\r\nexport function stringsToSignature(strings: StringSignatureFields): Signature {\r\n    return {\r\n        signatureType: Number(strings.signatureType),\r\n        v: Number(strings.v),\r\n        r: strings.r,\r\n        s: strings.s,\r\n    };\r\n}\r\n\r\n/**\r\n * Converts the request payload for a gasless swap metatransaction into\r\n * the appropriate types\r\n */\r\nexport function stringsToMetaTransactionFields(strings: RawMetaTransactionFields): MetaTransactionFields {\r\n    return {\r\n        callData: strings.callData,\r\n        chainId: Number(strings.chainId),\r\n        expirationTimeSeconds: new BigNumber(strings.expirationTimeSeconds),\r\n        feeAmount: new BigNumber(strings.feeAmount),\r\n        feeToken: strings.feeToken,\r\n        maxGasPrice: new BigNumber(strings.maxGasPrice),\r\n        minGasPrice: new BigNumber(strings.minGasPrice),\r\n        salt: new BigNumber(strings.salt),\r\n        sender: strings.sender,\r\n        signer: strings.signer,\r\n        value: new BigNumber(strings.value),\r\n        verifyingContract: strings.verifyingContract,\r\n    };\r\n}\r\n\r\n/**\r\n * convert a JSON OtcOrder into an OtcOrder\r\n */\r\nexport function stringsToOtcOrderFields(strings: RawOtcOrderFields): OtcOrderFields {\r\n    return {\r\n        maker: strings.maker,\r\n        taker: strings.taker,\r\n        makerAmount: new BigNumber(strings.makerAmount),\r\n        takerAmount: new BigNumber(strings.takerAmount),\r\n        makerToken: strings.makerToken,\r\n        takerToken: strings.takerToken,\r\n        txOrigin: strings.txOrigin,\r\n        expiryAndNonce: new BigNumber(strings.expiryAndNonce),\r\n        chainId: Number(strings.chainId),\r\n        verifyingContract: strings.verifyingContract,\r\n    };\r\n}\r\n\r\n// Internal function for handling the domain\r\nfunction _stringsToEIP712Domain(strings: RawEIP712ContextFields['domain']): Eip712Domain {\r\n    const res: Eip712Domain = {\r\n        ...strings,\r\n        chainId: Number(strings.chainId),\r\n    };\r\n\r\n    // remove chainId if its NaN\r\n    if (Number.isNaN(res.chainId)) {\r\n        delete res.chainId;\r\n    }\r\n\r\n    return res;\r\n}\r\n\r\n/**\r\n * convert a JSON EIP712Context into an EIP712Context\r\n */\r\nexport function stringsToEIP712Context(\r\n    strings: RawEIP712ContextFields,\r\n): ExecuteMetaTransactionEip712Context | PermitEip712Context {\r\n    return {\r\n        // $eslint-fix-me https://github.com/rhinodavid/eslint-fix-me\r\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n        types: strings.types as any,\r\n        // $eslint-fix-me https://github.com/rhinodavid/eslint-fix-me\r\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n        primaryType: strings.primaryType as any,\r\n        domain: _stringsToEIP712Domain(strings.domain),\r\n        // $eslint-fix-me https://github.com/rhinodavid/eslint-fix-me\r\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n        message: strings.message as any,\r\n    };\r\n}\r\n"],"version":3}