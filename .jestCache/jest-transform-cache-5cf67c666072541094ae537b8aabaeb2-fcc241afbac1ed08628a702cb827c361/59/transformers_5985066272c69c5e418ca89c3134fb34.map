{"file":"/Users/davidwalsh/code-local/0x-rfq-api/src/entities/transformers.ts","mappings":"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","names":[],"sources":["/Users/davidwalsh/code-local/0x-rfq-api/src/entities/transformers.ts"],"sourcesContent":["import { MetaTransaction, MetaTransactionFields } from '@0x/protocol-utils';\nimport { BigNumber } from '@0x/utils';\nimport { ValueTransformer } from 'typeorm';\n\nimport { Fee, StoredFee } from '../core/types';\nimport { feeToStoredFee, storedFeeToFee } from '../core/fee_utils';\n\nexport const BigIntTransformer: ValueTransformer = {\n    from: (value: string | null): number | null => {\n        if (value === null) {\n            return null;\n        }\n        const num = Number(value);\n        if (!Number.isSafeInteger(num)) {\n            throw new Error('unsafe integer precision when transforming value');\n        }\n        return value === null ? null : Number(value);\n    },\n    to: (value: number | null | undefined): string | null => {\n        if (value === null || value === undefined) {\n            return null;\n        }\n        if (!Number.isSafeInteger(value)) {\n            throw new Error('unsafe integer precision when transforming value');\n        }\n        return value.toString();\n    },\n};\n\nexport const BigNumberTransformer: ValueTransformer = {\n    from: (value: string | null): BigNumber | null => {\n        return value === null ? null : new BigNumber(value);\n    },\n    to: (value: BigNumber | null | undefined): string | null => {\n        return value === null || value === undefined ? null : value.toString();\n    },\n};\n\nexport const MetaTransactionTransformer: ValueTransformer = {\n    /**\n     * Used to marshal `MetaTransaction` when writing to the database.\n     */\n    to: (metaTransaction: MetaTransaction): Record<keyof MetaTransactionFields, string> => {\n        const { minGasPrice, maxGasPrice, expirationTimeSeconds, salt, value, feeAmount, chainId } = metaTransaction;\n        return {\n            ...metaTransaction,\n            minGasPrice: minGasPrice.toString(),\n            maxGasPrice: maxGasPrice.toString(),\n            expirationTimeSeconds: expirationTimeSeconds.toString(),\n            salt: salt.toString(),\n            value: value.toString(),\n            feeAmount: feeAmount.toString(),\n            chainId: chainId.toString(),\n        };\n    },\n    /**\n     * Used to unmarshal `MetaTransaction` when reading from the database.\n     */\n    from: (storedValue: Record<keyof MetaTransactionFields, string>): MetaTransaction => {\n        const { minGasPrice, maxGasPrice, expirationTimeSeconds, salt, value, feeAmount, chainId } = storedValue;\n        return new MetaTransaction({\n            ...storedValue,\n            minGasPrice: new BigNumber(minGasPrice),\n            maxGasPrice: new BigNumber(maxGasPrice),\n            expirationTimeSeconds: new BigNumber(expirationTimeSeconds),\n            salt: new BigNumber(salt),\n            value: new BigNumber(value),\n            feeAmount: new BigNumber(feeAmount),\n            chainId: Number(chainId),\n        });\n    },\n};\n\nexport const FeeTransformer: ValueTransformer = {\n    /**\n     * Used to marshal `Fee` when writing to the database.\n     */\n    to: (value: Fee): StoredFee => {\n        return feeToStoredFee(value);\n    },\n    /**\n     * Used to unmarshal `Fee` when reading from the database.\n     */\n    from: (storedFee: StoredFee): Fee => {\n        return storedFeeToFee(storedFee);\n    },\n};\n"],"version":3}