e7f668e59100f6b694a681bb18081475
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.stringsToEIP712Context = exports.stringsToOtcOrderFields = exports.stringsToMetaTransactionFields = exports.stringsToSignature = void 0;
const utils_1 = require("@0x/utils");
/**
 * convert a Signature response into the data types expected by protocol-utils
 */
function stringsToSignature(strings) {
    return {
        signatureType: Number(strings.signatureType),
        v: Number(strings.v),
        r: strings.r,
        s: strings.s,
    };
}
exports.stringsToSignature = stringsToSignature;
/**
 * Converts the request payload for a gasless swap metatransaction into
 * the appropriate types
 */
function stringsToMetaTransactionFields(strings) {
    return {
        callData: strings.callData,
        chainId: Number(strings.chainId),
        expirationTimeSeconds: new utils_1.BigNumber(strings.expirationTimeSeconds),
        feeAmount: new utils_1.BigNumber(strings.feeAmount),
        feeToken: strings.feeToken,
        maxGasPrice: new utils_1.BigNumber(strings.maxGasPrice),
        minGasPrice: new utils_1.BigNumber(strings.minGasPrice),
        salt: new utils_1.BigNumber(strings.salt),
        sender: strings.sender,
        signer: strings.signer,
        value: new utils_1.BigNumber(strings.value),
        verifyingContract: strings.verifyingContract,
    };
}
exports.stringsToMetaTransactionFields = stringsToMetaTransactionFields;
/**
 * convert a JSON OtcOrder into an OtcOrder
 */
function stringsToOtcOrderFields(strings) {
    return {
        maker: strings.maker,
        taker: strings.taker,
        makerAmount: new utils_1.BigNumber(strings.makerAmount),
        takerAmount: new utils_1.BigNumber(strings.takerAmount),
        makerToken: strings.makerToken,
        takerToken: strings.takerToken,
        txOrigin: strings.txOrigin,
        expiryAndNonce: new utils_1.BigNumber(strings.expiryAndNonce),
        chainId: Number(strings.chainId),
        verifyingContract: strings.verifyingContract,
    };
}
exports.stringsToOtcOrderFields = stringsToOtcOrderFields;
// Internal function for handling the domain
function _stringsToEIP712Domain(strings) {
    const res = {
        ...strings,
        chainId: Number(strings.chainId),
    };
    // remove chainId if its NaN
    if (Number.isNaN(res.chainId)) {
        delete res.chainId;
    }
    return res;
}
/**
 * convert a JSON EIP712Context into an EIP712Context
 */
function stringsToEIP712Context(strings) {
    return {
        // $eslint-fix-me https://github.com/rhinodavid/eslint-fix-me
        // eslint-disable-next-line @typescript-eslint/no-explicit-any
        types: strings.types,
        // $eslint-fix-me https://github.com/rhinodavid/eslint-fix-me
        // eslint-disable-next-line @typescript-eslint/no-explicit-any
        primaryType: strings.primaryType,
        domain: _stringsToEIP712Domain(strings.domain),
        // $eslint-fix-me https://github.com/rhinodavid/eslint-fix-me
        // eslint-disable-next-line @typescript-eslint/no-explicit-any
        message: strings.message,
    };
}
exports.stringsToEIP712Context = stringsToEIP712Context;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL2Rhdmlkd2Fsc2gvY29kZS1sb2NhbC8weC1yZnEtYXBpL3NyYy91dGlscy9yZnFtX3JlcXVlc3RfdXRpbHMudHMiLCJtYXBwaW5ncyI6Ijs7O0FBQ0EscUNBQXNDO0FBMEJ0Qzs7R0FFRztBQUNILFNBQWdCLGtCQUFrQixDQUFDLE9BQThCO0lBQzdELE9BQU87UUFDSCxhQUFhLEVBQUUsTUFBTSxDQUFDLE9BQU8sQ0FBQyxhQUFhLENBQUM7UUFDNUMsQ0FBQyxFQUFFLE1BQU0sQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDO1FBQ3BCLENBQUMsRUFBRSxPQUFPLENBQUMsQ0FBQztRQUNaLENBQUMsRUFBRSxPQUFPLENBQUMsQ0FBQztLQUNmLENBQUM7QUFDTixDQUFDO0FBUEQsZ0RBT0M7QUFFRDs7O0dBR0c7QUFDSCxTQUFnQiw4QkFBOEIsQ0FBQyxPQUFpQztJQUM1RSxPQUFPO1FBQ0gsUUFBUSxFQUFFLE9BQU8sQ0FBQyxRQUFRO1FBQzFCLE9BQU8sRUFBRSxNQUFNLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQztRQUNoQyxxQkFBcUIsRUFBRSxJQUFJLGlCQUFTLENBQUMsT0FBTyxDQUFDLHFCQUFxQixDQUFDO1FBQ25FLFNBQVMsRUFBRSxJQUFJLGlCQUFTLENBQUMsT0FBTyxDQUFDLFNBQVMsQ0FBQztRQUMzQyxRQUFRLEVBQUUsT0FBTyxDQUFDLFFBQVE7UUFDMUIsV0FBVyxFQUFFLElBQUksaUJBQVMsQ0FBQyxPQUFPLENBQUMsV0FBVyxDQUFDO1FBQy9DLFdBQVcsRUFBRSxJQUFJLGlCQUFTLENBQUMsT0FBTyxDQUFDLFdBQVcsQ0FBQztRQUMvQyxJQUFJLEVBQUUsSUFBSSxpQkFBUyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUM7UUFDakMsTUFBTSxFQUFFLE9BQU8sQ0FBQyxNQUFNO1FBQ3RCLE1BQU0sRUFBRSxPQUFPLENBQUMsTUFBTTtRQUN0QixLQUFLLEVBQUUsSUFBSSxpQkFBUyxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUM7UUFDbkMsaUJBQWlCLEVBQUUsT0FBTyxDQUFDLGlCQUFpQjtLQUMvQyxDQUFDO0FBQ04sQ0FBQztBQWZELHdFQWVDO0FBRUQ7O0dBRUc7QUFDSCxTQUFnQix1QkFBdUIsQ0FBQyxPQUEwQjtJQUM5RCxPQUFPO1FBQ0gsS0FBSyxFQUFFLE9BQU8sQ0FBQyxLQUFLO1FBQ3BCLEtBQUssRUFBRSxPQUFPLENBQUMsS0FBSztRQUNwQixXQUFXLEVBQUUsSUFBSSxpQkFBUyxDQUFDLE9BQU8sQ0FBQyxXQUFXLENBQUM7UUFDL0MsV0FBVyxFQUFFLElBQUksaUJBQVMsQ0FBQyxPQUFPLENBQUMsV0FBVyxDQUFDO1FBQy9DLFVBQVUsRUFBRSxPQUFPLENBQUMsVUFBVTtRQUM5QixVQUFVLEVBQUUsT0FBTyxDQUFDLFVBQVU7UUFDOUIsUUFBUSxFQUFFLE9BQU8sQ0FBQyxRQUFRO1FBQzFCLGNBQWMsRUFBRSxJQUFJLGlCQUFTLENBQUMsT0FBTyxDQUFDLGNBQWMsQ0FBQztRQUNyRCxPQUFPLEVBQUUsTUFBTSxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUM7UUFDaEMsaUJBQWlCLEVBQUUsT0FBTyxDQUFDLGlCQUFpQjtLQUMvQyxDQUFDO0FBQ04sQ0FBQztBQWJELDBEQWFDO0FBRUQsNENBQTRDO0FBQzVDLFNBQVMsc0JBQXNCLENBQUMsT0FBeUM7SUFDckUsTUFBTSxHQUFHLEdBQWlCO1FBQ3RCLEdBQUcsT0FBTztRQUNWLE9BQU8sRUFBRSxNQUFNLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQztLQUNuQyxDQUFDO0lBRUYsNEJBQTRCO0lBQzVCLElBQUksTUFBTSxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsT0FBTyxDQUFDLEVBQUU7UUFDM0IsT0FBTyxHQUFHLENBQUMsT0FBTyxDQUFDO0tBQ3RCO0lBRUQsT0FBTyxHQUFHLENBQUM7QUFDZixDQUFDO0FBRUQ7O0dBRUc7QUFDSCxTQUFnQixzQkFBc0IsQ0FDbEMsT0FBK0I7SUFFL0IsT0FBTztRQUNILDZEQUE2RDtRQUM3RCw4REFBOEQ7UUFDOUQsS0FBSyxFQUFFLE9BQU8sQ0FBQyxLQUFZO1FBQzNCLDZEQUE2RDtRQUM3RCw4REFBOEQ7UUFDOUQsV0FBVyxFQUFFLE9BQU8sQ0FBQyxXQUFrQjtRQUN2QyxNQUFNLEVBQUUsc0JBQXNCLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBQztRQUM5Qyw2REFBNkQ7UUFDN0QsOERBQThEO1FBQzlELE9BQU8sRUFBRSxPQUFPLENBQUMsT0FBYztLQUNsQyxDQUFDO0FBQ04sQ0FBQztBQWZELHdEQWVDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIi9Vc2Vycy9kYXZpZHdhbHNoL2NvZGUtbG9jYWwvMHgtcmZxLWFwaS9zcmMvdXRpbHMvcmZxbV9yZXF1ZXN0X3V0aWxzLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE1ldGFUcmFuc2FjdGlvbkZpZWxkcywgT3RjT3JkZXJGaWVsZHMsIFNpZ25hdHVyZSB9IGZyb20gJ0AweC9wcm90b2NvbC11dGlscyc7XG5pbXBvcnQgeyBCaWdOdW1iZXIgfSBmcm9tICdAMHgvdXRpbHMnO1xuXG5pbXBvcnQgeyBFaXA3MTJEYXRhRmllbGQsIEVpcDcxMkRvbWFpbiwgRXhlY3V0ZU1ldGFUcmFuc2FjdGlvbkVpcDcxMkNvbnRleHQsIFBlcm1pdEVpcDcxMkNvbnRleHQgfSBmcm9tICcuLi9jb3JlL3R5cGVzJztcblxuZXhwb3J0IGludGVyZmFjZSBTdHJpbmdTaWduYXR1cmVGaWVsZHMge1xuICAgIHNpZ25hdHVyZVR5cGU6IHN0cmluZztcbiAgICB2OiBzdHJpbmc7XG4gICAgcjogc3RyaW5nO1xuICAgIHM6IHN0cmluZztcbn1cblxuLy8gJGVzbGludC1maXgtbWUgaHR0cHM6Ly9naXRodWIuY29tL3JoaW5vZGF2aWQvZXNsaW50LWZpeC1tZVxuLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbmV4cG9ydCB0eXBlIFJhd090Y09yZGVyRmllbGRzID0gUmVjb3JkPGtleW9mIE9taXQ8T3RjT3JkZXJGaWVsZHMsICdjaGFpbklkJz4sIHN0cmluZz4gJiB7IGNoYWluSWQ6IGFueSB9O1xuLy8gJGVzbGludC1maXgtbWUgaHR0cHM6Ly9naXRodWIuY29tL3JoaW5vZGF2aWQvZXNsaW50LWZpeC1tZVxuLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbmV4cG9ydCB0eXBlIFJhd01ldGFUcmFuc2FjdGlvbkZpZWxkcyA9IFJlY29yZDxrZXlvZiBPbWl0PE1ldGFUcmFuc2FjdGlvbkZpZWxkcywgJ2NoYWluSWQnPiwgc3RyaW5nPiAmIHsgY2hhaW5JZDogYW55IH07XG5leHBvcnQgaW50ZXJmYWNlIFJhd0VJUDcxMkNvbnRleHRGaWVsZHMge1xuICAgIHR5cGVzOiBSZWNvcmQ8c3RyaW5nLCBSZWNvcmQ8a2V5b2YgRWlwNzEyRGF0YUZpZWxkLCBzdHJpbmc+W10+O1xuICAgIHByaW1hcnlUeXBlOiBzdHJpbmc7XG4gICAgZG9tYWluOiBSZWNvcmQ8a2V5b2YgRWlwNzEyRG9tYWluLCBzdHJpbmc+O1xuICAgIC8vICRlc2xpbnQtZml4LW1lIGh0dHBzOi8vZ2l0aHViLmNvbS9yaGlub2RhdmlkL2VzbGludC1maXgtbWVcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuICAgIG1lc3NhZ2U6IFJlY29yZDxzdHJpbmcsIGFueT47XG59XG5cbi8qKlxuICogY29udmVydCBhIFNpZ25hdHVyZSByZXNwb25zZSBpbnRvIHRoZSBkYXRhIHR5cGVzIGV4cGVjdGVkIGJ5IHByb3RvY29sLXV0aWxzXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBzdHJpbmdzVG9TaWduYXR1cmUoc3RyaW5nczogU3RyaW5nU2lnbmF0dXJlRmllbGRzKTogU2lnbmF0dXJlIHtcbiAgICByZXR1cm4ge1xuICAgICAgICBzaWduYXR1cmVUeXBlOiBOdW1iZXIoc3RyaW5ncy5zaWduYXR1cmVUeXBlKSxcbiAgICAgICAgdjogTnVtYmVyKHN0cmluZ3MudiksXG4gICAgICAgIHI6IHN0cmluZ3MucixcbiAgICAgICAgczogc3RyaW5ncy5zLFxuICAgIH07XG59XG5cbi8qKlxuICogQ29udmVydHMgdGhlIHJlcXVlc3QgcGF5bG9hZCBmb3IgYSBnYXNsZXNzIHN3YXAgbWV0YXRyYW5zYWN0aW9uIGludG9cbiAqIHRoZSBhcHByb3ByaWF0ZSB0eXBlc1xuICovXG5leHBvcnQgZnVuY3Rpb24gc3RyaW5nc1RvTWV0YVRyYW5zYWN0aW9uRmllbGRzKHN0cmluZ3M6IFJhd01ldGFUcmFuc2FjdGlvbkZpZWxkcyk6IE1ldGFUcmFuc2FjdGlvbkZpZWxkcyB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgY2FsbERhdGE6IHN0cmluZ3MuY2FsbERhdGEsXG4gICAgICAgIGNoYWluSWQ6IE51bWJlcihzdHJpbmdzLmNoYWluSWQpLFxuICAgICAgICBleHBpcmF0aW9uVGltZVNlY29uZHM6IG5ldyBCaWdOdW1iZXIoc3RyaW5ncy5leHBpcmF0aW9uVGltZVNlY29uZHMpLFxuICAgICAgICBmZWVBbW91bnQ6IG5ldyBCaWdOdW1iZXIoc3RyaW5ncy5mZWVBbW91bnQpLFxuICAgICAgICBmZWVUb2tlbjogc3RyaW5ncy5mZWVUb2tlbixcbiAgICAgICAgbWF4R2FzUHJpY2U6IG5ldyBCaWdOdW1iZXIoc3RyaW5ncy5tYXhHYXNQcmljZSksXG4gICAgICAgIG1pbkdhc1ByaWNlOiBuZXcgQmlnTnVtYmVyKHN0cmluZ3MubWluR2FzUHJpY2UpLFxuICAgICAgICBzYWx0OiBuZXcgQmlnTnVtYmVyKHN0cmluZ3Muc2FsdCksXG4gICAgICAgIHNlbmRlcjogc3RyaW5ncy5zZW5kZXIsXG4gICAgICAgIHNpZ25lcjogc3RyaW5ncy5zaWduZXIsXG4gICAgICAgIHZhbHVlOiBuZXcgQmlnTnVtYmVyKHN0cmluZ3MudmFsdWUpLFxuICAgICAgICB2ZXJpZnlpbmdDb250cmFjdDogc3RyaW5ncy52ZXJpZnlpbmdDb250cmFjdCxcbiAgICB9O1xufVxuXG4vKipcbiAqIGNvbnZlcnQgYSBKU09OIE90Y09yZGVyIGludG8gYW4gT3RjT3JkZXJcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHN0cmluZ3NUb090Y09yZGVyRmllbGRzKHN0cmluZ3M6IFJhd090Y09yZGVyRmllbGRzKTogT3RjT3JkZXJGaWVsZHMge1xuICAgIHJldHVybiB7XG4gICAgICAgIG1ha2VyOiBzdHJpbmdzLm1ha2VyLFxuICAgICAgICB0YWtlcjogc3RyaW5ncy50YWtlcixcbiAgICAgICAgbWFrZXJBbW91bnQ6IG5ldyBCaWdOdW1iZXIoc3RyaW5ncy5tYWtlckFtb3VudCksXG4gICAgICAgIHRha2VyQW1vdW50OiBuZXcgQmlnTnVtYmVyKHN0cmluZ3MudGFrZXJBbW91bnQpLFxuICAgICAgICBtYWtlclRva2VuOiBzdHJpbmdzLm1ha2VyVG9rZW4sXG4gICAgICAgIHRha2VyVG9rZW46IHN0cmluZ3MudGFrZXJUb2tlbixcbiAgICAgICAgdHhPcmlnaW46IHN0cmluZ3MudHhPcmlnaW4sXG4gICAgICAgIGV4cGlyeUFuZE5vbmNlOiBuZXcgQmlnTnVtYmVyKHN0cmluZ3MuZXhwaXJ5QW5kTm9uY2UpLFxuICAgICAgICBjaGFpbklkOiBOdW1iZXIoc3RyaW5ncy5jaGFpbklkKSxcbiAgICAgICAgdmVyaWZ5aW5nQ29udHJhY3Q6IHN0cmluZ3MudmVyaWZ5aW5nQ29udHJhY3QsXG4gICAgfTtcbn1cblxuLy8gSW50ZXJuYWwgZnVuY3Rpb24gZm9yIGhhbmRsaW5nIHRoZSBkb21haW5cbmZ1bmN0aW9uIF9zdHJpbmdzVG9FSVA3MTJEb21haW4oc3RyaW5nczogUmF3RUlQNzEyQ29udGV4dEZpZWxkc1snZG9tYWluJ10pOiBFaXA3MTJEb21haW4ge1xuICAgIGNvbnN0IHJlczogRWlwNzEyRG9tYWluID0ge1xuICAgICAgICAuLi5zdHJpbmdzLFxuICAgICAgICBjaGFpbklkOiBOdW1iZXIoc3RyaW5ncy5jaGFpbklkKSxcbiAgICB9O1xuXG4gICAgLy8gcmVtb3ZlIGNoYWluSWQgaWYgaXRzIE5hTlxuICAgIGlmIChOdW1iZXIuaXNOYU4ocmVzLmNoYWluSWQpKSB7XG4gICAgICAgIGRlbGV0ZSByZXMuY2hhaW5JZDtcbiAgICB9XG5cbiAgICByZXR1cm4gcmVzO1xufVxuXG4vKipcbiAqIGNvbnZlcnQgYSBKU09OIEVJUDcxMkNvbnRleHQgaW50byBhbiBFSVA3MTJDb250ZXh0XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBzdHJpbmdzVG9FSVA3MTJDb250ZXh0KFxuICAgIHN0cmluZ3M6IFJhd0VJUDcxMkNvbnRleHRGaWVsZHMsXG4pOiBFeGVjdXRlTWV0YVRyYW5zYWN0aW9uRWlwNzEyQ29udGV4dCB8IFBlcm1pdEVpcDcxMkNvbnRleHQge1xuICAgIHJldHVybiB7XG4gICAgICAgIC8vICRlc2xpbnQtZml4LW1lIGh0dHBzOi8vZ2l0aHViLmNvbS9yaGlub2RhdmlkL2VzbGludC1maXgtbWVcbiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbiAgICAgICAgdHlwZXM6IHN0cmluZ3MudHlwZXMgYXMgYW55LFxuICAgICAgICAvLyAkZXNsaW50LWZpeC1tZSBodHRwczovL2dpdGh1Yi5jb20vcmhpbm9kYXZpZC9lc2xpbnQtZml4LW1lXG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgICAgIHByaW1hcnlUeXBlOiBzdHJpbmdzLnByaW1hcnlUeXBlIGFzIGFueSxcbiAgICAgICAgZG9tYWluOiBfc3RyaW5nc1RvRUlQNzEyRG9tYWluKHN0cmluZ3MuZG9tYWluKSxcbiAgICAgICAgLy8gJGVzbGludC1maXgtbWUgaHR0cHM6Ly9naXRodWIuY29tL3JoaW5vZGF2aWQvZXNsaW50LWZpeC1tZVxuICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuICAgICAgICBtZXNzYWdlOiBzdHJpbmdzLm1lc3NhZ2UgYXMgYW55LFxuICAgIH07XG59XG4iXSwidmVyc2lvbiI6M30=