01d6ac3dae7a1bc17266c5398da2b924
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
jest.mock('axios');
jest.mock('../QuoteRequestor', () => {
    return {
        QuoteRequestor: jest.fn().mockImplementation((..._args) => {
            return {
                requestRfqtIndicativeQuotesAsync: mockRequestRfqtIndicativeQuotesAsync,
                requestRfqtFirmQuotesAsync: mockRequestRfqtFirmQuotesAsync,
            };
        }),
    };
});
jest.mock('../../utils/rfq_maker_manager', () => {
    return {
        RfqMakerManager: jest.fn().mockImplementation((..._args) => {
            const rmm = new stream_1.EventEmitter();
            rmm.getRfqtV1MakerOfferings = jest.fn().mockReturnValue([]);
            return rmm;
        }),
    };
});
const types_1 = require("@0x/types");
const utils_1 = require("@0x/utils");
const axios_1 = require("axios");
const stream_1 = require("stream");
const rfq_maker_manager_1 = require("../../utils/rfq_maker_manager");
const QuoteRequestor_1 = require("../QuoteRequestor");
const RefreshingQuoteRequestor_1 = require("../RefreshingQuoteRequestor");
const mockRequestRfqtIndicativeQuotesAsync = jest.fn().mockResolvedValue([]);
const mockRequestRfqtFirmQuotesAsync = jest.fn().mockResolvedValue([]);
// TODO (rhinodavid): Find a better way to initialize mocked classes
const mockRfqMakerManager = jest.mocked(
// tslint:disable-next-line: no-object-literal-type-assertion custom-no-magic-numbers
new rfq_maker_manager_1.RfqMakerManager({}, {}, /* chainId */ 1337));
const mockAxiosInstance = jest.mocked(axios_1.default.create());
describe('RefreshingQuoteRequestor', () => {
    it('refreshes the quote requestor instance on new pairs', () => {
        new RefreshingQuoteRequestor_1.RefreshingQuoteRequestor(mockRfqMakerManager, mockAxiosInstance); // tslint:disable-line: no-unused-expression
        expect(QuoteRequestor_1.QuoteRequestor).toBeCalledTimes(1);
        mockRfqMakerManager.emit(rfq_maker_manager_1.RfqMakerManager.REFRESHED_EVENT);
        expect(QuoteRequestor_1.QuoteRequestor).toBeCalledTimes(2);
    });
    describe('requestRfqtIndicativeQuotesAsync', () => {
        it('passes through arguments to quote requestor', async () => {
            const refreshingQuoteRequestor = new RefreshingQuoteRequestor_1.RefreshingQuoteRequestor(mockRfqMakerManager, mockAxiosInstance);
            await refreshingQuoteRequestor.requestRfqtIndicativeQuotesAsync('0xmakertoken', '0xtakertoken', 
            /* assetFillAmount */ new utils_1.BigNumber(100), types_1.MarketOperation.Buy, 
            /* comparisonPrice */ undefined, {
                integrator: {
                    allowedChainIds: [],
                    apiKeys: [],
                    integratorId: 'uuid-integrator-id',
                    label: 'integrator',
                    plp: false,
                    rfqm: false,
                    rfqt: true,
                },
                intentOnFilling: false,
                isIndicative: true,
                takerAddress: '0xtakeraddress',
                txOrigin: '0xtxorign',
            });
            const args = mockRequestRfqtIndicativeQuotesAsync.mock.calls[0];
            expect(args).toMatchInlineSnapshot(`
                Array [
                  "0xmakertoken",
                  "0xtakertoken",
                  "100",
                  "Buy",
                  undefined,
                  Object {
                    "integrator": Object {
                      "integratorId": "uuid-integrator-id",
                      "label": "integrator",
                    },
                    "intentOnFilling": false,
                    "isIndicative": true,
                    "takerAddress": "0xtakeraddress",
                    "txOrigin": "0xtxorign",
                  },
                ]
            `);
        });
    });
    describe('requestRfqtFirmQuotesAsync', () => {
        it('passes through arguments to quote requestor', async () => {
            const refreshingQuoteRequestor = new RefreshingQuoteRequestor_1.RefreshingQuoteRequestor(mockRfqMakerManager, mockAxiosInstance);
            await refreshingQuoteRequestor.requestRfqtFirmQuotesAsync('0xmakertoken', '0xtakertoken', 
            /* assetFillAmount */ new utils_1.BigNumber(100), types_1.MarketOperation.Buy, 
            /* comparisonPrice */ undefined, {
                integrator: {
                    allowedChainIds: [],
                    apiKeys: [],
                    integratorId: 'uuid-integrator-id',
                    label: 'integrator',
                    plp: false,
                    rfqm: false,
                    rfqt: true,
                },
                intentOnFilling: true,
                takerAddress: '0xtakeraddress',
                txOrigin: '0xtxorign',
            });
            const args = mockRequestRfqtFirmQuotesAsync.mock.calls[0];
            expect(args).toMatchInlineSnapshot(`
                Array [
                  "0xmakertoken",
                  "0xtakertoken",
                  "100",
                  "Buy",
                  undefined,
                  Object {
                    "integrator": Object {
                      "integratorId": "uuid-integrator-id",
                      "label": "integrator",
                    },
                    "intentOnFilling": true,
                    "takerAddress": "0xtakeraddress",
                    "txOrigin": "0xtxorign",
                  },
                ]
            `);
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL2Rhdmlkd2Fsc2gvY29kZS1sb2NhbC8weC1yZnEtYXBpL3NyYy9xdW90ZVJlcXVlc3Rvci9fX3Rlc3RzX18vUmVmcmVzaGluZ1F1b3RlUmVxdWVzdG9yLnRlc3QudHMiLCJtYXBwaW5ncyI6Ijs7QUFXQSxJQUFJLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDO0FBSW5CLElBQUksQ0FBQyxJQUFJLENBQUMsbUJBQW1CLEVBQUUsR0FBRyxFQUFFO0lBQ2hDLE9BQU87UUFDSCxjQUFjLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRSxDQUFDLGtCQUFrQixDQUFDLENBQUMsR0FBRyxLQUFLLEVBQUUsRUFBRTtZQUN0RCxPQUFPO2dCQUNILGdDQUFnQyxFQUFFLG9DQUFvQztnQkFDdEUsMEJBQTBCLEVBQUUsOEJBQThCO2FBQzdELENBQUM7UUFDTixDQUFDLENBQUM7S0FDTCxDQUFDO0FBQ04sQ0FBQyxDQUFDLENBQUM7QUFFSCxJQUFJLENBQUMsSUFBSSxDQUFDLCtCQUErQixFQUFFLEdBQUcsRUFBRTtJQUM1QyxPQUFPO1FBQ0gsZUFBZSxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUUsQ0FBQyxrQkFBa0IsQ0FBQyxDQUFDLEdBQUcsS0FBSyxFQUFFLEVBQUU7WUFDdkQsTUFBTSxHQUFHLEdBQUcsSUFBSSxxQkFBWSxFQUFtRCxDQUFDO1lBQ2hGLEdBQUcsQ0FBQyx1QkFBdUIsR0FBRyxJQUFJLENBQUMsRUFBRSxFQUFFLENBQUMsZUFBZSxDQUFDLEVBQUUsQ0FBQyxDQUFDO1lBQzVELE9BQU8sR0FBRyxDQUFDO1FBQ2YsQ0FBQyxDQUFDO0tBQ0wsQ0FBQztBQUNOLENBQUMsQ0FBQyxDQUFDO0FBbENILHFDQUE0QztBQUM1QyxxQ0FBc0M7QUFDdEMsaUNBQTZDO0FBQzdDLG1DQUFzQztBQUl0QyxxRUFBZ0U7QUFDaEUsc0RBQW1EO0FBQ25ELDBFQUF1RTtBQUl2RSxNQUFNLG9DQUFvQyxHQUFHLElBQUksQ0FBQyxFQUFFLEVBQUUsQ0FBQyxpQkFBaUIsQ0FBQyxFQUFFLENB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SztvQkFDVixJQUFJLEVBQUUsS0FBSztvQkFDWCxJQUFJLEVBQUUsSUFBSTtpQkFDYjtnQkFDRCxlQUFlLEVBQUUsSUFBSTtnQkFDckIsWUFBWSxFQUFFLGdCQUFnQjtnQkFDOUIsUUFBUSxFQUFFLFdBQVc7YUFDeEIsQ0FDSixDQUFDO1lBRUYsTUFBTSxJQUFJLEdBQUcsOEJBQThCLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUMxRCxNQUFNLENBQUMsSUFBSSxDQUFDLENBQUMscUJBQXFCLENBQUM7Ozs7Ozs7Ozs7Ozs7Ozs7O2FBaUJsQyxDQUFDLENBQUM7UUFDUCxDQUFDLENBQUMsQ0FBQztJQUNQLENBQUMsQ0FBQyxDQUFDO0FBQ1AsQ0FBQyxDQUFDLENBQUMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiL1VzZXJzL2Rhdmlkd2Fsc2gvY29kZS1sb2NhbC8weC1yZnEtYXBpL3NyYy9xdW90ZVJlcXVlc3Rvci9fX3Rlc3RzX18vUmVmcmVzaGluZ1F1b3RlUmVxdWVzdG9yLnRlc3QudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTWFya2V0T3BlcmF0aW9uIH0gZnJvbSAnQDB4L3R5cGVzJztcbmltcG9ydCB7IEJpZ051bWJlciB9IGZyb20gJ0AweC91dGlscyc7XG5pbXBvcnQgYXhpb3MsIHsgQXhpb3NJbnN0YW5jZSB9IGZyb20gJ2F4aW9zJztcbmltcG9ydCB7IEV2ZW50RW1pdHRlciB9IGZyb20gJ3N0cmVhbSc7XG5cbmltcG9ydCB7IENvbmZpZ01hbmFnZXIgfSBmcm9tICcuLi8uLi91dGlscy9jb25maWdfbWFuYWdlcic7XG5pbXBvcnQgeyBSZnFNYWtlckRiVXRpbHMgfSBmcm9tICcuLi8uLi91dGlscy9yZnFfbWFrZXJfZGJfdXRpbHMnO1xuaW1wb3J0IHsgUmZxTWFrZXJNYW5hZ2VyIH0gZnJvbSAnLi4vLi4vdXRpbHMvcmZxX21ha2VyX21hbmFnZXInO1xuaW1wb3J0IHsgUXVvdGVSZXF1ZXN0b3IgfSBmcm9tICcuLi9RdW90ZVJlcXVlc3Rvcic7XG5pbXBvcnQgeyBSZWZyZXNoaW5nUXVvdGVSZXF1ZXN0b3IgfSBmcm9tICcuLi9SZWZyZXNoaW5nUXVvdGVSZXF1ZXN0b3InO1xuXG5qZXN0Lm1vY2soJ2F4aW9zJyk7XG5cbmNvbnN0IG1vY2tSZXF1ZXN0UmZxdEluZGljYXRpdmVRdW90ZXNBc3luYyA9IGplc3QuZm4oKS5tb2NrUmVzb2x2ZWRWYWx1ZShbXSk7XG5jb25zdCBtb2NrUmVxdWVzdFJmcXRGaXJtUXVvdGVzQXN5bmMgPSBqZXN0LmZuKCkubW9ja1Jlc29sdmVkVmFsdWUoW10pO1xuamVzdC5tb2NrKCcuLi9RdW90ZVJlcXVlc3RvcicsICgpID0+IHtcbiAgICByZXR1cm4ge1xuICAgICAgICBRdW90ZVJlcXVlc3RvcjogamVzdC5mbigpLm1vY2tJbXBsZW1lbnRhdGlvbigoLi4uX2FyZ3MpID0+IHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgcmVxdWVzdFJmcXRJbmRpY2F0aXZlUXVvdGVzQXN5bmM6IG1vY2tSZXF1ZXN0UmZxdEluZGljYXRpdmVRdW90ZXNBc3luYyxcbiAgICAgICAgICAgICAgICByZXF1ZXN0UmZxdEZpcm1RdW90ZXNBc3luYzogbW9ja1JlcXVlc3RSZnF0RmlybVF1b3Rlc0FzeW5jLFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfSksXG4gICAgfTtcbn0pO1xuXG5qZXN0Lm1vY2soJy4uLy4uL3V0aWxzL3JmcV9tYWtlcl9tYW5hZ2VyJywgKCkgPT4ge1xuICAgIHJldHVybiB7XG4gICAgICAgIFJmcU1ha2VyTWFuYWdlcjogamVzdC5mbigpLm1vY2tJbXBsZW1lbnRhdGlvbigoLi4uX2FyZ3MpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHJtbSA9IG5ldyBFdmVudEVtaXR0ZXIoKSBhcyB1bmtub3duIGFzIGplc3QuTW9ja2VkT2JqZWN0PFJmcU1ha2VyTWFuYWdlcj47XG4gICAgICAgICAgICBybW0uZ2V0UmZxdFYxTWFrZXJPZmZlcmluZ3MgPSBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKFtdKTtcbiAgICAgICAgICAgIHJldHVybiBybW07XG4gICAgICAgIH0pLFxuICAgIH07XG59KTtcblxuLy8gVE9ETyAocmhpbm9kYXZpZCk6IEZpbmQgYSBiZXR0ZXIgd2F5IHRvIGluaXRpYWxpemUgbW9ja2VkIGNsYXNzZXNcbmNvbnN0IG1vY2tSZnFNYWtlck1hbmFnZXIgPSBqZXN0Lm1vY2tlZChcbiAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6IG5vLW9iamVjdC1saXRlcmFsLXR5cGUtYXNzZXJ0aW9uIGN1c3RvbS1uby1tYWdpYy1udW1iZXJzXG4gICAgbmV3IFJmcU1ha2VyTWFuYWdlcih7fSBhcyBDb25maWdNYW5hZ2VyLCB7fSBhcyBSZnFNYWtlckRiVXRpbHMsIC8qIGNoYWluSWQgKi8gMTMzNyksXG4pO1xuY29uc3QgbW9ja0F4aW9zSW5zdGFuY2UgPSBqZXN0Lm1vY2tlZChheGlvcy5jcmVhdGUoKSkgYXMgdW5rbm93biBhcyBqZXN0Lk1vY2tlZE9iamVjdDxBeGlvc0luc3RhbmNlPjtcblxuZGVzY3JpYmUoJ1JlZnJlc2hpbmdRdW90ZVJlcXVlc3RvcicsICgpID0+IHtcbiAgICBpdCgncmVmcmVzaGVzIHRoZSBxdW90ZSByZXF1ZXN0b3IgaW5zdGFuY2Ugb24gbmV3IHBhaXJzJywgKCkgPT4ge1xuICAgICAgICBuZXcgUmVmcmVzaGluZ1F1b3RlUmVxdWVzdG9yKG1vY2tSZnFNYWtlck1hbmFnZXIsIG1vY2tBeGlvc0luc3RhbmNlKTsgLy8gdHNsaW50OmRpc2FibGUtbGluZTogbm8tdW51c2VkLWV4cHJlc3Npb25cblxuICAgICAgICBleHBlY3QoUXVvdGVSZXF1ZXN0b3IpLnRvQmVDYWxsZWRUaW1lcygxKTtcblxuICAgICAgICBtb2NrUmZxTWFrZXJNYW5hZ2VyLmVtaXQoUmZxTWFrZXJNYW5hZ2VyLlJFRlJFU0hFRF9FVkVOVCk7XG5cbiAgICAgICAgZXhwZWN0KFF1b3RlUmVxdWVzdG9yKS50b0JlQ2FsbGVkVGltZXMoMik7XG4gICAgfSk7XG5cbiAgICBkZXNjcmliZSgncmVxdWVzdFJmcXRJbmRpY2F0aXZlUXVvdGVzQXN5bmMnLCAoKSA9PiB7XG4gICAgICAgIGl0KCdwYXNzZXMgdGhyb3VnaCBhcmd1bWVudHMgdG8gcXVvdGUgcmVxdWVzdG9yJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgcmVmcmVzaGluZ1F1b3RlUmVxdWVzdG9yID0gbmV3IFJlZnJlc2hpbmdRdW90ZVJlcXVlc3Rvcihtb2NrUmZxTWFrZXJNYW5hZ2VyLCBtb2NrQXhpb3NJbnN0YW5jZSk7XG5cbiAgICAgICAgICAgIGF3YWl0IHJlZnJlc2hpbmdRdW90ZVJlcXVlc3Rvci5yZXF1ZXN0UmZxdEluZGljYXRpdmVRdW90ZXNBc3luYyhcbiAgICAgICAgICAgICAgICAnMHhtYWtlcnRva2VuJyxcbiAgICAgICAgICAgICAgICAnMHh0YWtlcnRva2VuJyxcbiAgICAgICAgICAgICAgICAvKiBhc3NldEZpbGxBbW91bnQgKi8gbmV3IEJpZ051bWJlcigxMDApLFxuICAgICAgICAgICAgICAgIE1hcmtldE9wZXJhdGlvbi5CdXksXG4gICAgICAgICAgICAgICAgLyogY29tcGFyaXNvblByaWNlICovIHVuZGVmaW5lZCxcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGludGVncmF0b3I6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFsbG93ZWRDaGFpbklkczogW10sXG4gICAgICAgICAgICAgICAgICAgICAgICBhcGlLZXlzOiBbXSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGludGVncmF0b3JJZDogJ3V1aWQtaW50ZWdyYXRvci1pZCcsXG4gICAgICAgICAgICAgICAgICAgICAgICBsYWJlbDogJ2ludGVncmF0b3InLFxuICAgICAgICAgICAgICAgICAgICAgICAgcGxwOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHJmcW06IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgcmZxdDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgaW50ZW50T25GaWxsaW5nOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgaXNJbmRpY2F0aXZlOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICB0YWtlckFkZHJlc3M6ICcweHRha2VyYWRkcmVzcycsXG4gICAgICAgICAgICAgICAgICAgIHR4T3JpZ2luOiAnMHh0eG9yaWduJyxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgY29uc3QgYXJncyA9IG1vY2tSZXF1ZXN0UmZxdEluZGljYXRpdmVRdW90ZXNBc3luYy5tb2NrLmNhbGxzWzBdO1xuICAgICAgICAgICAgZXhwZWN0KGFyZ3MpLnRvTWF0Y2hJbmxpbmVTbmFwc2hvdChgXG4gICAgICAgICAgICAgICAgQXJyYXkgW1xuICAgICAgICAgICAgICAgICAgXCIweG1ha2VydG9rZW5cIixcbiAgICAgICAgICAgICAgICAgIFwiMHh0YWtlcnRva2VuXCIsXG4gICAgICAgICAgICAgICAgICBcIjEwMFwiLFxuICAgICAgICAgICAgICAgICAgXCJCdXlcIixcbiAgICAgICAgICAgICAgICAgIHVuZGVmaW5lZCxcbiAgICAgICAgICAgICAgICAgIE9iamVjdCB7XG4gICAgICAgICAgICAgICAgICAgIFwiaW50ZWdyYXRvclwiOiBPYmplY3Qge1xuICAgICAgICAgICAgICAgICAgICAgIFwiaW50ZWdyYXRvcklkXCI6IFwidXVpZC1pbnRlZ3JhdG9yLWlkXCIsXG4gICAgICAgICAgICAgICAgICAgICAgXCJsYWJlbFwiOiBcImludGVncmF0b3JcIixcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgXCJpbnRlbnRPbkZpbGxpbmdcIjogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIFwiaXNJbmRpY2F0aXZlXCI6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIFwidGFrZXJBZGRyZXNzXCI6IFwiMHh0YWtlcmFkZHJlc3NcIixcbiAgICAgICAgICAgICAgICAgICAgXCJ0eE9yaWdpblwiOiBcIjB4dHhvcmlnblwiLFxuICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICBgKTtcbiAgICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBkZXNjcmliZSgncmVxdWVzdFJmcXRGaXJtUXVvdGVzQXN5bmMnLCAoKSA9PiB7XG4gICAgICAgIGl0KCdwYXNzZXMgdGhyb3VnaCBhcmd1bWVudHMgdG8gcXVvdGUgcmVxdWVzdG9yJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgcmVmcmVzaGluZ1F1b3RlUmVxdWVzdG9yID0gbmV3IFJlZnJlc2hpbmdRdW90ZVJlcXVlc3Rvcihtb2NrUmZxTWFrZXJNYW5hZ2VyLCBtb2NrQXhpb3NJbnN0YW5jZSk7XG5cbiAgICAgICAgICAgIGF3YWl0IHJlZnJlc2hpbmdRdW90ZVJlcXVlc3Rvci5yZXF1ZXN0UmZxdEZpcm1RdW90ZXNBc3luYyhcbiAgICAgICAgICAgICAgICAnMHhtYWtlcnRva2VuJyxcbiAgICAgICAgICAgICAgICAnMHh0YWtlcnRva2VuJyxcbiAgICAgICAgICAgICAgICAvKiBhc3NldEZpbGxBbW91bnQgKi8gbmV3IEJpZ051bWJlcigxMDApLFxuICAgICAgICAgICAgICAgIE1hcmtldE9wZXJhdGlvbi5CdXksXG4gICAgICAgICAgICAgICAgLyogY29tcGFyaXNvblByaWNlICovIHVuZGVmaW5lZCxcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGludGVncmF0b3I6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFsbG93ZWRDaGFpbklkczogW10sXG4gICAgICAgICAgICAgICAgICAgICAgICBhcGlLZXlzOiBbXSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGludGVncmF0b3JJZDogJ3V1aWQtaW50ZWdyYXRvci1pZCcsXG4gICAgICAgICAgICAgICAgICAgICAgICBsYWJlbDogJ2ludGVncmF0b3InLFxuICAgICAgICAgICAgICAgICAgICAgICAgcGxwOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHJmcW06IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgcmZxdDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgaW50ZW50T25GaWxsaW5nOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICB0YWtlckFkZHJlc3M6ICcweHRha2VyYWRkcmVzcycsXG4gICAgICAgICAgICAgICAgICAgIHR4T3JpZ2luOiAnMHh0eG9yaWduJyxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgY29uc3QgYXJncyA9IG1vY2tSZXF1ZXN0UmZxdEZpcm1RdW90ZXNBc3luYy5tb2NrLmNhbGxzWzBdO1xuICAgICAgICAgICAgZXhwZWN0KGFyZ3MpLnRvTWF0Y2hJbmxpbmVTbmFwc2hvdChgXG4gICAgICAgICAgICAgICAgQXJyYXkgW1xuICAgICAgICAgICAgICAgICAgXCIweG1ha2VydG9rZW5cIixcbiAgICAgICAgICAgICAgICAgIFwiMHh0YWtlcnRva2VuXCIsXG4gICAgICAgICAgICAgICAgICBcIjEwMFwiLFxuICAgICAgICAgICAgICAgICAgXCJCdXlcIixcbiAgICAgICAgICAgICAgICAgIHVuZGVmaW5lZCxcbiAgICAgICAgICAgICAgICAgIE9iamVjdCB7XG4gICAgICAgICAgICAgICAgICAgIFwiaW50ZWdyYXRvclwiOiBPYmplY3Qge1xuICAgICAgICAgICAgICAgICAgICAgIFwiaW50ZWdyYXRvcklkXCI6IFwidXVpZC1pbnRlZ3JhdG9yLWlkXCIsXG4gICAgICAgICAgICAgICAgICAgICAgXCJsYWJlbFwiOiBcImludGVncmF0b3JcIixcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgXCJpbnRlbnRPbkZpbGxpbmdcIjogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgXCJ0YWtlckFkZHJlc3NcIjogXCIweHRha2VyYWRkcmVzc1wiLFxuICAgICAgICAgICAgICAgICAgICBcInR4T3JpZ2luXCI6IFwiMHh0eG9yaWduXCIsXG4gICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgIGApO1xuICAgICAgICB9KTtcbiAgICB9KTtcbn0pO1xuIl0sInZlcnNpb24iOjN9